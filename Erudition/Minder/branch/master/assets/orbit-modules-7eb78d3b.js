import{S as He,I as ur,y as De,z as yt,A as hr,O as pr}from"./ipfs-modules-6140a6e2.js";import{cd as Zt,ce as dr,b0 as Me,aZ as he,cf as fr,cg as Qt,b4 as ye,ch as ft,ci as Tt,cj as er,ck as Ke,cl as gr,cm as tr,cn as wt,co as mr,cp as Et,cq as br,cr as xt,cs as yr,ct as Tr,cu as wr,cv as Er,cw as xr,cx as kr,bu as kt,bq as Ct,cy as Cr,cz as Ge,b1 as Ar}from"./other-modules-3990ee0b.js";import{c as gt,g as rr}from"./ionic-modules-23047cf7.js";import{s as nr}from"./libp2p-modules-7ceb3045.js";class Sr{constructor(){this._index=null}get(){return this._index?this._index.values:[]}updateIndex(e){this._index=e}}class Or extends He{constructor(e,t,r,n={}){n.Index===void 0&&Object.assign(n,{Index:Sr}),super(e,t,r,n),this._type="eventlog",this.events.on("log.op.ADD",(p,w,g)=>{this.events.emit("db.append",g.value)})}add(e,t={}){return this._addOperation({op:"ADD",key:null,value:e},t)}get(e){return this.iterator({gte:e,limit:1}).collect()[0]}iterator(e){const t=this._query(e);let r=0;return{[Symbol.iterator](){return this},next(){let p={value:null,done:!0};return r<t.length&&(p={value:t[r],done:!1},r++),p},collect:()=>t}}_query(e){e||(e={});const t=e.limit?e.limit>-1?e.limit:this._index.get().length:1,r=this._index.get().slice();let n=[];return e.gt||e.gte?n=this._read(r,e.gt?e.gt:e.gte,t,!!e.gte):n=this._read(r.reverse(),e.lt?e.lt:e.lte,t,e.lte||!e.lt).reverse(),e.reverse&&n.reverse(),n}_read(e,t,r,n){const p=e.map(y=>y.hash).indexOf(t);let w=Math.max(p,0);return w+=n?0:1,e.slice(w).slice(0,r)}}class Mr{constructor(){this._index={}}get(){return Object.keys(this._index).map(e=>this._index[e])}updateIndex(e){this._index={},e.values.reduce((t,r)=>(t.includes(r.hash)||(t.push(r.hash),r.payload.op==="ADD"?this._index[r.hash]=r:r.payload.op==="DEL"&&delete this._index[r.payload.value]),t),[])}}class $n extends Or{constructor(e,t,r,n){n||(n={}),n.Index||Object.assign(n,{Index:Mr}),super(e,t,r,n),this._type="feed"}remove(e,t={}){return this.del(e,t)}del(e,t={}){const r={op:"DEL",key:null,value:e};return this._addOperation(r,t)}}class $r{constructor(){this._index={}}get(e){return this._index[e]}updateIndex(e){const t=e.values,r={};for(let n=t.length-1;n>=0;n--){const p=t[n];if(!r[p.payload.key]){if(r[p.payload.key]=!0,p.payload.op==="PUT"){this._index[p.payload.key]=p.payload.value;continue}if(p.payload.op==="DEL"){delete this._index[p.payload.key];continue}}}}}class Ln extends He{constructor(e,t,r,n){const p=Object.assign({},{Index:$r});Object.assign(p,n),super(e,t,r,p),this._type="keyvalue"}get all(){return this._index._index}get(e){return this._index.get(e)}set(e,t,r={}){return this.put(e,t,r)}put(e,t,r={}){return this._addOperation({op:"PUT",key:e,value:t},r)}del(e,t={}){return this._addOperation({op:"DEL",key:e,value:null},t)}}class Lr{constructor(e){this._index=new Zt(e)}get(){return this._index}updateIndex(e){if(this._index){const t=n=>n.payload.value.counters,r=n=>this._index.merge({_counters:n});e.values.filter(n=>n&&n.payload.op==="COUNTER").map(t).forEach(r)}}}class Rn extends He{constructor(e,t,r,n={}){n.Index||Object.assign(n,{Index:Lr}),super(e,t,r,n),this._index=new this.options.Index(this.identity.publicKey),this._type="counter"}get value(){return this._index.get().value}inc(e,t={}){const r=new Zt(this.identity.publicKey,Object.assign({},this._index.get()._counters));return r.increment(e),this._addOperation({op:"COUNTER",key:null,value:r.toJSON()},t)}}class Rr{constructor(){this._index={}}get(e,t=!1){return t?this._index[e]:this._index[e]?this._index[e].payload.value:null}updateIndex(e,t){const r=(n,p,w)=>{if(p.payload.op==="PUTALL"&&p.payload.docs[Symbol.iterator])for(const g of p.payload.docs)g&&n[g.key]!==!0&&(n[g.key]=!0,this._index[g.key]={payload:{op:"PUT",key:g.key,value:g.value}});else n[p.payload.key]!==!0&&(n[p.payload.key]=!0,p.payload.op==="PUT"?this._index[p.payload.key]=p:p.payload.op==="DEL"&&delete this._index[p.payload.key]);return t&&t(p,w),n};e.values.slice().reverse().reduce(r,{})}}const At=(_,e,t)=>_.toString().split(e).join(t);class Nn extends He{constructor(e,t,r,n){n||(n={}),n.indexBy||Object.assign(n,{indexBy:"_id"}),n.Index||Object.assign(n,{Index:Rr}),super(e,t,r,n),this._type="docstore"}get(e,t=!1){e=e.toString();const r=e.split(" ");e=r.length>1?At(e,"."," ").toLowerCase():e.toLowerCase();const n=g=>r.length>1?At(g,"."," ").toLowerCase().indexOf(e)!==-1:g.toLowerCase().indexOf(e)!==-1,p=g=>this._index.get(g),w=g=>t?g.indexOf(e)!==-1:n(g);return Object.keys(this._index._index).filter(w).map(p)}query(e,t={}){const r=t.fullOp||!1;return Object.keys(this._index._index).map(n=>this._index.get(n,r)).filter(e)}batchPut(e,t){return dr(e,(n,p)=>this._addOperationBatch({op:"PUT",key:n[this.options.indexBy],value:n},!0,p===e.length-1,t),{concurrency:1}).then(()=>this.saveSnapshot())}put(e,t={}){if(!e[this.options.indexBy])throw new Error(`The provided document doesn't contain field '${this.options.indexBy}'`);return this._addOperation({op:"PUT",key:e[this.options.indexBy],value:e},t)}putAll(e,t={}){if(Array.isArray(e)||(e=[e]),!e.every(r=>r[this.options.indexBy]))throw new Error(`The provided document doesn't contain field '${this.options.indexBy}'`);return this._addOperation({op:"PUTALL",docs:e.map(r=>({key:r[this.options.indexBy],value:r}))},t)}del(e,t={}){if(!this._index.get(e))throw new Error(`No entry with key '${e}' in the database`);return this._addOperation({op:"DEL",key:e,value:null},t)}}const xe=Me.create("pubsub",{color:Me.Colors.Yellow});Me.setLogLevel("ERROR");const Nr=256;let Be=0;class Bn{constructor(e,t){this._ipfs=e,this._id=t,this._subscriptions={},this._ipfs.pubsub===null&&xe.error("The provided version of ipfs doesn't have pubsub support. Messages will not be exchanged."),this._handleMessage=this._handleMessage.bind(this),this._ipfs.setMaxListeners&&this._ipfs.setMaxListeners(Nr)}async subscribe(e,t,r,n={}){if(!this._subscriptions[e]&&this._ipfs.pubsub){await this._ipfs.pubsub.subscribe(e,this._handleMessage,n);const p=new ur(this._ipfs.pubsub,e);p.on("join",w=>{xe.debug(`Peer joined ${e}:`),xe.debug(w),this._subscriptions[e]?r(e,w):(xe.warn("Peer joined a room we don't have a subscription for"),xe.warn(e,w))}),p.on("leave",w=>xe.debug(`Peer ${w} left ${e}`)),p.on("error",w=>xe.error(w)),this._subscriptions[e]={topicMonitor:p,onMessage:t,onNewPeer:r},Be++,xe.debug("Topics open:",Be)}}async unsubscribe(e){this._subscriptions[e]&&(await this._ipfs.pubsub.unsubscribe(e,this._handleMessage),this._subscriptions[e].topicMonitor.stop(),delete this._subscriptions[e],xe.debug(`Unsubscribed from '${e}'`),Be--,xe.debug("Topics open:",Be))}publish(e,t,r={}){if(this._subscriptions[e]&&this._ipfs.pubsub){let n;he.Buffer.isBuffer(t)||typeof t=="string"?n=t:n=JSON.stringify(t),this._ipfs.pubsub.publish(e,he.Buffer.from(n),r)}}async disconnect(){const e=Object.keys(this._subscriptions);await fr(e.map(t=>this.unsubscribe.bind(this,t))),this._subscriptions={}}async _handleMessage(e){if(String(e.from)===this._id)return;let t;const r=e.topic?e.topic:e.topicIDs[0];try{t=JSON.parse(he.Buffer.from(e.data).toString())}catch{t=e.data}const n=this._subscriptions[r];n&&n.onMessage&&t&&await n.onMessage(r,t,e.from)}}const Br=Me.create("cache",{color:Me.Colors.Magenta});Me.setLogLevel("ERROR");class _n{constructor(e){this._store=e}get status(){return this._store.status}async close(){if(!this._store)throw new Error("No cache store found to close");this.status==="open"&&await this._store.close()}async open(){if(!this._store)throw new Error("No cache store found to open");this.status!=="open"&&await this._store.open()}async get(e){try{return JSON.parse(await this._store.get(e))}catch(t){if(t.code==="LEVEL_NOT_FOUND"||t.cause!==void 0&&t.cause.code==="LEVEL_NOT_FOUND")return null;throw t}}async set(e,t){await this._store.put(e,JSON.stringify(t)),Br.debug(`cache: Set ${e} to ${JSON.stringify(t)}`)}load(){}destroy(){}async del(e){await this._store.del(e)}}const{ec:_r}=Qt,vr=async(_,e,t)=>{if(!_)throw new Error("No signature given");if(!e)throw new Error("Given publicKey was undefined");if(!t)throw new Error("Given input data was undefined");let r=!1;const n=new _r("secp256k1"),p=n.keyPair({pub:e,pubEnc:"hex"});try{r=n.verify(t,_,p)}catch{}return Promise.resolve(r)},Pr=Object.freeze(Object.defineProperty({__proto__:null,verify:vr},Symbol.toStringTag,{value:"Module"})),Ir=nr.secp256k1.unmarshalSecp256k1PublicKey,Hr=async(_,e,t)=>{if(!_)throw new Error("No signature given");if(!e)throw new Error("Given publicKey was undefined");if(!t)throw new Error("Given input data was undefined");ye.Buffer.isBuffer(t)||(t=ye.Buffer.from(t));const r=(p,w,g)=>p.verify(w,g);let n=!1;try{const p=Ir(ye.Buffer.from(e,"hex"));n=await r(p,t,ye.Buffer.from(_,"hex"))}catch{}return Promise.resolve(n)},Kr=Object.freeze(Object.defineProperty({__proto__:null,verify:Hr},Symbol.toStringTag,{value:"Module"})),Fr={v0:Pr,v1:Kr},Ur=_=>Fr[_],{ec:Dr}=Qt,Gr=new Dr("secp256k1"),St=nr.secp256k1.unmarshalSecp256k1PrivateKey;function je(_="./keystore"){return De&&De.mkdirSync&&De.mkdirSync(_,{recursive:!0}),new er(_,{})}const Ot=new ft(1e3);class Oe{constructor(e={}){typeof e=="string"?this._store=je(e):typeof e.open=="function"?this._store=e:typeof e.store=="string"?this._store=je(e.store):this._store=e.store||je(),this._cache=e.cache||new ft(100)}async open(){if(!this._store)throw new Error("Keystore: No store found to open");await this._store.open()}async close(){this._store&&await this._store.close()}async hasKey(e){if(!e)throw new Error("id needed to check a key");if(this._store.status&&this._store.status!=="open")return null;let t=!1;try{const r=this._cache.get(e)||await this._store.get(e);t=r!=null}catch{console.error("Error: ENOENT: no such file or directory")}return t}async createKey(e,{entropy:t}={}){if(!e)throw new Error("id needed to create a key");if(this._store.status&&this._store.status!=="open")return null;const r=Gr.genKeyPair({entropy:t}).getPrivate().toArrayLike(ye.Buffer),n=ye.Buffer.alloc(32);r.copy(n,n.length-r.length);const p=await St(n),w=p.public.marshal(),g=Tt.publicKeyConvert(ye.Buffer.from(w),!1),y={publicKey:ye.Buffer.from(g).toString("hex"),privateKey:ye.Buffer.from(p.marshal()).toString("hex")};try{await this._store.put(e,JSON.stringify(y))}catch(O){console.log(O)}return this._cache.set(e,y),p}async getKey(e){if(!e)throw new Error("id needed to get a key");if(this._store||await this.open(),this._store.status&&this._store.status!=="open")return null;const t=this._cache.get(e);let r;try{r=t||await this._store.get(e)}catch{}if(!r)return;const n=t||JSON.parse(r);if(n)return t||this._cache.set(e,n),St(ye.Buffer.from(n.privateKey,"hex"))}async sign(e,t){if(!e)throw new Error("No signing key given");if(!t)throw new Error("Given input data was undefined");return ye.Buffer.isBuffer(t)||(t=ye.Buffer.from(t)),ye.Buffer.from(await e.sign(t)).toString("hex")}getPublic(e,t={}){const r=["hex","buffer"],n=typeof t.decompress>"u"?!0:t.decompress,p=t.format||"hex";if(r.indexOf(p)===-1)throw new Error("Supported formats are `hex` and `buffer`");let w=e.public.marshal();return n&&(w=Tt.publicKeyConvert(ye.Buffer.from(w),!1)),w=ye.Buffer.from(w),p==="buffer"?w:w.toString("hex")}async verify(e,t,r,n="v1"){return Oe.verify(e,t,r,n)}static async verify(e,t,r,n="v1"){const p=Ot.get(e);let w=!1;if(p){const g=(y,O,b)=>{let s;return b==="v0"?s=ye.Buffer.compare(ye.Buffer.alloc(30,y),ye.Buffer.alloc(30,O))===0:s=ye.Buffer.isBuffer(O)?ye.Buffer.compare(y,O)===0:y===O,s};w=p.publicKey===t&&g(p.data,r,n)}else{const g=await Ur(n).verify(e,t,r);w=g,g&&Ot.set(e,{publicKey:t,data:r})}return w}}const Se=_=>_!=null;class _e{constructor(e,t,r,n,p,w){if(!Se(e))throw new Error("Identity id is required");if(!Se(t))throw new Error("Invalid public key");if(!Se(r))throw new Error("Signature of the id (idSignature) is required");if(!Se(n))throw new Error("Signature of (publicKey + idSignature) is required");if(!Se(p))throw new Error("Identity type is required");if(!Se(w))throw new Error("Identity provider is required");this._id=e,this._publicKey=t,this._signatures=Object.assign({},{id:r},{publicKey:n}),this._type=p,this._provider=w}get id(){return this._id}get publicKey(){return this._publicKey}get signatures(){return this._signatures}get type(){return this._type}get provider(){return this._provider}toJSON(){return{id:this.id,publicKey:this.publicKey,signatures:this.signatures,type:this.type}}static isIdentity(e){return e.id!==void 0&&e.publicKey!==void 0&&e.signatures!==void 0&&e.signatures.id!==void 0&&e.signatures.publicKey!==void 0&&e.type!==void 0}static toJSON(e){return{id:e.id,publicKey:e.publicKey,signatures:e.signatures,type:e.type}}}class Fe{async getId(e){}async signIdentity(e,t){}static async verifyIdentity(e){}static get type(){throw new Error("'static get type ()' needs to be defined in the inheriting class")}get type(){return this.constructor.type}}const jr="orbitdb";class sr extends Fe{constructor(e){if(super(),!e)throw new Error("OrbitDBIdentityProvider requires a keystore");this._keystore=e}static get type(){return jr}async getId(e={}){const t=e.id;if(!t)throw new Error("id is required");const r=this._keystore,n=await r.getKey(t)||await r.createKey(t);return he.Buffer.from(n.public.marshal()).toString("hex")}async signIdentity(e,t={}){const r=t.id;if(!r)throw new Error("id is required");const n=this._keystore,p=await n.getKey(r);if(!p)throw new Error(`Signing key for '${r}' not found`);return n.sign(p,e)}static async verifyIdentity(e){return Oe.verify(e.signatures.publicKey,e.id,e.publicKey+e.signatures.id)}}var Ve,Mt;function ke(){return Mt||(Mt=1,Ve={ALT:1,CAT:2,REP:3,RNM:4,TRG:5,TBS:6,TLS:7,UDT:11,AND:12,NOT:13,BKR:14,BKA:15,BKN:16,ABG:17,AEN:18,ACTIVE:100,MATCH:101,EMPTY:102,NOMATCH:103,SEM_PRE:200,SEM_POST:201,SEM_OK:300,SEM_SKIP:301,ATTR_N:400,ATTR_R:401,ATTR_MR:402,LOOKAROUND_NONE:500,LOOKAROUND_AHEAD:501,LOOKAROUND_BEHIND:502,BKR_MODE_UM:601,BKR_MODE_PM:602,BKR_MODE_CS:603,BKR_MODE_CI:604}),Ve}var Te={},Ye,$t;function Ue(){return $t||($t=1,Ye={CLASS_MONOSPACE:"apg-mono",CLASS_ACTIVE:"apg-active",CLASS_EMPTY:"apg-empty",CLASS_MATCH:"apg-match",CLASS_NOMATCH:"apg-nomatch",CLASS_LOOKAHEAD:"apg-lh-match",CLASS_LOOKBEHIND:"apg-lb-match",CLASS_REMAINDER:"apg-remainder",CLASS_CTRLCHAR:"apg-ctrl-char",CLASS_LINEEND:"apg-line-end",CLASS_ERROR:"apg-error",CLASS_PHRASE:"apg-phrase",CLASS_EMPTYPHRASE:"apg-empty-phrase",CLASS_STATE:"apg-state",CLASS_STATS:"apg-stats",CLASS_TRACE:"apg-trace",CLASS_GRAMMAR:"apg-grammar",CLASS_RULES:"apg-rules",CLASS_RULESLINK:"apg-rules-link",CLASS_ATTRIBUTES:"apg-attrs"}),Ye}var Re={},we={},Lt;function Vr(){if(Lt)return we;Lt=1;const _=gt,e=4294967292,t=4294967293,r=4294967294,n=4294967295,p=[0,1,3,7,15,31,63,127,255,511,1023],w=["00","01","02","03","04","05","06","07","08","09","0A","0B","0C","0D","0E","0F","10","11","12","13","14","15","16","17","18","19","1A","1B","1C","1D","1E","1F","20","21","22","23","24","25","26","27","28","29","2A","2B","2C","2D","2E","2F","30","31","32","33","34","35","36","37","38","39","3A","3B","3C","3D","3E","3F","40","41","42","43","44","45","46","47","48","49","4A","4B","4C","4D","4E","4F","50","51","52","53","54","55","56","57","58","59","5A","5B","5C","5D","5E","5F","60","61","62","63","64","65","66","67","68","69","6A","6B","6C","6D","6E","6F","70","71","72","73","74","75","76","77","78","79","7A","7B","7C","7D","7E","7F","80","81","82","83","84","85","86","87","88","89","8A","8B","8C","8D","8E","8F","90","91","92","93","94","95","96","97","98","99","9A","9B","9C","9D","9E","9F","A0","A1","A2","A3","A4","A5","A6","A7","A8","A9","AA","AB","AC","AD","AE","AF","B0","B1","B2","B3","B4","B5","B6","B7","B8","B9","BA","BB","BC","BD","BE","BF","C0","C1","C2","C3","C4","C5","C6","C7","C8","C9","CA","CB","CC","CD","CE","CF","D0","D1","D2","D3","D4","D5","D6","D7","D8","D9","DA","DB","DC","DD","DE","DF","E0","E1","E2","E3","E4","E5","E6","E7","E8","E9","EA","EB","EC","ED","EE","EF","F0","F1","F2","F3","F4","F5","F6","F7","F8","F9","FA","FB","FC","FD","FE","FF"],g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),y=[];g.forEach(s=>{y.push(s.charCodeAt(0))}),we.utf8={encode(s){const l=[];return s.forEach(o=>{if(o>=0&&o<=127)l.push(o);else if(o<=2047)l.push(192+(o>>6&p[5])),l.push(128+(o&p[6]));else if(o<55296||o>57343&&o<=65535)l.push(224+(o>>12&p[4])),l.push(128+(o>>6&p[6])),l.push(128+(o&p[6]));else if(o>=65536&&o<=1114111){const c=o>>16&p[5];l.push(240+(c>>2)),l.push(128+((c&p[2])<<4)+(o>>12&p[4])),l.push(128+(o>>6&p[6])),l.push(128+(o&p[6]))}else throw new RangeError(`utf8.encode: character out of range: char: ${o}`)}),he.Buffer.from(l)},decode(s,l){function o(q,S){if((S&192)!==128)return t;const N=((q&p[5])<<6)+(S&p[6]);return N<128?e:N}function c(q,S,N){if((N&192)!==128||(S&192)!==128)return t;const L=((q&p[4])<<12)+((S&p[6])<<6)+(N&p[6]);return L<2048?e:L>=55296&&L<=57343?r:L}function h(q,S,N,L){if((L&192)!==128||(N&192)!==128||(S&192)!==128)return t;const d=(((q&p[3])<<2)+(S>>4&p[2])<<16)+((S&p[4])<<12)+((N&p[6])<<6)+(L&p[6]);return d<65536?e:d>1114111?r:d}let M,a,E,K,F,Y;const f=s.length;let U=l?3:0;const W=[];for(;U<f;){a=s[U],M=n;const q=!0;for(;q;){if(a>=0&&a<=127){M=a,Y=1;break}if(E=U+1,E<f&&a>=194&&a<=223){M=o(a,s[E]),Y=2;break}if(K=U+2,K<f&&a>=224&&a<=239){M=c(a,s[E],s[K]),Y=3;break}if(F=U+3,F<f&&a>=240&&a<=244){M=h(a,s[E],s[K],s[F]),Y=4;break}break}if(M>1114111){const S=`byte[${U}]`;throw M===n?new RangeError(`utf8.decode: ill-formed UTF8 byte sequence found at: ${S}`):M===t?new RangeError(`utf8.decode: illegal trailing byte found at: ${S}`):M===r?new RangeError(`utf8.decode: code point out of range found at: ${S}`):M===e?new RangeError(`utf8.decode: non-shortest form found at: ${S}`):new RangeError(`utf8.decode: unrecognized error found at: ${S}`)}W.push(M),U+=Y}return W}},we.utf16be={encode(s){const l=[];let o,c,h;for(let M=0;M<s.length;M+=1)if(o=s[M],o>=0&&o<=55295||o>=57344&&o<=65535)l.push(o>>8&p[8]),l.push(o&p[8]);else if(o>=65536&&o<=1114111)h=o-65536,c=55296+(h>>10),h=56320+(h&p[10]),l.push(c>>8&p[8]),l.push(c&p[8]),l.push(h>>8&p[8]),l.push(h&p[8]);else throw new RangeError(`utf16be.encode: UTF16BE value out of range: char[${M}]: ${o}`);return he.Buffer.from(l)},decode(s,l){if(s.length%2>0)throw new RangeError(`utf16be.decode: data length must be even multiple of 2: length: ${s.length}`);const o=[],c=s.length;let h=l?2:0,M=0,a,E,K,F,Y,f;for(;h<c;){for(;;){if(K=h+1,K<c){if(Y=(s[h]<<8)+s[K],Y<55296||Y>57343){a=Y,E=2;break}if(F=h+3,F<c&&(f=(s[h+2]<<8)+s[F],Y<=56319&&f>=56320&&f<=57343)){a=65536+(Y-55296<<10)+(f-56320),E=4;break}}throw new RangeError(`utf16be.decode: ill-formed UTF16BE byte sequence found: byte[${h}]`)}o[M++]=a,h+=E}return o}},we.utf16le={encode(s){const l=[];let o,c,h;for(let M=0;M<s.length;M+=1)if(o=s[M],o>=0&&o<=55295||o>=57344&&o<=65535)l.push(o&p[8]),l.push(o>>8&p[8]);else if(o>=65536&&o<=1114111)h=o-65536,c=55296+(h>>10),h=56320+(h&p[10]),l.push(c&p[8]),l.push(c>>8&p[8]),l.push(h&p[8]),l.push(h>>8&p[8]);else throw new RangeError(`utf16le.encode: UTF16LE value out of range: char[${M}]: ${o}`);return he.Buffer.from(l)},decode(s,l){if(s.length%2>0)throw new RangeError(`utf16le.decode: data length must be even multiple of 2: length: ${s.length}`);const o=[],c=s.length;let h=l?2:0,M=0,a,E,K,F,Y,f;for(;h<c;){for(;;){if(K=h+1,K<c){if(Y=(s[K]<<8)+s[h],Y<55296||Y>57343){a=Y,E=2;break}if(F=h+3,F<c&&(f=(s[F]<<8)+s[h+2],Y<=56319&&f>=56320&&f<=57343)){a=65536+(Y-55296<<10)+(f-56320),E=4;break}}throw new RangeError(`utf16le.decode: ill-formed UTF16LE byte sequence found: byte[${h}]`)}o[M++]=a,h+=E}return o}},we.utf32be={encode(s){const l=he.Buffer.alloc(s.length*4);let o=0;return s.forEach(c=>{if(c>=55296&&c<=57343||c>1114111)throw new RangeError(`utf32be.encode: UTF32BE character code out of range: char[${o/4}]: ${c}`);l[o++]=c>>24&p[8],l[o++]=c>>16&p[8],l[o++]=c>>8&p[8],l[o++]=c&p[8]}),l},decode(s,l){if(s.length%4>0)throw new RangeError(`utf32be.decode: UTF32BE byte length must be even multiple of 4: length: ${s.length}`);const o=[];let c=l?4:0;for(;c<s.length;c+=4){const h=(s[c]<<24)+(s[c+1]<<16)+(s[c+2]<<8)+s[c+3];if(h>=55296&&h<=57343||h>1114111)throw new RangeError(`utf32be.decode: UTF32BE character code out of range: char[${c/4}]: ${h}`);o.push(h)}return o}},we.utf32le={encode(s){const l=he.Buffer.alloc(s.length*4);let o=0;return s.forEach(c=>{if(c>=55296&&c<=57343||c>1114111)throw new RangeError(`utf32le.encode: UTF32LE character code out of range: char[${o/4}]: ${c}`);l[o++]=c&p[8],l[o++]=c>>8&p[8],l[o++]=c>>16&p[8],l[o++]=c>>24&p[8]}),l},decode(s,l){if(s.length%4>0)throw new RangeError(`utf32be.decode: UTF32LE byte length must be even multiple of 4: length: ${s.length}`);const o=[];let c=l?4:0;for(;c<s.length;c+=4){const h=(s[c+3]<<24)+(s[c+2]<<16)+(s[c+1]<<8)+s[c];if(h>=55296&&h<=57343||h>1114111)throw new RangeError(`utf32le.encode: UTF32LE character code out of range: char[${c/4}]: ${h}`);o.push(h)}return o}},we.uint7={encode(s){const l=he.Buffer.alloc(s.length);for(let o=0;o<s.length;o+=1){if(s[o]>127)throw new RangeError(`uint7.encode: UINT7 character code out of range: char[${o}]: ${s[o]}`);l[o]=s[o]}return l},decode(s){const l=[];for(let o=0;o<s.length;o+=1){if(s[o]>127)throw new RangeError(`uint7.decode: UINT7 character code out of range: byte[${o}]: ${s[o]}`);l[o]=s[o]}return l}},we.uint8={encode(s){const l=he.Buffer.alloc(s.length);for(let o=0;o<s.length;o+=1){if(s[o]>255)throw new RangeError(`uint8.encode: UINT8 character code out of range: char[${o}]: ${s[o]}`);l[o]=s[o]}return l},decode(s){const l=[];for(let o=0;o<s.length;o+=1)l[o]=s[o];return l}},we.uint16be={encode(s){const l=he.Buffer.alloc(s.length*2);let o=0;return s.forEach(c=>{if(c>65535)throw new RangeError(`uint16be.encode: UINT16BE character code out of range: char[${o/2}]: ${c}`);l[o++]=c>>8&p[8],l[o++]=c&p[8]}),l},decode(s){if(s.length%2>0)throw new RangeError(`uint16be.decode: UINT16BE byte length must be even multiple of 2: length: ${s.length}`);const l=[];for(let o=0;o<s.length;o+=2)l.push((s[o]<<8)+s[o+1]);return l}},we.uint16le={encode(s){const l=he.Buffer.alloc(s.length*2);let o=0;return s.forEach(c=>{if(c>65535)throw new RangeError(`uint16le.encode: UINT16LE character code out of range: char[${o/2}]: ${c}`);l[o++]=c&p[8],l[o++]=c>>8&p[8]}),l},decode(s){if(s.length%2>0)throw new RangeError(`uint16le.decode: UINT16LE byte length must be even multiple of 2: length: ${s.length}`);const l=[];for(let o=0;o<s.length;o+=2)l.push((s[o+1]<<8)+s[o]);return l}},we.uint32be={encode(s){const l=he.Buffer.alloc(s.length*4);let o=0;return s.forEach(c=>{l[o++]=c>>24&p[8],l[o++]=c>>16&p[8],l[o++]=c>>8&p[8],l[o++]=c&p[8]}),l},decode(s){if(s.length%4>0)throw new RangeError(`uint32be.decode: UINT32BE byte length must be even multiple of 4: length: ${s.length}`);const l=[];for(let o=0;o<s.length;o+=4)l.push((s[o]<<24)+(s[o+1]<<16)+(s[o+2]<<8)+s[o+3]);return l}},we.uint32le={encode(s){const l=he.Buffer.alloc(s.length*4);let o=0;return s.forEach(c=>{l[o++]=c&p[8],l[o++]=c>>8&p[8],l[o++]=c>>16&p[8],l[o++]=c>>24&p[8]}),l},decode(s){if(s.length%4>0)throw new RangeError(`uint32le.decode: UINT32LE byte length must be even multiple of 4: length: ${s.length}`);const l=[];for(let o=0;o<s.length;o+=4)l.push((s[o+3]<<24)+(s[o+2]<<16)+(s[o+1]<<8)+s[o]);return l}},we.string={encode(s){return _.utf16le.encode(s).toString("utf16le")},decode(s){return _.utf16le.decode(he.Buffer.from(s,"utf16le"),0)}},we.escaped={encode(s){const l=[];for(let o=0;o<s.length;o+=1){const c=s[o];if(c===96)l.push(c),l.push(c);else if(c===10)l.push(c);else if(c>=32&&c<=126)l.push(c);else{let h="";if(c>=0&&c<=31)h+=`\`x${w[c]}`;else if(c>=127&&c<=255)h+=`\`x${w[c]}`;else if(c>=256&&c<=65535)h+=`\`u${w[c>>8&p[8]]}${w[c&p[8]]}`;else if(c>=65536&&c<=4294967295){h+="`u{";const a=c>>24&p[8];a>0&&(h+=w[a]),h+=`${w[c>>16&p[8]]+w[c>>8&p[8]]+w[c&p[8]]}}`}else throw new Error("escape.encode(char): char > 0xffffffff not allowed");he.Buffer.from(h).forEach(a=>{l.push(a)})}}return he.Buffer.from(l)},decode(s){function l(f){return f>=48&&f<=57||f>=65&&f<=70||f>=97&&f<=102}function o(f,U,W){const q={char:null,nexti:f+2,error:!0};if(f+1<U&&l(W[f])&&l(W[f+1])){const S=String.fromCodePoint(W[f],W[f+1]);q.char=parseInt(S,16),Number.isNaN(q.char)||(q.error=!1)}return q}function c(f,U,W){const q={char:null,nexti:f+4,error:!0};if(f+3<U&&l(W[f])&&l(W[f+1])&&l(W[f+2])&&l(W[f+3])){const S=String.fromCodePoint(W[f],W[f+1],W[f+2],W[f+3]);q.char=parseInt(S,16),Number.isNaN(q.char)||(q.error=!1)}return q}function h(f,U,W){const q={char:null,nexti:f+4,error:!0};let S="";for(;f<U&&l(W[f]);)S+=String.fromCodePoint(W[f]),f+=1;return q.char=parseInt(S,16),W[f]===125&&!Number.isNaN(q.char)&&(q.error=!1),q.nexti=f+1,q}const M=[],a=s.length;let E,K,F,Y=0;for(;Y<a;){for(;;){if(F=!0,s[Y]!==96){M.push(s[Y]),Y+=1,F=!1;break}if(E=Y+1,E>=a)break;if(s[E]===96){M.push(96),Y+=2,F=!1;break}if(s[E]===120){if(K=o(E+1,a,s),K.error)break;M.push(K.char),Y=K.nexti,F=!1;break}if(s[E]===117){if(s[E+1]===123){if(K=h(E+2,a,s),K.error)break;M.push(K.char),Y=K.nexti,F=!1;break}if(K=c(E+1,a,s),K.error)break;M.push(K.char),Y=K.nexti,F=!1;break}break}if(F)throw new Error(`escaped.decode: ill-formed escape sequence at buf[${Y}]`)}return M}};const O=13,b=10;return we.lineEnds={crlf(s){const l=[];let o=0;for(;o<s.length;)switch(s[o]){case O:o+1<s.length&&s[o+1]===b?o+=2:o+=1,l.push(O),l.push(b);break;case b:l.push(O),l.push(b),o+=1;break;default:l.push(s[o]),o+=1;break}return l.length>0&&l[l.length-1]!==b&&(l.push(O),l.push(b)),l},lf(s){const l=[];let o=0;for(;o<s.length;)switch(s[o]){case O:o+1<s.length&&s[o+1]===b?o+=2:o+=1,l.push(b);break;case b:l.push(b),o+=1;break;default:l.push(s[o]),o+=1;break}return l.length>0&&l[l.length-1]!==b&&l.push(b),l}},we.base64={encode(s){if(s.length===0)return he.Buffer.alloc(0);let l,o,c,h=s.length%3;h=h>0?3-h:0;let M=(s.length+h)/3;const a=he.Buffer.alloc(M*4);h>0&&(M-=1),l=0,o=0;for(let E=0;E<M;E+=1)c=s[l++]<<16,c+=s[l++]<<8,c+=s[l++],a[o++]=y[c>>18&p[6]],a[o++]=y[c>>12&p[6]],a[o++]=y[c>>6&p[6]],a[o++]=y[c&p[6]];if(h===0)return a;if(h===1)return c=s[l++]<<16,c+=s[l]<<8,a[o++]=y[c>>18&p[6]],a[o++]=y[c>>12&p[6]],a[o++]=y[c>>6&p[6]],a[o]=y[64],a;if(h===2)return c=s[l]<<16,a[o++]=y[c>>18&p[6]],a[o++]=y[c>>12&p[6]],a[o++]=y[64],a[o]=y[64],a},decode(s){function l(Y){const f=[];let U=0;for(let W=0;W<Y.length;W+=1){const q=Y[W],S=!0;for(;S&&!(q===32||q===9||q===10||q===13);){if(q>=65&&q<=90){f.push(q-65);break}if(q>=97&&q<=122){f.push(q-71);break}if(q>=48&&q<=57){f.push(q+4);break}if(q===43){f.push(62);break}if(q===47){f.push(63);break}if(q===61){f.push(64),U+=1;break}throw new RangeError(`base64.decode: invalid character buf[${W}]: ${q}`)}}if(f.length%4>0)throw new RangeError(`base64.decode: string length not integral multiple of 4: ${f.length}`);switch(U){case 0:break;case 1:if(f[f.length-1]!==64)throw new RangeError("base64.decode: one tail character found: not last character");break;case 2:if(f[f.length-1]!==64||f[f.length-2]!==64)throw new RangeError("base64.decode: two tail characters found: not last characters");break;default:throw new RangeError(`base64.decode: more than two tail characters found: ${U}`)}return{tail:U,buf:he.Buffer.from(f)}}if(s.length===0)return he.Buffer.alloc(0);const o=l(s),{tail:c}=o,h=o.buf;let M,a,E,K=h.length/4;const F=he.Buffer.alloc(K*3-c);c>0&&(K-=1),a=0,M=0;for(let Y=0;Y<K;Y+=1)E=h[M++]<<18,E+=h[M++]<<12,E+=h[M++]<<6,E+=h[M++],F[a++]=E>>16&p[8],F[a++]=E>>8&p[8],F[a++]=E&p[8];return c===1&&(E=h[M++]<<18,E+=h[M++]<<12,E+=h[M]<<6,F[a++]=E>>16&p[8],F[a]=E>>8&p[8]),c===2&&(E=h[M++]<<18,E+=h[M++]<<12,F[a]=E>>16&p[8]),F},toString(s){if(s.length%4>0)throw new RangeError(`base64.toString: input buffer length not multiple of 4: ${s.length}`);let l="",o=0;function c(M,a,E,K){switch(o){case 76:l+=`\r
${M}${a}${E}${K}`,o=4;break;case 75:l+=`${M}\r
${a}${E}${K}`,o=3;break;case 74:l+=`${M+a}\r
${E}${K}`,o=2;break;case 73:l+=`${M+a+E}\r
${K}`,o=1;break;default:l+=M+a+E+K,o+=4;break}}function h(M){return M>=65&&M<=90||M>=97&&M<=122||M>=48&&M<=57||M===43||M===47||M===61}for(let M=0;M<s.length;M+=4){for(let a=M;a<M+4;a+=1)if(!h(s[a]))throw new RangeError(`base64.toString: buf[${a}]: ${s[a]} : not valid base64 character code`);c(String.fromCharCode(s[M]),String.fromCharCode(s[M+1]),String.fromCharCode(s[M+2]),String.fromCharCode(s[M+3]))}return l}},we}var Rt;function ir(){if(Rt)return Re;Rt=1;const _=gt,e=Vr(),t="UTF8",r="UTF16",n="UTF16BE",p="UTF16LE",w="UTF32",g="UTF32BE",y="UTF32LE",O="UINT7",b="ASCII",s="BINARY",l="UINT8",o="UINT16",c="UINT16LE",h="UINT16BE",M="UINT32",a="UINT32LE",E="UINT32BE",K="ESCAPED",F="STRING",Y=function(d){d.type=t;const k=d.data;d.bom=0,k.length>=3&&k[0]===239&&k[1]===187&&k[2]===191&&(d.bom=3)},f=function(d){const k=d.data;switch(d.bom=0,d.type){case r:d.type=n,k.length>=2&&(k[0]===254&&k[1]===255?d.bom=2:k[0]===255&&k[1]===254&&(d.type=p,d.bom=2));break;case n:if(d.type=n,k.length>=2){if(k[0]===254&&k[1]===255)d.bom=2;else if(k[0]===255&&k[1]===254)throw new TypeError(`src type: "${n}" specified but BOM is for "${p}"`)}break;case p:if(d.type=p,k.length>=0){if(k[0]===254&&k[1]===255)throw new TypeError(`src type: "${p}" specified but BOM is for "${n}"`);k[0]===255&&k[1]===254&&(d.bom=2)}break;default:throw new TypeError(`UTF16 BOM: src type "${d.type}" unrecognized`)}},U=function(d){const k=d.data;switch(d.bom=0,d.type){case w:d.type=g,k.length>=4&&(k[0]===0&&k[1]===0&&k[2]===254&&k[3]===255&&(d.bom=4),k[0]===255&&k[1]===254&&k[2]===0&&k[3]===0&&(d.type=y,d.bom=4));break;case g:if(d.type=g,k.length>=4&&(k[0]===0&&k[1]===0&&k[2]===254&&k[3]===255&&(d.bom=4),k[0]===255&&k[1]===254&&k[2]===0&&k[3]===0))throw new TypeError(`src type: ${g} specified but BOM is for ${y}"`);break;case y:if(d.type=y,k.length>=4){if(k[0]===0&&k[1]===0&&k[2]===254&&k[3]===255)throw new TypeError(`src type: "${y}" specified but BOM is for "${g}"`);k[0]===255&&k[1]===254&&k[2]===0&&k[3]===0&&(d.bom=4)}break;default:throw new TypeError(`UTF32 BOM: src type "${d.type}" unrecognized`)}},W=function(d,k){function te(Q){const ae={type:"",base64:!1},V=/^(base64:)?([a-zA-Z0-9]+)$/i.exec(Q);return V&&(V[2]&&(ae.type=V[2].toUpperCase()),V[1]&&(ae.base64=!0)),ae}if(typeof d!="string"||d==="")throw new TypeError(`type: "${d}" not recognized`);const X=te(d.toUpperCase());if(X.base64){if(X.type===F)throw new TypeError(`type: "${d} "BASE64:" prefix not allowed with type ${F}`);if(he.Buffer.isBuffer(k))X.data=e.base64.decode(k);else if(typeof k=="string"){const Q=he.Buffer.from(k,"ascii");X.data=e.base64.decode(Q)}else throw new TypeError(`type: "${d} unrecognized data type: typeof(data): ${typeof k}`)}else X.data=k;switch(X.type){case t:Y(X);break;case r:case n:case p:f(X);break;case w:case g:case y:U(X);break;case o:X.type=h;break;case M:X.type=E;break;case b:X.type=O;break;case s:X.type=l;break;case O:case l:case c:case h:case a:case E:case F:case K:break;default:throw new TypeError(`type: "${d}" not recognized`)}if(X.type===F){if(typeof X.data!="string")throw new TypeError(`type: "${d}" but data is not a string`)}else if(!he.Buffer.isBuffer(X.data))throw new TypeError(`type: "${d}" but data is not a Buffer`);return X},q=function(d,k){function te(Q){let ae,de;const V={crlf:!1,lf:!1,base64:!1,type:""},Z=!0;for(;Z;){if(de=Q,ae=Q.slice(0,5),ae==="CRLF:"){V.crlf=!0,de=Q.slice(5);break}if(ae=Q.slice(0,3),ae==="LF:"){V.lf=!0,de=Q.slice(3);break}break}return ae=de.split(":"),ae.length===1?V.type=ae[0]:ae.length===2&&ae[1]==="BASE64"&&(V.base64=!0,V.type=ae[0]),V}if(!Array.isArray(k))throw new TypeError(`dst chars: not array: "${typeof k}`);if(typeof d!="string")throw new TypeError(`dst type: not string: "${typeof d}`);const X=te(d.toUpperCase());switch(X.type){case t:case n:case p:case g:case y:case O:case l:case c:case h:case a:case E:case K:break;case F:if(X.base64)throw new TypeError(`":BASE64" suffix not allowed with type ${F}`);break;case b:X.type=O;break;case s:X.type=l;break;case r:X.type=n;break;case w:X.type=g;break;case o:X.type=h;break;case M:X.type=E;break;default:throw new TypeError(`dst type unrecognized: "${d}" : must have form [crlf:|lf:]type[:base64]`)}return X},S=function(d,k){switch(d){case t:return e.utf8.encode(k);case n:return e.utf16be.encode(k);case p:return e.utf16le.encode(k);case g:return e.utf32be.encode(k);case y:return e.utf32le.encode(k);case O:return e.uint7.encode(k);case l:return e.uint8.encode(k);case h:return e.uint16be.encode(k);case c:return e.uint16le.encode(k);case E:return e.uint32be.encode(k);case a:return e.uint32le.encode(k);case F:return e.string.encode(k);case K:return e.escaped.encode(k);default:throw new TypeError(`encode type "${d}" not recognized`)}},N=function(d){switch(d.type){case t:return e.utf8.decode(d.data,d.bom);case p:return e.utf16le.decode(d.data,d.bom);case n:return e.utf16be.decode(d.data,d.bom);case g:return e.utf32be.decode(d.data,d.bom);case y:return e.utf32le.decode(d.data,d.bom);case O:return e.uint7.decode(d.data);case l:return e.uint8.decode(d.data);case h:return e.uint16be.decode(d.data);case c:return e.uint16le.decode(d.data);case E:return e.uint32be.decode(d.data);case a:return e.uint32le.decode(d.data);case F:return e.string.decode(d.data);case K:return e.escaped.decode(d.data);default:throw new TypeError(`decode type "${d.type}" not recognized`)}};return Re.decode=function(d,k){const te=W(d,k);return N(te)},Re.encode=function(d,k){let te,X;const Q=q(d,k);return Q.crlf?(te=e.lineEnds.crlf(k),X=S(Q.type,te)):Q.lf?(te=e.lineEnds.lf(k),X=S(Q.type,te)):X=S(Q.type,k),Q.base64&&(X=e.base64.encode(X)),X},Re.convert=function(d,k,te){return _.encode(te,_.decode(d,k))},Re}var ze,Nt;function or(){return Nt||(Nt=1,ze=function(){return`/* This file automatically generated by jsonToless() and LESS. */
.apg-mono {
  font-family: monospace;
}
.apg-active {
  font-weight: bold;
  color: #000000;
}
.apg-match {
  font-weight: bold;
  color: #264BFF;
}
.apg-empty {
  font-weight: bold;
  color: #0fbd0f;
}
.apg-nomatch {
  font-weight: bold;
  color: #FF4000;
}
.apg-lh-match {
  font-weight: bold;
  color: #1A97BA;
}
.apg-lb-match {
  font-weight: bold;
  color: #5F1687;
}
.apg-remainder {
  font-weight: bold;
  color: #999999;
}
.apg-ctrl-char {
  font-weight: bolder;
  font-style: italic;
  font-size: 0.6em;
}
.apg-line-end {
  font-weight: bold;
  color: #000000;
}
.apg-error {
  font-weight: bold;
  color: #FF4000;
}
.apg-phrase {
  color: #000000;
  background-color: #8caae6;
}
.apg-empty-phrase {
  color: #0fbd0f;
}
table.apg-state {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: left;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-state th,
table.apg-state td {
  text-align: left;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-state th:nth-last-child(2),
table.apg-state td:nth-last-child(2) {
  text-align: right;
}
table.apg-state caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-stats {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-stats th,
table.apg-stats td {
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-stats caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-trace {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-trace caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-trace th,
table.apg-trace td {
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-trace th:last-child,
table.apg-trace th:nth-last-child(2),
table.apg-trace td:last-child,
table.apg-trace td:nth-last-child(2) {
  text-align: left;
}
table.apg-grammar {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-grammar caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-grammar th,
table.apg-grammar td {
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-grammar th:last-child,
table.apg-grammar td:last-child {
  text-align: left;
}
table.apg-rules {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-rules caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-rules th,
table.apg-rules td {
  text-align: right;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-rules a {
  color: #003399 !important;
}
table.apg-rules a:hover {
  color: #8caae6 !important;
}
table.apg-attrs {
  font-family: monospace;
  margin-top: 5px;
  font-size: 11px;
  line-height: 130%;
  text-align: center;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-attrs caption {
  font-size: 125%;
  line-height: 130%;
  font-weight: bold;
  text-align: left;
}
table.apg-attrs th,
table.apg-attrs td {
  text-align: center;
  border: 1px solid black;
  border-collapse: collapse;
}
table.apg-attrs th:nth-child(1),
table.apg-attrs th:nth-child(2),
table.apg-attrs th:nth-child(3) {
  text-align: right;
}
table.apg-attrs td:nth-child(1),
table.apg-attrs td:nth-child(2),
table.apg-attrs td:nth-child(3) {
  text-align: right;
}
table.apg-attrs a {
  color: #003399 !important;
}
table.apg-attrs a:hover {
  color: #8caae6 !important;
}
`}),ze}var Bt;function $e(){if(Bt)return Te;Bt=1;const _=Ue(),e=ir(),t=or(),r=ke(),n="utilities.js: ",p=gt,w=function(y,O,b){let s,l=O;const o=!0;for(;o;){if(y<=0){l=0,s=0;break}if(typeof l!="number"){l=0,s=y;break}if(l>=y){l=y,s=y;break}if(typeof b!="number"){s=y;break}if(s=l+b,s>y){s=y;break}break}return{beg:l,end:s}};Te.htmlToPage=function(y,O){let b;if(typeof y!="string")throw new Error(`${n}htmlToPage: input HTML is not a string`);typeof O!="string"?b="htmlToPage":b=O;let s="";return s+=`<!DOCTYPE html>
`,s+=`<html lang="en">
`,s+=`<head>
`,s+=`<meta charset="utf-8">
`,s+=`<title>${b}</title>
`,s+=`<style>
`,s+=t(),s+=`</style>
`,s+=`</head>
<body>
`,s+=`<p>${new Date}</p>
`,s+=y,s+=`</body>
</html>
`,s},Te.parserResultToHtml=function(y,O){let b=null;typeof O=="string"&&O!==""&&(b=O);let s,l;y.success===!0?s=`<span class="${_.CLASS_MATCH}">true</span>`:s=`<span class="${_.CLASS_NOMATCH}">false</span>`,y.state===r.EMPTY?l=`<span class="${_.CLASS_EMPTY}">EMPTY</span>`:y.state===r.MATCH?l=`<span class="${_.CLASS_MATCH}">MATCH</span>`:y.state===r.NOMATCH?l=`<span class="${_.CLASS_NOMATCH}">NOMATCH</span>`:l=`<span class="${_.CLASS_NOMATCH}">unrecognized</span>`;let o="";return o+=`<table class="${_.CLASS_STATE}">
`,b&&(o+=`<caption>${b}</caption>
`),o+=`<tr><th>state item</th><th>value</th><th>description</th></tr>
`,o+=`<tr><td>parser success</td><td>${s}</td>
`,o+=`<td><span class="${_.CLASS_MATCH}">true</span> if the parse succeeded,
`,o+=` <span class="${_.CLASS_NOMATCH}">false</span> otherwise`,o+=`<br><i>NOTE: for success, entire string must be matched</i></td></tr>
`,o+=`<tr><td>parser state</td><td>${l}</td>
`,o+=`<td><span class="${_.CLASS_EMPTY}">EMPTY</span>, `,o+=`<span class="${_.CLASS_MATCH}">MATCH</span> or 
`,o+=`<span class="${_.CLASS_NOMATCH}">NOMATCH</span></td></tr>
`,o+=`<tr><td>string length</td><td>${y.length}</td><td>length of the input (sub)string</td></tr>
`,o+=`<tr><td>matched length</td><td>${y.matched}</td><td>number of input string characters matched</td></tr>
`,o+=`<tr><td>max matched</td><td>${y.maxMatched}</td><td>maximum number of input string characters matched</td></tr>
`,o+=`<tr><td>max tree depth</td><td>${y.maxTreeDepth}</td><td>maximum depth of the parse tree reached</td></tr>
`,o+=`<tr><td>node hits</td><td>${y.nodeHits}</td><td>number of parse tree node hits (opcode function calls)</td></tr>
`,o+=`<tr><td>input length</td><td>${y.inputLength}</td><td>length of full input string</td></tr>
`,o+=`<tr><td>sub-string begin</td><td>${y.subBegin}</td><td>sub-string first character index</td></tr>
`,o+=`<tr><td>sub-string end</td><td>${y.subEnd}</td><td>sub-string end-of-string index</td></tr>
`,o+=`<tr><td>sub-string length</td><td>${y.subLength}</td><td>sub-string length</td></tr>
`,o+=`</table>
`,o},Te.charsToString=function(y,O,b){let s,l;if(typeof O=="number"){if(O>=y.length)return"";s=O<0?0:O}else s=0;if(typeof b=="number"){if(b<=0)return"";l=b>y.length-s?y.length:s+b}else l=y.length;return s<l?e.encode("UTF16LE",y.slice(s,l)).toString("utf16le"):""},Te.stringToChars=function(y){return e.decode("STRING",y)},Te.opcodeToString=function(y){let O="unknown";switch(y){case r.ALT:O="ALT";break;case r.CAT:O="CAT";break;case r.RNM:O="RNM";break;case r.UDT:O="UDT";break;case r.AND:O="AND";break;case r.NOT:O="NOT";break;case r.REP:O="REP";break;case r.TRG:O="TRG";break;case r.TBS:O="TBS";break;case r.TLS:O="TLS";break;case r.BKR:O="BKR";break;case r.BKA:O="BKA";break;case r.BKN:O="BKN";break;case r.ABG:O="ABG";break;case r.AEN:O="AEN";break;default:throw new Error("unrecognized opcode")}return O},Te.stateToString=function(y){let O="unknown";switch(y){case r.ACTIVE:O="ACTIVE";break;case r.MATCH:O="MATCH";break;case r.EMPTY:O="EMPTY";break;case r.NOMATCH:O="NOMATCH";break;default:throw new Error("unrecognized state")}return O},Te.asciiChars=["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","BS","TAB","LF","VT","FF","CR","SO","SI","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","EM","SUB","ESC","FS","GS","RS","US","&nbsp;","!","&#34;","#","$","%","&#38;","&#39;","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","&#60;","=","&#62;","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","&#92;","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","DEL"],Te.charToHex=function(y){let O=y.toString(16).toUpperCase();switch(O.length){case 1:case 3:case 7:O=`0${O}`;break;case 2:case 6:O=`00${O}`;break;case 4:break;case 5:O=`000${O}`;break;default:throw new Error("unrecognized option")}return O},Te.charsToDec=function(y,O,b){let s="";if(!Array.isArray(y))throw new Error(`${n}charsToDec: input must be an array of integers`);const l=w(y.length,O,b);if(l.end>l.beg){s+=y[l.beg];for(let o=l.beg+1;o<l.end;o+=1)s+=`,${y[o]}`}return s},Te.charsToHex=function(y,O,b){let s="";if(!Array.isArray(y))throw new Error(`${n}charsToHex: input must be an array of integers`);const l=w(y.length,O,b);if(l.end>l.beg){s+=`\\x${p.charToHex(y[l.beg])}`;for(let o=l.beg+1;o<l.end;o+=1)s+=`,\\x${p.charToHex(y[o])}`}return s},Te.charsToHtmlEntities=function(y,O,b){let s="";if(!Array.isArray(y))throw new Error(`${n}charsToHex: input must be an array of integers`);const l=w(y.length,O,b);if(l.end>l.beg)for(let o=l.beg;o<l.end;o+=1)s+=`&#x${y[o].toString(16)};`;return s};function g(y){return!(y>=55296&&y<=57343||y>1114111)}return Te.charsToUnicode=function(y,O,b){let s="";if(!Array.isArray(y))throw new Error(`${n}charsToUnicode: input must be an array of integers`);const l=w(y.length,O,b);if(l.end>l.beg)for(let o=l.beg;o<l.end;o+=1)g(y[o])?s+=`&#${y[o]};`:s+=` U+${p.charToHex(y[o])}`;return s},Te.charsToJsUnicode=function(y,O,b){let s="";if(!Array.isArray(y))throw new Error(`${n}charsToJsUnicode: input must be an array of integers`);const l=w(y.length,O,b);if(l.end>l.beg){s+=`\\u${p.charToHex(y[l.beg])}`;for(let o=l.beg+1;o<l.end;o+=1)s+=`,\\u${p.charToHex(y[o])}`}return s},Te.charsToAscii=function(y,O,b){let s="";if(!Array.isArray(y))throw new Error(`${n}charsToAscii: input must be an array of integers`);const l=w(y.length,O,b);for(let o=l.beg;o<l.end;o+=1){const c=y[o];c>=32&&c<=126?s+=String.fromCharCode(c):s+=`\\x${p.charToHex(c)}`}return s},Te.charsToAsciiHtml=function(y,O,b){if(!Array.isArray(y))throw new Error(`${n}charsToAsciiHtml: input must be an array of integers`);let s="",l;const o=w(y.length,O,b);for(let c=o.beg;c<o.end;c+=1)l=y[c],l<32||l===127?s+=`<span class="${_.CLASS_CTRLCHAR}">${p.asciiChars[l]}</span>`:l>127?s+=`<span class="${_.CLASS_CTRLCHAR}">U+${p.charToHex(l)}</span>`:s+=p.asciiChars[l];return s},Te.stringToAsciiHtml=function(y){const O=e.decode("STRING",y);return this.charsToAsciiHtml(O)},Te}var qe,_t;function Yr(){return _t||(_t=1,qe=function(){const e=ke(),t=$e(),r="ast.js: ",n=this;let p=null,w=null,g=null,y=0;const O=[],b=[],s=[],l=[];this.callbacks=[],this.astObject="astObject",this.init=function(h,M,a){s.length=0,l.length=0,O.length=0,y=0,p=h,w=M,g=a;let E;const K=[];for(E=0;E<p.length;E+=1)K.push(p[E].lower);for(E=0;E<w.length;E+=1)K.push(w[E].lower);for(y=p.length+w.length,E=0;E<y;E+=1)O[E]=!1,b[E]=null;for(const F in n.callbacks){const Y=F.toLowerCase();if(E=K.indexOf(Y),E<0)throw new Error(`${r}init: node '${F}' not a rule or udt name`);typeof n.callbacks[F]=="function"&&(O[E]=!0,b[E]=n.callbacks[F]),n.callbacks[F]===!0&&(O[E]=!0)}},this.ruleDefined=function(h){return O[h]!==!1},this.udtDefined=function(h){return O[p.length+h]!==!1},this.down=function(h,M){const a=l.length;return s.push(a),l.push({name:M,thisIndex:a,thatIndex:null,state:e.SEM_PRE,callbackIndex:h,phraseIndex:null,phraseLength:null,stack:s.length}),a},this.up=function(h,M,a,E){const K=l.length,F=s.pop();return l.push({name:M,thisIndex:K,thatIndex:F,state:e.SEM_POST,callbackIndex:h,phraseIndex:a,phraseLength:E,stack:s.length}),l[F].thatIndex=K,l[F].phraseIndex=a,l[F].phraseLength=E,K},this.translate=function(h){let M,a,E;for(let K=0;K<l.length;K+=1)E=l[K],a=b[E.callbackIndex],E.state===e.SEM_PRE?a!==null&&(M=a(e.SEM_PRE,g,E.phraseIndex,E.phraseLength,h),M===e.SEM_SKIP&&(K=E.thatIndex)):a!==null&&a(e.SEM_POST,g,E.phraseIndex,E.phraseLength,h)},this.setLength=function(h){l.length=h,h>0?s.length=l[h-1].stack:s.length=0},this.getLength=function(){return l.length};function o(c){let h="";for(let M=0;M<c;M+=1)h+=" ";return h}this.toXml=function(h){let M=t.charsToDec,a="decimal integer character codes";if(typeof h=="string"&&h.length>=3){const F=h.slice(0,3).toLowerCase();F==="asc"?(M=t.charsToAscii,a="ASCII for printing characters, hex for non-printing"):F==="hex"?(M=t.charsToHex,a="hexadecimal integer character codes"):F==="uni"&&(M=t.charsToUnicode,a="Unicode UTF-32 integer character codes")}let E="",K=0;return E+=`<?xml version="1.0" encoding="utf-8"?>
`,E+=`<root nodes="${l.length/2}" characters="${g.length}">
`,E+=`<!-- input string, ${a} -->
`,E+=o(K+2),E+=M(g),E+=`
`,l.forEach(F=>{F.state===e.SEM_PRE?(K+=1,E+=o(K),E+=`<node name="${F.name}" index="${F.phraseIndex}" length="${F.phraseLength}">
`,E+=o(K+2),E+=M(g,F.phraseIndex,F.phraseLength),E+=`
`):(E+=o(K),E+=`</node><!-- name="${F.name}" -->
`,K-=1)}),E+=`</root>
`,E},this.phrases=function(){const h={};let M,a;for(M=0;M<l.length;M+=1)a=l[M],a.state===e.SEM_PRE&&(Array.isArray(h[a.name])||(h[a.name]=[]),h[a.name].push({index:a.phraseIndex,length:a.phraseLength}));return h}}),qe}var Je,vt;function lr(){return vt||(vt=1,Je=function(){"use strict;";const e="circular-buffer.js: ";let t=-1,r=0;this.init=function(p){if(typeof p!="number"||p<=0)throw new Error(`${e}init: circular buffer size must an integer > 0`);r=Math.ceil(p),t=-1},this.increment=function(){return t+=1,(t+r)%r},this.maxSize=function(){return r},this.items=function(){return t+1},this.getListIndex=function(p){return t===-1||p<0||p>t||t-p>=r?-1:(p+r)%r},this.forEach=function(p){if(t!==-1){if(t<r){for(let w=0;w<=t;w+=1)p(w,w);return}for(let w=t-r+1;w<=t;w+=1){const g=(w+r)%r;p(g,w)}}}}),Je}var We,Pt;function zr(){return Pt||(Pt=1,We=function(){const e=ke(),t=$e(),r="parser.js: ",n=this;let p;this.ast=null,this.stats=null,this.trace=null,this.callbacks=[];let w=null,g=null,y,O,b,s,l=0,o=0,c=0,h=null,M=null,a=null,E=null,K=null,F=0,Y=1/0,f=1/0;const U=function(x,i,m){const H=`${r}evaluateRule(): `;if(x>=a.length)throw new Error(`${H}rule index: ${x} out of range`);if(i>=b)throw new Error(`${H}phrase index: ${i} out of range`);const{length:P}=w;w.push({type:e.RNM,index:x}),p(P,i,m),w.pop()},W=function(R,x,i){const m=`${r}evaluateUdt(): `;if(R>=E.length)throw new Error(`${m}udt index: ${R} out of range`);if(x>=b)throw new Error(`${m}phrase index: ${x} out of range`);const{length:H}=w;w.push({type:e.UDT,empty:E[R].empty,index:R}),p(H,x,i),w.pop()},q=function(){l=0,o=0,c=0,F=0,s=[{lookAround:e.LOOKAROUND_NONE,anchor:0,charsEnd:0,charsLength:0}],a=null,E=null,g=null,y=0,O=0,b=0,h=null,M=null,K=null,w=null},S=function(){const R=[],x=function(){const m={};a.forEach(H=>{H.isBkr&&(m[H.lower]=null)}),E.length>0&&E.forEach(H=>{H.isBkr&&(m[H.lower]=null)}),R.push(m)},i=function(){const m=R[R.length-1],H={};for(const P in m)H[P]=m[P];return H};this.push=function(){R.push(i())},this.pop=function(H){let P=H;if(P||(P=R.length-1),P<1||P>R.length)throw new Error(`${r}backRef.pop(): bad length: ${P}`);return R.length=P,R[R.length-1]},this.length=function(){return R.length},this.savePhrase=function(H,P,z){R[R.length-1][H]={phraseIndex:P,phraseLength:z}},this.getPhrase=function(m){return R[R.length-1][m]},x()},N=function(){const x=this;this.state=e.ACTIVE,this.phraseLength=0,this.ruleIndex=0,this.udtIndex=0,this.lookAround=s[s.length-1],this.uFrame=new S,this.pFrame=new S,this.evaluateRule=U,this.evaluateUdt=W,this.refresh=function(){x.state=e.ACTIVE,x.phraseLength=0,x.lookAround=s[s.length-1]}},L=function(){return s[s.length-1]},d=function(){return s.length>1},k=function(){return s[s.length-1].lookAround===e.LOOKAROUND_BEHIND},te=function(){const R=`${r}initializeAst(): `,x=!0;for(;x;){if(n.ast===void 0){n.ast=null;break}if(n.ast===null)break;if(n.ast.astObject!=="astObject")throw new Error(`${R}ast object not recognized`);break}n.ast!==null&&n.ast.init(a,E,g)},X=function(){const R=`${r}initializeTrace(): `,x=!0;for(;x;){if(n.trace===void 0){n.trace=null;break}if(n.trace===null)break;if(n.trace.traceObject!=="traceObject")throw new Error(`${R}trace object not recognized`);break}n.trace!==null&&n.trace.init(a,E,g)},Q=function(){const R=`${r}initializeStats(): `,x=!0;for(;x;){if(n.stats===void 0){n.stats=null;break}if(n.stats===null)break;if(n.stats.statsObject!=="statsObject")throw new Error(`${R}stats object not recognized`);break}n.stats!==null&&n.stats.init(a,E)},ae=function(R){const x=`${r}initializeGrammar(): `;if(!R)throw new Error(`${x}grammar object undefined`);if(R.grammarObject!=="grammarObject")throw new Error(`${x}bad grammar object`);a=R.rules,E=R.udts},de=function(R){const x=`${r}initializeStartRule(): `;let i=null;if(typeof R=="number"){if(R>=a.length)throw new Error(`${x}start rule index too large: max: ${a.length}: index: ${R}`);i=R}else if(typeof R=="string"){const m=R.toLowerCase();for(let H=0;H<a.length;H+=1)if(m===a[H].lower){i=a[H].index;break}if(i===null)throw new Error(`${x}start rule name '${R}' not recognized`)}else throw new Error(`${x}type of start rule '${typeof R}' not recognized`);return i},V=function(x,i,m){const H=`${r}initializeInputChars(): `;let P=x,z=i,se=m;if(P===void 0)throw new Error(`${H}input string is undefined`);if(P===null)throw new Error(`${H}input string is null`);if(typeof P=="string")P=t.stringToChars(P);else if(!Array.isArray(P))throw new Error(`${H}input string is not a string or array`);if(P.length>0&&typeof P[0]!="number")throw new Error(`${H}input string not an array of integers`);if(typeof z!="number")z=0;else if(z=Math.floor(z),z<0||z>P.length)throw new Error(`${H}input beginning index out of range: ${z}`);if(typeof se!="number")se=P.length-z;else if(se=Math.floor(se),se<0||se>P.length-z)throw new Error(`${H}input length out of range: ${se}`);g=P,y=z,O=se,b=y+O},Z=function(){const R=`${r}initializeCallbacks(): `;let x;for(h=[],M=[],x=0;x<a.length;x+=1)h[x]=null;for(x=0;x<E.length;x+=1)M[x]=null;let i;const m=[];for(x=0;x<a.length;x+=1)m.push(a[x].lower);for(x=0;x<E.length;x+=1)m.push(E[x].lower);for(const H in n.callbacks){if(x=m.indexOf(H.toLowerCase()),x<0)throw new Error(`${R}syntax callback '${H}' not a rule or udt name`);if(i=n.callbacks[H],i||(i=null),typeof i=="function"||i===null)x<a.length?h[x]=i:M[x-a.length]=i;else throw new Error(`${R}syntax callback[${H}] must be function reference or 'false' (false/null/undefined/etc.)`)}for(x=0;x<E.length;x+=1)if(M[x]===null)throw new Error(`${R}all UDT callbacks must be defined. UDT callback[${E[x].lower}] not a function reference`)};this.setMaxTreeDepth=function(R){if(typeof R!="number")throw new Error(`parser: max tree depth must be integer > 0: ${R}`);if(Y=Math.floor(R),Y<=0)throw new Error(`parser: max tree depth must be integer > 0: ${R}`)},this.setMaxNodeHits=function(R){if(typeof R!="number")throw new Error(`parser: max node hits must be integer > 0: ${R}`);if(f=Math.floor(R),f<=0)throw new Error(`parser: max node hits must be integer > 0: ${R}`)};const J=function(R,x,i){let m;const H=`${r}parse(): `;ae(R);const P=de(x);Z(),X(),Q(),te();const z=new N;switch(i!=null&&(K=i),w=[{type:e.RNM,index:P}],p(0,y,z),w=null,z.state){case e.ACTIVE:throw new Error(`${H}final state should never be 'ACTIVE'`);case e.NOMATCH:m=!1;break;case e.EMPTY:case e.MATCH:z.phraseLength===O?m=!0:m=!1;break;default:throw new Error("unrecognized state")}return{success:m,state:z.state,length:O,matched:z.phraseLength,maxMatched:F,maxTreeDepth:o,nodeHits:c,inputLength:g.length,subBegin:y,subEnd:b,subLength:O}};this.parseSubstring=function(x,i,m,H,P,z){return q(),V(m,H,P),J(x,i,z)},this.parse=function(x,i,m,H){return q(),V(m,0,m.length),J(x,i,H)};const C=function(R,x,i){const m=w[R];for(let H=0;H<m.children.length&&(p(m.children[H],x,i),i.state===e.NOMATCH);H+=1);},ue=function(R,x,i){let m,H,P,z;const se=w[R],ge=i.uFrame.length(),fe=i.pFrame.length();n.ast&&(H=n.ast.getLength()),m=!0,P=x,z=0;for(let le=0;le<se.children.length;le+=1)if(p(se.children[le],P,i),i.state===e.NOMATCH){m=!1;break}else P+=i.phraseLength,z+=i.phraseLength;m?(i.state=z===0?e.EMPTY:e.MATCH,i.phraseLength=z):(i.state=e.NOMATCH,i.phraseLength=0,i.uFrame.pop(ge),i.pFrame.pop(fe),n.ast&&n.ast.setLength(H))},me=function(R,x,i){let m,H,P,z;const se=w[R];H=x,P=0,z=0;const ge=i.uFrame.length(),fe=i.pFrame.length();n.ast&&(m=n.ast.getLength());const le=!0;for(;le&&!(H>=b||(p(R+1,H,i),i.state===e.NOMATCH)||i.state===e.EMPTY||(z+=1,P+=i.phraseLength,H+=i.phraseLength,z===se.max)););i.state===e.EMPTY||z>=se.min?(i.state=P===0?e.EMPTY:e.MATCH,i.phraseLength=P):(i.state=e.NOMATCH,i.phraseLength=0,i.uFrame.pop(ge),i.pFrame.pop(fe),n.ast&&n.ast.setLength(m))},Ee=function(R,x,i,m){if(x.phraseLength>i){let H=`${r}opRNM(${R.name}): callback function error: `;throw H+=`sysData.phraseLength: ${x.phraseLength}`,H+=` must be <= remaining chars: ${i}`,new Error(H)}switch(x.state){case e.ACTIVE:if(m!==!0)throw new Error(`${r}opRNM(${R.name}): callback function return error. ACTIVE state not allowed.`);break;case e.EMPTY:x.phraseLength=0;break;case e.MATCH:x.phraseLength===0&&(x.state=e.EMPTY);break;case e.NOMATCH:x.phraseLength=0;break;default:throw new Error(`${r}opRNM(${R.name}): callback function return error. Unrecognized return state: ${x.state}`)}},ce=function(R,x,i){let m,H,P,z,se,ge;const fe=w[R],le=a[fe.index],be=h[le.index],Ce=!d();if(Ce&&(H=n.ast&&n.ast.ruleDefined(fe.index),H&&(m=n.ast.getLength(),n.ast.down(fe.index,a[fe.index].name)),z=i.uFrame.length(),se=i.pFrame.length(),i.uFrame.push(),i.pFrame.push(),ge=i.pFrame,i.pFrame=new S),be===null)P=w,w=le.opcodes,p(0,x,i),w=P;else{const bt=b-x;i.ruleIndex=le.index,be(i,g,x,K),Ee(le,i,bt,!0),i.state===e.ACTIVE&&(P=w,w=le.opcodes,p(0,x,i),w=P,i.ruleIndex=le.index,be(i,g,x,K),Ee(le,i,bt,!1))}Ce&&(H&&(i.state===e.NOMATCH?n.ast.setLength(m):n.ast.up(fe.index,le.name,x,i.phraseLength)),i.pFrame=ge,i.state===e.NOMATCH?(i.uFrame.pop(z),i.pFrame.pop(se)):le.isBkr&&(i.pFrame.savePhrase(le.lower,x,i.phraseLength),i.uFrame.savePhrase(le.lower,x,i.phraseLength)))},A=function(R,x,i){if(x.phraseLength>i){let m=`${r}opUDT(${R.name}): callback function error: `;throw m+=`sysData.phraseLength: ${x.phraseLength}`,m+=` must be <= remaining chars: ${i}`,new Error(m)}switch(x.state){case e.ACTIVE:throw new Error(`${r}opUDT(${R.name}): callback function return error. ACTIVE state not allowed.`);case e.EMPTY:if(R.empty===!1)throw new Error(`${r}opUDT(${R.name}): callback function return error. May not return EMPTY.`);x.phraseLength=0;break;case e.MATCH:if(x.phraseLength===0){if(R.empty===!1)throw new Error(`${r}opUDT(${R.name}): callback function return error. May not return EMPTY.`);x.state=e.EMPTY}break;case e.NOMATCH:x.phraseLength=0;break;default:throw new Error(`${r}opUDT(${R.name}): callback function return error. Unrecognized return state: ${x.state}`)}},T=function(R,x,i){let m,H,P,z,se,ge;const fe=w[R],le=E[fe.index];i.UdtIndex=le.index;const be=!d();be&&(P=n.ast&&n.ast.udtDefined(fe.index),P&&(H=a.length+fe.index,m=n.ast.getLength(),n.ast.down(H,le.name)),z=i.uFrame.length(),se=i.pFrame.length(),i.uFrame.push(),i.pFrame.push(),ge=i.pFrame,i.pFrame=new S);const Ce=b-x;M[fe.index](i,g,x,K),A(le,i,Ce),be&&(P&&(i.state===e.NOMATCH?n.ast.setLength(m):n.ast.up(H,le.name,x,i.phraseLength)),i.pFrame=ge,i.state===e.NOMATCH?(i.uFrame.pop(z),i.pFrame.pop(se)):le.isBkr&&(i.pFrame.savePhrase(le.lower,x,i.phraseLength),i.uFrame.savePhrase(le.lower,x,i.phraseLength)))},B=function(R,x,i){s.push({lookAround:e.LOOKAROUND_AHEAD,anchor:x,charsEnd:b,charsLength:O}),b=g.length,O=g.length-y,p(R+1,x,i);const m=s.pop();switch(b=m.charsEnd,O=m.charsLength,i.phraseLength=0,i.state){case e.EMPTY:i.state=e.EMPTY;break;case e.MATCH:i.state=e.EMPTY;break;case e.NOMATCH:i.state=e.NOMATCH;break;default:throw new Error(`opAND: invalid state ${i.state}`)}},j=function(R,x,i){s.push({lookAround:e.LOOKAROUND_AHEAD,anchor:x,charsEnd:b,charsLength:O}),b=g.length,O=g.length-y,p(R+1,x,i);const m=s.pop();switch(b=m.charsEnd,O=m.charsLength,i.phraseLength=0,i.state){case e.EMPTY:case e.MATCH:i.state=e.NOMATCH;break;case e.NOMATCH:i.state=e.EMPTY;break;default:throw new Error(`opNOT: invalid state ${i.state}`)}},ee=function(R,x,i){const m=w[R];i.state=e.NOMATCH,x<b&&m.min<=g[x]&&g[x]<=m.max&&(i.state=e.MATCH,i.phraseLength=1)},re=function(R,x,i){let m;const H=w[R],P=H.string.length;if(i.state=e.NOMATCH,x+P<=b){for(m=0;m<P;m+=1)if(g[x+m]!==H.string[m])return;i.state=e.MATCH,i.phraseLength=P}},ie=function(R,x,i){let m,H;const P=w[R];i.state=e.NOMATCH;const z=P.string.length;if(z===0){i.state=e.EMPTY;return}if(x+z<=b){for(m=0;m<z;m+=1)if(H=g[x+m],H>=65&&H<=90&&(H+=32),H!==P.string[m])return;i.state=e.MATCH,i.phraseLength=z}},I=function(R,x,i){i.state=e.NOMATCH,i.phraseLength=0,i.state=x===0?e.EMPTY:e.NOMATCH},G=function(R,x,i){i.state=e.NOMATCH,i.phraseLength=0,i.state=x===g.length?e.EMPTY:e.NOMATCH},$=function(R,x,i){let m,H,P,z;const se=w[R];i.state=e.NOMATCH,se.index<a.length?z=a[se.index].lower:z=E[se.index-a.length].lower;const ge=se.bkrMode===e.BKR_MODE_PM?i.pFrame.getPhrase(z):i.uFrame.getPhrase(z),fe=se.bkrCase===e.BKR_MODE_CI;if(ge===null)return;const le=ge.phraseIndex,be=ge.phraseLength;if(be===0){i.state=e.EMPTY;return}if(x+be<=b){if(fe){for(m=0;m<be;m+=1)if(H=g[x+m],P=g[le+m],H>=65&&H<=90&&(H+=32),P>=65&&P<=90&&(P+=32),H!==P)return;i.state=e.MATCH,i.phraseLength=be}else for(m=0;m<be;m+=1)if(H=g[x+m],P=g[le+m],H!==P)return;i.state=e.MATCH,i.phraseLength=be}},D=function(R,x,i){switch(s.push({lookAround:e.LOOKAROUND_BEHIND,anchor:x}),p(R+1,x,i),s.pop(),i.phraseLength=0,i.state){case e.EMPTY:i.state=e.EMPTY;break;case e.MATCH:i.state=e.EMPTY;break;case e.NOMATCH:i.state=e.NOMATCH;break;default:throw new Error(`opBKA: invalid state ${i.state}`)}},u=function(R,x,i){switch(s.push({lookAround:e.LOOKAROUND_BEHIND,anchor:x}),p(R+1,x,i),s.pop(),i.phraseLength=0,i.state){case e.EMPTY:case e.MATCH:i.state=e.NOMATCH;break;case e.NOMATCH:i.state=e.EMPTY;break;default:throw new Error(`opBKN: invalid state ${i.state}`)}},v=function(R,x,i){let m,H,P,z;const se=w[R],ge=i.uFrame.length(),fe=i.pFrame.length();n.ast&&(H=n.ast.getLength()),m=!0,P=x,z=0;for(let le=se.children.length-1;le>=0;le-=1)if(p(se.children[le],P,i),P-=i.phraseLength,z+=i.phraseLength,i.state===e.NOMATCH){m=!1;break}m?(i.state=z===0?e.EMPTY:e.MATCH,i.phraseLength=z):(i.state=e.NOMATCH,i.phraseLength=0,i.uFrame.pop(ge),i.pFrame.pop(fe),n.ast&&n.ast.setLength(H))},ne=function(R,x,i){let m,H,P,z;const se=w[R];H=x,P=0,z=0;const ge=i.uFrame.length(),fe=i.pFrame.length();n.ast&&(m=n.ast.getLength());const le=!0;for(;le&&!(H<=0||(p(R+1,H,i),i.state===e.NOMATCH)||i.state===e.EMPTY||(z+=1,P+=i.phraseLength,H-=i.phraseLength,z===se.max)););i.state===e.EMPTY||z>=se.min?(i.state=P===0?e.EMPTY:e.MATCH,i.phraseLength=P):(i.state=e.NOMATCH,i.phraseLength=0,i.uFrame.pop(ge),i.pFrame.pop(fe),n.ast&&n.ast.setLength(m))},oe=function(R,x,i){const m=w[R];if(i.state=e.NOMATCH,i.phraseLength=0,x>0){const H=g[x-1];m.min<=H&&H<=m.max&&(i.state=e.MATCH,i.phraseLength=1)}},pe=function(R,x,i){let m;const H=w[R];i.state=e.NOMATCH;const P=H.string.length,z=x-P;if(z>=0){for(m=0;m<P;m+=1)if(g[z+m]!==H.string[m])return;i.state=e.MATCH,i.phraseLength=P}},Ae=function(R,x,i){let m;const H=w[R];i.state=e.NOMATCH;const P=H.string.length;if(P===0){i.state=e.EMPTY;return}const z=x-P;if(z>=0){for(let se=0;se<P;se+=1)if(m=g[z+se],m>=65&&m<=90&&(m+=32),m!==H.string[se])return;i.state=e.MATCH,i.phraseLength=P}},Ne=function(R,x,i){let m,H,P,z;const se=w[R];i.state=e.NOMATCH,i.phraseLength=0,se.index<a.length?z=a[se.index].lower:z=E[se.index-a.length].lower;const ge=se.bkrMode===e.BKR_MODE_PM?i.pFrame.getPhrase(z):i.uFrame.getPhrase(z),fe=se.bkrCase===e.BKR_MODE_CI;if(ge===null)return;const le=ge.phraseIndex,be=ge.phraseLength;if(be===0){i.state=e.EMPTY,i.phraseLength=0;return}const Ce=x-be;if(Ce>=0){if(fe){for(m=0;m<be;m+=1)if(H=g[Ce+m],P=g[le+m],H>=65&&H<=90&&(H+=32),P>=65&&P<=90&&(P+=32),H!==P)return;i.state=e.MATCH,i.phraseLength=be}else for(m=0;m<be;m+=1)if(H=g[Ce+m],P=g[le+m],H!==P)return;i.state=e.MATCH,i.phraseLength=be}};p=function(x,i,m){let H=!0;const P=w[x];if(c+=1,c>f)throw new Error(`parser: maximum number of node hits exceeded: ${f}`);if(l+=1,l>o&&(o=l,o>Y))throw new Error(`parser: maximum parse tree depth exceeded: ${Y}`);if(m.refresh(),n.trace!==null){const z=L();n.trace.down(P,m.state,i,m.phraseLength,z.anchor,z.lookAround)}if(k())switch(P.type){case e.ALT:C(x,i,m);break;case e.CAT:v(x,i,m);break;case e.REP:ne(x,i,m);break;case e.RNM:ce(x,i,m);break;case e.UDT:T(x,i,m);break;case e.AND:B(x,i,m);break;case e.NOT:j(x,i,m);break;case e.TRG:oe(x,i,m);break;case e.TBS:pe(x,i,m);break;case e.TLS:Ae(x,i,m);break;case e.BKR:Ne(x,i,m);break;case e.BKA:D(x,i,m);break;case e.BKN:u(x,i,m);break;case e.ABG:I(x,i,m);break;case e.AEN:G(x,i,m);break;default:H=!1;break}else switch(P.type){case e.ALT:C(x,i,m);break;case e.CAT:ue(x,i,m);break;case e.REP:me(x,i,m);break;case e.RNM:ce(x,i,m);break;case e.UDT:T(x,i,m);break;case e.AND:B(x,i,m);break;case e.NOT:j(x,i,m);break;case e.TRG:ee(x,i,m);break;case e.TBS:re(x,i,m);break;case e.TLS:ie(x,i,m);break;case e.BKR:$(x,i,m);break;case e.BKA:D(x,i,m);break;case e.BKN:u(x,i,m);break;case e.ABG:I(x,i,m);break;case e.AEN:G(x,i,m);break;default:H=!1;break}if(!d()&&i+m.phraseLength>F&&(F=i+m.phraseLength),n.stats!==null&&n.stats.collect(P,m),n.trace!==null){const z=L();n.trace.up(P,m.state,i,m.phraseLength,z.anchor,z.lookAround)}return l-=1,H}}),We}var Xe,It;function qr(){return It||(It=1,Xe=function(){const e=ke(),t=$e(),r=Ue(),n="stats.js: ";let p=[],w=[];const g=[];let y;const O=[],b=[];this.statsObject="statsObject";const s="stats",l=function(f,U){return f.lower<U.lower?-1:f.lower>U.lower?1:0},o=function(f,U){return f.total<U.total?1:f.total>U.total?-1:l(f,U)},c=function(f,U){return f.index<U.index?-1:f.index>U.index?1:0},h=function(){this.empty=0,this.match=0,this.nomatch=0,this.total=0},M=function(){g.length=0,y=new h,g[e.ALT]=new h,g[e.CAT]=new h,g[e.REP]=new h,g[e.RNM]=new h,g[e.TRG]=new h,g[e.TBS]=new h,g[e.TLS]=new h,g[e.UDT]=new h,g[e.AND]=new h,g[e.NOT]=new h,g[e.BKR]=new h,g[e.BKA]=new h,g[e.BKN]=new h,g[e.ABG]=new h,g[e.AEN]=new h,O.length=0;for(let f=0;f<p.length;f+=1)O.push({empty:0,match:0,nomatch:0,total:0,name:p[f].name,lower:p[f].lower,index:p[f].index});if(w.length>0){b.length=0;for(let f=0;f<w.length;f+=1)b.push({empty:0,match:0,nomatch:0,total:0,name:w[f].name,lower:w[f].lower,index:w[f].index})}},a=function(f,U){switch(f.total+=1,U){case e.EMPTY:f.empty+=1;break;case e.MATCH:f.match+=1;break;case e.NOMATCH:f.nomatch+=1;break;default:throw new Error(`${n}collect(): incStat(): unrecognized state: ${U}`)}},E=function(f,U){let W="";return W+="<tr>",W+=`<td class="${r.CLASS_ACTIVE}">${f}</td>`,W+=`<td class="${r.CLASS_EMPTY}">${U.empty}</td>`,W+=`<td class="${r.CLASS_MATCH}">${U.match}</td>`,W+=`<td class="${r.CLASS_NOMATCH}">${U.nomatch}</td>`,W+=`<td class="${r.CLASS_ACTIVE}">${U.total}</td>`,W+=`</tr>
`,W},K=function(){let f="";return f+=E("ALT",g[e.ALT]),f+=E("CAT",g[e.CAT]),f+=E("REP",g[e.REP]),f+=E("RNM",g[e.RNM]),f+=E("TRG",g[e.TRG]),f+=E("TBS",g[e.TBS]),f+=E("TLS",g[e.TLS]),f+=E("UDT",g[e.UDT]),f+=E("AND",g[e.AND]),f+=E("NOT",g[e.NOT]),f+=E("BKR",g[e.BKR]),f+=E("BKA",g[e.BKA]),f+=E("BKN",g[e.BKN]),f+=E("ABG",g[e.ABG]),f+=E("AEN",g[e.AEN]),f+=E("totals",y),f},F=function(){let f="";f+=`<tr><th></th><th></th><th></th><th></th><th></th></tr>
`,f+=`<tr><th>rules</th><th></th><th></th><th></th><th></th></tr>
`;for(let U=0;U<p.length;U+=1)O[U].total>0&&(f+="<tr>",f+=`<td class="${r.CLASS_ACTIVE}">${O[U].name}</td>`,f+=`<td class="${r.CLASS_EMPTY}">${O[U].empty}</td>`,f+=`<td class="${r.CLASS_MATCH}">${O[U].match}</td>`,f+=`<td class="${r.CLASS_NOMATCH}">${O[U].nomatch}</td>`,f+=`<td class="${r.CLASS_ACTIVE}">${O[U].total}</td>`,f+=`</tr>
`);if(w.length>0){f+=`<tr><th></th><th></th><th></th><th></th><th></th></tr>
`,f+=`<tr><th>udts</th><th></th><th></th><th></th><th></th></tr>
`;for(let U=0;U<w.length;U+=1)b[U].total>0&&(f+="<tr>",f+=`<td class="${r.CLASS_ACTIVE}">${b[U].name}</td>`,f+=`<td class="${r.CLASS_EMPTY}">${b[U].empty}</td>`,f+=`<td class="${r.CLASS_MATCH}">${b[U].match}</td>`,f+=`<td class="${r.CLASS_NOMATCH}">${b[U].nomatch}</td>`,f+=`<td class="${r.CLASS_ACTIVE}">${b[U].total}</td>`,f+=`</tr>
`)}return f};this.validate=function(f){let U=!1;return typeof f=="string"&&s===f&&(U=!0),U},this.init=function(f,U){p=f,w=U,M()},this.collect=function(f,U){a(y,U.state,U.phraseLength),a(g[f.type],U.state,U.phraseLength),f.type===e.RNM&&a(O[f.index],U.state,U.phraseLength),f.type===e.UDT&&a(b[f.index],U.state,U.phraseLength)},this.toHtml=function(f,U){let W="";W+=`<table class="${r.CLASS_STATS}">
`,typeof U=="string"&&(W+=`<caption>${U}</caption>
`),W+=`<tr><th class="${r.CLASS_ACTIVE}">ops</th>
`,W+=`<th class="${r.CLASS_EMPTY}">EMPTY</th>
`,W+=`<th class="${r.CLASS_MATCH}">MATCH</th>
`,W+=`<th class="${r.CLASS_NOMATCH}">NOMATCH</th>
`,W+=`<th class="${r.CLASS_ACTIVE}">totals</th></tr>
`;const q=!0;for(;q;){if(f===void 0){W+=K();break}if(f===null){W+=K();break}if(f==="ops"){W+=K();break}if(f==="index"){O.sort(c),b.length>0&&b.sort(c),W+=K(),W+=F();break}if(f==="hits"){O.sort(o),b.length>0&&b.sort(c),W+=K(),W+=F();break}if(f==="alpha"){O.sort(l),b.length>0&&b.sort(l),W+=K(),W+=F();break}break}return W+=`</table>
`,W},this.toHtmlPage=function(f,U,W){return t.htmlToPage(this.toHtml(f,U),W)}}),Xe}var Ze,Ht;function Jr(){return Ht||(Ht=1,Ze=function(){const e=$e(),t=Ue(),r=new(lr()),n=ke(),p="trace.js: ",w=this,g=16,y=10,O=8,b=32,s=80,l=5,o=[];let c=5e3,h=-1,M=0,a=0;const E=[];let K=null,F=null,Y=null;const f=[],U=[],W=`<span class="${t.CLASS_LINEEND}">&bull;</span>`,q=`<span class="${t.CLASS_LINEEND}">&hellip;</span>`,S=`<span class="${t.CLASS_EMPTY}">&#120634;</span>`,N=function(){const A=function(B){f[n.ALT]=B,f[n.CAT]=B,f[n.REP]=B,f[n.TLS]=B,f[n.TBS]=B,f[n.TRG]=B,f[n.AND]=B,f[n.NOT]=B,f[n.BKR]=B,f[n.BKA]=B,f[n.BKN]=B,f[n.ABG]=B,f[n.AEN]=B};let T=0;for(const B in w.filter.operators)T+=1;if(T===0){A(!1);return}for(const B in w.filter.operators){const j=B.toUpperCase();if(j==="<ALL>"){A(!0);return}if(j==="<NONE>"){A(!1);return}}A(!1);for(const B in w.filter.operators){const j=B.toUpperCase();if(j==="ALT")f[n.ALT]=w.filter.operators[B]===!0;else if(j==="CAT")f[n.CAT]=w.filter.operators[B]===!0;else if(j==="REP")f[n.REP]=w.filter.operators[B]===!0;else if(j==="AND")f[n.AND]=w.filter.operators[B]===!0;else if(j==="NOT")f[n.NOT]=w.filter.operators[B]===!0;else if(j==="TLS")f[n.TLS]=w.filter.operators[B]===!0;else if(j==="TBS")f[n.TBS]=w.filter.operators[B]===!0;else if(j==="TRG")f[n.TRG]=w.filter.operators[B]===!0;else if(j==="BKR")f[n.BKR]=w.filter.operators[B]===!0;else if(j==="BKA")f[n.BKA]=w.filter.operators[B]===!0;else if(j==="BKN")f[n.BKN]=w.filter.operators[B]===!0;else if(j==="ABG")f[n.ABG]=w.filter.operators[B]===!0;else if(j==="AEN")f[n.AEN]=w.filter.operators[B]===!0;else throw new Error(`${p}initOpratorFilter: '${B}' not a valid operator name. Must be <all>, <none>, alt, cat, rep, tls, tbs, trg, and, not, bkr, bka or bkn`)}},L=function(){const A=function(ee){f[n.RNM]=ee,f[n.UDT]=ee;const re=F.length+Y.length;U.length=0;for(let ie=0;ie<re;ie+=1)U.push(ee)};let T,B;const j=[];for(B=0;B<F.length;B+=1)j.push(F[B].lower);for(B=0;B<Y.length;B+=1)j.push(Y[B].lower);U.length=0,T=0;for(const ee in w.filter.rules)T+=1;if(T===0){A(!0);return}for(const ee in w.filter.rules){const re=ee.toLowerCase();if(re==="<all>"){A(!0);return}if(re==="<none>"){A(!1);return}}A(!1),f[n.RNM]=!0,f[n.UDT]=!0;for(const ee in w.filter.rules){const re=ee.toLowerCase();if(B=j.indexOf(re),B<0)throw new Error(`${p}initRuleFilter: '${ee}' not a valid rule or udt name`);U[B]=w.filter.rules[ee]===!0}};this.traceObject="traceObject",this.filter={operators:[],rules:[]},this.setMaxRecords=function(A,T){if(h=-1,typeof A=="number"&&A>0)c=Math.ceil(A);else{c=0;return}typeof T=="number"&&(h=Math.floor(T),h<0&&(h=-1))},this.getMaxRecords=function(){return c},this.getLastRecord=function(){return h},this.init=function(A,T,B){o.length=0,E.length=0,M=0,a=0,K=B,F=A,Y=T,N(),L(),r.init(c)};const d=function(A){let T=!1;return A.type===n.RNM?f[A.type]&&U[A.index]?T=!0:T=!1:A.type===n.UDT?f[A.type]&&U[F.length+A.index]?T=!0:T=!1:T=f[A.type],T},k=function(A){return h===-1||A<=h};this.down=function(A,T,B,j,ee,re){k(M)&&d(A)&&(E.push(M),o[r.increment()]={dirUp:!1,depth:a,thisLine:M,thatLine:void 0,opcode:A,state:T,phraseIndex:B,phraseLength:j,lookAnchor:ee,lookAround:re},M+=1,a+=1)},this.up=function(A,T,B,j,ee,re){if(k(M)&&d(A)){const ie=M,I=E.pop(),G=r.getListIndex(I);G!==-1&&(o[G].thatLine=ie),a-=1,o[r.increment()]={dirUp:!0,depth:a,thisLine:ie,thatLine:I,opcode:A,state:T,phraseIndex:B,phraseLength:j,lookAnchor:ee,lookAround:re},M+=1}};const te=function(){function A(i,m){let H,P,z;if(m)switch(i.op={id:m.type,name:e.opcodeToString(m.type)},i.opData=void 0,m.type){case n.RNM:i.opData=F[m.index].name;break;case n.UDT:i.opData=Y[m.index].name;break;case n.BKR:m.index<F.length?H=F[m.index].name:H=Y[m.index-F.length].name,P=m.bkrCase===n.BKR_MODE_CI?"%i":"%s",z=m.bkrMode===n.BKR_MODE_UM?"%u":"%p",i.opData=`\\\\${P}${z}${H}`;break;case n.TLS:i.opData=[];for(let se=0;se<m.string.length;se+=1)i.opData.push(m.string[se]);break;case n.TBS:i.opData=[];for(let se=0;se<m.string.length;se+=1)i.opData.push(m.string[se]);break;case n.TRG:i.opData=[m.min,m.max];break;case n.REP:i.opData=[m.min,m.max];break;default:throw new Error("unrecognized opcode")}else i.op={id:void 0,name:void 0},i.opData=void 0}function T(i,m,H){return i===n.MATCH?{index:m,length:H}:i===n.NOMATCH?{index:m,length:0}:i===n.EMPTY?{index:m,length:0}:null}let B=-1;function j(i,m,H){const P={id:B++,branch:-1,parent:i,up:!1,down:!1,depth:H,children:[]};return m?(P.down=!0,P.state={id:m.state,name:e.stateToString(m.state)},P.phrase=null,A(P,m.opcode)):(P.state={id:void 0,name:void 0},P.phrase=T(),A(P,void 0)),P}function ee(i,m){m&&(i.up=!0,i.state={id:m.state,name:e.stateToString(m.state)},i.phrase=T(m.state,m.phraseIndex,m.phraseLength),i.down||A(i,m.opcode))}let re=0,ie=-1,I=1;function G(i){if(ie+=1,i.branch=I,ie>a&&(a=ie),i.children.length===0)re+=1;else for(let m=0;m<i.children.length;m+=1)m>0&&(I+=1),i.children[m].leftMost=!1,i.children[m].rightMost=!1,i.leftMost&&(i.children[m].leftMost=m===0),i.rightMost&&(i.children[m].rightMost=m===i.children.length-1),G(i.children[m]);ie-=1}function $(i,m){let H;const P={};if(P.id=i.id,P.branch=i.branch,P.leftMost=i.leftMost,P.rightMost=i.rightMost,H=i.state.name?i.state.name:"ACTIVE",P.state={id:i.state.id,name:H},H=i.op.name?i.op.name:"?",P.op={id:i.op.id,name:H},typeof i.opData=="string")P.opData=i.opData;else if(Array.isArray(i.opData)){P.opData=[];for(let z=0;z<i.opData.length;z+=1)P.opData[z]=i.opData[z]}else P.opData=void 0;i.phrase?P.phrase={index:i.phrase.index,length:i.phrase.length}:P.phrase=null,P.depth=i.depth,P.children=[];for(let z=0;z<i.children.length;z+=1)i.children.length-1,P.children[z]=$(i.children[z]);return P}const D=[];let u,v,ne,oe,pe=!0;const Ae=j(null,null,-1);for(D.push(Ae),v=Ae,r.forEach(i=>{if(oe=o[i],pe&&(pe=!1,oe.depth>0)){const m=oe.dirUp?oe.depth+1:oe.depth;for(let H=0;H<m;H+=1)ne=v,v=j(v,null,H),D.push(v),ne.children.push(v)}oe.dirUp?(v=D.pop(),ee(v,oe),v=D[D.length-1]):(ne=v,v=j(v,oe,oe.depth),D.push(v),ne.children.push(v))});D.length>1;)v=D.pop(),ee(v,null);if(Ae.children.length===0)throw new Error("trace.toTree(): parse tree has no nodes");if(D.length===0)throw new Error("trace.toTree(): integrity check: dummy root node disappeared?");u=Ae.children[0];let Ne=u;for(;u&&!u.down&&!u.up;)Ne=u,u=u.children[0];u=Ne,u.leftMost=!0,u.rightMost=!0,G(u),u.branch=0;const R={};R.string=[];for(let i=0;i<K.length;i+=1)R.string[i]=K[i];R.rules=[];for(let i=0;i<F.length;i+=1)R.rules[i]=F[i].name;R.udts=[];for(let i=0;i<Y.length;i+=1)R.udts[i]=Y[i].name;R.id={},R.id.ALT={id:n.ALT,name:"ALT"},R.id.CAT={id:n.CAT,name:"CAT"},R.id.REP={id:n.REP,name:"REP"},R.id.RNM={id:n.RNM,name:"RNM"},R.id.TLS={id:n.TLS,name:"TLS"},R.id.TBS={id:n.TBS,name:"TBS"},R.id.TRG={id:n.TRG,name:"TRG"},R.id.UDT={id:n.UDT,name:"UDT"},R.id.AND={id:n.AND,name:"AND"},R.id.NOT={id:n.NOT,name:"NOT"},R.id.BKR={id:n.BKR,name:"BKR"},R.id.BKA={id:n.BKA,name:"BKA"},R.id.BKN={id:n.BKN,name:"BKN"},R.id.ABG={id:n.ABG,name:"ABG"},R.id.AEN={id:n.AEN,name:"AEN"},R.id.ACTIVE={id:n.ACTIVE,name:"ACTIVE"},R.id.MATCH={id:n.MATCH,name:"MATCH"},R.id.EMPTY={id:n.EMPTY,name:"EMPTY"},R.id.NOMATCH={id:n.NOMATCH,name:"NOMATCH"},R.treeDepth=a,R.leafNodes=re;let x;return u.down?u.up?x="none":x="right":u.up?x="left":x="both",R.branchesIncomplete=x,R.tree=$(u,u.depth),R};this.toTree=function(A){const T=te();return A?JSON.stringify(T):T},this.toHtmlPage=function(A,T,B){return e.htmlToPage(this.toHtml(A,T),B)};const X=function(A,T){let B;switch(A){case g:B="hexadecimal";break;case y:B="decimal";break;case O:B="ASCII";break;case b:B="UNICODE";break;default:throw new Error(`${p}htmlHeader: unrecognized mode: ${A}`)}let j="";return j+=`<p>display mode: ${B}</p>
`,j+=`<table class="${t.CLASS_TRACE}">
`,typeof T=="string"&&(j+=`<caption>${T}</caption>`),j},Q=function(){let A="";return A+=`</table>
`,A+=`<p class="${t.CLASS_MONOSPACE}">legend:<br>
`,A+=`(a)&nbsp;-&nbsp;line number<br>
`,A+=`(b)&nbsp;-&nbsp;matching line number<br>
`,A+=`(c)&nbsp;-&nbsp;phrase offset<br>
`,A+=`(d)&nbsp;-&nbsp;phrase length<br>
`,A+=`(e)&nbsp;-&nbsp;tree depth<br>
`,A+=`(f)&nbsp;-&nbsp;operator state<br>
`,A+=`&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${t.CLASS_ACTIVE}">&darr;</span>&nbsp;&nbsp;phrase opened<br>
`,A+=`&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${t.CLASS_MATCH}">&uarr;M</span> phrase matched<br>
`,A+=`&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${t.CLASS_EMPTY}">&uarr;E</span> empty phrase matched<br>
`,A+=`&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${t.CLASS_NOMATCH}">&uarr;N</span> phrase not matched<br>
`,A+=`operator&nbsp;-&nbsp;ALT, CAT, REP, RNM, TRG, TLS, TBS<sup>&dagger;</sup>, UDT, AND, NOT, BKA, BKN, BKR, ABG, AEN<sup>&Dagger;</sup><br>
`,A+=`phrase&nbsp;&nbsp;&nbsp;-&nbsp;up to ${s} characters of the phrase being matched<br>
`,A+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${t.CLASS_MATCH}">matched characters</span><br>
`,A+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${t.CLASS_LOOKAHEAD}">matched characters in look ahead mode</span><br>
`,A+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${t.CLASS_LOOKBEHIND}">matched characters in look behind mode</span><br>
`,A+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${t.CLASS_REMAINDER}">remainder characters(not yet examined by parser)</span><br>
`,A+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;<span class="${t.CLASS_CTRLCHAR}">control characters, TAB, LF, CR, etc. (ASCII mode only)</span><br>
`,A+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;${S} empty string<br>
`,A+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;${W} end of input string<br>
`,A+=`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;${q} input string display truncated<br>
`,A+=`</p>
`,A+=`<p class="${t.CLASS_MONOSPACE}">
`,A+=`<sup>&dagger;</sup>original ABNF operators:<br>
`,A+=`ALT - alternation<br>
`,A+=`CAT - concatenation<br>
`,A+=`REP - repetition<br>
`,A+=`RNM - rule name<br>
`,A+=`TRG - terminal range<br>
`,A+=`TLS - terminal literal string (case insensitive)<br>
`,A+=`TBS - terminal binary string (case sensitive)<br>
`,A+=`<br>
`,A+=`<sup>&Dagger;</sup>super set SABNF operators:<br>
`,A+=`UDT - user-defined terminal<br>
`,A+=`AND - positive look ahead<br>
`,A+=`NOT - negative look ahead<br>
`,A+=`BKA - positive look behind<br>
`,A+=`BKN - negative look behind<br>
`,A+=`BKR - back reference<br>
`,A+=`ABG - anchor - begin of input string<br>
`,A+=`AEN - anchor - end of input string<br>
`,A+=`</p>
`,A};this.indent=function(A){let T="";for(let B=0;B<A;B+=1)T+=".";return T};const ae=function(A,T){let B="";if(T.type===n.TRG)if(A===g||A===b){let j=T.min.toString(16).toUpperCase();j.length%2!==0&&(j=`0${j}`),B+=A===g?"%x":"U+",B+=j,j=T.max.toString(16).toUpperCase(),j.length%2!==0&&(j=`0${j}`),B+=`&ndash;${j}`}else B=`%d${T.min.toString(10)}&ndash;${T.max.toString(10)}`;return B},de=function(A,T){let B="";if(T.type===n.REP)if(A===g){let j=T.min.toString(16).toUpperCase();j.length%2!==0&&(j=`0${j}`),B=`x${j}`,T.max<1/0?(j=T.max.toString(16).toUpperCase(),j.length%2!==0&&(j=`0${j}`)):j="inf",B+=`&ndash;${j}`}else T.max<1/0?B=`${T.min.toString(10)}&ndash;${T.max.toString(10)}`:B=`${T.min.toString(10)}&ndash;inf`;return B},V=function(A,T){let B="";if(T.type===n.TBS){const j=Math.min(T.string.length,l*2);if(A===g||A===b){B+=A===g?"%x":"U+";for(let ee=0;ee<j;ee+=1){let re;ee>0&&(B+="."),re=T.string[ee].toString(16).toUpperCase(),re.length%2!==0&&(re=`0${re}`),B+=re}}else{B="%d";for(let ee=0;ee<j;ee+=1)ee>0&&(B+="."),B+=T.string[ee].toString(10)}j<T.string.length&&(B+=q)}return B},Z=function(A,T){let B="";if(T.type===n.TLS){const j=Math.min(T.string.length,l);if(A===g||A===y){let ee,re,ie;A===g?(B="%x",ie=16):(B="%d",ie=10);for(let I=0;I<j;I+=1)I>0&&(B+="."),re=T.string[I],re>=97&&re<=122?(ee=re-32,B+=`${ee.toString(ie)}/${re.toString(ie)}`.toUpperCase()):re>=65&&re<=90?(ee=re,re+=32,B+=`${ee.toString(ie)}/${re.toString(ie)}`.toUpperCase()):B+=re.toString(ie).toUpperCase();j<T.string.length&&(B+=q)}else{B='"';for(let ee=0;ee<j;ee+=1)B+=e.asciiChars[T.string[ee]];j<T.string.length&&(B+=q),B+='"'}}return B},J=function(A,T,B,j,ee){if(j===0)return"";let re="";const ie=ee?",":"";switch(A){case g:re=ie+e.charsToHex(T,B,j);break;case y:if(ee)return`,${e.charsToDec(T,B,j)}`;re=ie+e.charsToDec(T,B,j);break;case b:re=e.charsToUnicode(T,B,j);break;case O:default:re=e.charsToAsciiHtml(T,B,j);break}return re},C=function(A,T,B,j,ee,re){let ie="",I,G,$,D,u=W;const v=`<span class="${t.CLASS_LOOKBEHIND}">`,ne=`<span class="${t.CLASS_REMAINDER}">`,oe="</span>";let pe=!1;switch(B){case n.EMPTY:ie+=S;case n.NOMATCH:case n.MATCH:case n.ACTIVE:I=j-ee,G=re-I,$=re,D=T.length-$;break;default:throw new Error("unrecognized state")}return u=W,G>s?(G=s,u=q,D=0):G+D>s&&(u=q,D=s-G),G>0&&(ie+=v,ie+=J(A,T,I,G,pe),ie+=oe,pe=!0),D>0&&(ie+=ne,ie+=J(A,T,$,D,pe),ie+=oe),ie+u},ue=function(A,T,B,j,ee,re){let ie="",I,G,$,D,u=W;const v=`<span class="${t.CLASS_REMAINDER}">`,ne="</span>";let oe=!1;switch(B){case n.EMPTY:ie+=S;case n.NOMATCH:case n.ACTIVE:I=j,G=0,$=j,D=T.length-$;break;case n.MATCH:I=j,G=ee,$=j+G,D=T.length-$;break;default:throw new Error("unrecognized state")}return u=W,G>s?(G=s,u=q,D=0):G+D>s&&(u=q,D=s-G),G>0&&(ie+=re,ie+=J(A,T,I,G,oe),ie+=ne,oe=!0),D>0&&(ie+=v,ie+=J(A,T,$,D,oe),ie+=ne),ie+u},me=function(A,T,B,j,ee){const re=`<span class="${t.CLASS_LOOKAHEAD}">`;return ue(A,T,B,j,ee,re)},Ee=function(A,T,B,j,ee){const re=`<span class="${t.CLASS_MATCH}">`;return ue(A,T,B,j,ee,re)},ce=function(A){if(F===null)return"";let T="",B,j,ee,re,ie,I;return T+="<tr><th>(a)</th><th>(b)</th><th>(c)</th><th>(d)</th><th>(e)</th><th>(f)</th>",T+=`<th>operator</th><th>phrase</th></tr>
`,r.forEach(G=>{const $=o[G];switch(B=$.thisLine,j=$.thatLine!==void 0?$.thatLine:"--",ee=!1,re=!1,ie=!1,$.lookAround===n.LOOKAROUND_AHEAD&&(ee=!0,ie=!0,I=$.lookAnchor),($.opcode.type===n.AND||$.opcode.type===n.NOT)&&(ee=!0,ie=!0,I=$.phraseIndex),$.lookAround===n.LOOKAROUND_BEHIND&&(re=!0,ie=!0,I=$.lookAnchor),($.opcode.type===n.BKA||$.opcode.type===n.BKN)&&(re=!0,ie=!0,I=$.phraseIndex),T+="<tr>",T+=`<td>${B}</td><td>${j}</td>`,T+=`<td>${$.phraseIndex}</td>`,T+=`<td>${$.phraseLength}</td>`,T+=`<td>${$.depth}</td>`,T+="<td>",$.state){case n.ACTIVE:T+=`<span class="${t.CLASS_ACTIVE}">&darr;&nbsp;</span>`;break;case n.MATCH:T+=`<span class="${t.CLASS_MATCH}">&uarr;M</span>`;break;case n.NOMATCH:T+=`<span class="${t.CLASS_NOMATCH}">&uarr;N</span>`;break;case n.EMPTY:T+=`<span class="${t.CLASS_EMPTY}">&uarr;E</span>`;break;default:T+=`<span class="${t.CLASS_ACTIVE}">--</span>`;break}if(T+="</td>",T+="<td>",T+=w.indent($.depth),ee?T+=`<span class="${t.CLASS_LOOKAHEAD}">`:re&&(T+=`<span class="${t.CLASS_LOOKBEHIND}">`),T+=e.opcodeToString($.opcode.type),$.opcode.type===n.RNM&&(T+=`(${F[$.opcode.index].name}) `),$.opcode.type===n.BKR){const D=$.opcode.bkrCase===n.BKR_MODE_CI?"%i":"%s",u=$.opcode.bkrMode===n.BKR_MODE_UM?"%u":"%p";T+=`(\\${D}${u}${F[$.opcode.index].name}) `}$.opcode.type===n.UDT&&(T+=`(${Y[$.opcode.index].name}) `),$.opcode.type===n.TRG&&(T+=`(${ae(A,$.opcode)}) `),$.opcode.type===n.TBS&&(T+=`(${V(A,$.opcode)}) `),$.opcode.type===n.TLS&&(T+=`(${Z(A,$.opcode)}) `),$.opcode.type===n.REP&&(T+=`(${de(A,$.opcode)}) `),ie&&(T+="</span>"),T+="</td>",T+="<td>",re?T+=C(A,K,$.state,$.phraseIndex,$.phraseLength,I):ee?T+=me(A,K,$.state,$.phraseIndex,$.phraseLength):T+=Ee(A,K,$.state,$.phraseIndex,$.phraseLength),T+=`</td></tr>
`}),T+="<tr><th>(a)</th><th>(b)</th><th>(c)</th><th>(d)</th><th>(e)</th><th>(f)</th>",T+=`<th>operator</th><th>phrase</th></tr>
`,T+=`</table>
`,T};this.toHtml=function(A,T){let B=O;if(typeof A=="string"&&A.length>=3){const ee=A.toLowerCase().slice(0,3);ee==="hex"?B=g:ee==="dec"?B=y:ee==="uni"&&(B=b)}let j="";return j+=X(B,T),j+=ce(B),j+=Q(),j}}),Ze}var Qe,Kt;function Le(){return Kt||(Kt=1,Qe={ast:Yr(),circular:lr(),ids:ke(),parser:zr(),stats:qr(),trace:Jr(),utils:$e(),emitcss:or(),style:Ue()}),Qe}var et,Ft;function Wr(){return Ft||(Ft=1,et=function(){this.grammarObject="grammarObject",this.rules=[],this.rules[0]={name:"file",lower:"file",index:0,isBkr:!1},this.rules[1]={name:"line",lower:"line",index:1,isBkr:!1},this.rules[2]={name:"line-text",lower:"line-text",index:2,isBkr:!1},this.rules[3]={name:"last-line",lower:"last-line",index:3,isBkr:!1},this.rules[4]={name:"valid",lower:"valid",index:4,isBkr:!1},this.rules[5]={name:"invalid",lower:"invalid",index:5,isBkr:!1},this.rules[6]={name:"end",lower:"end",index:6,isBkr:!1},this.rules[7]={name:"CRLF",lower:"crlf",index:7,isBkr:!1},this.rules[8]={name:"LF",lower:"lf",index:8,isBkr:!1},this.rules[9]={name:"CR",lower:"cr",index:9,isBkr:!1},this.udts=[],this.rules[0].opcodes=[],this.rules[0].opcodes[0]={type:2,children:[1,3]},this.rules[0].opcodes[1]={type:3,min:0,max:1/0},this.rules[0].opcodes[2]={type:4,index:1},this.rules[0].opcodes[3]={type:3,min:0,max:1},this.rules[0].opcodes[4]={type:4,index:3},this.rules[1].opcodes=[],this.rules[1].opcodes[0]={type:2,children:[1,2]},this.rules[1].opcodes[1]={type:4,index:2},this.rules[1].opcodes[2]={type:4,index:6},this.rules[2].opcodes=[],this.rules[2].opcodes[0]={type:3,min:0,max:1/0},this.rules[2].opcodes[1]={type:1,children:[2,3]},this.rules[2].opcodes[2]={type:4,index:4},this.rules[2].opcodes[3]={type:4,index:5},this.rules[3].opcodes=[],this.rules[3].opcodes[0]={type:3,min:1,max:1/0},this.rules[3].opcodes[1]={type:1,children:[2,3]},this.rules[3].opcodes[2]={type:4,index:4},this.rules[3].opcodes[3]={type:4,index:5},this.rules[4].opcodes=[],this.rules[4].opcodes[0]={type:1,children:[1,2]},this.rules[4].opcodes[1]={type:5,min:32,max:126},this.rules[4].opcodes[2]={type:6,string:[9]},this.rules[5].opcodes=[],this.rules[5].opcodes[0]={type:1,children:[1,2,3,4]},this.rules[5].opcodes[1]={type:5,min:0,max:8},this.rules[5].opcodes[2]={type:5,min:11,max:12},this.rules[5].opcodes[3]={type:5,min:14,max:31},this.rules[5].opcodes[4]={type:5,min:127,max:4294967295},this.rules[6].opcodes=[],this.rules[6].opcodes[0]={type:1,children:[1,2,3]},this.rules[6].opcodes[1]={type:4,index:7},this.rules[6].opcodes[2]={type:4,index:8},this.rules[6].opcodes[3]={type:4,index:9},this.rules[7].opcodes=[],this.rules[7].opcodes[0]={type:6,string:[13,10]},this.rules[8].opcodes=[],this.rules[8].opcodes[0]={type:6,string:[10]},this.rules[9].opcodes=[],this.rules[9].opcodes[0]={type:6,string:[13]},this.toString=function(){let t="";return t+=`file = *line [last-line]
`,t+=`line = line-text end
`,t+=`line-text = *(valid/invalid)
`,t+=`last-line = 1*(valid/invalid)
`,t+=`valid = %d32-126 / %d9
`,t+=`invalid = %d0-8 / %d11-12 /%d14-31 / %x7f-ffffffff
`,t+=`end = CRLF / LF / CR
`,t+=`CRLF = %d13.10
`,t+=`LF = %d10
`,t+=`CR = %d13
`,t}}),et}var tt={},Ut;function Xr(){if(Ut)return tt;Ut=1;const _=ke(),e=$e();function t(s,l,o,c,h){return s===_.SEM_PRE?(h.endLength=0,h.textLength=0,h.invalidCount=0):h.lines.push({lineNo:h.lines.length,beginChar:o,length:c,textLength:h.textLength,endType:h.endType,invalidChars:h.invalidCount}),_.SEM_OK}function r(s,l,o,c,h){return s===_.SEM_PRE&&(h.textLength=c),_.SEM_OK}function n(s,l,o,c,h){return s===_.SEM_PRE?(h.endLength=0,h.textLength=0,h.invalidCount=0):h.strict?(h.lines.push({lineNo:h.lines.length,beginChar:o,length:c,textLength:c,endType:"none",invalidChars:h.invalidCount}),h.errors.push({line:h.lineNo,char:o+c,msg:"no line end on last line - strict ABNF specifies CRLF(\\r\\n, \\x0D\\x0A)"})):(l.push(10),h.lines.push({lineNo:h.lines.length,beginChar:o,length:c+1,textLength:c,endType:"LF",invalidChars:h.invalidCount})),_.SEM_OK}function p(s,l,o,c,h){return s===_.SEM_PRE&&h.errors.push({line:h.lineNo,char:o,msg:`invalid character found '\\x${e.charToHex(l[o])}'`}),_.SEM_OK}function w(s,l,o,c,h){return s===_.SEM_POST&&(h.lineNo+=1),_.SEM_OK}function g(s,l,o,c,h){return s===_.SEM_PRE&&(h.endType="LF",h.strict&&h.errors.push({line:h.lineNo,char:o,msg:"line end character LF(\\n, \\x0A) - strict ABNF specifies CRLF(\\r\\n, \\x0D\\x0A)"})),_.SEM_OK}function y(s,l,o,c,h){return s===_.SEM_PRE&&(h.endType="CR",h.strict&&h.errors.push({line:h.lineNo,char:o,msg:"line end character CR(\\r, \\x0D) - strict ABNF specifies CRLF(\\r\\n, \\x0D\\x0A)"})),_.SEM_OK}function O(s,l,o,c,h){return s===_.SEM_PRE&&(h.endType="CRLF"),_.SEM_OK}const b=[];return b.line=t,b["line-text"]=r,b["last-line"]=n,b.invalid=p,b.end=w,b.lf=g,b.cr=y,b.crlf=O,tt.callbacks=b,tt}var rt,Dt;function Zr(){return Dt||(Dt=1,rt=function(e,t,r,n){const p="scanner.js: ",w=Le(),g=new(Wr()),{callbacks:y}=Xr(),O=[],b=new w.parser;if(b.ast=new w.ast,b.ast.callbacks=y,n){if(n.traceObject!=="traceObject")throw new TypeError(`${p}trace argument is not a trace object`);b.trace=n}if(b.parse(g,"file",e).success!==!0){t.push({line:0,char:0,msg:"syntax analysis error analyzing input SABNF grammar"});return}const l={lines:O,lineNo:0,errors:t,strict:!!r};return b.ast.translate(l),O}),rt}var nt,Gt;function Qr(){return Gt||(Gt=1,nt=function(){const e="syntax-callbacks.js: ",t=Le(),r=t.ids;let n;const p=function(Z,J,C,ue){switch(Z.state){case r.ACTIVE:ue.altStack=[],ue.repCount=0;break;case r.EMPTY:ue.errors.push({line:0,char:0,msg:"grammar file is empty"});break;case r.MATCH:ue.ruleCount===0&&ue.errors.push({line:0,char:0,msg:"no rules defined"});break;case r.NOMATCH:throw new Error(`${e}synFile: grammar file NOMATCH: design error: should never happen.`);default:throw new Error(`${e}synFile: unrecognized case.`)}},w=function(V,Z,J,C){switch(V.state){case r.ACTIVE:C.altStack.length=0,n={groupOpen:null,groupError:!1,optionOpen:null,optionError:!1,tlsOpen:null,clsOpen:null,prosValOpen:null,basicError:!1},C.altStack.push(n);break;case r.EMPTY:throw new Error(`${e}synRule: EMPTY: rule cannot be empty`);case r.NOMATCH:break;case r.MATCH:C.ruleCount+=1;break;default:throw new Error(`${e}synFile: unrecognized case.`)}},g=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:C.errors.push({line:C.findLine(C.lines,J,C.charsLength),char:J,msg:"Unrecognized SABNF line. Invalid rule, comment or blank line."});break;default:throw new Error(`${e}synFile: unrecognized case.`)}},y=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:C.errors.push({line:C.findLine(C.lines,J,C.charsLength),char:J,msg:"Rule names must be alphanum and begin with alphabetic character."});break;default:throw new Error(`${e}synFile: unrecognized case.`)}},O=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:C.errors.push({line:C.findLine(C.lines,J,C.charsLength),char:J,msg:"Expected '=' or '=/'. Not found."});break;default:throw new Error(`${e}synFile: unrecognized case.`)}},b=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:C.strict&&C.errors.push({line:C.findLine(C.lines,J,C.charsLength),char:J,msg:"AND operator(&) found - strict ABNF specified."});break;default:throw new Error(`${e}synFile: unrecognized case.`)}},s=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:C.strict&&C.errors.push({line:C.findLine(C.lines,J,C.charsLength),char:J,msg:"NOT operator(!) found - strict ABNF specified."});break;default:throw new Error(`${e}synFile: unrecognized case.`)}},l=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:C.strict&&C.errors.push({line:C.findLine(C.lines,J,C.charsLength),char:J,msg:"Positive look-behind operator(&&) found - strict ABNF specified."});break;default:throw new Error(`${e}synFile: unrecognized case.`)}},o=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:C.strict&&C.errors.push({line:C.findLine(C.lines,J,C.charsLength),char:J,msg:"Negative look-behind operator(!!) found - strict ABNF specified."});break;default:throw new Error(`${e}synFile: unrecognized case.`)}},c=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:C.strict&&C.errors.push({line:C.findLine(C.lines,J,C.charsLength),char:J,msg:"Beginning of string anchor(%^) found - strict ABNF specified."});break;default:throw new Error(`${e}synFile: unrecognized case.`)}},h=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:C.strict&&C.errors.push({line:C.findLine(C.lines,J,C.charsLength),char:J,msg:"End of string anchor(%$) found - strict ABNF specified."});break;default:throw new Error(`${e}synFile: unrecognized case.`)}},M=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:if(C.strict){const ue=t.utils.charsToString(Z,J,V.phraseLength);C.errors.push({line:C.findLine(C.lines,J,C.charsLength),char:J,msg:`Back reference operator(${ue}) found - strict ABNF specified.`})}break;default:throw new Error(`${e}synFile: unrecognized case.`)}},a=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:if(C.strict){const ue=t.utils.charsToString(Z,J,V.phraseLength);C.errors.push({line:C.findLine(C.lines,J,C.charsLength),char:J,msg:`UDT operator found(${ue}) - strict ABNF specified.`})}break;default:throw new Error(`${e}synFile: unrecognized case.`)}},E=function(V,Z,J){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:n.tlsOpen=J;break;default:throw new Error(`${e}synFile: unrecognized case.`)}},K=function(V,Z,J,C){switch(V.state){case r.ACTIVE:C.stringTabChar=!1;break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:C.stringTabChar!==!1&&C.errors.push({line:C.findLine(C.lines,C.stringTabChar),char:C.stringTabChar,msg:"Tab character (\\t, x09) not allowed in literal string (see 'quoted-string' definition, RFC 7405.)"});break;default:throw new Error(`${e}synFile: unrecognized case.`)}},F=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:C.stringTabChar=J;break;default:throw new Error(`${e}synFile: unrecognized case.`)}},Y=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:C.errors.push({line:C.findLine(C.lines,n.tlsOpen),char:n.tlsOpen,msg:'Case-insensitive literal string("...") opened but not closed.'}),n.basicError=!0,n.tlsOpen=null;break;case r.MATCH:n.tlsOpen=null;break;default:throw new Error(`${e}synFile: unrecognized case.`)}},f=function(V,Z,J){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:n.clsOpen=J;break;default:throw new Error(`${e}synFile: unrecognized case.`)}},U=function(V,Z,J,C){switch(V.state){case r.ACTIVE:C.stringTabChar=!1;break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:C.stringTabChar!==!1&&C.errors.push({line:C.findLine(C.lines,C.stringTabChar),char:C.stringTabChar,msg:"Tab character (\\t, x09) not allowed in literal string."});break;default:throw new Error(`${e}synFile: unrecognized case.`)}},W=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:C.errors.push({line:C.findLine(C.lines,n.clsOpen),char:n.clsOpen,msg:"Case-sensitive literal string('...') opened but not closed."}),n.clsOpen=null,n.basicError=!0;break;case r.MATCH:C.strict&&C.errors.push({line:C.findLine(C.lines,n.clsOpen),char:n.clsOpen,msg:"Case-sensitive string operator('...') found - strict ABNF specified."}),n.clsOpen=null;break;default:throw new Error(`${e}synFile: unrecognized case.`)}},q=function(V,Z,J){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:n.prosValOpen=J;break;default:throw new Error(`${e}synFile: unrecognized case.`)}},S=function(V,Z,J,C){switch(V.state){case r.ACTIVE:C.stringTabChar=!1;break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:C.stringTabChar!==!1&&C.errors.push({line:C.findLine(C.lines,C.stringTabChar),char:C.stringTabChar,msg:"Tab character (\\t, x09) not allowed in prose value string."});break;default:throw new Error(`${e}synFile: unrecognized case.`)}},N=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:C.errors.push({line:C.findLine(C.lines,n.prosValOpen),char:n.prosValOpen,msg:"Prose value operator(<...>) opened but not closed."}),n.basicError=!0,n.prosValOpen=null;break;case r.MATCH:C.errors.push({line:C.findLine(C.lines,n.prosValOpen),char:n.prosValOpen,msg:"Prose value operator(<...>) found. The ABNF syntax is valid, but a parser cannot be generated from this grammar."}),n.prosValOpen=null;break;default:throw new Error(`${e}synFile: unrecognized case.`)}},L=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:n={groupOpen:J,groupError:!1,optionOpen:null,optionError:!1,tlsOpen:null,clsOpen:null,prosValOpen:null,basicError:!1},C.altStack.push(n);break;default:throw new Error(`${e}synFile: unrecognized case.`)}},d=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:C.errors.push({line:C.findLine(C.lines,n.groupOpen),char:n.groupOpen,msg:'Group "(...)" opened but not closed.'}),n=C.altStack.pop(),n.groupError=!0;break;case r.MATCH:n=C.altStack.pop();break;default:throw new Error(`${e}synFile: unrecognized case.`)}},k=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:n={groupOpen:null,groupError:!1,optionOpen:J,optionError:!1,tlsOpen:null,clsOpen:null,prosValOpen:null,basicError:!1},C.altStack.push(n);break;default:throw new Error(`${e}synFile: unrecognized case.`)}},te=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:C.errors.push({line:C.findLine(C.lines,n.optionOpen),char:n.optionOpen,msg:'Option "[...]" opened but not closed.'}),n=C.altStack.pop(),n.optionError=!0;break;case r.MATCH:n=C.altStack.pop();break;default:throw new Error(`${e}synFile: unrecognized case.`)}},X=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:n.basicError===!1&&C.errors.push({line:C.findLine(C.lines,J,C.charsLength),char:J,msg:"Unrecognized SABNF element."});break;default:throw new Error(`${e}synFile: unrecognized case.`)}},Q=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:if(V.phraseLength===1&&C.strict){const ue=Z[J]===13?"CR":"LF";C.errors.push({line:C.findLine(C.lines,J,C.charsLength),char:J,msg:`Line end '${ue}' found - strict ABNF specified, only CRLF allowed.`})}break;default:throw new Error(`${e}synFile: unrecognized case.`)}},ae=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:break;case r.MATCH:C.errors.push({line:C.findLine(C.lines,J,C.charsLength),char:J,msg:"Unrecognized grammar element or characters."});break;default:throw new Error(`${e}synFile: unrecognized case.`)}},de=function(V,Z,J,C){switch(V.state){case r.ACTIVE:break;case r.EMPTY:break;case r.NOMATCH:C.repCount+=1;break;case r.MATCH:C.repCount+=1;break;default:throw new Error(`${e}synFile: unrecognized case.`)}};this.callbacks=[],this.callbacks.andop=b,this.callbacks.basicelementerr=X,this.callbacks.clsclose=W,this.callbacks.clsopen=f,this.callbacks.clsstring=U,this.callbacks.definedaserror=O,this.callbacks.file=p,this.callbacks.groupclose=d,this.callbacks.groupopen=L,this.callbacks.lineenderror=ae,this.callbacks.lineend=Q,this.callbacks.notop=s,this.callbacks.optionclose=te,this.callbacks.optionopen=k,this.callbacks.prosvalclose=N,this.callbacks.prosvalopen=q,this.callbacks.prosvalstring=S,this.callbacks.repetition=de,this.callbacks.rule=w,this.callbacks.ruleerror=g,this.callbacks.rulenameerror=y,this.callbacks.stringtab=F,this.callbacks.tlsclose=Y,this.callbacks.tlsopen=E,this.callbacks.tlsstring=K,this.callbacks.udtop=a,this.callbacks.bkaop=l,this.callbacks.bknop=o,this.callbacks.bkrop=M,this.callbacks.abgop=c,this.callbacks.aenop=h}),nt}var st,jt;function en(){return jt||(jt=1,st=function(){const e=Le(),t=e.ids,r=function(){this.names=[],this.add=function($){let D=-1;return this.get($)===-1&&(D={name:$,lower:$.toLowerCase(),index:this.names.length},this.names.push(D)),D},this.get=function($){let D=-1;const u=$.toLowerCase();for(let v=0;v<this.names.length;v+=1)if(this.names[v].lower===u){D=this.names[v];break}return D}},n=function(G,$,D){let u=0;for(let v=$;v<$+D;v+=1)u=10*u+G[v]-48;return u},p=function(G,$,D){let u=0;for(let v=$;v<$+D;v+=1)u=2*u+G[v]-48;return u},w=function(G,$,D){let u=0;for(let v=$;v<$+D;v+=1){let ne=G[v];if(ne>=48&&ne<=57)ne-=48;else if(ne>=65&&ne<=70)ne-=55;else if(ne>=97&&ne<=102)ne-=87;else throw new Error("hexnum out of range");u=16*u+ne}return u};function g(I,G,$,D,u){const v=t.SEM_OK;if(I===t.SEM_PRE)u.ruleNames=new r,u.udtNames=new r,u.rules=[],u.udts=[],u.rulesLineMap=[],u.opcodes=[],u.altStack=[],u.topStack=null,u.topRule=null;else if(I===t.SEM_POST){let ne;u.rules.forEach(oe=>{oe.isBkr=!1,oe.opcodes.forEach(pe=>{pe.type===t.RNM&&(ne=u.ruleNames.get(pe.index.name),ne===-1?(u.errors.push({line:u.findLine(u.lines,pe.index.phraseIndex,u.charsLength),char:pe.index.phraseIndex,msg:`Rule name '${pe.index.name}' used but not defined.`}),pe.index=-1):pe.index=ne.index)})}),u.udts.forEach(oe=>{oe.isBkr=!1}),u.rules.forEach(oe=>{oe.opcodes.forEach(pe=>{pe.type===t.BKR&&(oe.hasBkr=!0,ne=u.ruleNames.get(pe.index.name),ne!==-1?(u.rules[ne.index].isBkr=!0,pe.index=ne.index):(ne=u.udtNames.get(pe.index.name),ne!==-1?(u.udts[ne.index].isBkr=!0,pe.index=u.rules.length+ne.index):(u.errors.push({line:u.findLine(u.lines,pe.index.phraseIndex,u.charsLength),char:pe.index.phraseIndex,msg:`Back reference name '${pe.index.name}' refers to undefined rule or unamed UDT.`}),pe.index=-1)))})})}return v}function y(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_PRE&&(u.altStack.length=0,u.topStack=null,u.rulesLineMap.push({line:u.findLine(u.lines,$,u.charsLength),char:$})),v}function O(I,G,$,D,u){const v=t.SEM_OK;if(I===t.SEM_PRE)u.ruleName="",u.definedas="";else if(I===t.SEM_POST){let ne;u.definedas==="="?(ne=u.ruleNames.add(u.ruleName),ne===-1?(u.definedas=null,u.errors.push({line:u.findLine(u.lines,$,u.charsLength),char:$,msg:`Rule name '${u.ruleName}' previously defined.`})):(u.topRule={name:ne.name,lower:ne.lower,opcodes:[],index:ne.index},u.rules.push(u.topRule),u.opcodes=u.topRule.opcodes)):(ne=u.ruleNames.get(u.ruleName),ne===-1?(u.definedas=null,u.errors.push({line:u.findLine(u.lines,$,u.charsLength),char:$,msg:`Rule name '${u.ruleName}' for incremental alternate not previously defined.`})):(u.topRule=u.rules[ne.index],u.opcodes=u.topRule.opcodes))}return v}function b(I,G,$,D,u){let v=t.SEM_OK;if(I===t.SEM_PRE)for(;;){if(u.definedas===null){v=t.SEM_SKIP;break}if(u.topStack===null){if(u.definedas==="="){u.topStack={alt:{type:t.ALT,children:[]},cat:null},u.altStack.push(u.topStack),u.opcodes.push(u.topStack.alt);break}u.topStack={alt:u.opcodes[0],cat:null},u.altStack.push(u.topStack);break}u.topStack={alt:{type:t.ALT,children:[]},cat:null},u.altStack.push(u.topStack),u.opcodes.push(u.topStack.alt);break}else I===t.SEM_POST&&(u.altStack.pop(),u.altStack.length>0?u.topStack=u.altStack[u.altStack.length-1]:u.topStack=null);return v}function s(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_PRE?(u.topStack.alt.children.push(u.opcodes.length),u.topStack.cat={type:t.CAT,children:[]},u.opcodes.push(u.topStack.cat)):I===t.SEM_POST&&(u.topStack.cat=null),v}function l(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_PRE&&u.topStack.cat.children.push(u.opcodes.length),v}function o(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&u.opcodes.push({type:t.REP,min:0,max:1,char:$}),v}function c(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_PRE&&(u.ruleName=e.utils.charsToString(G,$,D)),v}function h(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.definedas="="),v}function M(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.definedas="=/"),v}function a(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_PRE?(u.min=0,u.max=1/0,u.topRep={type:t.REP,min:0,max:1/0},u.opcodes.push(u.topRep)):I===t.SEM_POST&&(u.min>u.max&&u.errors.push({line:u.findLine(u.lines,$,u.charsLength),char:$,msg:`repetition min cannot be greater than max: min: ${u.min}: max: ${u.max}`}),u.topRep.min=u.min,u.topRep.max=u.max),v}function E(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.min=n(G,$,D)),v}function K(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.max=n(G,$,D)),v}function F(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.max=n(G,$,D),u.min=u.max),v}function Y(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&u.opcodes.push({type:t.AND}),v}function f(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&u.opcodes.push({type:t.NOT}),v}function U(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&u.opcodes.push({type:t.RNM,index:{phraseIndex:$,name:e.utils.charsToString(G,$,D)}}),v}function W(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&u.opcodes.push({type:t.ABG}),v}function q(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&u.opcodes.push({type:t.AEN}),v}function S(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&u.opcodes.push({type:t.BKA}),v}function N(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&u.opcodes.push({type:t.BKN}),v}function L(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_PRE?(u.ci=!0,u.cs=!1,u.um=!0,u.pm=!1):I===t.SEM_POST&&u.opcodes.push({type:t.BKR,bkrCase:u.cs===!0?t.BKR_MODE_CS:t.BKR_MODE_CI,bkrMode:u.pm===!0?t.BKR_MODE_PM:t.BKR_MODE_UM,index:{phraseIndex:u.bkrname.phraseIndex,name:e.utils.charsToString(G,u.bkrname.phraseIndex,u.bkrname.phraseLength)}}),v}function d(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.ci=!0),v}function k(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.cs=!0),v}function te(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.um=!0),v}function X(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.pm=!0),v}function Q(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.bkrname={phraseIndex:$,phraseLength:D}),v}function ae(I,G,$,D,u){const v=t.SEM_OK;if(I===t.SEM_POST){const ne=e.utils.charsToString(G,$,D);let oe=u.udtNames.add(ne);if(oe===-1){if(oe=u.udtNames.get(ne),oe===-1)throw new Error("semUdtEmpty: name look up error")}else u.udts.push({name:oe.name,lower:oe.lower,index:oe.index,empty:!0});u.opcodes.push({type:t.UDT,empty:!0,index:oe.index})}return v}function de(I,G,$,D,u){const v=t.SEM_OK;if(I===t.SEM_POST){const ne=e.utils.charsToString(G,$,D);let oe=u.udtNames.add(ne);if(oe===-1){if(oe=u.udtNames.get(ne),oe===-1)throw new Error("semUdtNonEmpty: name look up error")}else u.udts.push({name:oe.name,lower:oe.lower,index:oe.index,empty:!1});u.opcodes.push({type:t.UDT,empty:!1,index:oe.index,syntax:null,semantic:null})}return v}function V(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_PRE&&(u.tlscase=!0),v}function Z(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&D>0&&(G[$+1]===83||G[$+1]===115)&&(u.tlscase=!1),v}function J(I,G,$,D,u){const v=t.SEM_OK;if(I===t.SEM_POST)if(u.tlscase){const ne=G.slice($,$+D);for(let oe=0;oe<ne.length;oe+=1)ne[oe]>=65&&ne[oe]<=90&&(ne[oe]+=32);u.opcodes.push({type:t.TLS,string:ne})}else u.opcodes.push({type:t.TBS,string:G.slice($,$+D)});return v}function C(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(D<=2?u.opcodes.push({type:t.TLS,string:[]}):u.opcodes.push({type:t.TBS,string:G.slice($+1,$+D-1)})),v}function ue(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_PRE?u.tbsstr=[]:I===t.SEM_POST&&u.opcodes.push({type:t.TBS,string:u.tbsstr}),v}function me(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_PRE?(u.min=0,u.max=0):I===t.SEM_POST&&(u.min>u.max&&u.errors.push({line:u.findLine(u.lines,$,u.charsLength),char:$,msg:`TRG, (%dmin-max), min cannot be greater than max: min: ${u.min}: max: ${u.max}`}),u.opcodes.push({type:t.TRG,min:u.min,max:u.max})),v}function Ee(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.min=n(G,$,D)),v}function ce(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.max=n(G,$,D)),v}function A(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.min=p(G,$,D)),v}function T(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.max=p(G,$,D)),v}function B(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.min=w(G,$,D)),v}function j(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&(u.max=w(G,$,D)),v}function ee(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&u.tbsstr.push(n(G,$,D)),v}function re(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&u.tbsstr.push(p(G,$,D)),v}function ie(I,G,$,D,u){const v=t.SEM_OK;return I===t.SEM_POST&&u.tbsstr.push(w(G,$,D)),v}this.callbacks=[],this.callbacks.abgop=W,this.callbacks.aenop=q,this.callbacks.alternation=b,this.callbacks.andop=Y,this.callbacks.bmax=T,this.callbacks.bmin=A,this.callbacks.bkaop=S,this.callbacks.bknop=N,this.callbacks.bkrop=L,this.callbacks["bkr-name"]=Q,this.callbacks.bstring=re,this.callbacks.clsop=C,this.callbacks.ci=d,this.callbacks.cs=k,this.callbacks.um=te,this.callbacks.pm=X,this.callbacks.concatenation=s,this.callbacks.defined=h,this.callbacks.dmax=ce,this.callbacks.dmin=Ee,this.callbacks.dstring=ee,this.callbacks.file=g,this.callbacks.incalt=M,this.callbacks.notop=f,this.callbacks.optionopen=o,this.callbacks["rep-max"]=K,this.callbacks["rep-min"]=E,this.callbacks["rep-min-max"]=F,this.callbacks.repetition=l,this.callbacks.repop=a,this.callbacks.rnmop=U,this.callbacks.rule=y,this.callbacks.rulelookup=O,this.callbacks.rulename=c,this.callbacks.tbsop=ue,this.callbacks.tlscase=Z,this.callbacks.tlsstring=J,this.callbacks.tlsop=V,this.callbacks.trgop=me,this.callbacks["udt-empty"]=ae,this.callbacks["udt-non-empty"]=de,this.callbacks.xmax=j,this.callbacks.xmin=B,this.callbacks.xstring=ie}),st}var it,Vt;function tn(){return Vt||(Vt=1,it=function(){this.grammarObject="grammarObject",this.rules=[],this.rules[0]={name:"File",lower:"file",index:0,isBkr:!1},this.rules[1]={name:"BlankLine",lower:"blankline",index:1,isBkr:!1},this.rules[2]={name:"Rule",lower:"rule",index:2,isBkr:!1},this.rules[3]={name:"RuleLookup",lower:"rulelookup",index:3,isBkr:!1},this.rules[4]={name:"RuleNameTest",lower:"rulenametest",index:4,isBkr:!1},this.rules[5]={name:"RuleName",lower:"rulename",index:5,isBkr:!1},this.rules[6]={name:"RuleNameError",lower:"rulenameerror",index:6,isBkr:!1},this.rules[7]={name:"DefinedAsTest",lower:"definedastest",index:7,isBkr:!1},this.rules[8]={name:"DefinedAsError",lower:"definedaserror",index:8,isBkr:!1},this.rules[9]={name:"DefinedAs",lower:"definedas",index:9,isBkr:!1},this.rules[10]={name:"Defined",lower:"defined",index:10,isBkr:!1},this.rules[11]={name:"IncAlt",lower:"incalt",index:11,isBkr:!1},this.rules[12]={name:"RuleError",lower:"ruleerror",index:12,isBkr:!1},this.rules[13]={name:"LineEndError",lower:"lineenderror",index:13,isBkr:!1},this.rules[14]={name:"Alternation",lower:"alternation",index:14,isBkr:!1},this.rules[15]={name:"Concatenation",lower:"concatenation",index:15,isBkr:!1},this.rules[16]={name:"Repetition",lower:"repetition",index:16,isBkr:!1},this.rules[17]={name:"Modifier",lower:"modifier",index:17,isBkr:!1},this.rules[18]={name:"Predicate",lower:"predicate",index:18,isBkr:!1},this.rules[19]={name:"BasicElement",lower:"basicelement",index:19,isBkr:!1},this.rules[20]={name:"BasicElementErr",lower:"basicelementerr",index:20,isBkr:!1},this.rules[21]={name:"Group",lower:"group",index:21,isBkr:!1},this.rules[22]={name:"GroupError",lower:"grouperror",index:22,isBkr:!1},this.rules[23]={name:"GroupOpen",lower:"groupopen",index:23,isBkr:!1},this.rules[24]={name:"GroupClose",lower:"groupclose",index:24,isBkr:!1},this.rules[25]={name:"Option",lower:"option",index:25,isBkr:!1},this.rules[26]={name:"OptionError",lower:"optionerror",index:26,isBkr:!1},this.rules[27]={name:"OptionOpen",lower:"optionopen",index:27,isBkr:!1},this.rules[28]={name:"OptionClose",lower:"optionclose",index:28,isBkr:!1},this.rules[29]={name:"RnmOp",lower:"rnmop",index:29,isBkr:!1},this.rules[30]={name:"BkrOp",lower:"bkrop",index:30,isBkr:!1},this.rules[31]={name:"bkrModifier",lower:"bkrmodifier",index:31,isBkr:!1},this.rules[32]={name:"cs",lower:"cs",index:32,isBkr:!1},this.rules[33]={name:"ci",lower:"ci",index:33,isBkr:!1},this.rules[34]={name:"um",lower:"um",index:34,isBkr:!1},this.rules[35]={name:"pm",lower:"pm",index:35,isBkr:!1},this.rules[36]={name:"bkr-name",lower:"bkr-name",index:36,isBkr:!1},this.rules[37]={name:"rname",lower:"rname",index:37,isBkr:!1},this.rules[38]={name:"uname",lower:"uname",index:38,isBkr:!1},this.rules[39]={name:"ename",lower:"ename",index:39,isBkr:!1},this.rules[40]={name:"UdtOp",lower:"udtop",index:40,isBkr:!1},this.rules[41]={name:"udt-non-empty",lower:"udt-non-empty",index:41,isBkr:!1},this.rules[42]={name:"udt-empty",lower:"udt-empty",index:42,isBkr:!1},this.rules[43]={name:"RepOp",lower:"repop",index:43,isBkr:!1},this.rules[44]={name:"AltOp",lower:"altop",index:44,isBkr:!1},this.rules[45]={name:"CatOp",lower:"catop",index:45,isBkr:!1},this.rules[46]={name:"StarOp",lower:"starop",index:46,isBkr:!1},this.rules[47]={name:"AndOp",lower:"andop",index:47,isBkr:!1},this.rules[48]={name:"NotOp",lower:"notop",index:48,isBkr:!1},this.rules[49]={name:"BkaOp",lower:"bkaop",index:49,isBkr:!1},this.rules[50]={name:"BknOp",lower:"bknop",index:50,isBkr:!1},this.rules[51]={name:"AbgOp",lower:"abgop",index:51,isBkr:!1},this.rules[52]={name:"AenOp",lower:"aenop",index:52,isBkr:!1},this.rules[53]={name:"TrgOp",lower:"trgop",index:53,isBkr:!1},this.rules[54]={name:"TbsOp",lower:"tbsop",index:54,isBkr:!1},this.rules[55]={name:"TlsOp",lower:"tlsop",index:55,isBkr:!1},this.rules[56]={name:"TlsCase",lower:"tlscase",index:56,isBkr:!1},this.rules[57]={name:"TlsOpen",lower:"tlsopen",index:57,isBkr:!1},this.rules[58]={name:"TlsClose",lower:"tlsclose",index:58,isBkr:!1},this.rules[59]={name:"TlsString",lower:"tlsstring",index:59,isBkr:!1},this.rules[60]={name:"StringTab",lower:"stringtab",index:60,isBkr:!1},this.rules[61]={name:"ClsOp",lower:"clsop",index:61,isBkr:!1},this.rules[62]={name:"ClsOpen",lower:"clsopen",index:62,isBkr:!1},this.rules[63]={name:"ClsClose",lower:"clsclose",index:63,isBkr:!1},this.rules[64]={name:"ClsString",lower:"clsstring",index:64,isBkr:!1},this.rules[65]={name:"ProsVal",lower:"prosval",index:65,isBkr:!1},this.rules[66]={name:"ProsValOpen",lower:"prosvalopen",index:66,isBkr:!1},this.rules[67]={name:"ProsValString",lower:"prosvalstring",index:67,isBkr:!1},this.rules[68]={name:"ProsValClose",lower:"prosvalclose",index:68,isBkr:!1},this.rules[69]={name:"rep-min",lower:"rep-min",index:69,isBkr:!1},this.rules[70]={name:"rep-min-max",lower:"rep-min-max",index:70,isBkr:!1},this.rules[71]={name:"rep-max",lower:"rep-max",index:71,isBkr:!1},this.rules[72]={name:"rep-num",lower:"rep-num",index:72,isBkr:!1},this.rules[73]={name:"dString",lower:"dstring",index:73,isBkr:!1},this.rules[74]={name:"xString",lower:"xstring",index:74,isBkr:!1},this.rules[75]={name:"bString",lower:"bstring",index:75,isBkr:!1},this.rules[76]={name:"Dec",lower:"dec",index:76,isBkr:!1},this.rules[77]={name:"Hex",lower:"hex",index:77,isBkr:!1},this.rules[78]={name:"Bin",lower:"bin",index:78,isBkr:!1},this.rules[79]={name:"dmin",lower:"dmin",index:79,isBkr:!1},this.rules[80]={name:"dmax",lower:"dmax",index:80,isBkr:!1},this.rules[81]={name:"bmin",lower:"bmin",index:81,isBkr:!1},this.rules[82]={name:"bmax",lower:"bmax",index:82,isBkr:!1},this.rules[83]={name:"xmin",lower:"xmin",index:83,isBkr:!1},this.rules[84]={name:"xmax",lower:"xmax",index:84,isBkr:!1},this.rules[85]={name:"dnum",lower:"dnum",index:85,isBkr:!1},this.rules[86]={name:"bnum",lower:"bnum",index:86,isBkr:!1},this.rules[87]={name:"xnum",lower:"xnum",index:87,isBkr:!1},this.rules[88]={name:"alphanum",lower:"alphanum",index:88,isBkr:!1},this.rules[89]={name:"owsp",lower:"owsp",index:89,isBkr:!1},this.rules[90]={name:"wsp",lower:"wsp",index:90,isBkr:!1},this.rules[91]={name:"space",lower:"space",index:91,isBkr:!1},this.rules[92]={name:"comment",lower:"comment",index:92,isBkr:!1},this.rules[93]={name:"LineEnd",lower:"lineend",index:93,isBkr:!1},this.rules[94]={name:"LineContinue",lower:"linecontinue",index:94,isBkr:!1},this.udts=[],this.rules[0].opcodes=[],this.rules[0].opcodes[0]={type:3,min:0,max:1/0},this.rules[0].opcodes[1]={type:1,children:[2,3,4]},this.rules[0].opcodes[2]={type:4,index:1},this.rules[0].opcodes[3]={type:4,index:2},this.rules[0].opcodes[4]={type:4,index:12},this.rules[1].opcodes=[],this.rules[1].opcodes[0]={type:2,children:[1,5,7]},this.rules[1].opcodes[1]={type:3,min:0,max:1/0},this.rules[1].opcodes[2]={type:1,children:[3,4]},this.rules[1].opcodes[3]={type:6,string:[32]},this.rules[1].opcodes[4]={type:6,string:[9]},this.rules[1].opcodes[5]={type:3,min:0,max:1},this.rules[1].opcodes[6]={type:4,index:92},this.rules[1].opcodes[7]={type:4,index:93},this.rules[2].opcodes=[],this.rules[2].opcodes[0]={type:2,children:[1,2,3,4]},this.rules[2].opcodes[1]={type:4,index:3},this.rules[2].opcodes[2]={type:4,index:89},this.rules[2].opcodes[3]={type:4,index:14},this.rules[2].opcodes[4]={type:1,children:[5,8]},this.rules[2].opcodes[5]={type:2,children:[6,7]},this.rules[2].opcodes[6]={type:4,index:89},this.rules[2].opcodes[7]={type:4,index:93},this.rules[2].opcodes[8]={type:2,children:[9,10]},this.rules[2].opcodes[9]={type:4,index:13},this.rules[2].opcodes[10]={type:4,index:93},this.rules[3].opcodes=[],this.rules[3].opcodes[0]={type:2,children:[1,2,3]},this.rules[3].opcodes[1]={type:4,index:4},this.rules[3].opcodes[2]={type:4,index:89},this.rules[3].opcodes[3]={type:4,index:7},this.rules[4].opcodes=[],this.rules[4].opcodes[0]={type:1,children:[1,2]},this.rules[4].opcodes[1]={type:4,index:5},this.rules[4].opcodes[2]={type:4,index:6},this.rules[5].opcodes=[],this.rules[5].opcodes[0]={type:4,index:88},this.rules[6].opcodes=[],this.rules[6].opcodes[0]={type:3,min:1,max:1/0},this.rules[6].opcodes[1]={type:1,children:[2,3]},this.rules[6].opcodes[2]={type:5,min:33,max:60},this.rules[6].opcodes[3]={type:5,min:62,max:126},this.rules[7].opcodes=[],this.rules[7].opcodes[0]={type:1,children:[1,2]},this.rules[7].opcodes[1]={type:4,index:9},this.rules[7].opcodes[2]={type:4,index:8},this.rules[8].opcodes=[],this.rules[8].opcodes[0]={type:3,min:1,max:2},this.rules[8].opcodes[1]={type:5,min:33,max:126},this.rules[9].opcodes=[],this.rules[9].opcodes[0]={type:1,children:[1,2]},this.rules[9].opcodes[1]={type:4,index:11},this.rules[9].opcodes[2]={type:4,index:10},this.rules[10].opcodes=[],this.rules[10].opcodes[0]={type:6,string:[61]},this.rules[11].opcodes=[],this.rules[11].opcodes[0]={type:6,string:[61,47]},this.rules[12].opcodes=[],this.rules[12].opcodes[0]={type:2,children:[1,6]},this.rules[12].opcodes[1]={type:3,min:1,max:1/0},this.rules[12].opcodes[2]={type:1,children:[3,4,5]},this.rules[12].opcodes[3]={type:5,min:32,max:126},this.rules[12].opcodes[4]={type:6,string:[9]},this.rules[12].opcodes[5]={type:4,index:94},this.rules[12].opcodes[6]={type:4,index:93},this.rules[13].opcodes=[],this.rules[13].opcodes[0]={type:3,min:1,max:1/0},this.rules[13].opcodes[1]={type:1,children:[2,3,4]},this.rules[13].opcodes[2]={type:5,min:32,max:126},this.rules[13].opcodes[3]={type:6,string:[9]},this.rules[13].opcodes[4]={type:4,index:94},this.rules[14].opcodes=[],this.rules[14].opcodes[0]={type:2,children:[1,2]},this.rules[14].opcodes[1]={type:4,index:15},this.rules[14].opcodes[2]={type:3,min:0,max:1/0},this.rules[14].opcodes[3]={type:2,children:[4,5,6]},this.rules[14].opcodes[4]={type:4,index:89},this.rules[14].opcodes[5]={type:4,index:44},this.rules[14].opcodes[6]={type:4,index:15},this.rules[15].opcodes=[],this.rules[15].opcodes[0]={type:2,children:[1,2]},this.rules[15].opcodes[1]={type:4,index:16},this.rules[15].opcodes[2]={type:3,min:0,max:1/0},this.rules[15].opcodes[3]={type:2,children:[4,5]},this.rules[15].opcodes[4]={type:4,index:45},this.rules[15].opcodes[5]={type:4,index:16},this.rules[16].opcodes=[],this.rules[16].opcodes[0]={type:2,children:[1,3]},this.rules[16].opcodes[1]={type:3,min:0,max:1},this.rules[16].opcodes[2]={type:4,index:17},this.rules[16].opcodes[3]={type:1,children:[4,5,6,7]},this.rules[16].opcodes[4]={type:4,index:21},this.rules[16].opcodes[5]={type:4,index:25},this.rules[16].opcodes[6]={type:4,index:19},this.rules[16].opcodes[7]={type:4,index:20},this.rules[17].opcodes=[],this.rules[17].opcodes[0]={type:1,children:[1,5]},this.rules[17].opcodes[1]={type:2,children:[2,3]},this.rules[17].opcodes[2]={type:4,index:18},this.rules[17].opcodes[3]={type:3,min:0,max:1},this.rules[17].opcodes[4]={type:4,index:43},this.rules[17].opcodes[5]={type:4,index:43},this.rules[18].opcodes=[],this.rules[18].opcodes[0]={type:1,children:[1,2,3,4]},this.rules[18].opcodes[1]={type:4,index:49},this.rules[18].opcodes[2]={type:4,index:50},this.rules[18].opcodes[3]={type:4,index:47},this.rules[18].opcodes[4]={type:4,index:48},this.rules[19].opcodes=[],this.rules[19].opcodes[0]={type:1,children:[1,2,3,4,5,6,7,8,9,10]},this.rules[19].opcodes[1]={type:4,index:40},this.rules[19].opcodes[2]={type:4,index:29},this.rules[19].opcodes[3]={type:4,index:53},this.rules[19].opcodes[4]={type:4,index:54},this.rules[19].opcodes[5]={type:4,index:55},this.rules[19].opcodes[6]={type:4,index:61},this.rules[19].opcodes[7]={type:4,index:30},this.rules[19].opcodes[8]={type:4,index:51},this.rules[19].opcodes[9]={type:4,index:52},this.rules[19].opcodes[10]={type:4,index:65},this.rules[20].opcodes=[],this.rules[20].opcodes[0]={type:3,min:1,max:1/0},this.rules[20].opcodes[1]={type:1,children:[2,3,4,5]},this.rules[20].opcodes[2]={type:5,min:33,max:40},this.rules[20].opcodes[3]={type:5,min:42,max:46},this.rules[20].opcodes[4]={type:5,min:48,max:92},this.rules[20].opcodes[5]={type:5,min:94,max:126},this.rules[21].opcodes=[],this.rules[21].opcodes[0]={type:2,children:[1,2,3]},this.rules[21].opcodes[1]={type:4,index:23},this.rules[21].opcodes[2]={type:4,index:14},this.rules[21].opcodes[3]={type:1,children:[4,5]},this.rules[21].opcodes[4]={type:4,index:24},this.rules[21].opcodes[5]={type:4,index:22},this.rules[22].opcodes=[],this.rules[22].opcodes[0]={type:3,min:1,max:1/0},this.rules[22].opcodes[1]={type:1,children:[2,3,4,5]},this.rules[22].opcodes[2]={type:5,min:33,max:40},this.rules[22].opcodes[3]={type:5,min:42,max:46},this.rules[22].opcodes[4]={type:5,min:48,max:92},this.rules[22].opcodes[5]={type:5,min:94,max:126},this.rules[23].opcodes=[],this.rules[23].opcodes[0]={type:2,children:[1,2]},this.rules[23].opcodes[1]={type:6,string:[40]},this.rules[23].opcodes[2]={type:4,index:89},this.rules[24].opcodes=[],this.rules[24].opcodes[0]={type:2,children:[1,2]},this.rules[24].opcodes[1]={type:4,index:89},this.rules[24].opcodes[2]={type:6,string:[41]},this.rules[25].opcodes=[],this.rules[25].opcodes[0]={type:2,children:[1,2,3]},this.rules[25].opcodes[1]={type:4,index:27},this.rules[25].opcodes[2]={type:4,index:14},this.rules[25].opcodes[3]={type:1,children:[4,5]},this.rules[25].opcodes[4]={type:4,index:28},this.rules[25].opcodes[5]={type:4,index:26},this.rules[26].opcodes=[],this.rules[26].opcodes[0]={type:3,min:1,max:1/0},this.rules[26].opcodes[1]={type:1,children:[2,3,4,5]},this.rules[26].opcodes[2]={type:5,min:33,max:40},this.rules[26].opcodes[3]={type:5,min:42,max:46},this.rules[26].opcodes[4]={type:5,min:48,max:92},this.rules[26].opcodes[5]={type:5,min:94,max:126},this.rules[27].opcodes=[],this.rules[27].opcodes[0]={type:2,children:[1,2]},this.rules[27].opcodes[1]={type:6,string:[91]},this.rules[27].opcodes[2]={type:4,index:89},this.rules[28].opcodes=[],this.rules[28].opcodes[0]={type:2,children:[1,2]},this.rules[28].opcodes[1]={type:4,index:89},this.rules[28].opcodes[2]={type:6,string:[93]},this.rules[29].opcodes=[],this.rules[29].opcodes[0]={type:4,index:88},this.rules[30].opcodes=[],this.rules[30].opcodes[0]={type:2,children:[1,2,4]},this.rules[30].opcodes[1]={type:6,string:[92]},this.rules[30].opcodes[2]={type:3,min:0,max:1},this.rules[30].opcodes[3]={type:4,index:31},this.rules[30].opcodes[4]={type:4,index:36},this.rules[31].opcodes=[],this.rules[31].opcodes[0]={type:1,children:[1,7,13,19]},this.rules[31].opcodes[1]={type:2,children:[2,3]},this.rules[31].opcodes[2]={type:4,index:32},this.rules[31].opcodes[3]={type:3,min:0,max:1},this.rules[31].opcodes[4]={type:1,children:[5,6]},this.rules[31].opcodes[5]={type:4,index:34},this.rules[31].opcodes[6]={type:4,index:35},this.rules[31].opcodes[7]={type:2,children:[8,9]},this.rules[31].opcodes[8]={type:4,index:33},this.rules[31].opcodes[9]={type:3,min:0,max:1},this.rules[31].opcodes[10]={type:1,children:[11,12]},this.rules[31].opcodes[11]={type:4,index:34},this.rules[31].opcodes[12]={type:4,index:35},this.rules[31].opcodes[13]={type:2,children:[14,15]},this.rules[31].opcodes[14]={type:4,index:34},this.rules[31].opcodes[15]={type:3,min:0,max:1},this.rules[31].opcodes[16]={type:1,children:[17,18]},this.rules[31].opcodes[17]={type:4,index:32},this.rules[31].opcodes[18]={type:4,index:33},this.rules[31].opcodes[19]={type:2,children:[20,21]},this.rules[31].opcodes[20]={type:4,index:35},this.rules[31].opcodes[21]={type:3,min:0,max:1},this.rules[31].opcodes[22]={type:1,children:[23,24]},this.rules[31].opcodes[23]={type:4,index:32},this.rules[31].opcodes[24]={type:4,index:33},this.rules[32].opcodes=[],this.rules[32].opcodes[0]={type:6,string:[37,115]},this.rules[33].opcodes=[],this.rules[33].opcodes[0]={type:6,string:[37,105]},this.rules[34].opcodes=[],this.rules[34].opcodes[0]={type:6,string:[37,117]},this.rules[35].opcodes=[],this.rules[35].opcodes[0]={type:6,string:[37,112]},this.rules[36].opcodes=[],this.rules[36].opcodes[0]={type:1,children:[1,2,3]},this.rules[36].opcodes[1]={type:4,index:38},this.rules[36].opcodes[2]={type:4,index:39},this.rules[36].opcodes[3]={type:4,index:37},this.rules[37].opcodes=[],this.rules[37].opcodes[0]={type:4,index:88},this.rules[38].opcodes=[],this.rules[38].opcodes[0]={type:2,children:[1,2]},this.rules[38].opcodes[1]={type:6,string:[117,95]},this.rules[38].opcodes[2]={type:4,index:88},this.rules[39].opcodes=[],this.rules[39].opcodes[0]={type:2,children:[1,2]},this.rules[39].opcodes[1]={type:6,string:[101,95]},this.rules[39].opcodes[2]={type:4,index:88},this.rules[40].opcodes=[],this.rules[40].opcodes[0]={type:1,children:[1,2]},this.rules[40].opcodes[1]={type:4,index:42},this.rules[40].opcodes[2]={type:4,index:41},this.rules[41].opcodes=[],this.rules[41].opcodes[0]={type:2,children:[1,2]},this.rules[41].opcodes[1]={type:6,string:[117,95]},this.rules[41].opcodes[2]={type:4,index:88},this.rules[42].opcodes=[],this.rules[42].opcodes[0]={type:2,children:[1,2]},this.rules[42].opcodes[1]={type:6,string:[101,95]},this.rules[42].opcodes[2]={type:4,index:88},this.rules[43].opcodes=[],this.rules[43].opcodes[0]={type:1,children:[1,5,8,11,12]},this.rules[43].opcodes[1]={type:2,children:[2,3,4]},this.rules[43].opcodes[2]={type:4,index:69},this.rules[43].opcodes[3]={type:4,index:46},this.rules[43].opcodes[4]={type:4,index:71},this.rules[43].opcodes[5]={type:2,children:[6,7]},this.rules[43].opcodes[6]={type:4,index:69},this.rules[43].opcodes[7]={type:4,index:46},this.rules[43].opcodes[8]={type:2,children:[9,10]},this.rules[43].opcodes[9]={type:4,index:46},this.rules[43].opcodes[10]={type:4,index:71},this.rules[43].opcodes[11]={type:4,index:46},this.rules[43].opcodes[12]={type:4,index:70},this.rules[44].opcodes=[],this.rules[44].opcodes[0]={type:2,children:[1,2]},this.rules[44].opcodes[1]={type:6,string:[47]},this.rules[44].opcodes[2]={type:4,index:89},this.rules[45].opcodes=[],this.rules[45].opcodes[0]={type:4,index:90},this.rules[46].opcodes=[],this.rules[46].opcodes[0]={type:6,string:[42]},this.rules[47].opcodes=[],this.rules[47].opcodes[0]={type:6,string:[38]},this.rules[48].opcodes=[],this.rules[48].opcodes[0]={type:6,string:[33]},this.rules[49].opcodes=[],this.rules[49].opcodes[0]={type:6,string:[38,38]},this.rules[50].opcodes=[],this.rules[50].opcodes[0]={type:6,string:[33,33]},this.rules[51].opcodes=[],this.rules[51].opcodes[0]={type:6,string:[37,94]},this.rules[52].opcodes=[],this.rules[52].opcodes[0]={type:6,string:[37,36]},this.rules[53].opcodes=[],this.rules[53].opcodes[0]={type:2,children:[1,2]},this.rules[53].opcodes[1]={type:6,string:[37]},this.rules[53].opcodes[2]={type:1,children:[3,8,13]},this.rules[53].opcodes[3]={type:2,children:[4,5,6,7]},this.rules[53].opcodes[4]={type:4,index:76},this.rules[53].opcodes[5]={type:4,index:79},this.rules[53].opcodes[6]={type:6,string:[45]},this.rules[53].opcodes[7]={type:4,index:80},this.rules[53].opcodes[8]={type:2,children:[9,10,11,12]},this.rules[53].opcodes[9]={type:4,index:77},this.rules[53].opcodes[10]={type:4,index:83},this.rules[53].opcodes[11]={type:6,string:[45]},this.rules[53].opcodes[12]={type:4,index:84},this.rules[53].opcodes[13]={type:2,children:[14,15,16,17]},this.rules[53].opcodes[14]={type:4,index:78},this.rules[53].opcodes[15]={type:4,index:81},this.rules[53].opcodes[16]={type:6,string:[45]},this.rules[53].opcodes[17]={type:4,index:82},this.rules[54].opcodes=[],this.rules[54].opcodes[0]={type:2,children:[1,2]},this.rules[54].opcodes[1]={type:6,string:[37]},this.rules[54].opcodes[2]={type:1,children:[3,10,17]},this.rules[54].opcodes[3]={type:2,children:[4,5,6]},this.rules[54].opcodes[4]={type:4,index:76},this.rules[54].opcodes[5]={type:4,index:73},this.rules[54].opcodes[6]={type:3,min:0,max:1/0},this.rules[54].opcodes[7]={type:2,children:[8,9]},this.rules[54].opcodes[8]={type:6,string:[46]},this.rules[54].opcodes[9]={type:4,index:73},this.rules[54].opcodes[10]={type:2,children:[11,12,13]},this.rules[54].opcodes[11]={type:4,index:77},this.rules[54].opcodes[12]={type:4,index:74},this.rules[54].opcodes[13]={type:3,min:0,max:1/0},this.rules[54].opcodes[14]={type:2,children:[15,16]},this.rules[54].opcodes[15]={type:6,string:[46]},this.rules[54].opcodes[16]={type:4,index:74},this.rules[54].opcodes[17]={type:2,children:[18,19,20]},this.rules[54].opcodes[18]={type:4,index:78},this.rules[54].opcodes[19]={type:4,index:75},this.rules[54].opcodes[20]={type:3,min:0,max:1/0},this.rules[54].opcodes[21]={type:2,children:[22,23]},this.rules[54].opcodes[22]={type:6,string:[46]},this.rules[54].opcodes[23]={type:4,index:75},this.rules[55].opcodes=[],this.rules[55].opcodes[0]={type:2,children:[1,2,3,4]},this.rules[55].opcodes[1]={type:4,index:56},this.rules[55].opcodes[2]={type:4,index:57},this.rules[55].opcodes[3]={type:4,index:59},this.rules[55].opcodes[4]={type:4,index:58},this.rules[56].opcodes=[],this.rules[56].opcodes[0]={type:3,min:0,max:1},this.rules[56].opcodes[1]={type:1,children:[2,3]},this.rules[56].opcodes[2]={type:7,string:[37,105]},this.rules[56].opcodes[3]={type:7,string:[37,115]},this.rules[57].opcodes=[],this.rules[57].opcodes[0]={type:6,string:[34]},this.rules[58].opcodes=[],this.rules[58].opcodes[0]={type:6,string:[34]},this.rules[59].opcodes=[],this.rules[59].opcodes[0]={type:3,min:0,max:1/0},this.rules[59].opcodes[1]={type:1,children:[2,3,4]},this.rules[59].opcodes[2]={type:5,min:32,max:33},this.rules[59].opcodes[3]={type:5,min:35,max:126},this.rules[59].opcodes[4]={type:4,index:60},this.rules[60].opcodes=[],this.rules[60].opcodes[0]={type:6,string:[9]},this.rules[61].opcodes=[],this.rules[61].opcodes[0]={type:2,children:[1,2,3]},this.rules[61].opcodes[1]={type:4,index:62},this.rules[61].opcodes[2]={type:4,index:64},this.rules[61].opcodes[3]={type:4,index:63},this.rules[62].opcodes=[],this.rules[62].opcodes[0]={type:6,string:[39]},this.rules[63].opcodes=[],this.rules[63].opcodes[0]={type:6,string:[39]},this.rules[64].opcodes=[],this.rules[64].opcodes[0]={type:3,min:0,max:1/0},this.rules[64].opcodes[1]={type:1,children:[2,3,4]},this.rules[64].opcodes[2]={type:5,min:32,max:38},this.rules[64].opcodes[3]={type:5,min:40,max:126},this.rules[64].opcodes[4]={type:4,index:60},this.rules[65].opcodes=[],this.rules[65].opcodes[0]={type:2,children:[1,2,3]},this.rules[65].opcodes[1]={type:4,index:66},this.rules[65].opcodes[2]={type:4,index:67},this.rules[65].opcodes[3]={type:4,index:68},this.rules[66].opcodes=[],this.rules[66].opcodes[0]={type:6,string:[60]},this.rules[67].opcodes=[],this.rules[67].opcodes[0]={type:3,min:0,max:1/0},this.rules[67].opcodes[1]={type:1,children:[2,3,4]},this.rules[67].opcodes[2]={type:5,min:32,max:61},this.rules[67].opcodes[3]={type:5,min:63,max:126},this.rules[67].opcodes[4]={type:4,index:60},this.rules[68].opcodes=[],this.rules[68].opcodes[0]={type:6,string:[62]},this.rules[69].opcodes=[],this.rules[69].opcodes[0]={type:4,index:72},this.rules[70].opcodes=[],this.rules[70].opcodes[0]={type:4,index:72},this.rules[71].opcodes=[],this.rules[71].opcodes[0]={type:4,index:72},this.rules[72].opcodes=[],this.rules[72].opcodes[0]={type:3,min:1,max:1/0},this.rules[72].opcodes[1]={type:5,min:48,max:57},this.rules[73].opcodes=[],this.rules[73].opcodes[0]={type:4,index:85},this.rules[74].opcodes=[],this.rules[74].opcodes[0]={type:4,index:87},this.rules[75].opcodes=[],this.rules[75].opcodes[0]={type:4,index:86},this.rules[76].opcodes=[],this.rules[76].opcodes[0]={type:1,children:[1,2]},this.rules[76].opcodes[1]={type:6,string:[68]},this.rules[76].opcodes[2]={type:6,string:[100]},this.rules[77].opcodes=[],this.rules[77].opcodes[0]={type:1,children:[1,2]},this.rules[77].opcodes[1]={type:6,string:[88]},this.rules[77].opcodes[2]={type:6,string:[120]},this.rules[78].opcodes=[],this.rules[78].opcodes[0]={type:1,children:[1,2]},this.rules[78].opcodes[1]={type:6,string:[66]},this.rules[78].opcodes[2]={type:6,string:[98]},this.rules[79].opcodes=[],this.rules[79].opcodes[0]={type:4,index:85},this.rules[80].opcodes=[],this.rules[80].opcodes[0]={type:4,index:85},this.rules[81].opcodes=[],this.rules[81].opcodes[0]={type:4,index:86},this.rules[82].opcodes=[],this.rules[82].opcodes[0]={type:4,index:86},this.rules[83].opcodes=[],this.rules[83].opcodes[0]={type:4,index:87},this.rules[84].opcodes=[],this.rules[84].opcodes[0]={type:4,index:87},this.rules[85].opcodes=[],this.rules[85].opcodes[0]={type:3,min:1,max:1/0},this.rules[85].opcodes[1]={type:5,min:48,max:57},this.rules[86].opcodes=[],this.rules[86].opcodes[0]={type:3,min:1,max:1/0},this.rules[86].opcodes[1]={type:5,min:48,max:49},this.rules[87].opcodes=[],this.rules[87].opcodes[0]={type:3,min:1,max:1/0},this.rules[87].opcodes[1]={type:1,children:[2,3,4]},this.rules[87].opcodes[2]={type:5,min:48,max:57},this.rules[87].opcodes[3]={type:5,min:65,max:70},this.rules[87].opcodes[4]={type:5,min:97,max:102},this.rules[88].opcodes=[],this.rules[88].opcodes[0]={type:2,children:[1,4]},this.rules[88].opcodes[1]={type:1,children:[2,3]},this.rules[88].opcodes[2]={type:5,min:97,max:122},this.rules[88].opcodes[3]={type:5,min:65,max:90},this.rules[88].opcodes[4]={type:3,min:0,max:1/0},this.rules[88].opcodes[5]={type:1,children:[6,7,8,9]},this.rules[88].opcodes[6]={type:5,min:97,max:122},this.rules[88].opcodes[7]={type:5,min:65,max:90},this.rules[88].opcodes[8]={type:5,min:48,max:57},this.rules[88].opcodes[9]={type:6,string:[45]},this.rules[89].opcodes=[],this.rules[89].opcodes[0]={type:3,min:0,max:1/0},this.rules[89].opcodes[1]={type:4,index:91},this.rules[90].opcodes=[],this.rules[90].opcodes[0]={type:3,min:1,max:1/0},this.rules[90].opcodes[1]={type:4,index:91},this.rules[91].opcodes=[],this.rules[91].opcodes[0]={type:1,children:[1,2,3,4]},this.rules[91].opcodes[1]={type:6,string:[32]},this.rules[91].opcodes[2]={type:6,string:[9]},this.rules[91].opcodes[3]={type:4,index:92},this.rules[91].opcodes[4]={type:4,index:94},this.rules[92].opcodes=[],this.rules[92].opcodes[0]={type:2,children:[1,2]},this.rules[92].opcodes[1]={type:6,string:[59]},this.rules[92].opcodes[2]={type:3,min:0,max:1/0},this.rules[92].opcodes[3]={type:1,children:[4,5]},this.rules[92].opcodes[4]={type:5,min:32,max:126},this.rules[92].opcodes[5]={type:6,string:[9]},this.rules[93].opcodes=[],this.rules[93].opcodes[0]={type:1,children:[1,2,3]},this.rules[93].opcodes[1]={type:6,string:[13,10]},this.rules[93].opcodes[2]={type:6,string:[10]},this.rules[93].opcodes[3]={type:6,string:[13]},this.rules[94].opcodes=[],this.rules[94].opcodes[0]={type:2,children:[1,5]},this.rules[94].opcodes[1]={type:1,children:[2,3,4]},this.rules[94].opcodes[2]={type:6,string:[13,10]},this.rules[94].opcodes[3]={type:6,string:[10]},this.rules[94].opcodes[4]={type:6,string:[13]},this.rules[94].opcodes[5]={type:1,children:[6,7]},this.rules[94].opcodes[6]={type:6,string:[32]},this.rules[94].opcodes[7]={type:6,string:[9]},this.toString=function(){let t="";return t+=`;
`,t+=`; ABNF for JavaScript APG 2.0 SABNF
`,t+=`; RFC 5234 with some restrictions and additions.
`,t+=`; Updated 11/24/2015 for RFC 7405 case-sensitive literal string notation
`,t+=`;  - accepts %s"string" as a case-sensitive string
`,t+=`;  - accepts %i"string" as a case-insensitive string
`,t+=`;  - accepts "string" as a case-insensitive string
`,t+=`;
`,t+=`; Some restrictions:
`,t+=`;   1. Rules must begin at first character of each line.
`,t+=`;      Indentations on first rule and rules thereafter are not allowed.
`,t+=`;   2. Relaxed line endings. CRLF, LF or CR are accepted as valid line ending.
`,t+=`;   3. Prose values, i.e. <prose value>, are accepted as valid grammar syntax.
`,t+=`;      However, a working parser cannot be generated from them.
`,t+=`;
`,t+=`; Super set (SABNF) additions:
`,t+=`;   1. Look-ahead (syntactic predicate) operators are accepted as element prefixes.
`,t+=`;      & is the positive look-ahead operator, succeeds and backtracks if the look-ahead phrase is found
`,t+=`;      ! is the negative look-ahead operator, succeeds and backtracks if the look-ahead phrase is NOT found
`,t+=`;      e.g. &%d13 or &rule or !(A / B)
`,t+=`;   2. User-Defined Terminals (UDT) of the form, u_name and e_name are accepted.
`,t+=`;      'name' is alpha followed by alpha/num/hyphen just like a rule name.
`,t+=`;      u_name may be used as an element but no rule definition is given.
`,t+=`;      e.g. rule = A / u_myUdt
`,t+=`;           A = "a"
`,t+=`;      would be a valid grammar.
`,t+=`;   3. Case-sensitive, single-quoted strings are accepted.
`,t+=`;      e.g. 'abc' would be equivalent to %d97.98.99
`,t+=`;      (kept for backward compatibility, but superseded by %s"abc")  
`,t+=`; New 12/26/2015
`,t+=`;   4. Look-behind operators are accepted as element prefixes.
`,t+=`;      && is the positive look-behind operator, succeeds and backtracks if the look-behind phrase is found
`,t+=`;      !! is the negative look-behind operator, succeeds and backtracks if the look-behind phrase is NOT found
`,t+=`;      e.g. &&%d13 or &&rule or !!(A / B)
`,t+=`;   5. Back reference operators, i.e. \\rulename, are accepted.
`,t+=`;      A back reference operator acts like a TLS or TBS terminal except that the phrase it attempts
`,t+=`;      to match is a phrase previously matched by the rule 'rulename'.
`,t+=`;      There are two modes of previous phrase matching - the parent-frame mode and the universal mode.
`,t+=`;      In universal mode, \\rulename matches the last match to 'rulename' regardless of where it was found.
`,t+=`;      In parent-frame mode, \\rulename matches only the last match found on the parent's frame or parse tree level.
`,t+=`;      Back reference modifiers can be used to specify case and mode.
`,t+=`;      \\A defaults to case-insensitive and universal mode, e.g. \\A === \\%i%uA
`,t+=`;      Modifiers %i and %s determine case-insensitive and case-sensitive mode, respectively.
`,t+=`;      Modifiers %u and %p determine universal mode and parent frame mode, respectively.
`,t+=`;      Case and mode modifiers can appear in any order, e.g. \\%s%pA === \\%p%sA. 
`,t+=`;   7. String begin anchor, ABG(%^) matches the beginning of the input string location.
`,t+=`;      Returns EMPTY or NOMATCH. Never consumes any characters.
`,t+=`;   8. String end anchor, AEN(%$) matches the end of the input string location.
`,t+=`;      Returns EMPTY or NOMATCH. Never consumes any characters.
`,t+=`;
`,t+=`File            = *(BlankLine / Rule / RuleError)
`,t+=`BlankLine       = *(%d32/%d9) [comment] LineEnd
`,t+=`Rule            = RuleLookup owsp Alternation ((owsp LineEnd)
`,t+=`                / (LineEndError LineEnd))
`,t+=`RuleLookup      = RuleNameTest owsp DefinedAsTest
`,t+=`RuleNameTest    = RuleName/RuleNameError
`,t+=`RuleName        = alphanum
`,t+=`RuleNameError   = 1*(%d33-60/%d62-126)
`,t+=`DefinedAsTest   = DefinedAs / DefinedAsError
`,t+=`DefinedAsError  = 1*2%d33-126
`,t+=`DefinedAs       = IncAlt / Defined
`,t+=`Defined         = %d61
`,t+=`IncAlt          = %d61.47
`,t+=`RuleError       = 1*(%d32-126 / %d9  / LineContinue) LineEnd
`,t+=`LineEndError    = 1*(%d32-126 / %d9  / LineContinue)
`,t+=`Alternation     = Concatenation *(owsp AltOp Concatenation)
`,t+=`Concatenation   = Repetition *(CatOp Repetition)
`,t+=`Repetition      = [Modifier] (Group / Option / BasicElement / BasicElementErr)
`,t+=`Modifier        = (Predicate [RepOp])
`,t+=`                / RepOp
`,t+=`Predicate       = BkaOp
`,t+=`                / BknOp
`,t+=`                / AndOp
`,t+=`                / NotOp
`,t+=`BasicElement    = UdtOp
`,t+=`                / RnmOp
`,t+=`                / TrgOp
`,t+=`                / TbsOp
`,t+=`                / TlsOp
`,t+=`                / ClsOp
`,t+=`                / BkrOp
`,t+=`                / AbgOp
`,t+=`                / AenOp
`,t+=`                / ProsVal
`,t+=`BasicElementErr = 1*(%d33-40/%d42-46/%d48-92/%d94-126)
`,t+=`Group           = GroupOpen  Alternation (GroupClose / GroupError)
`,t+=`GroupError      = 1*(%d33-40/%d42-46/%d48-92/%d94-126) ; same as BasicElementErr
`,t+=`GroupOpen       = %d40 owsp
`,t+=`GroupClose      = owsp %d41
`,t+=`Option          = OptionOpen Alternation (OptionClose / OptionError)
`,t+=`OptionError     = 1*(%d33-40/%d42-46/%d48-92/%d94-126) ; same as BasicElementErr
`,t+=`OptionOpen      = %d91 owsp
`,t+=`OptionClose     = owsp %d93
`,t+=`RnmOp           = alphanum
`,t+=`BkrOp           = %d92 [bkrModifier] bkr-name
`,t+=`bkrModifier     = (cs [um / pm]) / (ci [um / pm]) / (um [cs /ci]) / (pm [cs / ci])
`,t+=`cs              = '%s'
`,t+=`ci              = '%i'
`,t+=`um              = '%u'
`,t+=`pm              = '%p'
`,t+=`bkr-name        = uname / ename / rname
`,t+=`rname           = alphanum
`,t+=`uname           = %d117.95 alphanum
`,t+=`ename           = %d101.95 alphanum
`,t+=`UdtOp           = udt-empty
`,t+=`                / udt-non-empty
`,t+=`udt-non-empty   = %d117.95 alphanum
`,t+=`udt-empty       = %d101.95 alphanum
`,t+=`RepOp           = (rep-min StarOp rep-max)
`,t+=`                / (rep-min StarOp)
`,t+=`                / (StarOp rep-max)
`,t+=`                / StarOp
`,t+=`                / rep-min-max
`,t+=`AltOp           = %d47 owsp
`,t+=`CatOp           = wsp
`,t+=`StarOp          = %d42
`,t+=`AndOp           = %d38
`,t+=`NotOp           = %d33
`,t+=`BkaOp           = %d38.38
`,t+=`BknOp           = %d33.33
`,t+=`AbgOp           = %d37.94
`,t+=`AenOp           = %d37.36
`,t+=`TrgOp           = %d37 ((Dec dmin %d45 dmax) / (Hex xmin %d45 xmax) / (Bin bmin %d45 bmax))
`,t+=`TbsOp           = %d37 ((Dec dString *(%d46 dString)) / (Hex xString *(%d46 xString)) / (Bin bString *(%d46 bString)))
`,t+=`TlsOp           = TlsCase TlsOpen TlsString TlsClose
`,t+=`TlsCase         = ["%i" / "%s"]
`,t+=`TlsOpen         = %d34
`,t+=`TlsClose        = %d34
`,t+=`TlsString       = *(%d32-33/%d35-126/StringTab)
`,t+=`StringTab       = %d9
`,t+=`ClsOp           = ClsOpen ClsString ClsClose
`,t+=`ClsOpen         = %d39
`,t+=`ClsClose        = %d39
`,t+=`ClsString       = *(%d32-38/%d40-126/StringTab)
`,t+=`ProsVal         = ProsValOpen ProsValString ProsValClose
`,t+=`ProsValOpen     = %d60
`,t+=`ProsValString   = *(%d32-61/%d63-126/StringTab)
`,t+=`ProsValClose    = %d62
`,t+=`rep-min         = rep-num
`,t+=`rep-min-max     = rep-num
`,t+=`rep-max         = rep-num
`,t+=`rep-num         = 1*(%d48-57)
`,t+=`dString         = dnum
`,t+=`xString         = xnum
`,t+=`bString         = bnum
`,t+=`Dec             = (%d68/%d100)
`,t+=`Hex             = (%d88/%d120)
`,t+=`Bin             = (%d66/%d98)
`,t+=`dmin            = dnum
`,t+=`dmax            = dnum
`,t+=`bmin            = bnum
`,t+=`bmax            = bnum
`,t+=`xmin            = xnum
`,t+=`xmax            = xnum
`,t+=`dnum            = 1*(%d48-57)
`,t+=`bnum            = 1*%d48-49
`,t+=`xnum            = 1*(%d48-57 / %d65-70 / %d97-102)
`,t+=`;
`,t+=`; Basics
`,t+=`alphanum        = (%d97-122/%d65-90) *(%d97-122/%d65-90/%d48-57/%d45)
`,t+=`owsp            = *space
`,t+=`wsp             = 1*space
`,t+=`space           = %d32
`,t+=`                / %d9
`,t+=`                / comment
`,t+=`                / LineContinue
`,t+=`comment         = %d59 *(%d32-126 / %d9)
`,t+=`LineEnd         = %d13.10
`,t+=`                / %d10
`,t+=`                / %d13
`,t+=`LineContinue    = (%d13.10 / %d10 / %d13) (%d32 / %d9)
`,t}}),it}var ot,Yt;function rn(){return Yt||(Yt=1,ot=function(){const e="parser: ",t=Le(),r=t.ids,n=new(Qr()),p=new(en()),w=new(tn()),g=new t.parser;g.ast=new t.ast,g.callbacks=n.callbacks,g.ast.callbacks=p.callbacks;const y=function(l,o,c){if(o<0||o>=c)return-1;for(let h=0;h<l.length;h+=1)if(o>=l[h].beginChar&&o<l[h].beginChar+l[h].length)return h;return-1},O=function(l,o){let c=-1;if(o<l.length){for(let h=o;h<l.length;h+=1)if(l[h]!==null){c=l[h];break}}return c},b=function(l){l.forEach(o=>{const c=[],h=[];let M=0;o.opcodes.forEach(a=>{a.type===r.ALT&&a.children.length===1||a.type===r.CAT&&a.children.length===1||a.type===r.REP&&a.min===1&&a.max===1?h.push(null):(h.push(M),c.push(a),M+=1)}),h.push(M),c.forEach(a=>{if(a.type===r.ALT||a.type===r.CAT)for(let E=0;E<a.children.length;E+=1)a.children[E]=O(h,a.children[E])}),o.opcodes=c})};this.syntax=function(l,o,c,h,M){if(M){if(M.traceObject!=="traceObject")throw new TypeError(`${e}trace argument is not a trace object`);g.trace=M}const a={};a.errors=c,a.strict=!!h,a.lines=o,a.findLine=y,a.charsLength=l.length,a.ruleCount=0,g.parse(w,"file",l,a).success||c.push({line:0,char:0,msg:"syntax analysis of input grammar failed"})},this.semantic=function(l,o,c){const h={};return h.errors=c,h.lines=o,h.findLine=y,h.charsLength=l.length,g.ast.translate(h),c.length?null:(b(h.rules),{rules:h.rules,udts:h.udts,lineMap:h.rulesLineMap})},this.generateSource=function(l,o,c,h,M){let a="",E,K,F,Y=0,f=1/0,U=0;const W=[],q=[];let S=0,N=0,L=0,d=0,k=0,te=0,X=0,Q=0,ae=0,de=0,V=0,Z=0,J=0,C=0,ue=0;c.forEach(ce=>{W.push(ce.lower),Y+=ce.opcodes.length,ce.opcodes.forEach(A=>{switch(A.type){case r.ALT:S+=1;break;case r.CAT:N+=1;break;case r.RNM:L+=1;break;case r.UDT:d+=1;break;case r.REP:k+=1;break;case r.AND:te+=1;break;case r.NOT:X+=1;break;case r.BKA:Z+=1;break;case r.BKN:J+=1;break;case r.BKR:V+=1;break;case r.ABG:C+=1;break;case r.AEN:ue+=1;break;case r.TLS:for(Q+=1,E=0;E<A.string.length;E+=1)A.string[E]<f&&(f=A.string[E]),A.string[E]>U&&(U=A.string[E]);break;case r.TBS:for(ae+=1,E=0;E<A.string.length;E+=1)A.string[E]<f&&(f=A.string[E]),A.string[E]>U&&(U=A.string[E]);break;case r.TRG:de+=1,A.min<f&&(f=A.min),A.max>U&&(U=A.max);break;default:throw new Error("generateSource: unrecognized opcode")}})}),W.sort(),h.length>0&&(h.forEach(ce=>{q.push(ce.lower)}),q.sort());let me="module.exports";M&&typeof M=="string"&&(me=`let ${M}`),a+=`// copyright: Copyright (c) 2021 Lowell D. Thomas, all rights reserved<br>
`,a+=`//   license: BSD-2-Clause (https://opensource.org/licenses/BSD-2-Clause)<br>
`,a+=`//
`,a+=`// Generated by apg-js, Version 4.0.0 [apg-js](https://github.com/ldthomas/apg-js)
`,a+=`${me} = function grammar(){
`,a+="  // ```\n",a+=`  // SUMMARY
`,a+=`  //      rules = ${c.length}
`,a+=`  //       udts = ${h.length}
`,a+=`  //    opcodes = ${Y}
`,a+=`  //        ---   ABNF original opcodes
`,a+=`  //        ALT = ${S}
`,a+=`  //        CAT = ${N}
`,a+=`  //        REP = ${k}
`,a+=`  //        RNM = ${L}
`,a+=`  //        TLS = ${Q}
`,a+=`  //        TBS = ${ae}
`,a+=`  //        TRG = ${de}
`,a+=`  //        ---   SABNF superset opcodes
`,a+=`  //        UDT = ${d}
`,a+=`  //        AND = ${te}
`,a+=`  //        NOT = ${X}
`,a+=`  //        BKA = ${Z}
`,a+=`  //        BKN = ${J}
`,a+=`  //        BKR = ${V}
`,a+=`  //        ABG = ${C}
`,a+=`  //        AEN = ${ue}
`,a+="  // characters = [",Q+ae+de===0?a+=" none defined ]":a+=`${f} - ${U}]`,d>0&&(a+=" + user defined"),a+=`
`,a+="  // ```\n",a+=`  /* OBJECT IDENTIFIER (for internal parser use) */
`,a+=`  this.grammarObject = 'grammarObject';
`,a+=`
`,a+=`  /* RULES */
`,a+=`  this.rules = [];
`,c.forEach((ce,A)=>{let T="  this.rules[";T+=A,T+="] = {name: '",T+=ce.name,T+="', lower: '",T+=ce.lower,T+="', index: ",T+=ce.index,T+=", isBkr: ",T+=ce.isBkr,T+=`};
`,a+=T}),a+=`
`,a+=`  /* UDTS */
`,a+=`  this.udts = [];
`,h.length>0&&h.forEach((ce,A)=>{let T="  this.udts[";T+=A,T+="] = {name: '",T+=ce.name,T+="', lower: '",T+=ce.lower,T+="', index: ",T+=ce.index,T+=", empty: ",T+=ce.empty,T+=", isBkr: ",T+=ce.isBkr,T+=`};
`,a+=T}),a+=`
`,a+=`  /* OPCODES */
`,c.forEach((ce,A)=>{A>0&&(a+=`
`),a+=`  /* ${ce.name} */
`,a+=`  this.rules[${A}].opcodes = [];
`,ce.opcodes.forEach((T,B)=>{let j;switch(T.type){case r.ALT:a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}, children: [${T.children.toString()}]};// ALT
`;break;case r.CAT:a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}, children: [${T.children.toString()}]};// CAT
`;break;case r.RNM:a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}, index: ${T.index}};// RNM(${c[T.index].name})
`;break;case r.BKR:T.index>=c.length?(K=h[T.index-c.length].name,F=h[T.index-c.length].lower):(K=c[T.index].name,F=c[T.index].lower),j="%i",T.bkrCase===r.BKR_MODE_CS&&(j="%s"),T.bkrMode===r.BKR_MODE_UM?j+="%u":j+="%p",K=j+K,a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}, index: ${T.index}, lower: '${F}', bkrCase: ${T.bkrCase}, bkrMode: ${T.bkrMode}};// BKR(\\${K})
`;break;case r.UDT:a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}, empty: ${T.empty}, index: ${T.index}};// UDT(${h[T.index].name})
`;break;case r.REP:a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}, min: ${T.min}, max: ${T.max}};// REP
`;break;case r.AND:a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}};// AND
`;break;case r.NOT:a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}};// NOT
`;break;case r.ABG:a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}};// ABG(%^)
`;break;case r.AEN:a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}};// AEN(%$)
`;break;case r.BKA:a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}};// BKA
`;break;case r.BKN:a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}};// BKN
`;break;case r.TLS:a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}, string: [${T.string.toString()}]};// TLS
`;break;case r.TBS:a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}, string: [${T.string.toString()}]};// TBS
`;break;case r.TRG:a+=`  this.rules[${A}].opcodes[${B}] = {type: ${T.type}, min: ${T.min}, max: ${T.max}};// TRG
`;break;default:throw new Error("parser.js: ~143: unrecognized opcode")}})}),a+=`
`,a+="  // The `toString()` function will display the original grammar file(s) that produced these opcodes.\n",a+=`  this.toString = function toString(){
`,a+=`    let str = "";
`;let Ee;return o.forEach(ce=>{const A=ce.beginChar+ce.length;Ee="",a+='    str += "';for(let T=ce.beginChar;T<A;T+=1){switch(l[T]){case 9:Ee=" ";break;case 10:Ee="\\n";break;case 13:Ee="\\r";break;case 34:Ee='\\"';break;case 92:Ee="\\\\";break;default:Ee=String.fromCharCode(l[T]);break}a+=Ee}a+=`";
`}),a+=`    return str;
`,a+=`  }
`,a+=`}
`,a},this.generateObject=function(l,o,c){const h={},M=[],a=[],E=l.slice(0);return h.grammarObject="grammarObject",o.forEach(K=>{M.push(K.lower)}),M.sort(),c.length>0&&(c.forEach(K=>{a.push(K.lower)}),a.sort()),h.callbacks=[],M.forEach(K=>{h.callbacks[K]=!1}),c.length>0&&a.forEach(K=>{h.callbacks[K]=!1}),h.rules=o,h.udts=c,h.toString=function(){return E},h}}),ot}var lt,zt;function nn(){return zt||(zt=1,lt=function(){const e=ke(),t="rule-attributes.js";let r=null;function n(S){return S.left||S.nested||S.right||S.cyclic?!1:S.empty}function p(S){return!!(S.left||S.nested||S.right||S.cyclic)}function w(S,N){let L=0,d=0,k=0;for(L=0;L<N;L+=1)if(S[L].nested)return!0;for(L=0;L<N;L+=1)if(S[L].right&&!S[L].leaf){for(d=L+1;d<N;d+=1)if(!n(S[d]))return!0}for(L=N-1;L>=0;L-=1)if(S[L].left&&!S[L].leaf){for(d=L-1;d>=0;d-=1)if(!n(S[d]))return!0}for(L=0;L<N;L+=1)if(!S[L].empty&&!p(S[L])){for(d=L+1;d<N;d+=1)if(p(S[d])){for(k=d+1;k<N;k+=1)if(!S[k].empty&&!p(S[k]))return!0}}return!1}function g(S,N){for(let L=0;L<N;L+=1)if(!S[L].cyclic)return!1;return!0}function y(S,N){for(let L=0;L<N;L+=1){if(S[L].left)return!0;if(!S[L].empty)return!1}return!1}function O(S,N){for(let L=N-1;L>=0;L-=1){if(S[L].right)return!0;if(!S[L].empty)return!1}return!1}function b(S,N){for(let L=0;L<N;L+=1)if(!S[L].empty)return!1;return!0}function s(S,N){for(let L=0;L<N;L+=1)if(!S[L].finite)return!1;return!0}function l(S,N,L,d){let k=0;const te=N[L],X=te.children.length,Q=[];for(k=0;k<X;k+=1)Q.push(S.attrGen());for(k=0;k<X;k+=1)h(S,N,te.children[k],Q[k]);d.left=y(Q,X),d.right=O(Q,X),d.nested=w(Q,X),d.empty=b(Q,X),d.finite=s(Q,X),d.cyclic=g(Q,X)}function o(S,N,L,d){let k=0;const te=N[L],X=te.children.length,Q=[];for(k=0;k<X;k+=1)Q.push(S.attrGen());for(k=0;k<X;k+=1)h(S,N,te.children[k],Q[k]);for(d.left=!1,d.right=!1,d.nested=!1,d.empty=!1,d.finite=!1,d.cyclic=!1,k=0;k<X;k+=1)Q[k].left&&(d.left=!0),Q[k].nested&&(d.nested=!0),Q[k].right&&(d.right=!0),Q[k].empty&&(d.empty=!0),Q[k].finite&&(d.finite=!0),Q[k].cyclic&&(d.cyclic=!0)}function c(S,N,L,d){const k=N[L];k.index>=S.ruleCount?(d.empty=S.udts[k.index-S.ruleCount].empty,d.finite=!0):(M(S,k.index,d),d.left=!1,d.nested=!1,d.right=!1,d.cyclic=!1)}function h(S,N,L,d){S.attrInit(d);const k=N[L];switch(k.type){case e.ALT:o(S,N,L,d);break;case e.CAT:l(S,N,L,d);break;case e.REP:h(S,N,L+1,d),k.min===0&&(d.empty=!0,d.finite=!0);break;case e.RNM:M(S,N[L].index,d);break;case e.BKR:c(S,N,L,d);break;case e.AND:case e.NOT:case e.BKA:case e.BKN:h(S,N,L+1,d),d.empty=!0;break;case e.TLS:d.empty=!N[L].string.length,d.finite=!0,d.cyclic=!1;break;case e.TBS:case e.TRG:d.empty=!1,d.finite=!0,d.cyclic=!1;break;case e.UDT:d.empty=k.empty,d.finite=!0,d.cyclic=!1;break;case e.ABG:case e.AEN:d.empty=!0,d.finite=!0,d.cyclic=!1;break;default:throw new Error(`unknown opcode type: ${k}`)}}function M(S,N,L){const d=S.attrsWorking[N];d.isComplete?S.attrCopy(L,d):d.isOpen?N===S.startRule?N===S.startRule&&(L.left=!0,L.right=!0,L.cyclic=!0,L.leaf=!0):L.finite=!0:(d.isOpen=!0,h(S,d.rule.opcodes,0,L),d.left=L.left,d.right=L.right,d.nested=L.nested,d.empty=L.empty,d.finite=L.finite,d.cyclic=L.cyclic,d.leaf=!1,d.isOpen=!1,d.isComplete=!0)}const a=S=>{r=S;let N=0,L=0;const d=r.attrGen();for(N=0;N<r.ruleCount;N+=1){for(L=0;L<r.ruleCount;L+=1)r.attrInit(r.attrsWorking[L]);r.startRule=N,M(r,N,d),r.attrCopy(r.attrs[N],r.attrsWorking[N])}r.attributesComplete=!0;let k=null;for(N=0;N<r.ruleCount;N+=1)if(k=r.attrs[N],k.left||!k.finite||k.cyclic){const te=r.attrGen(k.rule);r.attrCopy(te,k),r.attrsErrors.push(te),r.attrsErrorCount+=1}},E=S=>S?"t":"f",K=S=>S?"e":"f",F=S=>S?"t":"e",Y=(S,N,L,d)=>{let k=`${S}:${N}:`;return k+=`${K(L.left)} `,k+=`${E(L.nested)} `,k+=`${E(L.right)} `,k+=`${K(L.cyclic)} `,k+=`${F(L.finite)} `,k+=`${E(L.empty)}:`,k+=`${r.typeToString(d.recursiveType)}:`,k+=d.recursiveType===e.ATTR_MR?d.groupNumber:"-",k+=`:${L.rule.name}
`,k},f=()=>{let S=`LEGEND - t=true, f=false, e=error
`;return S+=`sequence:rule index:left nested right cyclic finite empty:type:group number:rule name
`,S},U=()=>{let S=null,N=null,L="";if(L+=`RULE ATTRIBUTES WITH ERRORS
`,L+=f(),r.attrsErrorCount)for(let d=0;d<r.attrsErrorCount;d+=1)S=r.attrsErrors[d],N=r.ruleDeps[S.rule.index],L+=Y(d,S.rule.index,S,N);else L+=`<none>
`;return L},W=S=>{let N=0,L=0,d=null,k=null,te="",{ruleIndexes:X}=r;for(S===97?X=r.ruleAlphaIndexes:S===116&&(X=r.ruleTypeIndexes),N=0;N<r.ruleCount;N+=1)L=X[N],d=r.attrs[L],k=r.ruleDeps[L],te+=Y(N,L,d,k);return te};return{ruleAttributes:a,showAttributes:(S="index")=>{if(!r.attributesComplete)throw new Error(`${t}:showAttributes: attributes not available`);let N="";const L=`RULE ATTRIBUTES
`;return S.charCodeAt(0)===97?(N+=`alphabetical by rule name
`,N+=L,N+=f(),N+=W(97)):S.charCodeAt(0)===116?(N+=`ordered by rule type
`,N+=L,N+=f(),N+=W(116)):(N+=`ordered by rule index
`,N+=L,N+=f(),N+=W()),N},showAttributeErrors:U}}()),lt}var at,qt;function sn(){return qt||(qt=1,at=(()=>{const _=ke();let e=null;const t=(w,g,y,O)=>{let b=0,s=0;const l=g[y];O[y]=!0;const o=l.rule.opcodes;for(b=0;b<o.length;b+=1){const c=o[b];if(c.type===_.RNM)for(l.refersTo[c.index]=!0,O[c.index]||t(w,g,c.index,O),s=0;s<w;s+=1)g[c.index].refersTo[s]&&(l.refersTo[s]=!0);else c.type===_.UDT?l.refersToUdt[c.index]=!0:c.type===_.BKR&&(c.index<w?(l.refersTo[c.index]=!0,O[c.index]||t(w,g,c.index,O)):l.refersToUdt[w-c.index]=!0)}},r=w=>{e=w;let g=0,y=0,O=0,b=null,s=null,l=!1;e.dependenciesComplete=!1;const o=e.falseArray(e.ruleCount);for(g=0;g<e.ruleCount;g+=1)e.falsifyArray(o),t(e.ruleCount,e.ruleDeps,g,o);for(g=0;g<e.ruleCount;g+=1)for(y=0;y<e.ruleCount;y+=1)g!==y&&e.ruleDeps[y].refersTo[g]&&(e.ruleDeps[g].referencedBy[y]=!0);for(g=0;g<e.ruleCount;g+=1)e.ruleDeps[g].recursiveType=_.ATTR_N,e.ruleDeps[g].refersTo[g]&&(e.ruleDeps[g].recursiveType=_.ATTR_R);for(O=-1,g=0;g<e.ruleCount;g+=1)if(b=e.ruleDeps[g],b.recursiveType===_.ATTR_R)for(l=!0,y=0;y<e.ruleCount;y+=1)g!==y&&(s=e.ruleDeps[y],s.recursiveType===_.ATTR_R&&b.refersTo[y]&&s.refersTo[g]&&(l&&(O+=1,b.recursiveType=_.ATTR_MR,b.groupNumber=O,l=!1),s.recursiveType=_.ATTR_MR,s.groupNumber=O));e.isMutuallyRecursive=O>-1,e.ruleAlphaIndexes.sort(e.compRulesAlpha),e.ruleTypeIndexes.sort(e.compRulesAlpha),e.ruleTypeIndexes.sort(e.compRulesType),e.isMutuallyRecursive&&e.ruleTypeIndexes.sort(e.compRulesGroup),e.udtCount&&e.udtAlphaIndexes.sort(e.compUdtsAlpha),e.dependenciesComplete=!0},n=(w=null)=>{let g=0,y=0,O=0,b=0;const s=e.ruleCount-1,l=e.udtCount-1,o=100;let c="",h="";const M="=> ",a="<= ";let E=!1,K=null,{ruleIndexes:F}=e,{udtIndexes:Y}=e;for(w===97?(F=e.ruleAlphaIndexes,Y=e.udtAlphaIndexes):w===116&&(F=e.ruleTypeIndexes,Y=e.udtAlphaIndexes),g=0;g<e.ruleCount;g+=1){for(K=e.ruleDeps[F[g]],h=`${F[g]}:${e.typeToString(K.recursiveType)}:`,e.isMutuallyRecursive&&(h+=K.groupNumber>-1?K.groupNumber:"-",h+=":"),h+=" ",c+=`${h+e.rules[F[g]].name}
`,E=!0,O=0,b=c.length,c+=h,y=0;y<e.ruleCount;y+=1)K.refersTo[F[y]]&&(E?(c+=M,E=!1,c+=e.ruleDeps[F[y]].rule.name):c+=`, ${e.ruleDeps[F[y]].rule.name}`,O+=1),c.length-b>o&&y!==s&&(c+=`
${h}${M}`,b=c.length);if(e.udtCount)for(y=0;y<e.udtCount;y+=1)K.refersToUdt[Y[y]]&&(E?(c+=M,E=!1,c+=e.udts[Y[y]].name):c+=`, ${e.udts[Y[y]].name}`,O+=1),c.length-b>o&&y!==l&&(c+=`
${h}${M}`,b=c.length);for(O===0&&(c+=`=> <none>
`),E===!1&&(c+=`
`),E=!0,O=0,b=c.length,c+=h,y=0;y<e.ruleCount;y+=1)K.referencedBy[F[y]]&&(E?(c+=a,E=!1,c+=e.ruleDeps[F[y]].rule.name):c+=`, ${e.ruleDeps[F[y]].rule.name}`,O+=1),c.length-b>o&&y!==s&&(c+=`
${h}${M}`,b=c.length);O===0&&(c+=`<= <none>
`),E===!1&&(c+=`
`),c+=`
`}return c};return{ruleDependencies:r,showRuleDependencies:(w="index")=>{let g=`RULE DEPENDENCIES(index:type:[group number:])
`;return g+=`=> refers to rule names
`,g+=`<= referenced by rule names
`,e.dependenciesComplete&&(w.charCodeAt(0)===97?(g+=`alphabetical by rule name
`,g+=n(97)):w.charCodeAt(0)===116?(g+=`ordered by rule type
`,g+=n(116)):(g+=`ordered by rule index
`,g+=n(null))),g}}})()),at}var ct,Jt;function on(){return Jt||(Jt=1,ct=function(){const e=ke(),{ruleAttributes:t,showAttributes:r,showAttributeErrors:n}=nn(),{ruleDependencies:p,showRuleDependencies:w}=sn();class g{constructor(b,s){this.rules=b,this.udts=s,this.ruleCount=b.length,this.udtCount=s.length,this.startRule=0,this.dependenciesComplete=!1,this.attributesComplete=!1,this.isMutuallyRecursive=!1,this.ruleIndexes=this.indexArray(this.ruleCount),this.ruleAlphaIndexes=this.indexArray(this.ruleCount),this.ruleTypeIndexes=this.indexArray(this.ruleCount),this.udtIndexes=this.indexArray(this.udtCount),this.udtAlphaIndexes=this.indexArray(this.udtCount),this.attrsErrorCount=0,this.attrs=[],this.attrsErrors=[],this.attrsWorking=[],this.ruleDeps=[];for(let l=0;l<this.ruleCount;l+=1)this.attrs.push(this.attrGen(this.rules[l])),this.attrsWorking.push(this.attrGen(this.rules[l])),this.ruleDeps.push(this.rdGen(b[l],this.ruleCount,this.udtCount));this.compRulesAlpha=this.compRulesAlpha.bind(this),this.compUdtsAlpha=this.compUdtsAlpha.bind(this),this.compRulesType=this.compRulesType.bind(this),this.compRulesGroup=this.compRulesGroup.bind(this)}attrGen(b){return{left:!1,nested:!1,right:!1,empty:!1,finite:!1,cyclic:!1,leaf:!1,isOpen:!1,isComplete:!1,rule:b}}attrInit(b){b.left=!1,b.nested=!1,b.right=!1,b.empty=!1,b.finite=!1,b.cyclic=!1,b.leaf=!1,b.isOpen=!1,b.isComplete=!1}attrCopy(b,s){b.left=s.left,b.nested=s.nested,b.right=s.right,b.empty=s.empty,b.finite=s.finite,b.cyclic=s.cyclic,b.leaf=s.leaf,b.isOpen=s.isOpen,b.isComplete=s.isComplete,b.rule=s.rule}rdGen(b,s,l){return{rule:b,recursiveType:e.ATTR_N,groupNumber:-1,refersTo:this.falseArray(s),refersToUdt:this.falseArray(l),referencedBy:this.falseArray(s)}}typeToString(b){switch(b){case e.ATTR_N:return" N";case e.ATTR_R:return" R";case e.ATTR_MR:return"MR";default:return"UNKNOWN"}}falseArray(b){const s=[];if(b>0)for(let l=0;l<b;l+=1)s.push(!1);return s}falsifyArray(b){for(let s=0;s<b.length;s+=1)b[s]=!1}indexArray(b){const s=[];if(b>0)for(let l=0;l<b;l+=1)s.push(l);return s}compRulesAlpha(b,s){return this.rules[b].lower<this.rules[s].lower?-1:this.rules[b].lower>this.rules[s].lower?1:0}compUdtsAlpha(b,s){return this.udts[b].lower<this.udts[s].lower?-1:this.udts[b].lower>this.udts[s].lower?1:0}compRulesType(b,s){return this.ruleDeps[b].recursiveType<this.ruleDeps[s].recursiveType?-1:this.ruleDeps[b].recursiveType>this.ruleDeps[s].recursiveType?1:0}compRulesGroup(b,s){if(this.ruleDeps[b].recursiveType===e.ATTR_MR&&this.ruleDeps[s].recursiveType===e.ATTR_MR){if(this.ruleDeps[b].groupNumber<this.ruleDeps[s].groupNumber)return-1;if(this.ruleDeps[b].groupNumber>this.ruleDeps[s].groupNumber)return 1}return 0}}return{attributes:function(b=[],s=[],l=[],o=[]){const c=new g(b,s);return p(c),t(c),c.attrsErrorCount&&o.push({line:0,char:0,msg:`${c.attrsErrorCount} attribute errors`}),c.attrsErrorCount},showAttributes:r,showAttributeErrors:n,showRuleDependencies:w}}()),ct}var ut,Wt;function ln(){return Wt||(Wt=1,ut=function(){const e="show-rules.js";return function(n=[],p=[],w="index"){const g="showRules";let y=[],O=[];const b=[],s=[],l=n,o=p,c=n.length,h=p.length;let M="RULE/UDT NAMES",a;function E(F,Y){return l[F].lower<l[Y].lower?-1:l[F].lower>l[Y].lower?1:0}function K(F,Y){return o[F].lower<o[Y].lower?-1:o[F].lower>o[Y].lower?1:0}if(!(Array.isArray(n)&&n.length))throw new Error(`${e}:${g}: rules arg must be array with length > 0`);if(!Array.isArray(p))throw new Error(`${e}:${g}: udts arg must be array`);for(a=0;a<c;a+=1)b.push(a);if(y=b.slice(0),y.sort(E),h){for(a=0;a<h;a+=1)s.push(a);O=s.slice(0),O.sort(K)}if(w.charCodeAt(0)===97){for(M+=` - alphabetical by rule/UDT name
`,a=0;a<c;a+=1)M+=`${a}: ${y[a]}: ${l[y[a]].name}
`;if(h)for(a=0;a<h;a+=1)M+=`${a}: ${O[a]}: ${o[O[a]].name}
`}else{for(M+=` - ordered by rule/UDT index
`,a=0;a<c;a+=1)M+=`${a}: ${l[a].name}
`;if(h)for(a=0;a<h;a+=1)M+=`${a}: ${o[a].name}
`}return M}}()),ut}var an=function(e){const t="api.js: ",r=this,n=Le(),p=ir(),w=Zr(),g=new(rn()),{attributes:y,showAttributes:O,showAttributeErrors:b,showRuleDependencies:s}=on(),l=ln(),o=function(S,N,L){const X=`<span class="${n.style.CLASS_CTRLCHAR}">`,Q="</span>",ae=`<span class="${n.style.CLASS_NOMATCH}">`,de="</span>";let V,Z="";const J=!0;for(;J&&!(!Array.isArray(S)||S.length===0);){if(typeof N!="number")throw new Error("abnfToHtml: beg must be type number");if(N>=S.length)break;typeof L!="number"||N+L>=S.length?V=S.length:V=N+L;let C=0;for(let ue=N;ue<V;ue+=1){const me=S[ue];if(me>=32&&me<=126)switch(C===1?(Z+=Q,C=0):C===2&&(Z+=de,C=0),me){case 32:Z+="&nbsp;";break;case 60:Z+="&lt;";break;case 62:Z+="&gt;";break;case 38:Z+="&amp;";break;case 34:Z+="&quot;";break;case 39:Z+="&#039;";break;case 92:Z+="&#092;";break;default:Z+=String.fromCharCode(me);break}else me===9||me===10||me===13?(C===0?(Z+=X,C=1):C===2&&(Z+=de+X,C=1),me===9&&(Z+="TAB"),me===10&&(Z+="LF"),me===13&&(Z+="CR")):(C===0?(Z+=ae,C=2):C===1&&(Z+=Q+ae,C=2),Z+=`\\x${n.utils.charToHex(me)}`)}C===2&&(Z+=de),C===1&&(Z+=Q);break}return Z},c=function(S,N,L){let d="";for(let k=N;k<N+L;k+=1){const te=S[k];if(te>=32&&te<=126)d+=String.fromCharCode(te);else switch(te){case 9:d+="\\t";break;case 10:d+="\\n";break;case 13:d+="\\r";break;default:d+="\\unknown";break}}return d},h=function(S){let N="Annotated Input Grammar";return S.forEach(L=>{N+=`
`,N+=`line no: ${L.lineNo}`,N+=` : char index: ${L.beginChar}`,N+=` : length: ${L.length}`,N+=` : abnf: ${c(r.chars,L.beginChar,L.length)}`}),N+=`
`,N},M=function(S){let N="";return N+=`<table class="${n.style.CLASS_GRAMMAR}">
`,N+=`<caption>Annotated Input Grammar</caption>
`,N+="<tr>",N+="<th>line<br>no.</th><th>first<br>char</th><th><br>length</th><th><br>text</th>",N+=`</tr>
`,S.forEach(d=>{N+="<tr>",N+=`<td>${d.lineNo}`,N+=`</td><td>${d.beginChar}`,N+=`</td><td>${d.length}`,N+=`</td><td>${o(r.chars,d.beginChar,d.length)}`,N+="</td>",N+=`</tr>
`}),N+=`</table>
`,N},a=function(S,N,L,d){const[k]=n;let te="";const X=`<span class="${k.CLASS_NOMATCH}">&raquo;</span>`;return te+=`<p><table class="${k.CLASS_GRAMMAR}">
`,d&&typeof d=="string"&&(te+=`<caption>${d}</caption>
`),te+=`<tr><th>line<br>no.</th><th>line<br>offset</th><th>error<br>offset</th><th><br>text</th></tr>
`,S.forEach(Q=>{let ae,de,V,Z,J,C="",ue="";N.length===0?(J=X,de=0):(ae=N[Q.line],V=ae.beginChar,Q.char>V&&(C=o(L,V,Q.char-V)),V=Q.char,Z=ae.beginChar+ae.length,V<Z&&(ue=o(L,V,Z-V)),J=C+X+ue,de=Q.char-ae.beginChar,te+="<tr>",te+=`<td>${Q.line}</td><td>${ae.beginChar}</td><td>${de}</td><td>${J}</td>`,te+=`</tr>
`,te+="<tr>",te+=`<td colspan="3"></td><td>&uarr;:&nbsp;${n.utils.stringToAsciiHtml(Q.msg)}</td>`,te+=`</tr>
`)}),te+=`</table></p>
`,te},E=function(S,N,L){let d,k,te,X;return d="",S.forEach(Q=>{k=N[Q.line],d+=`${k.lineNo}: `,d+=`${k.beginChar}: `,d+=`${Q.char-k.beginChar}: `,te=k.beginChar,X=Q.char-k.beginChar,d+=c(L,te,X),d+=" >> ",te=Q.char,X=k.beginChar+k.length-Q.char,d+=c(L,te,X),d+=`
`,d+=`${k.lineNo}: `,d+=`${k.beginChar}: `,d+=`${Q.char-k.beginChar}: `,d+="error: ",d+=Q.msg,d+=`
`}),d};let K=!1,F=!1,Y=!1,f=!1,U=0,W;if(this.errors=[],he.Buffer.isBuffer(e))this.chars=p.decode("BINARY",e);else if(Array.isArray(e))this.chars=e.slice();else if(typeof e=="string")this.chars=p.decode("STRING",e);else throw new Error(`${t}input source is not a string, byte Buffer or character array`);this.sabnf=p.encode("STRING",this.chars),this.scan=function(S,N){this.lines=w(this.chars,this.errors,S,N),K=!0},this.parse=function(S,N){if(!K)throw new Error(`${t}grammar not scanned`);g.syntax(this.chars,this.lines,this.errors,S,N),F=!0},this.translate=function(){if(!F)throw new Error(`${t}grammar not scanned and parsed`);const S=g.semantic(this.chars,this.lines,this.errors);this.errors.length===0&&(this.rules=S.rules,this.udts=S.udts,W=S.lineMap,Y=!0)},this.attributes=function(){if(!Y)throw new Error(`${t}grammar not scanned, parsed and translated`);return U=y(this.rules,this.udts,W,this.errors),f=!0,U},this.generate=function(S){if(this.lines=w(this.chars,this.errors,S),this.errors.length||(g.syntax(this.chars,this.lines,this.errors,S),this.errors.length))return;const N=g.semantic(this.chars,this.lines,this.errors);this.errors.length||(this.rules=N.rules,this.udts=N.udts,W=N.lineMap,U=y(this.rules,this.udts,W,this.errors),f=!0)},this.displayRules=function(S="index"){if(!Y)throw new Error(`${t}grammar not scanned, parsed and translated`);return l(this.rules,this.udts,S)},this.displayRuleDependencies=function(S="index"){if(!f)throw new Error(`${t}no attributes - must be preceeded by call to attributes()`);return s(S)},this.displayAttributes=function(S="index"){if(!f)throw new Error(`${t}no attributes - must be preceeded by call to attributes()`);return U&&b(S),O(S)},this.displayAttributeErrors=function(){if(!f)throw new Error(`${t}no attributes - must be preceeded by call to attributes()`);return b()},this.toSource=function(S){if(!f)throw new Error(`${t}can't generate parser source - must be preceeded by call to attributes()`);if(U)throw new Error(`${t}can't generate parser source - attributes have ${U} errors`);return g.generateSource(this.chars,this.lines,this.rules,this.udts,S)},this.toObject=function(){if(!f)throw new Error(`${t}can't generate parser source - must be preceeded by call to attributes()`);if(U)throw new Error(`${t}can't generate parser source - attributes have ${U} errors`);return g.generateObject(this.sabnf,this.rules,this.udts)},this.errorsToAscii=function(){return E(this.errors,this.lines,this.chars)},this.errorsToHtml=function(S){return a(this.errors,this.lines,this.chars,S)},this.linesToAscii=function(){return h(this.lines)},this.linesToHtml=function(){return M(this.lines)}};const vn=rr(an);var cn=Le();const Pn=rr(cn);function un(){return Ke(gr.randomBytes(16),"base64")}const ar="base64pad",cr="base64url";function hn(_){return Ke(_,ar)}function pn(_){return Ke(_,cr)}function dn(_){return tr(_,ar)}function ht(_){return JSON.parse(Ke(tr(_,cr)))}function fn(_){if(_.signatures.length>1)throw new Error("Cant convert to compact jws");return`${_.signatures[0].protected}.${_.payload}.${_.signatures[0].signature}`}function gn(_,e){if(e){const t=e.toISOString().split(".")[0]+"Z";return`${_}?versionTime=${t}`}else return _}function mn(_){return _?Array.isArray(_)?_:[_]:[]}const bn={...kr()};function yn(_){return"registry"in _&&"cache"in _}class Pe{get capability(){if(!this._capability)throw new Error("DID has no capability attached");return this._capability}get hasCapability(){return this._capability!=null}get parent(){if(!this._parentId)throw new Error("DID has no parent DID");return this._parentId}get hasParent(){return this._parentId!=null}get id(){if(this._id==null)throw new Error("DID is not authenticated");return this._id}get authenticated(){return this._id!=null}withCapability(e){return new Pe({provider:this._client?.connection,resolver:this._resolver,capability:e,parent:this._parentId})}setProvider(e){if(this._client==null)this._client=new wt(e);else if(this._client.connection!==e)throw new Error("A different provider is already set, create a new DID instance to use another provider")}setResolver(e,t){this._resolver=yn(e)?e:new mr(e,t)}async authenticate({provider:e,paths:t=[],aud:r}={}){if(e!=null&&this.setProvider(e),this._client==null)throw new Error("No provider available");const n=un(),p=await this._client.request("did_authenticate",{nonce:n,aud:r,paths:t}),{kid:w}=await this.verifyJWS(p),g=ht(p.payload);if(!w.includes(g.did))throw new Error("Invalid authencation response, kid mismatch");if(g.nonce!==n)throw new Error("Invalid authencation response, wrong nonce");if(g.aud!==r)throw new Error("Invalid authencation response, wrong aud");if(g.exp<Date.now()/1e3)throw new Error("Invalid authencation response, expired");return this._id=g.did,this._id}async createJWS(e,t={}){if(this._client==null)throw new Error("No provider available");if(this._id==null)throw new Error("DID is not authenticated");if(this._capability){const n=this._capability.p.exp;if(n&&Date.parse(n)<Date.now())throw new Error("Capability is expired, cannot create a valid signature");const p=await Et.fromCacao(this._capability),w=yt.asCID(p.cid);if(!w)throw new Error("Capability CID of the JWS cannot be set to the capability payload cid as they are incompatible");t.protected=t.protected||{},t.protected.cap=`ipfs://${w?.toString()}`}const{jws:r}=await this._client.request("did_createJWS",{did:this._id,...t,payload:e});return r}async createDagJWS(e,t={}){const{cid:r,linkedBlock:n}=await br(e),p=pn(r.bytes);Object.assign(t,{linkedBlock:hn(n)});const w=await this.createJWS(p,t),g=yt.asCID(r);if(!g)throw new Error("CID of the JWS cannot be set to the encoded payload cid as they are incompatible");if(w.link=g,this._capability){const y=await Et.fromCacao(this._capability);return{jws:w,linkedBlock:n,cacaoBlock:y.bytes}}return{jws:w,linkedBlock:n}}async verifyJWS(e,t={}){t=Object.assign({verifiers:bn},t),typeof e!="string"&&(e=fn(e));const r=ht(e.split(".")[0]).kid;if(!r)throw new Error('No "kid" found in jws');const n=await this.resolve(r);if(!t.disableTimecheck){const O=n.didDocumentMetadata?.nextUpdate;if(O){const s=t.revocationPhaseOutSecs?t.revocationPhaseOutSecs*1e3:0,l=new Date(O).valueOf()+s;if(!(t.atTime&&t.atTime.getTime()<l))throw new Error(`invalid_jws: signature authored with a revoked DID version: ${r}`)}const b=n.didDocumentMetadata?.updated;if(b&&t.atTime&&t.atTime.getTime()<new Date(b).valueOf())throw new Error(`invalid_jws: signature authored before creation of DID version: ${r}`)}const w=n.didDocument?.id;if(t.issuer&&t.issuer===t.capability?.p.iss&&w===t.capability.p.aud){if(!t.verifiers)throw new Error("Registered verifiers needed for CACAO");await xt.verify(t.capability,{disableExpirationCheck:t.disableTimecheck,atTime:t.atTime?t.atTime:void 0,revocationPhaseOutSecs:t.revocationPhaseOutSecs,verifiers:t.verifiers??{}})}else if(t.issuer&&t.issuer!==w){const O=gn(t.issuer,t.atTime),s=(await this.resolve(O)).didDocument?.controller,l=mn(s);if(t.capability?.s&&t.capability.p.aud===w&&l.includes(t.capability.p.iss))await xt.verify(t.capability,{atTime:t.atTime?t.atTime:void 0,revocationPhaseOutSecs:t.revocationPhaseOutSecs,verifiers:t.verifiers??{}});else if(!(w?l.includes(w):!1))throw new Error(`invalid_jws: not a valid verificationMethod for issuer: ${r}`)}const g=n.didDocument?.verificationMethod||[];yr(e,g);let y;try{y=ht(e.split(".")[1])}catch{}return{kid:r,payload:y,didResolutionResult:n}}async createJWE(e,t,r={}){const n=await Tr(t,this._resolver);return wr(e,n,r.protectedHeader,r.aad)}async createDagJWE(e,t,r={}){const n=await Er(e);return this.createJWE(n,t,r)}async decryptJWE(e,t={}){if(this._client==null)throw new Error("No provider available");if(this._id==null)throw new Error("DID is not authenticated");const{cleartext:r}=await this._client.request("did_decryptJWE",{did:this._id,...t,jwe:e});return dn(r)}async decryptDagJWE(e){const t=await this.decryptJWE(e);return xr(t)}async resolve(e){const t=await this._resolver.resolve(e);if(t.didResolutionMetadata.error){const{error:r,message:n}=t.didResolutionMetadata,p=n?`, ${n}`:"";throw new Error(`Failed to resolve ${e}: ${r}${p}`)}return t}constructor({provider:e,resolver:t={},resolverOptions:r,capability:n,parent:p}={}){if(e!=null&&(this._client=new wt(e)),n){if(this._capability=n,this._parentId=this._capability.p.iss,p&&this._parentId!==p)throw new Error("Capability issuer and parent not equal")}else p&&(this._parentId=p);this.setResolver(t,r)}}const Tn="DID";class Ie extends Fe{constructor({didProvider:e}){super(),this.did=new Pe({resolver:Ie.did._resolver,provider:e})}static get type(){return Tn}async getId({space:e}){return this.did.authenticated||await this.did.authenticate(),this.did.id}async signIdentity(e,{space:t}){this.did.authenticated||await this.did.authenticate();const r=kt(Ct(e,"base16"),"base64url"),n=await this.did.createJWS(r);return`${n.signatures[0].protected}..${n.signatures[0].signature}`}static setDIDResolver(e){this.did?this.did.setResolver(e):this.did=new Pe({resolver:e})}static async verifyIdentity(e){if(!this.did)throw new Error("The DID resolver must first be set with setDIDResolver()");const t=e.publicKey+e.signatures.id;try{const r=kt(Ct(t,"base16"),"base64url"),[n,p]=e.signatures.publicKey.split(".."),w=[n,r,p].join(".");await this.did.verifyJWS(w)}catch{return!1}return!0}}const wn="ethereum";class Xt extends Fe{constructor(e={}){super(),this.wallet=e.wallet}static get type(){return wn}async getId(e={}){return this.wallet||(this.wallet=await this._createWallet(e)),this.wallet.getAddress()}async signIdentity(e,t={}){const r=this.wallet;if(!r)throw new Error("wallet is required");return r.signMessage(e)}static async verifyIdentity(e){return Cr(e.publicKey+e.signatures.id,e.signatures.publicKey)===e.id}async _createWallet(e={}){if(e.mnemonicOpts){if(!e.mnemonicOpts.mnemonic)throw new Error("mnemonic is required");return Ge.fromMnemonic(e.mnemonicOpts.mnemonic,e.mnemonicOpts.path,e.mnemonicOpts.wordlist)}if(e.encryptedJsonOpts){if(!e.encryptedJsonOpts.json)throw new Error("encrypted json is required");if(!e.encryptedJsonOpts.password)throw new Error("password for encrypted json is required");return Ge.fromEncryptedJson(e.encryptedJsonOpts.json,e.encryptedJsonOpts.password,e.encryptedJsonOpts.progressCallback)}return Ge.createRandom()}}const pt="orbitdb",En=Ar.join("./orbitdb","identity","identitykeys"),ve={orbitdb:sr,[Ie.type]:Ie,[Xt.type]:Xt},dt=_=>{if(!mt.isSupported(_))throw new Error(`IdentityProvider type '${_}' is not supported`);return ve[_]};class mt{constructor(e){this._keystore=e.keystore,this._signingKeystore=e.signingKeystore||this._keystore,this._knownIdentities=e.cache||new ft(e.cacheSize||100)}static get IdentityProvider(){return Fe}get keystore(){return this._keystore}get signingKeystore(){return this._signingKeystore}async sign(e,t){const r=await this.keystore.getKey(e.id);if(!r)throw new Error("Private signing key not found from Keystore");return await this.keystore.sign(r,t)}async verify(e,t,r,n="v1"){return this.keystore.verify(e,t,r,n)}async createIdentity(e={}){const t=e.keystore||this.keystore,r=e.type||pt,n=r===pt?new sr(e.signingKeystore||t):new(dt(r))(e),p=await n.getId(e);e.migrate&&await e.migrate({targetStore:t._store,targetId:p});const{publicKey:w,idSignature:g}=await this.signId(p),y=await n.signIdentity(w+g,e);return new _e(p,w,g,y,r,this)}async signId(e){const t=this.keystore,r=await t.getKey(e)||await t.createKey(e),n=t.getPublic(r),p=await t.sign(r,e);return{publicKey:n,idSignature:p}}async verifyIdentity(e){if(!_e.isIdentity(e))return!1;const t=this._knownIdentities.get(e.signatures.id);if(t)return e.id===t.id&&e.publicKey===t.publicKey&&e.signatures.id===t.signatures.id&&e.signatures.publicKey===t.signatures.publicKey;if(!await this.keystore.verify(e.signatures.id,e.publicKey,e.id))return!1;const p=await dt(e.type).verifyIdentity(e);return p&&this._knownIdentities.set(e.signatures.id,_e.toJSON(e)),p}static async verifyIdentity(e){return!_e.isIdentity(e)||!await Oe.verify(e.signatures.id,e.publicKey,e.id)?!1:dt(e.type).verifyIdentity(e)}static async createIdentity(e={}){return e.keystore||(e.keystore=new Oe(e.identityKeysPath||En)),e.signingKeystore||(e.signingKeysPath?e.signingKeystore=new Oe(e.signingKeysPath):e.signingKeystore=e.keystore),await e.keystore.open(),await e.signingKeystore.open(),e=Object.assign({},{type:pt},e),new mt(e).createIdentity(e)}static isSupported(e){return Object.keys(ve).includes(e)}static addIdentityProvider(e){if(!e)throw new Error("IdentityProvider class needs to be given as an option");if(!e.type||typeof e.type!="string")throw new Error("Given IdentityProvider class needs to implement: static get type() { /* return a string */ }.");ve[e.type]=e}static removeIdentityProvider(e){delete ve[e]}}class xn{constructor(e,t={}){const r={createIfMissing:!0,errorIfExists:!1,compression:!0,cacheSize:8388608};this.storage=e,this.preCreate=t.preCreate?t.preCreate:()=>{};const n=Object.assign({},t,r);delete n.preCreate,this.options={down:n}}async createStore(e="./orbitdb",t={}){this.options.up=t,await this.preCreate(e,this.options);const r=new er(e,t);return await r.open(),r}async destroy(e){!this.storage||!this.storage.destroy||await this.storage.destroy(e._db.location)}async preCreate(e,t){}}const In=(_,e)=>new xn(_,e),kn={relay:{enabled:!0,hop:{enabled:!0,active:!0}}},Cn={create:!0,accessController:{write:["*"]}};async function Hn(_){const e=await hr(kn),r=await(await pr.createInstance(e)).log(_,Cn);return await r.load(),console.log("OrbitDB database started at ",r.address.toString()),r.events.on("write",(n,p,w)=>{console.log("Wrote entry to database. ",p)}),r.events.on("ready",(n,p)=>{console.log("Loaded locally cached database ",n)}),r}export{_n as C,Nn as D,Or as E,$n as F,Bn as I,Oe as K,In as S,mt as a,Ln as b,Rn as c,vn as d,Pn as e,Hn as s};
//# sourceMappingURL=orbit-modules-7eb78d3b.js.map
