var Ap=Object.defineProperty;var Cp=(n,e,t)=>e in n?Ap(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var la=(n,e,t)=>(Cp(n,typeof e!="symbol"?e+"":e,t),t);import{g as getDefaultExportFromCjs,c as commonjsGlobal,p as process$3,b as buffer$2,_ as __vitePreload}from"./index-e9de3215.js";var isPlainObj=n=>{if(Object.prototype.toString.call(n)!=="[object Object]")return!1;const e=Object.getPrototypeOf(n);return e===null||e===Object.prototype};const isOptionObject=isPlainObj,{hasOwnProperty:hasOwnProperty$2}=Object.prototype,{propertyIsEnumerable}=Object,defineProperty=(n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!0,enumerable:!0,configurable:!0}),globalThis$1=commonjsGlobal,defaultMergeOptions={concatArrays:!1,ignoreUndefined:!1},getEnumerableOwnPropertyKeys=n=>{const e=[];for(const t in n)hasOwnProperty$2.call(n,t)&&e.push(t);if(Object.getOwnPropertySymbols){const t=Object.getOwnPropertySymbols(n);for(const i of t)propertyIsEnumerable.call(n,i)&&e.push(i)}return e};function clone(n){return Array.isArray(n)?cloneArray(n):isOptionObject(n)?cloneOptionObject(n):n}function cloneArray(n){const e=n.slice(0,0);return getEnumerableOwnPropertyKeys(n).forEach(t=>{defineProperty(e,t,clone(n[t]))}),e}function cloneOptionObject(n){const e=Object.getPrototypeOf(n)===null?Object.create(null):{};return getEnumerableOwnPropertyKeys(n).forEach(t=>{defineProperty(e,t,clone(n[t]))}),e}const mergeKeys=(n,e,t,i)=>(t.forEach(o=>{typeof e[o]>"u"&&i.ignoreUndefined||(o in n&&n[o]!==Object.getPrototypeOf(n)?defineProperty(n,o,merge$3(n[o],e[o],i)):defineProperty(n,o,clone(e[o])))}),n),concatArrays=(n,e,t)=>{let i=n.slice(0,0),o=0;return[n,e].forEach(a=>{const c=[];for(let u=0;u<a.length;u++)hasOwnProperty$2.call(a,u)&&(c.push(String(u)),a===n?defineProperty(i,o++,a[u]):defineProperty(i,o++,clone(a[u])));i=mergeKeys(i,a,getEnumerableOwnPropertyKeys(a).filter(u=>!c.includes(u)),t)}),i};function merge$3(n,e,t){return t.concatArrays&&Array.isArray(n)&&Array.isArray(e)?concatArrays(n,e,t):!isOptionObject(e)||!isOptionObject(n)?clone(e):mergeKeys(n,e,getEnumerableOwnPropertyKeys(e),t)}var mergeOptions=function(...n){const e=merge$3(clone(defaultMergeOptions),this!==globalThis$1&&this||{},defaultMergeOptions);let t={_:{}};for(const i of n)if(i!==void 0){if(!isOptionObject(i))throw new TypeError("`"+i+"` is not an Option Object");t=merge$3(t,{_:i},e)}return t._};const mergeOptions$1=getDefaultExportFromCjs(mergeOptions);function commonjsRequire(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var browser$c={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var n=1e3,e=n*60,t=e*60,i=t*24,o=i*7,a=i*365.25;ms=function(h,b){b=b||{};var m=typeof h;if(m==="string"&&h.length>0)return c(h);if(m==="number"&&isFinite(h))return b.long?d(h):u(h);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(h))};function c(h){if(h=String(h),!(h.length>100)){var b=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(h);if(b){var m=parseFloat(b[1]),v=(b[2]||"ms").toLowerCase();switch(v){case"years":case"year":case"yrs":case"yr":case"y":return m*a;case"weeks":case"week":case"w":return m*o;case"days":case"day":case"d":return m*i;case"hours":case"hour":case"hrs":case"hr":case"h":return m*t;case"minutes":case"minute":case"mins":case"min":case"m":return m*e;case"seconds":case"second":case"secs":case"sec":case"s":return m*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return m;default:return}}}}function u(h){var b=Math.abs(h);return b>=i?Math.round(h/i)+"d":b>=t?Math.round(h/t)+"h":b>=e?Math.round(h/e)+"m":b>=n?Math.round(h/n)+"s":h+"ms"}function d(h){var b=Math.abs(h);return b>=i?p(h,b,i,"day"):b>=t?p(h,b,t,"hour"):b>=e?p(h,b,e,"minute"):b>=n?p(h,b,n,"second"):h+" ms"}function p(h,b,m,v){var _=b>=m*1.5;return Math.round(h/m)+" "+v+(_?"s":"")}return ms}function setup(n){t.debug=t,t.default=t,t.coerce=d,t.disable=a,t.enable=o,t.enabled=c,t.humanize=requireMs(),t.destroy=p,Object.keys(n).forEach(h=>{t[h]=n[h]}),t.names=[],t.skips=[],t.formatters={};function e(h){let b=0;for(let m=0;m<h.length;m++)b=(b<<5)-b+h.charCodeAt(m),b|=0;return t.colors[Math.abs(b)%t.colors.length]}t.selectColor=e;function t(h){let b,m=null,v,_;function $(...k){if(!$.enabled)return;const D=$,O=Number(new Date),H=O-(b||O);D.diff=H,D.prev=b,D.curr=O,b=O,k[0]=t.coerce(k[0]),typeof k[0]!="string"&&k.unshift("%O");let j=0;k[0]=k[0].replace(/%([a-zA-Z%])/g,(ae,fe)=>{if(ae==="%%")return"%";j++;const pe=t.formatters[fe];if(typeof pe=="function"){const ve=k[j];ae=pe.call(D,ve),k.splice(j,1),j--}return ae}),t.formatArgs.call(D,k),(D.log||t.log).apply(D,k)}return $.namespace=h,$.useColors=t.useColors(),$.color=t.selectColor(h),$.extend=i,$.destroy=t.destroy,Object.defineProperty($,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(v!==t.namespaces&&(v=t.namespaces,_=t.enabled(h)),_),set:k=>{m=k}}),typeof t.init=="function"&&t.init($),$}function i(h,b){const m=t(this.namespace+(typeof b>"u"?":":b)+h);return m.log=this.log,m}function o(h){t.save(h),t.namespaces=h,t.names=[],t.skips=[];let b;const m=(typeof h=="string"?h:"").split(/[\s,]+/),v=m.length;for(b=0;b<v;b++)m[b]&&(h=m[b].replace(/\*/g,".*?"),h[0]==="-"?t.skips.push(new RegExp("^"+h.slice(1)+"$")):t.names.push(new RegExp("^"+h+"$")))}function a(){const h=[...t.names.map(u),...t.skips.map(u).map(b=>"-"+b)].join(",");return t.enable(""),h}function c(h){if(h[h.length-1]==="*")return!0;let b,m;for(b=0,m=t.skips.length;b<m;b++)if(t.skips[b].test(h))return!1;for(b=0,m=t.names.length;b<m;b++)if(t.names[b].test(h))return!0;return!1}function u(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}function d(h){return h instanceof Error?h.stack||h.message:h}function p(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var common$7=setup;(function(n,e){e.formatArgs=i,e.save=o,e.load=a,e.useColors=t,e.storage=c(),e.destroy=(()=>{let d=!1;return()=>{d||(d=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(d){if(d[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+d[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;const p="color: "+this.color;d.splice(1,0,p,"color: inherit");let h=0,b=0;d[0].replace(/%[a-zA-Z%]/g,m=>{m!=="%%"&&(h++,m==="%c"&&(b=h))}),d.splice(b,0,p)}e.log=console.debug||console.log||(()=>{});function o(d){try{d?e.storage.setItem("debug",d):e.storage.removeItem("debug")}catch{}}function a(){let d;try{d=e.storage.getItem("debug")}catch{}return!d&&typeof process$3<"u"&&"env"in process$3&&(d={}.DEBUG),d}function c(){try{return localStorage}catch{}}n.exports=common$7(e);const{formatters:u}=n.exports;u.j=function(d){try{return JSON.stringify(d)}catch(p){return"[UnexpectedJSONParseError]: "+p.message}}})(browser$c,browser$c.exports);var browserExports=browser$c.exports;const debug=getDefaultExportFromCjs(browserExports);function base$5(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var o=0;o<n.length;o++){var a=n.charAt(o),c=a.charCodeAt(0);if(t[c]!==255)throw new TypeError(a+" is ambiguous");t[c]=o}var u=n.length,d=n.charAt(0),p=Math.log(u)/Math.log(256),h=Math.log(256)/Math.log(u);function b(_){if(_ instanceof Uint8Array||(ArrayBuffer.isView(_)?_=new Uint8Array(_.buffer,_.byteOffset,_.byteLength):Array.isArray(_)&&(_=Uint8Array.from(_))),!(_ instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(_.length===0)return"";for(var $=0,k=0,D=0,O=_.length;D!==O&&_[D]===0;)D++,$++;for(var H=(O-D)*h+1>>>0,j=new Uint8Array(H);D!==O;){for(var W=_[D],ae=0,fe=H-1;(W!==0||ae<k)&&fe!==-1;fe--,ae++)W+=256*j[fe]>>>0,j[fe]=W%u>>>0,W=W/u>>>0;if(W!==0)throw new Error("Non-zero carry");k=ae,D++}for(var pe=H-k;pe!==H&&j[pe]===0;)pe++;for(var ve=d.repeat($);pe<H;++pe)ve+=n.charAt(j[pe]);return ve}function m(_){if(typeof _!="string")throw new TypeError("Expected String");if(_.length===0)return new Uint8Array;var $=0;if(_[$]!==" "){for(var k=0,D=0;_[$]===d;)k++,$++;for(var O=(_.length-$)*p+1>>>0,H=new Uint8Array(O);_[$];){var j=t[_.charCodeAt($)];if(j===255)return;for(var W=0,ae=O-1;(j!==0||W<D)&&ae!==-1;ae--,W++)j+=u*H[ae]>>>0,H[ae]=j%256>>>0,j=j/256>>>0;if(j!==0)throw new Error("Non-zero carry");D=W,$++}if(_[$]!==" "){for(var fe=O-D;fe!==O&&H[fe]===0;)fe++;for(var pe=new Uint8Array(k+(O-fe)),ve=k;fe!==O;)pe[ve++]=H[fe++];return pe}}}function v(_){var $=m(_);if($)return $;throw new Error(`Non-${e} character`)}return{encode:b,decodeUnsafe:m,decode:v}}var src$4=base$5,_brrp__multiformats_scope_baseX$3=src$4;const equals$5=(n,e)=>{if(n===e)return!0;if(n.byteLength!==e.byteLength)return!1;for(let t=0;t<n.byteLength;t++)if(n[t]!==e[t])return!1;return!0},coerce$3=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},fromString$a=n=>new TextEncoder().encode(n),toString$a=n=>new TextDecoder().decode(n);let Encoder$3=class{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Decoder$3=class{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return or$3(this,e)}},ComposedDecoder$3=class{constructor(e){this.decoders=e}or(e){return or$3(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$3=(n,e)=>new ComposedDecoder$3({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});let Codec$3=class{constructor(e,t,i,o){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=o,this.encoder=new Encoder$3(e,t,i),this.decoder=new Decoder$3(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const from$5=({name:n,prefix:e,encode:t,decode:i})=>new Codec$3(n,e,t,i),baseX$3=({prefix:n,name:e,alphabet:t})=>{const{encode:i,decode:o}=_brrp__multiformats_scope_baseX$3(t,e);return from$5({prefix:n,name:e,encode:i,decode:a=>coerce$3(o(a))})},decode$k=(n,e,t,i)=>{const o={};for(let h=0;h<e.length;++h)o[e[h]]=h;let a=n.length;for(;n[a-1]==="=";)--a;const c=new Uint8Array(a*t/8|0);let u=0,d=0,p=0;for(let h=0;h<a;++h){const b=o[n[h]];if(b===void 0)throw new SyntaxError(`Non-${i} character`);d=d<<t|b,u+=t,u>=8&&(u-=8,c[p++]=255&d>>u)}if(u>=t||255&d<<8-u)throw new SyntaxError("Unexpected end of data");return c},encode$i=(n,e,t)=>{const i=e[e.length-1]==="=",o=(1<<t)-1;let a="",c=0,u=0;for(let d=0;d<n.length;++d)for(u=u<<8|n[d],c+=8;c>t;)c-=t,a+=e[o&u>>c];if(c&&(a+=e[o&u<<t-c]),i)for(;a.length*t&7;)a+="=";return a},rfc4648$3=({name:n,prefix:e,bitsPerChar:t,alphabet:i})=>from$5({prefix:e,name:n,encode(o){return encode$i(o,i,t)},decode(o){return decode$k(o,i,t,n)}}),base58btc$3=baseX$3({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$3=baseX$3({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$3=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$3,base58flickr:base58flickr$3},Symbol.toStringTag,{value:"Module"})),base32$6=rfc4648$3({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$3=rfc4648$3({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$3=rfc4648$3({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$3=rfc4648$3({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$3=rfc4648$3({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$3=rfc4648$3({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$3=rfc4648$3({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$3=rfc4648$3({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$3=rfc4648$3({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$7=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$6,base32hex:base32hex$3,base32hexpad:base32hexpad$3,base32hexpadupper:base32hexpadupper$3,base32hexupper:base32hexupper$3,base32pad:base32pad$3,base32padupper:base32padupper$3,base32upper:base32upper$3,base32z:base32z$3},Symbol.toStringTag,{value:"Module"})),base64$8=rfc4648$3({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$3=rfc4648$3({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$3=rfc4648$3({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$3=rfc4648$3({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$9=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$8,base64pad:base64pad$3,base64url:base64url$3,base64urlpad:base64urlpad$3},Symbol.toStringTag,{value:"Module"}));function assign(n,e){for(const t in e)Object.defineProperty(n,t,{value:e[t],enumerable:!0,configurable:!0});return n}function createError(n,e,t){if(!n||typeof n=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return assign(n,t)}catch{t.message=n.message,t.stack=n.stack;const o=function(){};return o.prototype=Object.create(Object.getPrototypeOf(n)),assign(new o,t)}}var errCode=createError;const errcode=getDefaultExportFromCjs(errCode);var indexMinimal={},minimal$1={},aspromise=asPromise;function asPromise(n,e){for(var t=new Array(arguments.length-1),i=0,o=2,a=!0;o<arguments.length;)t[i++]=arguments[o++];return new Promise(function(u,d){t[i]=function(h){if(a)if(a=!1,h)d(h);else{for(var b=new Array(arguments.length-1),m=0;m<b.length;)b[m++]=arguments[m];u.apply(null,b)}};try{n.apply(e||null,t)}catch(p){a&&(a=!1,d(p))}})}var base64$7={};(function(n){var e=n;e.length=function(u){var d=u.length;if(!d)return 0;for(var p=0;--d%4>1&&u.charAt(d)==="=";)++p;return Math.ceil(u.length*3)/4-p};for(var t=new Array(64),i=new Array(123),o=0;o<64;)i[t[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;e.encode=function(u,d,p){for(var h=null,b=[],m=0,v=0,_;d<p;){var $=u[d++];switch(v){case 0:b[m++]=t[$>>2],_=($&3)<<4,v=1;break;case 1:b[m++]=t[_|$>>4],_=($&15)<<2,v=2;break;case 2:b[m++]=t[_|$>>6],b[m++]=t[$&63],v=0;break}m>8191&&((h||(h=[])).push(String.fromCharCode.apply(String,b)),m=0)}return v&&(b[m++]=t[_],b[m++]=61,v===1&&(b[m++]=61)),h?(m&&h.push(String.fromCharCode.apply(String,b.slice(0,m))),h.join("")):String.fromCharCode.apply(String,b.slice(0,m))};var a="invalid encoding";e.decode=function(u,d,p){for(var h=p,b=0,m,v=0;v<u.length;){var _=u.charCodeAt(v++);if(_===61&&b>1)break;if((_=i[_])===void 0)throw Error(a);switch(b){case 0:m=_,b=1;break;case 1:d[p++]=m<<2|(_&48)>>4,m=_,b=2;break;case 2:d[p++]=(m&15)<<4|(_&60)>>2,m=_,b=3;break;case 3:d[p++]=(m&3)<<6|_,b=0;break}}if(b===1)throw Error(a);return p-h},e.test=function(u){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(u)}})(base64$7);var eventemitter=EventEmitter$4;function EventEmitter$4(){this._listeners={}}EventEmitter$4.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this};EventEmitter$4.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],o=0;o<i.length;)i[o].fn===t?i.splice(o,1):++o;return this};EventEmitter$4.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],o=1;o<arguments.length;)i.push(arguments[o++]);for(o=0;o<t.length;)t[o].fn.apply(t[o++].ctx,i)}return this};var float=factory(factory);function factory(n){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),i=t[3]===128;function o(d,p,h){e[0]=d,p[h]=t[0],p[h+1]=t[1],p[h+2]=t[2],p[h+3]=t[3]}function a(d,p,h){e[0]=d,p[h]=t[3],p[h+1]=t[2],p[h+2]=t[1],p[h+3]=t[0]}n.writeFloatLE=i?o:a,n.writeFloatBE=i?a:o;function c(d,p){return t[0]=d[p],t[1]=d[p+1],t[2]=d[p+2],t[3]=d[p+3],e[0]}function u(d,p){return t[3]=d[p],t[2]=d[p+1],t[1]=d[p+2],t[0]=d[p+3],e[0]}n.readFloatLE=i?c:u,n.readFloatBE=i?u:c}():function(){function e(i,o,a,c){var u=o<0?1:0;if(u&&(o=-o),o===0)i(1/o>0?0:2147483648,a,c);else if(isNaN(o))i(2143289344,a,c);else if(o>34028234663852886e22)i((u<<31|2139095040)>>>0,a,c);else if(o<11754943508222875e-54)i((u<<31|Math.round(o/1401298464324817e-60))>>>0,a,c);else{var d=Math.floor(Math.log(o)/Math.LN2),p=Math.round(o*Math.pow(2,-d)*8388608)&8388607;i((u<<31|d+127<<23|p)>>>0,a,c)}}n.writeFloatLE=e.bind(null,writeUintLE),n.writeFloatBE=e.bind(null,writeUintBE);function t(i,o,a){var c=i(o,a),u=(c>>31)*2+1,d=c>>>23&255,p=c&8388607;return d===255?p?NaN:u*(1/0):d===0?u*1401298464324817e-60*p:u*Math.pow(2,d-150)*(p+8388608)}n.readFloatLE=t.bind(null,readUintLE),n.readFloatBE=t.bind(null,readUintBE)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),i=t[7]===128;function o(d,p,h){e[0]=d,p[h]=t[0],p[h+1]=t[1],p[h+2]=t[2],p[h+3]=t[3],p[h+4]=t[4],p[h+5]=t[5],p[h+6]=t[6],p[h+7]=t[7]}function a(d,p,h){e[0]=d,p[h]=t[7],p[h+1]=t[6],p[h+2]=t[5],p[h+3]=t[4],p[h+4]=t[3],p[h+5]=t[2],p[h+6]=t[1],p[h+7]=t[0]}n.writeDoubleLE=i?o:a,n.writeDoubleBE=i?a:o;function c(d,p){return t[0]=d[p],t[1]=d[p+1],t[2]=d[p+2],t[3]=d[p+3],t[4]=d[p+4],t[5]=d[p+5],t[6]=d[p+6],t[7]=d[p+7],e[0]}function u(d,p){return t[7]=d[p],t[6]=d[p+1],t[5]=d[p+2],t[4]=d[p+3],t[3]=d[p+4],t[2]=d[p+5],t[1]=d[p+6],t[0]=d[p+7],e[0]}n.readDoubleLE=i?c:u,n.readDoubleBE=i?u:c}():function(){function e(i,o,a,c,u,d){var p=c<0?1:0;if(p&&(c=-c),c===0)i(0,u,d+o),i(1/c>0?0:2147483648,u,d+a);else if(isNaN(c))i(0,u,d+o),i(2146959360,u,d+a);else if(c>17976931348623157e292)i(0,u,d+o),i((p<<31|2146435072)>>>0,u,d+a);else{var h;if(c<22250738585072014e-324)h=c/5e-324,i(h>>>0,u,d+o),i((p<<31|h/4294967296)>>>0,u,d+a);else{var b=Math.floor(Math.log(c)/Math.LN2);b===1024&&(b=1023),h=c*Math.pow(2,-b),i(h*4503599627370496>>>0,u,d+o),i((p<<31|b+1023<<20|h*1048576&1048575)>>>0,u,d+a)}}}n.writeDoubleLE=e.bind(null,writeUintLE,0,4),n.writeDoubleBE=e.bind(null,writeUintBE,4,0);function t(i,o,a,c,u){var d=i(c,u+o),p=i(c,u+a),h=(p>>31)*2+1,b=p>>>20&2047,m=4294967296*(p&1048575)+d;return b===2047?m?NaN:h*(1/0):b===0?h*5e-324*m:h*Math.pow(2,b-1075)*(m+4503599627370496)}n.readDoubleLE=t.bind(null,readUintLE,0,4),n.readDoubleBE=t.bind(null,readUintBE,4,0)}(),n}function writeUintLE(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}function writeUintBE(n,e,t){e[t]=n>>>24,e[t+1]=n>>>16&255,e[t+2]=n>>>8&255,e[t+3]=n&255}function readUintLE(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0}function readUintBE(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}var utf8$2={};(function(n){var e=n;e.length=function(i){for(var o=0,a=0,c=0;c<i.length;++c)a=i.charCodeAt(c),a<128?o+=1:a<2048?o+=2:(a&64512)===55296&&(i.charCodeAt(c+1)&64512)===56320?(++c,o+=4):o+=3;return o},e.read=function(i,o,a){var c=a-o;if(c<1)return"";for(var u=null,d=[],p=0,h;o<a;)h=i[o++],h<128?d[p++]=h:h>191&&h<224?d[p++]=(h&31)<<6|i[o++]&63:h>239&&h<365?(h=((h&7)<<18|(i[o++]&63)<<12|(i[o++]&63)<<6|i[o++]&63)-65536,d[p++]=55296+(h>>10),d[p++]=56320+(h&1023)):d[p++]=(h&15)<<12|(i[o++]&63)<<6|i[o++]&63,p>8191&&((u||(u=[])).push(String.fromCharCode.apply(String,d)),p=0);return u?(p&&u.push(String.fromCharCode.apply(String,d.slice(0,p))),u.join("")):String.fromCharCode.apply(String,d.slice(0,p))},e.write=function(i,o,a){for(var c=a,u,d,p=0;p<i.length;++p)u=i.charCodeAt(p),u<128?o[a++]=u:u<2048?(o[a++]=u>>6|192,o[a++]=u&63|128):(u&64512)===55296&&((d=i.charCodeAt(p+1))&64512)===56320?(u=65536+((u&1023)<<10)+(d&1023),++p,o[a++]=u>>18|240,o[a++]=u>>12&63|128,o[a++]=u>>6&63|128,o[a++]=u&63|128):(o[a++]=u>>12|224,o[a++]=u>>6&63|128,o[a++]=u&63|128);return a-c}})(utf8$2);var pool_1=pool;function pool(n,e,t){var i=t||8192,o=i>>>1,a=null,c=i;return function(d){if(d<1||d>o)return n(d);c+d>i&&(a=n(i),c=0);var p=e.call(a,c,c+=d);return c&7&&(c=(c|7)+1),p}}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=e;var n=requireMinimal();function e(a,c){this.lo=a>>>0,this.hi=c>>>0}var t=e.zero=new e(0,0);t.toNumber=function(){return 0},t.zzEncode=t.zzDecode=function(){return this},t.length=function(){return 1};var i=e.zeroHash="\0\0\0\0\0\0\0\0";e.fromNumber=function(c){if(c===0)return t;var u=c<0;u&&(c=-c);var d=c>>>0,p=(c-d)/4294967296>>>0;return u&&(p=~p>>>0,d=~d>>>0,++d>4294967295&&(d=0,++p>4294967295&&(p=0))),new e(d,p)},e.from=function(c){if(typeof c=="number")return e.fromNumber(c);if(n.isString(c))if(n.Long)c=n.Long.fromString(c);else return e.fromNumber(parseInt(c,10));return c.low||c.high?new e(c.low>>>0,c.high>>>0):t},e.prototype.toNumber=function(c){if(!c&&this.hi>>>31){var u=~this.lo+1>>>0,d=~this.hi>>>0;return u||(d=d+1>>>0),-(u+d*4294967296)}return this.lo+this.hi*4294967296},e.prototype.toLong=function(c){return n.Long?new n.Long(this.lo|0,this.hi|0,!!c):{low:this.lo|0,high:this.hi|0,unsigned:!!c}};var o=String.prototype.charCodeAt;return e.fromHash=function(c){return c===i?t:new e((o.call(c,0)|o.call(c,1)<<8|o.call(c,2)<<16|o.call(c,3)<<24)>>>0,(o.call(c,4)|o.call(c,5)<<8|o.call(c,6)<<16|o.call(c,7)<<24)>>>0)},e.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},e.prototype.zzEncode=function(){var c=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^c)>>>0,this.lo=(this.lo<<1^c)>>>0,this},e.prototype.zzDecode=function(){var c=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^c)>>>0,this.hi=(this.hi>>>1^c)>>>0,this},e.prototype.length=function(){var c=this.lo,u=(this.lo>>>28|this.hi<<4)>>>0,d=this.hi>>>24;return d===0?u===0?c<16384?c<128?1:2:c<2097152?3:4:u<16384?u<128?5:6:u<2097152?7:8:d<128?9:10},longbits}var hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(n){var e=n;e.asPromise=aspromise,e.base64=base64$7,e.EventEmitter=eventemitter,e.float=float,e.inquire=inquire_1,e.utf8=utf8$2,e.pool=pool_1,e.LongBits=requireLongbits(),e.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),e.global=e.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,e.emptyArray=Object.freeze?Object.freeze([]):[],e.emptyObject=Object.freeze?Object.freeze({}):{},e.isInteger=Number.isInteger||function(a){return typeof a=="number"&&isFinite(a)&&Math.floor(a)===a},e.isString=function(a){return typeof a=="string"||a instanceof String},e.isObject=function(a){return a&&typeof a=="object"},e.isset=e.isSet=function(a,c){var u=a[c];return u!=null&&a.hasOwnProperty(c)?typeof u!="object"||(Array.isArray(u)?u.length:Object.keys(u).length)>0:!1},e.Buffer=function(){try{var o=e.inquire("buffer").Buffer;return o.prototype.utf8Write?o:null}catch{return null}}(),e._Buffer_from=null,e._Buffer_allocUnsafe=null,e.newBuffer=function(a){return typeof a=="number"?e.Buffer?e._Buffer_allocUnsafe(a):new e.Array(a):e.Buffer?e._Buffer_from(a):typeof Uint8Array>"u"?a:new Uint8Array(a)},e.Array=typeof Uint8Array<"u"?Uint8Array:Array,e.Long=e.global.dcodeIO&&e.global.dcodeIO.Long||e.global.Long||e.inquire("long"),e.key2Re=/^true|false|0|1$/,e.key32Re=/^-?(?:0|[1-9][0-9]*)$/,e.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,e.longToHash=function(a){return a?e.LongBits.from(a).toHash():e.LongBits.zeroHash},e.longFromHash=function(a,c){var u=e.LongBits.fromHash(a);return e.Long?e.Long.fromBits(u.lo,u.hi,c):u.toNumber(!!c)};function t(o,a,c){for(var u=Object.keys(a),d=0;d<u.length;++d)(o[u[d]]===void 0||!c)&&(o[u[d]]=a[u[d]]);return o}e.merge=t,e.lcFirst=function(a){return a.charAt(0).toLowerCase()+a.substring(1)};function i(o){function a(c,u){if(!(this instanceof a))return new a(c,u);Object.defineProperty(this,"message",{get:function(){return c}}),Error.captureStackTrace?Error.captureStackTrace(this,a):Object.defineProperty(this,"stack",{value:new Error().stack||""}),u&&t(this,u)}return a.prototype=Object.create(Error.prototype,{constructor:{value:a,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return o},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),a}e.newError=i,e.ProtocolError=i("ProtocolError"),e.oneOfGetter=function(a){for(var c={},u=0;u<a.length;++u)c[a[u]]=1;return function(){for(var d=Object.keys(this),p=d.length-1;p>-1;--p)if(c[d[p]]===1&&this[d[p]]!==void 0&&this[d[p]]!==null)return d[p]}},e.oneOfSetter=function(a){return function(c){for(var u=0;u<a.length;++u)a[u]!==c&&delete this[a[u]]}},e.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},e._configure=function(){var o=e.Buffer;if(!o){e._Buffer_from=e._Buffer_allocUnsafe=null;return}e._Buffer_from=o.from!==Uint8Array.from&&o.from||function(c,u){return new o(c,u)},e._Buffer_allocUnsafe=o.allocUnsafe||function(c){return new o(c)}}}(minimal$1)),minimal$1}var writer=Writer$1,util$5=requireMinimal(),BufferWriter$1,LongBits$1=util$5.LongBits,base64$6=util$5.base64,utf8$1=util$5.utf8;function Op(n,e,t){this.fn=n,this.len=e,this.next=void 0,this.val=t}function noop$2(){}function State(n){this.head=n.head,this.tail=n.tail,this.len=n.len,this.next=n.states}function Writer$1(){this.len=0,this.head=new Op(noop$2,0,0),this.tail=this.head,this.states=null}var create$8=function n(){return util$5.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};Writer$1.create=create$8();Writer$1.alloc=function n(e){return new util$5.Array(e)};util$5.Array!==Array&&(Writer$1.alloc=util$5.pool(Writer$1.alloc,util$5.Array.prototype.subarray));Writer$1.prototype._push=function n(e,t,i){return this.tail=this.tail.next=new Op(e,t,i),this.len+=t,this};function writeByte(n,e,t){e[t]=n&255}function writeVarint32(n,e,t){for(;n>127;)e[t++]=n&127|128,n>>>=7;e[t]=n}function VarintOp(n,e){this.len=n,this.next=void 0,this.val=e}VarintOp.prototype=Object.create(Op.prototype);VarintOp.prototype.fn=writeVarint32;Writer$1.prototype.uint32=function n(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Writer$1.prototype.int32=function n(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)};Writer$1.prototype.sint32=function n(e){return this.uint32((e<<1^e>>31)>>>0)};function writeVarint64(n,e,t){for(;n.hi;)e[t++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)e[t++]=n.lo&127|128,n.lo=n.lo>>>7;e[t++]=n.lo}Writer$1.prototype.uint64=function n(e){var t=LongBits$1.from(e);return this._push(writeVarint64,t.length(),t)};Writer$1.prototype.int64=Writer$1.prototype.uint64;Writer$1.prototype.sint64=function n(e){var t=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)};Writer$1.prototype.bool=function n(e){return this._push(writeByte,1,e?1:0)};function writeFixed32(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}Writer$1.prototype.fixed32=function n(e){return this._push(writeFixed32,4,e>>>0)};Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32;Writer$1.prototype.fixed64=function n(e){var t=LongBits$1.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)};Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64;Writer$1.prototype.float=function n(e){return this._push(util$5.float.writeFloatLE,4,e)};Writer$1.prototype.double=function n(e){return this._push(util$5.float.writeDoubleLE,8,e)};var writeBytes=util$5.Array.prototype.set?function n(e,t,i){t.set(e,i)}:function n(e,t,i){for(var o=0;o<e.length;++o)t[i+o]=e[o]};Writer$1.prototype.bytes=function n(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(util$5.isString(e)){var i=Writer$1.alloc(t=base64$6.length(e));base64$6.decode(e,i,0),e=i}return this.uint32(t)._push(writeBytes,t,e)};Writer$1.prototype.string=function n(e){var t=utf8$1.length(e);return t?this.uint32(t)._push(utf8$1.write,t,e):this._push(writeByte,1,0)};Writer$1.prototype.fork=function n(){return this.states=new State(this),this.head=this.tail=new Op(noop$2,0,0),this.len=0,this};Writer$1.prototype.reset=function n(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop$2,0,0),this.len=0),this};Writer$1.prototype.ldelim=function n(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this};Writer$1.prototype.finish=function n(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t};Writer$1._configure=function(n){BufferWriter$1=n,Writer$1.create=create$8(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$4=requireMinimal();function BufferWriter(){Writer.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=util$4._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$4.Buffer&&util$4.Buffer.prototype instanceof Uint8Array&&util$4.Buffer.prototype.set.name==="set"?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var o=0;o<e.length;)t[i++]=e[o++]}};BufferWriter.prototype.bytes=function n(e){util$4.isString(e)&&(e=util$4._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(BufferWriter.writeBytesBuffer,t,e),this};function writeStringBuffer(n,e,t){n.length<40?util$4.utf8.write(n,e,t):e.utf8Write?e.utf8Write(n,t):e.write(n,t)}BufferWriter.prototype.string=function n(e){var t=util$4.Buffer.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer,t,e),this};BufferWriter._configure();var reader=Reader$1,util$3=requireMinimal(),BufferReader$1,LongBits=util$3.LongBits,utf8=util$3.utf8;function indexOutOfRange(n,e){return RangeError("index out of range: "+n.pos+" + "+(e||1)+" > "+n.len)}function Reader$1(n){this.buf=n,this.pos=0,this.len=n.length}var create_array=typeof Uint8Array<"u"?function n(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")}:function n(e){if(Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")},create$7=function n(){return util$3.Buffer?function(t){return(Reader$1.create=function(o){return util$3.Buffer.isBuffer(o)?new BufferReader$1(o):create_array(o)})(t)}:create_array};Reader$1.create=create$7();Reader$1.prototype._slice=util$3.Array.prototype.subarray||util$3.Array.prototype.slice;Reader$1.prototype.uint32=function n(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return e}}();Reader$1.prototype.int32=function n(){return this.uint32()|0};Reader$1.prototype.sint32=function n(){var e=this.uint32();return e>>>1^-(e&1)|0};function readLongVarint(){var n=new LongBits(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n;if(n.lo=(n.lo|(this.buf[this.pos]&127)<<28)>>>0,n.hi=(n.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return n;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw indexOutOfRange(this);if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n}return n.lo=(n.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,n}if(this.len-this.pos>4){for(;e<5;++e)if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}else for(;e<5;++e){if(this.pos>=this.len)throw indexOutOfRange(this);if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}throw Error("invalid varint encoding")}Reader$1.prototype.bool=function n(){return this.uint32()!==0};function readFixed32_end(n,e){return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0}Reader$1.prototype.fixed32=function n(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)};Reader$1.prototype.sfixed32=function n(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.prototype.float=function n(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=util$3.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Reader$1.prototype.double=function n(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=util$3.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Reader$1.prototype.bytes=function n(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw indexOutOfRange(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,i):t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)};Reader$1.prototype.string=function n(){var e=this.bytes();return utf8.read(e,0,e.length)};Reader$1.prototype.skip=function n(e){if(typeof e=="number"){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this};Reader$1.prototype.skipType=function(n){switch(n){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(n=this.uint32()&7)!==4;)this.skipType(n);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+n+" at offset "+this.pos)}return this};Reader$1._configure=function(n){BufferReader$1=n,Reader$1.create=create$7(),BufferReader$1._configure();var e=util$3.Long?"toLong":"toNumber";util$3.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[e](!1)},uint64:function(){return readLongVarint.call(this)[e](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[e](!1)},fixed64:function(){return readFixed64.call(this)[e](!0)},sfixed64:function(){return readFixed64.call(this)[e](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$2=requireMinimal();function BufferReader(n){Reader.call(this,n)}BufferReader._configure=function(){util$2.Buffer&&(BufferReader.prototype._slice=util$2.Buffer.prototype.slice)};BufferReader.prototype.string=function n(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};BufferReader._configure();var rpc={},service=Service,util$1=requireMinimal();(Service.prototype=Object.create(util$1.EventEmitter.prototype)).constructor=Service;function Service(n,e,t){if(typeof n!="function")throw TypeError("rpcImpl must be a function");util$1.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=!!e,this.responseDelimited=!!t}Service.prototype.rpcCall=function n(e,t,i,o,a){if(!o)throw TypeError("request must be specified");var c=this;if(!a)return util$1.asPromise(n,c,e,t,i,o);if(!c.rpcImpl){setTimeout(function(){a(Error("already ended"))},0);return}try{return c.rpcImpl(e,t[c.requestDelimited?"encodeDelimited":"encode"](o).finish(),function(d,p){if(d)return c.emit("error",d,e),a(d);if(p===null){c.end(!0);return}if(!(p instanceof i))try{p=i[c.responseDelimited?"decodeDelimited":"decode"](p)}catch(h){return c.emit("error",h,e),a(h)}return c.emit("data",p,e),a(null,p)})}catch(u){c.emit("error",u,e),setTimeout(function(){a(u)},0);return}};Service.prototype.end=function n(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};(function(n){var e=n;e.Service=service})(rpc);var roots={};(function(n){var e=n;e.build="minimal",e.Writer=writer,e.BufferWriter=writer_buffer,e.Reader=reader,e.BufferReader=reader_buffer,e.util=requireMinimal(),e.rpc=rpc,e.roots=roots,e.configure=t;function t(){e.util._configure(),e.Writer._configure(e.BufferWriter),e.Reader._configure(e.BufferReader)}t()})(indexMinimal);var minimal=indexMinimal;const $protobuf=getDefaultExportFromCjs(minimal);var encode_1$2=encode$h,MSB$4=128,REST$4=127,MSBALL$2=~REST$4,INT$2=Math.pow(2,31);function encode$h(n,e,t){e=e||[],t=t||0;for(var i=t;n>=INT$2;)e[t++]=n&255|MSB$4,n/=128;for(;n&MSBALL$2;)e[t++]=n&255|MSB$4,n>>>=7;return e[t]=n|0,encode$h.bytes=t-i+1,e}var decode$j=read$2,MSB$1$1=128,REST$1$1=127;function read$2(n,i){var t=0,i=i||0,o=0,a=i,c,u=n.length;do{if(a>=u)throw read$2.bytes=0,new RangeError("Could not decode varint");c=n[a++],t+=o<28?(c&REST$1$1)<<o:(c&REST$1$1)*Math.pow(2,o),o+=7}while(c>=MSB$1$1);return read$2.bytes=a-i,t}var N1$2=Math.pow(2,7),N2$2=Math.pow(2,14),N3$2=Math.pow(2,21),N4$2=Math.pow(2,28),N5$2=Math.pow(2,35),N6$2=Math.pow(2,42),N7$2=Math.pow(2,49),N8$2=Math.pow(2,56),N9$2=Math.pow(2,63),length$3=function(n){return n<N1$2?1:n<N2$2?2:n<N3$2?3:n<N4$2?4:n<N5$2?5:n<N6$2?6:n<N7$2?7:n<N8$2?8:n<N9$2?9:10},varint$3={encode:encode_1$2,decode:decode$j,encodingLength:length$3},_brrp_varint$1=varint$3;const decode$i=(n,e=0)=>[_brrp_varint$1.decode(n,e),_brrp_varint$1.decode.bytes],encodeTo$1=(n,e,t=0)=>(_brrp_varint$1.encode(n,e,t),e),encodingLength$1=n=>_brrp_varint$1.encodingLength(n),create$6=(n,e)=>{const t=e.byteLength,i=encodingLength$1(n),o=i+encodingLength$1(t),a=new Uint8Array(o+t);return encodeTo$1(n,a,0),encodeTo$1(t,a,i),a.set(e,o),new Digest$1(n,t,e,a)},decode$h=n=>{const e=coerce$3(n),[t,i]=decode$i(e),[o,a]=decode$i(e.subarray(i)),c=e.subarray(i+a);if(c.byteLength!==o)throw new Error("Incorrect length");return new Digest$1(t,o,c,e)},equals$4=(n,e)=>{if(n===e)return!0;{const t=e;return n.code===t.code&&n.size===t.size&&t.bytes instanceof Uint8Array&&equals$5(n.bytes,t.bytes)}};let Digest$1=class{constructor(e,t,i,o){this.code=e,this.size=t,this.digest=i,this.bytes=o}};const format$2=(n,e)=>{const{bytes:t,version:i}=n;switch(i){case 0:return toStringV0$1(t,baseCache$1(n),e||base58btc$3.encoder);default:return toStringV1$1(t,baseCache$1(n),e||base32$6.encoder)}},cache$1=new WeakMap,baseCache$1=n=>{const e=cache$1.get(n);if(e==null){const t=new Map;return cache$1.set(n,t),t}return e};let CID$1=class Fr{constructor(e,t,i,o){this.code=t,this.version=e,this.multihash=i,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE$1)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE$1)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Fr.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,i=create$6(e,t);return Fr.createV1(this.code,i)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Fr.equals(this,e)}static equals(e,t){const i=t;return i&&e.code===i.code&&e.version===i.version&&equals$4(e.multihash,i.multihash)}toString(e){return format$2(this,e)}toJSON(){return{"/":format$2(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;const t=e;if(t instanceof Fr)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){const{version:i,code:o,multihash:a,bytes:c}=t;return new Fr(i,o,a,c||encodeCID$2(i,o,a.bytes))}else if(t[cidSymbol$1]===!0){const{version:i,multihash:o,code:a}=t,c=decode$h(o);return Fr.create(i,a,c)}else return null}static create(e,t,i){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(i.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==DAG_PB_CODE$1)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$1}) block encoding`);return new Fr(e,t,i,i.bytes)}case 1:{const o=encodeCID$2(e,t,i.bytes);return new Fr(e,t,i,o)}default:throw new Error("Invalid version")}}static createV0(e){return Fr.create(0,DAG_PB_CODE$1,e)}static createV1(e,t){return Fr.create(1,e,t)}static decode(e){const[t,i]=Fr.decodeFirst(e);if(i.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Fr.inspectBytes(e),i=t.size-t.multihashSize,o=coerce$3(e.subarray(i,i+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");const a=o.subarray(t.multihashSize-t.digestSize),c=new Digest$1(t.multihashCode,t.digestSize,a,o);return[t.version===0?Fr.createV0(c):Fr.createV1(t.codec,c),e.subarray(t.size)]}static inspectBytes(e){let t=0;const i=()=>{const[b,m]=decode$i(e.subarray(t));return t+=m,b};let o=i(),a=DAG_PB_CODE$1;if(o===18?(o=0,t=0):a=i(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);const c=t,u=i(),d=i(),p=t+d,h=p-c;return{version:o,codec:a,multihashCode:u,digestSize:d,multihashSize:h,size:p}}static parse(e,t){const[i,o]=parseCIDtoBytes$1(e,t),a=Fr.decode(o);if(a.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache$1(a).set(i,e),a}};const parseCIDtoBytes$1=(n,e)=>{switch(n[0]){case"Q":{const t=e||base58btc$3;return[base58btc$3.prefix,t.decode(`${base58btc$3.prefix}${n}`)]}case base58btc$3.prefix:{const t=e||base58btc$3;return[base58btc$3.prefix,t.decode(n)]}case base32$6.prefix:{const t=e||base32$6;return[base32$6.prefix,t.decode(n)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[n[0],e.decode(n)]}}},toStringV0$1=(n,e,t)=>{const{prefix:i}=t;if(i!==base58btc$3.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const o=e.get(i);if(o==null){const a=t.encode(n).slice(1);return e.set(i,a),a}else return o},toStringV1$1=(n,e,t)=>{const{prefix:i}=t,o=e.get(i);if(o==null){const a=t.encode(n);return e.set(i,a),a}else return o},DAG_PB_CODE$1=112,SHA_256_CODE$1=18,encodeCID$2=(n,e,t)=>{const i=encodingLength$1(n),o=i+encodingLength$1(e),a=new Uint8Array(o+t.byteLength);return encodeTo$1(n,a,0),encodeTo$1(e,a,i),a.set(t,o),a},cidSymbol$1=Symbol.for("@ipld/js-cid/CID"),typeofs=["string","number","bigint","symbol"],objectTypeNames=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function is(n){if(n===null)return"null";if(n===void 0)return"undefined";if(n===!0||n===!1)return"boolean";const e=typeof n;if(typeofs.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(n))return"Array";if(isBuffer$1(n))return"Buffer";const t=getObjectType(n);return t||"Object"}function isBuffer$1(n){return n&&n.constructor&&n.constructor.isBuffer&&n.constructor.isBuffer.call(null,n)}function getObjectType(n){const e=Object.prototype.toString.call(n).slice(8,-1);if(objectTypeNames.includes(e))return e}class Type{constructor(e,t,i){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=i}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}Type.uint=new Type(0,"uint",!0);Type.negint=new Type(1,"negint",!0);Type.bytes=new Type(2,"bytes",!0);Type.string=new Type(3,"string",!0);Type.array=new Type(4,"array",!1);Type.map=new Type(5,"map",!1);Type.tag=new Type(6,"tag",!1);Type.float=new Type(7,"float",!0);Type.false=new Type(7,"false",!0);Type.true=new Type(7,"true",!0);Type.null=new Type(7,"null",!0);Type.undefined=new Type(7,"undefined",!0);Type.break=new Type(7,"break",!0);class Token{constructor(e,t,i){this.type=e,this.value=t,this.encodedLength=i,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const useBuffer=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",textDecoder$2=new TextDecoder,textEncoder$4=new TextEncoder;function isBuffer(n){return useBuffer&&globalThis.Buffer.isBuffer(n)}function asU8A(n){return n instanceof Uint8Array?isBuffer(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n:Uint8Array.from(n)}const toString$9=useBuffer?(n,e,t)=>t-e>64?globalThis.Buffer.from(n.subarray(e,t)).toString("utf8"):utf8Slice(n,e,t):(n,e,t)=>t-e>64?textDecoder$2.decode(n.subarray(e,t)):utf8Slice(n,e,t),fromString$9=useBuffer?n=>n.length>64?globalThis.Buffer.from(n):utf8ToBytes(n):n=>n.length>64?textEncoder$4.encode(n):utf8ToBytes(n),fromArray=n=>Uint8Array.from(n),slice$1=useBuffer?(n,e,t)=>isBuffer(n)?new Uint8Array(n.subarray(e,t)):n.slice(e,t):(n,e,t)=>n.slice(e,t),concat$3=useBuffer?(n,e)=>(n=n.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),asU8A(globalThis.Buffer.concat(n,e))):(n,e)=>{const t=new Uint8Array(e);let i=0;for(let o of n)i+o.length>t.length&&(o=o.subarray(0,t.length-i)),t.set(o,i),i+=o.length;return t},alloc=useBuffer?n=>globalThis.Buffer.allocUnsafe(n):n=>new Uint8Array(n);function compare$1(n,e){if(isBuffer(n)&&isBuffer(e))return n.compare(e);for(let t=0;t<n.length;t++)if(n[t]!==e[t])return n[t]<e[t]?-1:1;return 0}function utf8ToBytes(n,e=1/0){let t;const i=n.length;let o=null;const a=[];for(let c=0;c<i;++c){if(t=n.charCodeAt(c),t>55295&&t<57344){if(!o){if(t>56319){(e-=3)>-1&&a.push(239,191,189);continue}else if(c+1===i){(e-=3)>-1&&a.push(239,191,189);continue}o=t;continue}if(t<56320){(e-=3)>-1&&a.push(239,191,189),o=t;continue}t=(o-55296<<10|t-56320)+65536}else o&&(e-=3)>-1&&a.push(239,191,189);if(o=null,t<128){if((e-=1)<0)break;a.push(t)}else if(t<2048){if((e-=2)<0)break;a.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;a.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;a.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return a}function utf8Slice(n,e,t){const i=[];for(;e<t;){const o=n[e];let a=null,c=o>239?4:o>223?3:o>191?2:1;if(e+c<=t){let u,d,p,h;switch(c){case 1:o<128&&(a=o);break;case 2:u=n[e+1],(u&192)===128&&(h=(o&31)<<6|u&63,h>127&&(a=h));break;case 3:u=n[e+1],d=n[e+2],(u&192)===128&&(d&192)===128&&(h=(o&15)<<12|(u&63)<<6|d&63,h>2047&&(h<55296||h>57343)&&(a=h));break;case 4:u=n[e+1],d=n[e+2],p=n[e+3],(u&192)===128&&(d&192)===128&&(p&192)===128&&(h=(o&15)<<18|(u&63)<<12|(d&63)<<6|p&63,h>65535&&h<1114112&&(a=h))}}a===null?(a=65533,c=1):a>65535&&(a-=65536,i.push(a>>>10&1023|55296),a=56320|a&1023),i.push(a),e+=c}return decodeCodePointsArray(i)}const MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(n){const e=n.length;if(e<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,n);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,n.slice(i,i+=MAX_ARGUMENTS_LENGTH));return t}const defaultChunkSize=256;class Bl{constructor(e=defaultChunkSize){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const o=t.length-(this.maxCursor-this.cursor)-1;t.set(e,o)}else{if(t){const o=t.length-(this.maxCursor-this.cursor)-1;o<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,o),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=alloc(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){const i=this.chunks[0];e&&this.cursor>i.length/2?(t=this.cursor===i.length?i:i.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=slice$1(i,0,this.cursor)}else t=concat$3(this.chunks,this.cursor);return e&&this.reset(),t}}const decodeErrPrefix="CBOR decode error:",encodeErrPrefix="CBOR encode error:";function assertEnoughData(n,e,t){if(n.length-e<t)throw new Error(`${decodeErrPrefix} not enough data for type`)}const uintBoundaries=[24,256,65536,4294967296,BigInt("18446744073709551616")];function readUint8(n,e,t){assertEnoughData(n,e,1);const i=n[e];if(t.strict===!0&&i<uintBoundaries[0])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return i}function readUint16(n,e,t){assertEnoughData(n,e,2);const i=n[e]<<8|n[e+1];if(t.strict===!0&&i<uintBoundaries[1])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return i}function readUint32(n,e,t){assertEnoughData(n,e,4);const i=n[e]*16777216+(n[e+1]<<16)+(n[e+2]<<8)+n[e+3];if(t.strict===!0&&i<uintBoundaries[2])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return i}function readUint64(n,e,t){assertEnoughData(n,e,8);const i=n[e]*16777216+(n[e+1]<<16)+(n[e+2]<<8)+n[e+3],o=n[e+4]*16777216+(n[e+5]<<16)+(n[e+6]<<8)+n[e+7],a=(BigInt(i)<<BigInt(32))+BigInt(o);if(t.strict===!0&&a<uintBoundaries[3])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);if(a<=Number.MAX_SAFE_INTEGER)return Number(a);if(t.allowBigInt===!0)return a;throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`)}function decodeUint8(n,e,t,i){return new Token(Type.uint,readUint8(n,e+1,i),2)}function decodeUint16(n,e,t,i){return new Token(Type.uint,readUint16(n,e+1,i),3)}function decodeUint32(n,e,t,i){return new Token(Type.uint,readUint32(n,e+1,i),5)}function decodeUint64(n,e,t,i){return new Token(Type.uint,readUint64(n,e+1,i),9)}function encodeUint(n,e){return encodeUintValue(n,0,e.value)}function encodeUintValue(n,e,t){if(t<uintBoundaries[0]){const i=Number(t);n.push([e|i])}else if(t<uintBoundaries[1]){const i=Number(t);n.push([e|24,i])}else if(t<uintBoundaries[2]){const i=Number(t);n.push([e|25,i>>>8,i&255])}else if(t<uintBoundaries[3]){const i=Number(t);n.push([e|26,i>>>24&255,i>>>16&255,i>>>8&255,i&255])}else{const i=BigInt(t);if(i<uintBoundaries[4]){const o=[e|27,0,0,0,0,0,0,0];let a=Number(i&BigInt(4294967295)),c=Number(i>>BigInt(32)&BigInt(4294967295));o[8]=a&255,a=a>>8,o[7]=a&255,a=a>>8,o[6]=a&255,a=a>>8,o[5]=a&255,o[4]=c&255,c=c>>8,o[3]=c&255,c=c>>8,o[2]=c&255,c=c>>8,o[1]=c&255,n.push(o)}else throw new Error(`${decodeErrPrefix} encountered BigInt larger than allowable range`)}}encodeUint.encodedSize=function n(e){return encodeUintValue.encodedSize(e.value)};encodeUintValue.encodedSize=function n(e){return e<uintBoundaries[0]?1:e<uintBoundaries[1]?2:e<uintBoundaries[2]?3:e<uintBoundaries[3]?5:9};encodeUint.compareTokens=function n(e,t){return e.value<t.value?-1:e.value>t.value?1:0};function decodeNegint8(n,e,t,i){return new Token(Type.negint,-1-readUint8(n,e+1,i),2)}function decodeNegint16(n,e,t,i){return new Token(Type.negint,-1-readUint16(n,e+1,i),3)}function decodeNegint32(n,e,t,i){return new Token(Type.negint,-1-readUint32(n,e+1,i),5)}const neg1b=BigInt(-1),pos1b=BigInt(1);function decodeNegint64(n,e,t,i){const o=readUint64(n,e+1,i);if(typeof o!="bigint"){const a=-1-o;if(a>=Number.MIN_SAFE_INTEGER)return new Token(Type.negint,a,9)}if(i.allowBigInt!==!0)throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`);return new Token(Type.negint,neg1b-BigInt(o),9)}function encodeNegint(n,e){const t=e.value,i=typeof t=="bigint"?t*neg1b-pos1b:t*-1-1;encodeUintValue(n,e.type.majorEncoded,i)}encodeNegint.encodedSize=function n(e){const t=e.value,i=typeof t=="bigint"?t*neg1b-pos1b:t*-1-1;return i<uintBoundaries[0]?1:i<uintBoundaries[1]?2:i<uintBoundaries[2]?3:i<uintBoundaries[3]?5:9};encodeNegint.compareTokens=function n(e,t){return e.value<t.value?1:e.value>t.value?-1:0};function toToken$3(n,e,t,i){assertEnoughData(n,e,t+i);const o=slice$1(n,e+t,e+t+i);return new Token(Type.bytes,o,t+i)}function decodeBytesCompact(n,e,t,i){return toToken$3(n,e,1,t)}function decodeBytes8(n,e,t,i){return toToken$3(n,e,2,readUint8(n,e+1,i))}function decodeBytes16(n,e,t,i){return toToken$3(n,e,3,readUint16(n,e+1,i))}function decodeBytes32(n,e,t,i){return toToken$3(n,e,5,readUint32(n,e+1,i))}function decodeBytes64(n,e,t,i){const o=readUint64(n,e+1,i);if(typeof o=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer bytes lengths not supported`);return toToken$3(n,e,9,o)}function tokenBytes(n){return n.encodedBytes===void 0&&(n.encodedBytes=n.type===Type.string?fromString$9(n.value):n.value),n.encodedBytes}function encodeBytes(n,e){const t=tokenBytes(e);encodeUintValue(n,e.type.majorEncoded,t.length),n.push(t)}encodeBytes.encodedSize=function n(e){const t=tokenBytes(e);return encodeUintValue.encodedSize(t.length)+t.length};encodeBytes.compareTokens=function n(e,t){return compareBytes(tokenBytes(e),tokenBytes(t))};function compareBytes(n,e){return n.length<e.length?-1:n.length>e.length?1:compare$1(n,e)}function toToken$2(n,e,t,i,o){const a=t+i;assertEnoughData(n,e,a);const c=new Token(Type.string,toString$9(n,e+t,e+a),a);return o.retainStringBytes===!0&&(c.byteValue=slice$1(n,e+t,e+a)),c}function decodeStringCompact(n,e,t,i){return toToken$2(n,e,1,t,i)}function decodeString8(n,e,t,i){return toToken$2(n,e,2,readUint8(n,e+1,i),i)}function decodeString16(n,e,t,i){return toToken$2(n,e,3,readUint16(n,e+1,i),i)}function decodeString32(n,e,t,i){return toToken$2(n,e,5,readUint32(n,e+1,i),i)}function decodeString64(n,e,t,i){const o=readUint64(n,e+1,i);if(typeof o=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer string lengths not supported`);return toToken$2(n,e,9,o,i)}const encodeString$1=encodeBytes;function toToken$1(n,e,t,i){return new Token(Type.array,i,t)}function decodeArrayCompact(n,e,t,i){return toToken$1(n,e,1,t)}function decodeArray8(n,e,t,i){return toToken$1(n,e,2,readUint8(n,e+1,i))}function decodeArray16(n,e,t,i){return toToken$1(n,e,3,readUint16(n,e+1,i))}function decodeArray32(n,e,t,i){return toToken$1(n,e,5,readUint32(n,e+1,i))}function decodeArray64(n,e,t,i){const o=readUint64(n,e+1,i);if(typeof o=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer array lengths not supported`);return toToken$1(n,e,9,o)}function decodeArrayIndefinite(n,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken$1(n,e,1,1/0)}function encodeArray(n,e){encodeUintValue(n,Type.array.majorEncoded,e.value)}encodeArray.compareTokens=encodeUint.compareTokens;encodeArray.encodedSize=function n(e){return encodeUintValue.encodedSize(e.value)};function toToken(n,e,t,i){return new Token(Type.map,i,t)}function decodeMapCompact(n,e,t,i){return toToken(n,e,1,t)}function decodeMap8(n,e,t,i){return toToken(n,e,2,readUint8(n,e+1,i))}function decodeMap16(n,e,t,i){return toToken(n,e,3,readUint16(n,e+1,i))}function decodeMap32(n,e,t,i){return toToken(n,e,5,readUint32(n,e+1,i))}function decodeMap64(n,e,t,i){const o=readUint64(n,e+1,i);if(typeof o=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer map lengths not supported`);return toToken(n,e,9,o)}function decodeMapIndefinite(n,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken(n,e,1,1/0)}function encodeMap(n,e){encodeUintValue(n,Type.map.majorEncoded,e.value)}encodeMap.compareTokens=encodeUint.compareTokens;encodeMap.encodedSize=function n(e){return encodeUintValue.encodedSize(e.value)};function decodeTagCompact(n,e,t,i){return new Token(Type.tag,t,1)}function decodeTag8(n,e,t,i){return new Token(Type.tag,readUint8(n,e+1,i),2)}function decodeTag16(n,e,t,i){return new Token(Type.tag,readUint16(n,e+1,i),3)}function decodeTag32(n,e,t,i){return new Token(Type.tag,readUint32(n,e+1,i),5)}function decodeTag64(n,e,t,i){return new Token(Type.tag,readUint64(n,e+1,i),9)}function encodeTag(n,e){encodeUintValue(n,Type.tag.majorEncoded,e.value)}encodeTag.compareTokens=encodeUint.compareTokens;encodeTag.encodedSize=function n(e){return encodeUintValue.encodedSize(e.value)};const MINOR_FALSE=20,MINOR_TRUE=21,MINOR_NULL=22,MINOR_UNDEFINED=23;function decodeUndefined(n,e,t,i){if(i.allowUndefined===!1)throw new Error(`${decodeErrPrefix} undefined values are not supported`);return i.coerceUndefinedToNull===!0?new Token(Type.null,null,1):new Token(Type.undefined,void 0,1)}function decodeBreak(n,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return new Token(Type.break,void 0,1)}function createToken(n,e,t){if(t){if(t.allowNaN===!1&&Number.isNaN(n))throw new Error(`${decodeErrPrefix} NaN values are not supported`);if(t.allowInfinity===!1&&(n===1/0||n===-1/0))throw new Error(`${decodeErrPrefix} Infinity values are not supported`)}return new Token(Type.float,n,e)}function decodeFloat16(n,e,t,i){return createToken(readFloat16(n,e+1),3,i)}function decodeFloat32(n,e,t,i){return createToken(readFloat32(n,e+1),5,i)}function decodeFloat64(n,e,t,i){return createToken(readFloat64(n,e+1),9,i)}function encodeFloat(n,e,t){const i=e.value;if(i===!1)n.push([Type.float.majorEncoded|MINOR_FALSE]);else if(i===!0)n.push([Type.float.majorEncoded|MINOR_TRUE]);else if(i===null)n.push([Type.float.majorEncoded|MINOR_NULL]);else if(i===void 0)n.push([Type.float.majorEncoded|MINOR_UNDEFINED]);else{let o,a=!1;(!t||t.float64!==!0)&&(encodeFloat16(i),o=readFloat16(ui8a,1),i===o||Number.isNaN(i)?(ui8a[0]=249,n.push(ui8a.slice(0,3)),a=!0):(encodeFloat32(i),o=readFloat32(ui8a,1),i===o&&(ui8a[0]=250,n.push(ui8a.slice(0,5)),a=!0))),a||(encodeFloat64(i),o=readFloat64(ui8a,1),ui8a[0]=251,n.push(ui8a.slice(0,9)))}}encodeFloat.encodedSize=function n(e,t){const i=e.value;if(i===!1||i===!0||i===null||i===void 0)return 1;if(!t||t.float64!==!0){encodeFloat16(i);let o=readFloat16(ui8a,1);if(i===o||Number.isNaN(i))return 3;if(encodeFloat32(i),o=readFloat32(ui8a,1),i===o)return 5}return 9};const buffer$1=new ArrayBuffer(9),dataView=new DataView(buffer$1,1),ui8a=new Uint8Array(buffer$1,0);function encodeFloat16(n){if(n===1/0)dataView.setUint16(0,31744,!1);else if(n===-1/0)dataView.setUint16(0,64512,!1);else if(Number.isNaN(n))dataView.setUint16(0,32256,!1);else{dataView.setFloat32(0,n);const e=dataView.getUint32(0),t=(e&2139095040)>>23,i=e&8388607;if(t===255)dataView.setUint16(0,31744,!1);else if(t===0)dataView.setUint16(0,(n&2147483648)>>16|i>>13,!1);else{const o=t-127;o<-24?dataView.setUint16(0,0):o<-14?dataView.setUint16(0,(e&2147483648)>>16|1<<24+o,!1):dataView.setUint16(0,(e&2147483648)>>16|o+15<<10|i>>13,!1)}}}function readFloat16(n,e){if(n.length-e<2)throw new Error(`${decodeErrPrefix} not enough data for float16`);const t=(n[e]<<8)+n[e+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;const i=t>>10&31,o=t&1023;let a;return i===0?a=o*2**-24:i!==31?a=(o+1024)*2**(i-25):a=o===0?1/0:NaN,t&32768?-a:a}function encodeFloat32(n){dataView.setFloat32(0,n,!1)}function readFloat32(n,e){if(n.length-e<4)throw new Error(`${decodeErrPrefix} not enough data for float32`);const t=(n.byteOffset||0)+e;return new DataView(n.buffer,t,4).getFloat32(0,!1)}function encodeFloat64(n){dataView.setFloat64(0,n,!1)}function readFloat64(n,e){if(n.length-e<8)throw new Error(`${decodeErrPrefix} not enough data for float64`);const t=(n.byteOffset||0)+e;return new DataView(n.buffer,t,8).getFloat64(0,!1)}encodeFloat.compareTokens=encodeUint.compareTokens;function invalidMinor(n,e,t){throw new Error(`${decodeErrPrefix} encountered invalid minor (${t}) for major ${n[e]>>>5}`)}function errorer(n){return()=>{throw new Error(`${decodeErrPrefix} ${n}`)}}const jump=[];for(let n=0;n<=23;n++)jump[n]=invalidMinor;jump[24]=decodeUint8;jump[25]=decodeUint16;jump[26]=decodeUint32;jump[27]=decodeUint64;jump[28]=invalidMinor;jump[29]=invalidMinor;jump[30]=invalidMinor;jump[31]=invalidMinor;for(let n=32;n<=55;n++)jump[n]=invalidMinor;jump[56]=decodeNegint8;jump[57]=decodeNegint16;jump[58]=decodeNegint32;jump[59]=decodeNegint64;jump[60]=invalidMinor;jump[61]=invalidMinor;jump[62]=invalidMinor;jump[63]=invalidMinor;for(let n=64;n<=87;n++)jump[n]=decodeBytesCompact;jump[88]=decodeBytes8;jump[89]=decodeBytes16;jump[90]=decodeBytes32;jump[91]=decodeBytes64;jump[92]=invalidMinor;jump[93]=invalidMinor;jump[94]=invalidMinor;jump[95]=errorer("indefinite length bytes/strings are not supported");for(let n=96;n<=119;n++)jump[n]=decodeStringCompact;jump[120]=decodeString8;jump[121]=decodeString16;jump[122]=decodeString32;jump[123]=decodeString64;jump[124]=invalidMinor;jump[125]=invalidMinor;jump[126]=invalidMinor;jump[127]=errorer("indefinite length bytes/strings are not supported");for(let n=128;n<=151;n++)jump[n]=decodeArrayCompact;jump[152]=decodeArray8;jump[153]=decodeArray16;jump[154]=decodeArray32;jump[155]=decodeArray64;jump[156]=invalidMinor;jump[157]=invalidMinor;jump[158]=invalidMinor;jump[159]=decodeArrayIndefinite;for(let n=160;n<=183;n++)jump[n]=decodeMapCompact;jump[184]=decodeMap8;jump[185]=decodeMap16;jump[186]=decodeMap32;jump[187]=decodeMap64;jump[188]=invalidMinor;jump[189]=invalidMinor;jump[190]=invalidMinor;jump[191]=decodeMapIndefinite;for(let n=192;n<=215;n++)jump[n]=decodeTagCompact;jump[216]=decodeTag8;jump[217]=decodeTag16;jump[218]=decodeTag32;jump[219]=decodeTag64;jump[220]=invalidMinor;jump[221]=invalidMinor;jump[222]=invalidMinor;jump[223]=invalidMinor;for(let n=224;n<=243;n++)jump[n]=errorer("simple values are not supported");jump[244]=invalidMinor;jump[245]=invalidMinor;jump[246]=invalidMinor;jump[247]=decodeUndefined;jump[248]=errorer("simple values are not supported");jump[249]=decodeFloat16;jump[250]=decodeFloat32;jump[251]=decodeFloat64;jump[252]=invalidMinor;jump[253]=invalidMinor;jump[254]=invalidMinor;jump[255]=decodeBreak;const quick=[];for(let n=0;n<24;n++)quick[n]=new Token(Type.uint,n,1);for(let n=-1;n>=-24;n--)quick[31-n]=new Token(Type.negint,n,1);quick[64]=new Token(Type.bytes,new Uint8Array(0),1);quick[96]=new Token(Type.string,"",1);quick[128]=new Token(Type.array,0,1);quick[160]=new Token(Type.map,0,1);quick[244]=new Token(Type.false,!1,1);quick[245]=new Token(Type.true,!0,1);quick[246]=new Token(Type.null,null,1);function quickEncodeToken(n){switch(n.type){case Type.false:return fromArray([244]);case Type.true:return fromArray([245]);case Type.null:return fromArray([246]);case Type.bytes:return n.value.length?void 0:fromArray([64]);case Type.string:return n.value===""?fromArray([96]):void 0;case Type.array:return n.value===0?fromArray([128]):void 0;case Type.map:return n.value===0?fromArray([160]):void 0;case Type.uint:return n.value<24?fromArray([Number(n.value)]):void 0;case Type.negint:if(n.value>=-24)return fromArray([31-Number(n.value)])}}const defaultEncodeOptions={float64:!1,mapSorter,quickEncodeToken};function makeCborEncoders(){const n=[];return n[Type.uint.major]=encodeUint,n[Type.negint.major]=encodeNegint,n[Type.bytes.major]=encodeBytes,n[Type.string.major]=encodeString$1,n[Type.array.major]=encodeArray,n[Type.map.major]=encodeMap,n[Type.tag.major]=encodeTag,n[Type.float.major]=encodeFloat,n}const cborEncoders=makeCborEncoders(),buf=new Bl;class Ref{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${encodeErrPrefix} object contains circular references`);return new Ref(t,e)}}const simpleTokens={null:new Token(Type.null,null),undefined:new Token(Type.undefined,void 0),true:new Token(Type.true,!0),false:new Token(Type.false,!1),emptyArray:new Token(Type.array,0),emptyMap:new Token(Type.map,0)},typeEncoders={number(n,e,t,i){return!Number.isInteger(n)||!Number.isSafeInteger(n)?new Token(Type.float,n):n>=0?new Token(Type.uint,n):new Token(Type.negint,n)},bigint(n,e,t,i){return n>=BigInt(0)?new Token(Type.uint,n):new Token(Type.negint,n)},Uint8Array(n,e,t,i){return new Token(Type.bytes,n)},string(n,e,t,i){return new Token(Type.string,n)},boolean(n,e,t,i){return n?simpleTokens.true:simpleTokens.false},null(n,e,t,i){return simpleTokens.null},undefined(n,e,t,i){return simpleTokens.undefined},ArrayBuffer(n,e,t,i){return new Token(Type.bytes,new Uint8Array(n))},DataView(n,e,t,i){return new Token(Type.bytes,new Uint8Array(n.buffer,n.byteOffset,n.byteLength))},Array(n,e,t,i){if(!n.length)return t.addBreakTokens===!0?[simpleTokens.emptyArray,new Token(Type.break)]:simpleTokens.emptyArray;i=Ref.createCheck(i,n);const o=[];let a=0;for(const c of n)o[a++]=objectToTokens(c,t,i);return t.addBreakTokens?[new Token(Type.array,n.length),o,new Token(Type.break)]:[new Token(Type.array,n.length),o]},Object(n,e,t,i){const o=e!=="Object",a=o?n.keys():Object.keys(n),c=o?n.size:a.length;if(!c)return t.addBreakTokens===!0?[simpleTokens.emptyMap,new Token(Type.break)]:simpleTokens.emptyMap;i=Ref.createCheck(i,n);const u=[];let d=0;for(const p of a)u[d++]=[objectToTokens(p,t,i),objectToTokens(o?n.get(p):n[p],t,i)];return sortMapEntries(u,t),t.addBreakTokens?[new Token(Type.map,c),u,new Token(Type.break)]:[new Token(Type.map,c),u]}};typeEncoders.Map=typeEncoders.Object;typeEncoders.Buffer=typeEncoders.Uint8Array;for(const n of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))typeEncoders[`${n}Array`]=typeEncoders.DataView;function objectToTokens(n,e={},t){const i=is(n),o=e&&e.typeEncoders&&e.typeEncoders[i]||typeEncoders[i];if(typeof o=="function"){const c=o(n,i,e,t);if(c!=null)return c}const a=typeEncoders[i];if(!a)throw new Error(`${encodeErrPrefix} unsupported type: ${i}`);return a(n,i,e,t)}function sortMapEntries(n,e){e.mapSorter&&n.sort(e.mapSorter)}function mapSorter(n,e){const t=Array.isArray(n[0])?n[0][0]:n[0],i=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==i.type)return t.type.compare(i.type);const o=t.type.major,a=cborEncoders[o].compareTokens(t,i);return a===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),a}function tokensToEncoded(n,e,t,i){if(Array.isArray(e))for(const o of e)tokensToEncoded(n,o,t,i);else t[e.type.major](n,e,i)}function encodeCustom(n,e,t){const i=objectToTokens(n,t);if(!Array.isArray(i)&&t.quickEncodeToken){const o=t.quickEncodeToken(i);if(o)return o;const a=e[i.type.major];if(a.encodedSize){const c=a.encodedSize(i,t),u=new Bl(c);if(a(u,i,t),u.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${i} was wrong`);return asU8A(u.chunks[0])}}return buf.reset(),tokensToEncoded(buf,i,e,t),buf.toBytes(!0)}function encode$g(n,e){return e=Object.assign({},defaultEncodeOptions,e),encodeCustom(n,cborEncoders,e)}const defaultDecodeOptions={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Tokeniser{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){const e=this.data[this.pos];let t=quick[e];if(t===void 0){const i=jump[e];if(!i)throw new Error(`${decodeErrPrefix} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const o=e&31;t=i(this.data,this.pos,o,this.options)}return this.pos+=t.encodedLength,t}}const DONE=Symbol.for("DONE"),BREAK=Symbol.for("BREAK");function tokenToArray(n,e,t){const i=[];for(let o=0;o<n.value;o++){const a=tokensToObject(e,t);if(a===BREAK){if(n.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed array`)}if(a===DONE)throw new Error(`${decodeErrPrefix} found array but not enough entries (got ${o}, expected ${n.value})`);i[o]=a}return i}function tokenToMap(n,e,t){const i=t.useMaps===!0,o=i?void 0:{},a=i?new Map:void 0;for(let c=0;c<n.value;c++){const u=tokensToObject(e,t);if(u===BREAK){if(n.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed map`)}if(u===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${c} [no key], expected ${n.value})`);if(i!==!0&&typeof u!="string")throw new Error(`${decodeErrPrefix} non-string keys not supported (got ${typeof u})`);if(t.rejectDuplicateMapKeys===!0&&(i&&a.has(u)||!i&&u in o))throw new Error(`${decodeErrPrefix} found repeat map key "${u}"`);const d=tokensToObject(e,t);if(d===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${c} [no value], expected ${n.value})`);i?a.set(u,d):o[u]=d}return i?a:o}function tokensToObject(n,e){if(n.done())return DONE;const t=n.next();if(t.type===Type.break)return BREAK;if(t.type.terminal)return t.value;if(t.type===Type.array)return tokenToArray(t,n,e);if(t.type===Type.map)return tokenToMap(t,n,e);if(t.type===Type.tag){if(e.tags&&typeof e.tags[t.value]=="function"){const i=tokensToObject(n,e);return e.tags[t.value](i)}throw new Error(`${decodeErrPrefix} tag not supported (${t.value})`)}throw new Error("unsupported")}function decode$g(n,e){if(!(n instanceof Uint8Array))throw new Error(`${decodeErrPrefix} data to decode must be a Uint8Array`);e=Object.assign({},defaultDecodeOptions,e);const t=e.tokenizer||new Tokeniser(n,e),i=tokensToObject(t,e);if(i===DONE)throw new Error(`${decodeErrPrefix} did not find any content to decode`);if(i===BREAK)throw new Error(`${decodeErrPrefix} got unexpected break`);if(!t.done())throw new Error(`${decodeErrPrefix} too many terminals, data makes no sense`);return i}const identity$5=from$5({prefix:"\0",name:"identity",encode:n=>toString$a(n),decode:n=>fromString$a(n)}),identityBase$3=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$5},Symbol.toStringTag,{value:"Module"})),base2$6=rfc4648$3({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$7=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$6},Symbol.toStringTag,{value:"Module"})),base8$6=rfc4648$3({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$7=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$6},Symbol.toStringTag,{value:"Module"})),base10$6=baseX$3({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$7=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$6},Symbol.toStringTag,{value:"Module"})),base16$6=rfc4648$3({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$3=rfc4648$3({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$7=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$6,base16upper:base16upper$3},Symbol.toStringTag,{value:"Module"})),base36$6=baseX$3({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$3=baseX$3({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$7=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$6,base36upper:base36upper$3},Symbol.toStringTag,{value:"Module"})),alphabet$3=Array.from(""),alphabetBytesToChars$3=alphabet$3.reduce((n,e,t)=>(n[t]=e,n),[]),alphabetCharsToBytes$3=alphabet$3.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function encode$f(n){return n.reduce((e,t)=>(e+=alphabetBytesToChars$3[t],e),"")}function decode$f(n){const e=[];for(const t of n){const i=alphabetCharsToBytes$3[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const base256emoji$6=from$5({prefix:"",name:"base256emoji",encode:encode$f,decode:decode$f}),base256emoji$7=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$6},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const bases$3={...identityBase$3,...base2$7,...base8$7,...base10$7,...base16$7,...base32$7,...base36$7,...base58$3,...base64$9,...base256emoji$7};function asUint8Array$2(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function base$4(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var o=0;o<n.length;o++){var a=n.charAt(o),c=a.charCodeAt(0);if(t[c]!==255)throw new TypeError(a+" is ambiguous");t[c]=o}var u=n.length,d=n.charAt(0),p=Math.log(u)/Math.log(256),h=Math.log(256)/Math.log(u);function b(_){if(_ instanceof Uint8Array||(ArrayBuffer.isView(_)?_=new Uint8Array(_.buffer,_.byteOffset,_.byteLength):Array.isArray(_)&&(_=Uint8Array.from(_))),!(_ instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(_.length===0)return"";for(var $=0,k=0,D=0,O=_.length;D!==O&&_[D]===0;)D++,$++;for(var H=(O-D)*h+1>>>0,j=new Uint8Array(H);D!==O;){for(var W=_[D],ae=0,fe=H-1;(W!==0||ae<k)&&fe!==-1;fe--,ae++)W+=256*j[fe]>>>0,j[fe]=W%u>>>0,W=W/u>>>0;if(W!==0)throw new Error("Non-zero carry");k=ae,D++}for(var pe=H-k;pe!==H&&j[pe]===0;)pe++;for(var ve=d.repeat($);pe<H;++pe)ve+=n.charAt(j[pe]);return ve}function m(_){if(typeof _!="string")throw new TypeError("Expected String");if(_.length===0)return new Uint8Array;var $=0;if(_[$]!==" "){for(var k=0,D=0;_[$]===d;)k++,$++;for(var O=(_.length-$)*p+1>>>0,H=new Uint8Array(O);_[$];){var j=t[_.charCodeAt($)];if(j===255)return;for(var W=0,ae=O-1;(j!==0||W<D)&&ae!==-1;ae--,W++)j+=u*H[ae]>>>0,H[ae]=j%256>>>0,j=j/256>>>0;if(j!==0)throw new Error("Non-zero carry");D=W,$++}if(_[$]!==" "){for(var fe=O-D;fe!==O&&H[fe]===0;)fe++;for(var pe=new Uint8Array(k+(O-fe)),ve=k;fe!==O;)pe[ve++]=H[fe++];return pe}}}function v(_){var $=m(_);if($)return $;throw new Error(`Non-${e} character`)}return{encode:b,decodeUnsafe:m,decode:v}}var src$3=base$4,_brrp__multiformats_scope_baseX$2=src$3;const coerce$2=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},fromString$8=n=>new TextEncoder().encode(n),toString$8=n=>new TextDecoder().decode(n);let Encoder$2=class{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Decoder$2=class{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return or$2(this,e)}},ComposedDecoder$2=class{constructor(e){this.decoders=e}or(e){return or$2(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$2=(n,e)=>new ComposedDecoder$2({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});let Codec$2=class{constructor(e,t,i,o){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=o,this.encoder=new Encoder$2(e,t,i),this.decoder=new Decoder$2(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const from$4=({name:n,prefix:e,encode:t,decode:i})=>new Codec$2(n,e,t,i),baseX$2=({prefix:n,name:e,alphabet:t})=>{const{encode:i,decode:o}=_brrp__multiformats_scope_baseX$2(t,e);return from$4({prefix:n,name:e,encode:i,decode:a=>coerce$2(o(a))})},decode$e=(n,e,t,i)=>{const o={};for(let h=0;h<e.length;++h)o[e[h]]=h;let a=n.length;for(;n[a-1]==="=";)--a;const c=new Uint8Array(a*t/8|0);let u=0,d=0,p=0;for(let h=0;h<a;++h){const b=o[n[h]];if(b===void 0)throw new SyntaxError(`Non-${i} character`);d=d<<t|b,u+=t,u>=8&&(u-=8,c[p++]=255&d>>u)}if(u>=t||255&d<<8-u)throw new SyntaxError("Unexpected end of data");return c},encode$e=(n,e,t)=>{const i=e[e.length-1]==="=",o=(1<<t)-1;let a="",c=0,u=0;for(let d=0;d<n.length;++d)for(u=u<<8|n[d],c+=8;c>t;)c-=t,a+=e[o&u>>c];if(c&&(a+=e[o&u<<t-c]),i)for(;a.length*t&7;)a+="=";return a},rfc4648$2=({name:n,prefix:e,bitsPerChar:t,alphabet:i})=>from$4({prefix:e,name:n,encode(o){return encode$e(o,i,t)},decode(o){return decode$e(o,i,t,n)}}),base10$4=baseX$2({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$5=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$4},Symbol.toStringTag,{value:"Module"})),base16$4=rfc4648$2({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$2=rfc4648$2({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$5=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$4,base16upper:base16upper$2},Symbol.toStringTag,{value:"Module"})),base2$4=rfc4648$2({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$5=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$4},Symbol.toStringTag,{value:"Module"})),alphabet$2=Array.from(""),alphabetBytesToChars$2=alphabet$2.reduce((n,e,t)=>(n[t]=e,n),[]),alphabetCharsToBytes$2=alphabet$2.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function encode$d(n){return n.reduce((e,t)=>(e+=alphabetBytesToChars$2[t],e),"")}function decode$d(n){const e=[];for(const t of n){const i=alphabetCharsToBytes$2[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const base256emoji$4=from$4({prefix:"",name:"base256emoji",encode:encode$d,decode:decode$d}),base256emoji$5=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$4},Symbol.toStringTag,{value:"Module"})),base32$4=rfc4648$2({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$2=rfc4648$2({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$2=rfc4648$2({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$2=rfc4648$2({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$2=rfc4648$2({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$2=rfc4648$2({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$2=rfc4648$2({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$2=rfc4648$2({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$2=rfc4648$2({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$5=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$4,base32hex:base32hex$2,base32hexpad:base32hexpad$2,base32hexpadupper:base32hexpadupper$2,base32hexupper:base32hexupper$2,base32pad:base32pad$2,base32padupper:base32padupper$2,base32upper:base32upper$2,base32z:base32z$2},Symbol.toStringTag,{value:"Module"})),base36$4=baseX$2({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$2=baseX$2({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$5=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$4,base36upper:base36upper$2},Symbol.toStringTag,{value:"Module"})),base58btc$2=baseX$2({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$2=baseX$2({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$2=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$2,base58flickr:base58flickr$2},Symbol.toStringTag,{value:"Module"})),base64$4=rfc4648$2({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$2=rfc4648$2({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$2=rfc4648$2({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$2=rfc4648$2({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$5=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$4,base64pad:base64pad$2,base64url:base64url$2,base64urlpad:base64urlpad$2},Symbol.toStringTag,{value:"Module"})),base8$4=rfc4648$2({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$5=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$4},Symbol.toStringTag,{value:"Module"})),identity$4=from$4({prefix:"\0",name:"identity",encode:n=>toString$8(n),decode:n=>fromString$8(n)}),identityBase$2=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$4},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const bases$2={...identityBase$2,...base2$5,...base8$5,...base10$5,...base16$5,...base32$5,...base36$5,...base58$2,...base64$5,...base256emoji$5};function allocUnsafe$2(n=0){return globalThis.Buffer?.allocUnsafe!=null?asUint8Array$2(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function createCodec$2(n,e,t,i){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:i}}}const string$2=createCodec$2("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),ascii$2=createCodec$2("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=allocUnsafe$2(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),BASES$2={utf8:string$2,"utf-8":string$2,hex:bases$2.base16,latin1:ascii$2,ascii:ascii$2,binary:ascii$2,...bases$2};function fromString$7(n,e="utf8"){const t=BASES$2[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array$2(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}class Parser{constructor(){la(this,"index",0);la(this,"input","")}new(e){return this.index=0,this.input=e,this}readAtomically(e){const t=this.index,i=e();return i===void 0&&(this.index=t),i}parseWith(e){const t=e();if(this.index===this.input.length)return t}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically(()=>{const t=this.readChar();if(t===e)return t})}readSeparator(e,t,i){return this.readAtomically(()=>{if(!(t>0&&this.readGivenChar(e)===void 0))return i()})}readNumber(e,t,i,o){return this.readAtomically(()=>{let a=0,c=0;const u=this.peekChar();if(u===void 0)return;const d=u==="0",p=2**(8*o)-1;for(;;){const h=this.readAtomically(()=>{const b=this.readChar();if(b===void 0)return;const m=Number.parseInt(b,e);if(!Number.isNaN(m))return m});if(h===void 0)break;if(a*=e,a+=h,a>p||(c+=1,t!==void 0&&c>t))return}if(c!==0)return!i&&d&&c>1?void 0:a})}readIPv4Addr(){return this.readAtomically(()=>{const e=new Uint8Array(4);for(let t=0;t<e.length;t++){const i=this.readSeparator(".",t,()=>this.readNumber(10,3,!1,1));if(i===void 0)return;e[t]=i}return e})}readIPv6Addr(){const e=t=>{for(let i=0;i<t.length/2;i++){const o=i*2;if(i<t.length-3){const c=this.readSeparator(":",i,()=>this.readIPv4Addr());if(c!==void 0)return t[o]=c[0],t[o+1]=c[1],t[o+2]=c[2],t[o+3]=c[3],[o+4,!0]}const a=this.readSeparator(":",i,()=>this.readNumber(16,4,!0,2));if(a===void 0)return[o,!1];t[o]=a>>8,t[o+1]=a&255}return[t.length,!1]};return this.readAtomically(()=>{const t=new Uint8Array(16),[i,o]=e(t);if(i===16)return t;if(o||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;const a=new Uint8Array(14),c=16-(i+2),[u]=e(a.subarray(0,c));return t.set(a.subarray(0,u),16-u),t})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}}const MAX_IPV6_LENGTH=45,MAX_IPV4_LENGTH=15,parser=new Parser;function parseIPv4(n){if(!(n.length>MAX_IPV4_LENGTH))return parser.new(n).parseWith(()=>parser.readIPv4Addr())}function parseIPv6(n){if(!(n.length>MAX_IPV6_LENGTH))return parser.new(n).parseWith(()=>parser.readIPv6Addr())}function parseIP(n){if(!(n.length>MAX_IPV6_LENGTH))return parser.new(n).parseWith(()=>parser.readIPAddr())}function isIPv4(n){return!!parseIPv4(n)}function isIPv6(n){return!!parseIPv6(n)}function isIP(n){return!!parseIP(n)}function asUint8Array$1(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function allocUnsafe$1(n=0){return globalThis.Buffer?.allocUnsafe!=null?asUint8Array$1(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function createCodec$1(n,e,t,i){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:i}}}const string$1=createCodec$1("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),ascii$1=createCodec$1("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=allocUnsafe$1(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),BASES$1={utf8:string$1,"utf-8":string$1,hex:bases$3.base16,latin1:ascii$1,ascii:ascii$1,binary:ascii$1,...bases$3};function toString$7(n,e="utf8"){const t=BASES$1[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):t.encoder.encode(n).substring(1)}const isV4=isIPv4,isV6=isIPv6,toBytes$1=function(n){let e=0;if(n=n.toString().trim(),isV4(n)){const t=new Uint8Array(e+4);return n.split(/\./g).forEach(i=>{t[e++]=parseInt(i,10)&255}),t}if(isV6(n)){const t=n.split(":",8);let i;for(i=0;i<t.length;i++){const a=isV4(t[i]);let c;a&&(c=toBytes$1(t[i]),t[i]=toString$7(c.slice(0,2),"base16")),c!=null&&++i<8&&t.splice(i,0,toString$7(c.slice(2,4),"base16"))}if(t[0]==="")for(;t.length<8;)t.unshift("0");else if(t[t.length-1]==="")for(;t.length<8;)t.push("0");else if(t.length<8){for(i=0;i<t.length&&t[i]!=="";i++);const a=[i,1];for(i=9-t.length;i>0;i--)a.push("0");t.splice.apply(t,a)}const o=new Uint8Array(e+16);for(i=0;i<t.length;i++){const a=parseInt(t[i],16);o[e++]=a>>8&255,o[e++]=a&255}return o}throw new Error("invalid ip address")},toString$6=function(n,e=0,t){e=~~e,t=t??n.length-e;const i=new DataView(n.buffer);if(t===4){const o=[];for(let a=0;a<t;a++)o.push(n[e+a]);return o.join(".")}if(t===16){const o=[];for(let a=0;a<t;a+=2)o.push(i.getUint16(e+a).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},V=-1,names={},codes={},table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,V,"ip6zone"],[43,8,"ipcidr"],[53,V,"dns",!0],[54,V,"dns4",!0],[55,V,"dns6",!0],[56,V,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[281,0,"webrtc-w3c"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,V,"unix",!1,!0],[421,V,"ipfs"],[421,V,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,V,"garlic64"],[448,0,"tls"],[449,V,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,V,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,V,"memory"]];table.forEach(n=>{const e=createProtocol(...n);codes[e.code]=e,names[e.name]=e});function createProtocol(n,e,t,i,o){return{code:n,size:e,name:t,resolvable:!!i,path:!!o}}function getProtocol(n){if(typeof n=="number"){if(codes[n]!=null)return codes[n];throw new Error(`no protocol with code: ${n}`)}else if(typeof n=="string"){if(names[n]!=null)return names[n];throw new Error(`no protocol with name: ${n}`)}throw new Error(`invalid protocol id type: ${typeof n}`)}var encode_1$1=encode$c,MSB$3=128,REST$3=127,MSBALL$1=~REST$3,INT$1=Math.pow(2,31);function encode$c(n,e,t){if(Number.MAX_SAFE_INTEGER&&n>Number.MAX_SAFE_INTEGER)throw encode$c.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var i=t;n>=INT$1;)e[t++]=n&255|MSB$3,n/=128;for(;n&MSBALL$1;)e[t++]=n&255|MSB$3,n>>>=7;return e[t]=n|0,encode$c.bytes=t-i+1,e}var decode$c=read$1,MSB$2=128,REST$2=127;function read$1(n,i){var t=0,i=i||0,o=0,a=i,c,u=n.length;do{if(a>=u||o>49)throw read$1.bytes=0,new RangeError("Could not decode varint");c=n[a++],t+=o<28?(c&REST$2)<<o:(c&REST$2)*Math.pow(2,o),o+=7}while(c>=MSB$2);return read$1.bytes=a-i,t}var N1$1=Math.pow(2,7),N2$1=Math.pow(2,14),N3$1=Math.pow(2,21),N4$1=Math.pow(2,28),N5$1=Math.pow(2,35),N6$1=Math.pow(2,42),N7$1=Math.pow(2,49),N8$1=Math.pow(2,56),N9$1=Math.pow(2,63),length$2=function(n){return n<N1$1?1:n<N2$1?2:n<N3$1?3:n<N4$1?4:n<N5$1?5:n<N6$1?6:n<N7$1?7:n<N8$1?8:n<N9$1?9:10},varint$1={encode:encode_1$1,decode:decode$c,encodingLength:length$2};const varint$2=getDefaultExportFromCjs(varint$1);function fromString$6(n,e="utf8"){const t=BASES$1[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array$1(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}function concat$2(n,e){e==null&&(e=n.reduce((o,a)=>o+a.length,0));const t=allocUnsafe$1(e);let i=0;for(const o of n)t.set(o,i),i+=o.length;return asUint8Array$1(t)}function convertToString(n,e){switch(getProtocol(n).code){case 4:case 41:return bytes2ip(e);case 42:return bytes2str(e);case 6:case 273:case 33:case 132:return bytes2port(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return bytes2str(e);case 421:return bytes2mh(e);case 444:return bytes2onion(e);case 445:return bytes2onion(e);case 466:return bytes2mb(e);default:return toString$7(e,"base16")}}function convertToBytes(n,e){switch(getProtocol(n).code){case 4:return ip2bytes(e);case 41:return ip2bytes(e);case 42:return str2bytes(e);case 6:case 273:case 33:case 132:return port2bytes(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return str2bytes(e);case 421:return mh2bytes(e);case 444:return onion2bytes(e);case 445:return onion32bytes(e);case 466:return mb2bytes(e);default:return fromString$6(e,"base16")}}const decoders$1=Object.values(bases$3).map(n=>n.decoder),anybaseDecoder=function(){let n=decoders$1[0].or(decoders$1[1]);return decoders$1.slice(2).forEach(e=>n=n.or(e)),n}();function ip2bytes(n){if(!isIP(n))throw new Error("invalid ip address");return toBytes$1(n)}function bytes2ip(n){const e=toString$6(n,0,n.length);if(e==null)throw new Error("ipBuff is required");if(!isIP(e))throw new Error("invalid ip address");return e}function port2bytes(n){const e=new ArrayBuffer(2);return new DataView(e).setUint16(0,n),new Uint8Array(e)}function bytes2port(n){return new DataView(n.buffer).getUint16(n.byteOffset)}function str2bytes(n){const e=fromString$6(n),t=Uint8Array.from(varint$2.encode(e.length));return concat$2([t,e],t.length+e.length)}function bytes2str(n){const e=varint$2.decode(n);if(n=n.slice(varint$2.decode.bytes),n.length!==e)throw new Error("inconsistent lengths");return toString$7(n)}function mh2bytes(n){let e;n[0]==="Q"||n[0]==="1"?e=decode$h(base58btc$3.decode(`z${n}`)).bytes:e=CID$1.parse(n).multihash.bytes;const t=Uint8Array.from(varint$2.encode(e.length));return concat$2([t,e],t.length+e.length)}function mb2bytes(n){const e=anybaseDecoder.decode(n),t=Uint8Array.from(varint$2.encode(e.length));return concat$2([t,e],t.length+e.length)}function bytes2mb(n){const e=varint$2.decode(n),t=n.slice(varint$2.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return"u"+toString$7(t,"base64url")}function bytes2mh(n){const e=varint$2.decode(n),t=n.slice(varint$2.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return toString$7(t,"base58btc")}function onion2bytes(n){const e=n.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);const t=base32$6.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const o=port2bytes(i);return concat$2([t,o],t.length+o.length)}function onion32bytes(n){const e=n.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);const t=base32$6.decode(`b${e[0]}`),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const o=port2bytes(i);return concat$2([t,o],t.length+o.length)}function bytes2onion(n){const e=n.slice(0,n.length-2),t=n.slice(n.length-2),i=toString$7(e,"base32"),o=bytes2port(t);return`${i}:${o}`}function stringToStringTuples(n){const e=[],t=n.split("/").slice(1);if(t.length===1&&t[0]==="")return[];for(let i=0;i<t.length;i++){const o=t[i],a=getProtocol(o);if(a.size===0){e.push([o]);continue}if(i++,i>=t.length)throw ParseError("invalid address: "+n);if(a.path===!0){e.push([o,cleanPath(t.slice(i).join("/"))]);break}e.push([o,t[i]])}return e}function stringTuplesToString(n){const e=[];return n.map(t=>{const i=protoFromTuple(t);return e.push(i.name),t.length>1&&t[1]!=null&&e.push(t[1]),null}),cleanPath(e.join("/"))}function stringTuplesToTuples(n){return n.map(e=>{Array.isArray(e)||(e=[e]);const t=protoFromTuple(e);return e.length>1?[t.code,convertToBytes(t.code,e[1])]:[t.code]})}function tuplesToStringTuples(n){return n.map(e=>{const t=protoFromTuple(e);return e[1]!=null?[t.code,convertToString(t.code,e[1])]:[t.code]})}function tuplesToBytes(n){return fromBytes$1(concat$2(n.map(e=>{const t=protoFromTuple(e);let i=Uint8Array.from(varint$2.encode(t.code));return e.length>1&&e[1]!=null&&(i=concat$2([i,e[1]])),i})))}function sizeForAddr(n,e){return n.size>0?n.size/8:n.size===0?0:varint$2.decode(e)+(varint$2.decode.bytes??0)}function bytesToTuples(n){const e=[];let t=0;for(;t<n.length;){const i=varint$2.decode(n,t),o=varint$2.decode.bytes??0,a=getProtocol(i),c=sizeForAddr(a,n.slice(t+o));if(c===0){e.push([i]),t+=o;continue}const u=n.slice(t+o,t+o+c);if(t+=c+o,t>n.length)throw ParseError("Invalid address Uint8Array: "+toString$7(n,"base16"));e.push([i,u])}return e}function bytesToString(n){const e=bytesToTuples(n),t=tuplesToStringTuples(e);return stringTuplesToString(t)}function stringToBytes(n){n=cleanPath(n);const e=stringToStringTuples(n),t=stringTuplesToTuples(e);return tuplesToBytes(t)}function fromString$5(n){return stringToBytes(n)}function fromBytes$1(n){const e=validateBytes(n);if(e!=null)throw e;return Uint8Array.from(n)}function validateBytes(n){try{bytesToTuples(n)}catch(e){return e}}function cleanPath(n){return"/"+n.trim().split("/").filter(e=>e).join("/")}function ParseError(n){return new Error("Error parsing address: "+n)}function protoFromTuple(n){return getProtocol(n[0])}function equals$3(n,e){if(n===e)return!0;if(n.byteLength!==e.byteLength)return!1;for(let t=0;t<n.byteLength;t++)if(n[t]!==e[t])return!1;return!0}var __classPrivateFieldGet$3=globalThis&&globalThis.__classPrivateFieldGet||function(n,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(n):i?i.value:e.get(n)},__classPrivateFieldSet$2=globalThis&&globalThis.__classPrivateFieldSet||function(n,e,t,i,o){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!o:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?o.call(n,t):o?o.value=t:e.set(n,t),t},_DefaultMultiaddr_string,_DefaultMultiaddr_tuples,_DefaultMultiaddr_stringTuples,_a;const inspect$1=Symbol.for("nodejs.util.inspect.custom"),DNS_CODES=[getProtocol("dns").code,getProtocol("dns4").code,getProtocol("dns6").code,getProtocol("dnsaddr").code],resolvers=new Map,symbol=Symbol.for("@multiformats/js-multiaddr/multiaddr");function isMultiaddr(n){return!!n?.[symbol]}class DefaultMultiaddr{constructor(e){if(_DefaultMultiaddr_string.set(this,void 0),_DefaultMultiaddr_tuples.set(this,void 0),_DefaultMultiaddr_stringTuples.set(this,void 0),this[_a]=!0,e==null&&(e=""),e instanceof Uint8Array)this.bytes=fromBytes$1(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=fromString$5(e)}else if(isMultiaddr(e))this.bytes=fromBytes$1(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return __classPrivateFieldGet$3(this,_DefaultMultiaddr_string,"f")==null&&__classPrivateFieldSet$2(this,_DefaultMultiaddr_string,bytesToString(this.bytes),"f"),__classPrivateFieldGet$3(this,_DefaultMultiaddr_string,"f")}toJSON(){return this.toString()}toOptions(){let e,t,i,o,a="";const c=getProtocol("tcp"),u=getProtocol("udp"),d=getProtocol("ip4"),p=getProtocol("ip6"),h=getProtocol("dns6"),b=getProtocol("ip6zone");for(const[v,_]of this.stringTuples())v===b.code&&(a=`%${_??""}`),DNS_CODES.includes(v)&&(t=c.name,o=443,i=`${_??""}${a}`,e=v===h.code?6:4),(v===c.code||v===u.code)&&(t=getProtocol(v).name,o=parseInt(_??"")),(v===d.code||v===p.code)&&(t=getProtocol(v).name,i=`${_??""}${a}`,e=v===p.code?6:4);if(e==null||t==null||i==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:i,transport:t,port:o}}protos(){return this.protoCodes().map(e=>Object.assign({},getProtocol(e)))}protoCodes(){const e=[],t=this.bytes;let i=0;for(;i<t.length;){const o=varint$2.decode(t,i),a=varint$2.decode.bytes??0,c=getProtocol(o),u=sizeForAddr(c,t.slice(i+a));i+=u+a,e.push(o)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return __classPrivateFieldGet$3(this,_DefaultMultiaddr_tuples,"f")==null&&__classPrivateFieldSet$2(this,_DefaultMultiaddr_tuples,bytesToTuples(this.bytes),"f"),__classPrivateFieldGet$3(this,_DefaultMultiaddr_tuples,"f")}stringTuples(){return __classPrivateFieldGet$3(this,_DefaultMultiaddr_stringTuples,"f")==null&&__classPrivateFieldSet$2(this,_DefaultMultiaddr_stringTuples,tuplesToStringTuples(this.tuples()),"f"),__classPrivateFieldGet$3(this,_DefaultMultiaddr_stringTuples,"f")}encapsulate(e){return e=new DefaultMultiaddr(e),new DefaultMultiaddr(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),i=this.toString(),o=i.lastIndexOf(t);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new DefaultMultiaddr(i.slice(0,o))}decapsulateCode(e){const t=this.tuples();for(let i=t.length-1;i>=0;i--)if(t[i][0]===e)return new DefaultMultiaddr(tuplesToBytes(t.slice(0,i)));return this}getPeerId(){try{const t=this.stringTuples().filter(i=>i[0]===names.ipfs.code).pop();if(t?.[1]!=null){const i=t[1];return i[0]==="Q"||i[0]==="1"?toString$7(base58btc$3.decode(`z${i}`),"base58btc"):toString$7(CID$1.parse(i).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(t=>getProtocol(t[0]).path===!0)[0][1],e==null&&(e=null)}catch{e=null}return e}equals(e){return equals$3(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find(a=>a.resolvable);if(t==null)return[this];const i=resolvers.get(t.name);if(i==null)throw errcode(new Error(`no available resolver for ${t.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await i(this,e)).map(a=>new DefaultMultiaddr(a))}nodeAddress(){const e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}[(_DefaultMultiaddr_string=new WeakMap,_DefaultMultiaddr_tuples=new WeakMap,_DefaultMultiaddr_stringTuples=new WeakMap,_a=symbol,inspect$1)](){return`Multiaddr(${bytesToString(this.bytes)})`}}function multiaddr(n){return new DefaultMultiaddr(n)}function toString$5(n,e="utf8"){const t=BASES$2[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):t.encoder.encode(n).substring(1)}let nanoid=(n=21)=>crypto.getRandomValues(new Uint8Array(n)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");const pathSepS="/",pathSepB=new TextEncoder().encode(pathSepS),pathSep=pathSepB[0];class Key{constructor(e,t){if(typeof e=="string")this._buf=fromString$7(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==pathSep)throw new Error("Invalid key")}toString(e="utf8"){return toString$5(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Key(e.join(pathSepS))}static random(){return new Key(nanoid().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new Key(e):typeof e.uint8Array=="function"?new Key(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=pathSepB),this._buf[0]!==pathSep){const e=new Uint8Array(this._buf.byteLength+1);e.fill(pathSep,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===pathSep;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),i=e.list();for(let o=0;o<t.length;o++){if(i.length<o+1)return!1;const a=t[o],c=i[o];if(a<c)return!0;if(a>c)return!1}return t.length<i.length}reverse(){return Key.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(pathSepS).slice(1)}type(){return namespaceType(this.baseNamespace())}name(){return namespaceValue(this.baseNamespace())}instance(e){return new Key(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(pathSepS)||(e+=pathSepS),e+=this.type(),new Key(e)}parent(){const e=this.list();return e.length===1?new Key(pathSepS):new Key(e.slice(0,-1).join(pathSepS))}child(e){return this.toString()===pathSepS?e:e.toString()===pathSepS?this:new Key(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return Key.withNamespaces([...this.namespaces(),...flatten(e.map(t=>t.namespaces()))])}}function namespaceType(n){const e=n.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function namespaceValue(n){const e=n.split(":");return e[e.length-1]}function flatten(n){return[].concat(...n)}var eventemitter3={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function o(d,p,h){this.fn=d,this.context=p,this.once=h||!1}function a(d,p,h,b,m){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new o(h,b||d,m),_=t?t+p:p;return d._events[_]?d._events[_].fn?d._events[_]=[d._events[_],v]:d._events[_].push(v):(d._events[_]=v,d._eventsCount++),d}function c(d,p){--d._eventsCount===0?d._events=new i:delete d._events[p]}function u(){this._events=new i,this._eventsCount=0}u.prototype.eventNames=function(){var p=[],h,b;if(this._eventsCount===0)return p;for(b in h=this._events)e.call(h,b)&&p.push(t?b.slice(1):b);return Object.getOwnPropertySymbols?p.concat(Object.getOwnPropertySymbols(h)):p},u.prototype.listeners=function(p){var h=t?t+p:p,b=this._events[h];if(!b)return[];if(b.fn)return[b.fn];for(var m=0,v=b.length,_=new Array(v);m<v;m++)_[m]=b[m].fn;return _},u.prototype.listenerCount=function(p){var h=t?t+p:p,b=this._events[h];return b?b.fn?1:b.length:0},u.prototype.emit=function(p,h,b,m,v,_){var $=t?t+p:p;if(!this._events[$])return!1;var k=this._events[$],D=arguments.length,O,H;if(k.fn){switch(k.once&&this.removeListener(p,k.fn,void 0,!0),D){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,h),!0;case 3:return k.fn.call(k.context,h,b),!0;case 4:return k.fn.call(k.context,h,b,m),!0;case 5:return k.fn.call(k.context,h,b,m,v),!0;case 6:return k.fn.call(k.context,h,b,m,v,_),!0}for(H=1,O=new Array(D-1);H<D;H++)O[H-1]=arguments[H];k.fn.apply(k.context,O)}else{var j=k.length,W;for(H=0;H<j;H++)switch(k[H].once&&this.removeListener(p,k[H].fn,void 0,!0),D){case 1:k[H].fn.call(k[H].context);break;case 2:k[H].fn.call(k[H].context,h);break;case 3:k[H].fn.call(k[H].context,h,b);break;case 4:k[H].fn.call(k[H].context,h,b,m);break;default:if(!O)for(W=1,O=new Array(D-1);W<D;W++)O[W-1]=arguments[W];k[H].fn.apply(k[H].context,O)}}return!0},u.prototype.on=function(p,h,b){return a(this,p,h,b,!1)},u.prototype.once=function(p,h,b){return a(this,p,h,b,!0)},u.prototype.removeListener=function(p,h,b,m){var v=t?t+p:p;if(!this._events[v])return this;if(!h)return c(this,v),this;var _=this._events[v];if(_.fn)_.fn===h&&(!m||_.once)&&(!b||_.context===b)&&c(this,v);else{for(var $=0,k=[],D=_.length;$<D;$++)(_[$].fn!==h||m&&!_[$].once||b&&_[$].context!==b)&&k.push(_[$]);k.length?this._events[v]=k.length===1?k[0]:k:c(this,v)}return this},u.prototype.removeAllListeners=function(p){var h;return p?(h=t?t+p:p,this._events[h]&&c(this,h)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=t,u.EventEmitter=u,n.exports=u})(eventemitter3);var eventemitter3Exports=eventemitter3.exports;const EventEmitter$3=getDefaultExportFromCjs(eventemitter3Exports);let TimeoutError$1=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},AbortError$2=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}};const getDOMException$1=n=>globalThis.DOMException===void 0?new AbortError$2(n):new DOMException(n),getAbortedReason$1=n=>{const e=n.reason===void 0?getDOMException$1("This operation was aborted."):n.reason;return e instanceof Error?e:getDOMException$1(e)};function pTimeout$1(n,e,t,i){let o;const a=new Promise((c,u)=>{if(typeof e!="number"||Math.sign(e)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e===Number.POSITIVE_INFINITY){c(n);return}if(i={customTimers:{setTimeout,clearTimeout},...i},i.signal){const{signal:d}=i;d.aborted&&u(getAbortedReason$1(d)),d.addEventListener("abort",()=>{u(getAbortedReason$1(d))})}o=i.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{c(t())}catch(h){u(h)}return}const d=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,p=t instanceof Error?t:new TimeoutError$1(d);typeof n.cancel=="function"&&n.cancel(),u(p)},e),(async()=>{try{c(await n)}catch(d){u(d)}finally{i.customTimers.clearTimeout.call(void 0,o)}})()});return a.clear=()=>{clearTimeout(o),o=void 0},a}function lowerBound(n,e,t){let i=0,o=n.length;for(;o>0;){const a=Math.trunc(o/2);let c=i+a;t(n[c],e)<=0?(i=++c,o-=a+1):o=a}return i}var __classPrivateFieldGet$2=globalThis&&globalThis.__classPrivateFieldGet||function(n,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(n):i?i.value:e.get(n)},_PriorityQueue_queue;class PriorityQueue{constructor(){_PriorityQueue_queue.set(this,[])}enqueue(e,t){t={priority:0,...t};const i={priority:t.priority,run:e};if(this.size&&__classPrivateFieldGet$2(this,_PriorityQueue_queue,"f")[this.size-1].priority>=t.priority){__classPrivateFieldGet$2(this,_PriorityQueue_queue,"f").push(i);return}const o=lowerBound(__classPrivateFieldGet$2(this,_PriorityQueue_queue,"f"),i,(a,c)=>c.priority-a.priority);__classPrivateFieldGet$2(this,_PriorityQueue_queue,"f").splice(o,0,i)}dequeue(){const e=__classPrivateFieldGet$2(this,_PriorityQueue_queue,"f").shift();return e?.run}filter(e){return __classPrivateFieldGet$2(this,_PriorityQueue_queue,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return __classPrivateFieldGet$2(this,_PriorityQueue_queue,"f").length}}_PriorityQueue_queue=new WeakMap;var __classPrivateFieldSet$1=globalThis&&globalThis.__classPrivateFieldSet||function(n,e,t,i,o){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!o:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?o.call(n,t):o?o.value=t:e.set(n,t),t},__classPrivateFieldGet$1=globalThis&&globalThis.__classPrivateFieldGet||function(n,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(n):i?i.value:e.get(n)},_PQueue_instances,_PQueue_carryoverConcurrencyCount,_PQueue_isIntervalIgnored,_PQueue_intervalCount,_PQueue_intervalCap,_PQueue_interval,_PQueue_intervalEnd,_PQueue_intervalId,_PQueue_timeoutId,_PQueue_queue,_PQueue_queueClass,_PQueue_pending,_PQueue_concurrency,_PQueue_isPaused,_PQueue_throwOnTimeout,_PQueue_doesIntervalAllowAnother_get,_PQueue_doesConcurrentAllowAnother_get,_PQueue_next,_PQueue_onResumeInterval,_PQueue_isIntervalPaused_get,_PQueue_tryToStartAnother,_PQueue_initializeIntervalIfNeeded,_PQueue_onInterval,_PQueue_processQueue,_PQueue_throwOnAbort,_PQueue_onEvent;let AbortError$1=class extends Error{};class PQueue extends EventEmitter$3{constructor(e){var t,i,o,a;if(super(),_PQueue_instances.add(this),_PQueue_carryoverConcurrencyCount.set(this,void 0),_PQueue_isIntervalIgnored.set(this,void 0),_PQueue_intervalCount.set(this,0),_PQueue_intervalCap.set(this,void 0),_PQueue_interval.set(this,void 0),_PQueue_intervalEnd.set(this,0),_PQueue_intervalId.set(this,void 0),_PQueue_timeoutId.set(this,void 0),_PQueue_queue.set(this,void 0),_PQueue_queueClass.set(this,void 0),_PQueue_pending.set(this,0),_PQueue_concurrency.set(this,void 0),_PQueue_isPaused.set(this,void 0),_PQueue_throwOnTimeout.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:PriorityQueue,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(a=(o=e.interval)===null||o===void 0?void 0:o.toString())!==null&&a!==void 0?a:""}\` (${typeof e.interval})`);__classPrivateFieldSet$1(this,_PQueue_carryoverConcurrencyCount,e.carryoverConcurrencyCount,"f"),__classPrivateFieldSet$1(this,_PQueue_isIntervalIgnored,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),__classPrivateFieldSet$1(this,_PQueue_intervalCap,e.intervalCap,"f"),__classPrivateFieldSet$1(this,_PQueue_interval,e.interval,"f"),__classPrivateFieldSet$1(this,_PQueue_queue,new e.queueClass,"f"),__classPrivateFieldSet$1(this,_PQueue_queueClass,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,__classPrivateFieldSet$1(this,_PQueue_throwOnTimeout,e.throwOnTimeout===!0,"f"),__classPrivateFieldSet$1(this,_PQueue_isPaused,e.autoStart===!1,"f")}get concurrency(){return __classPrivateFieldGet$1(this,_PQueue_concurrency,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);__classPrivateFieldSet$1(this,_PQueue_concurrency,e,"f"),__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_processQueue).call(this)}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:__classPrivateFieldGet$1(this,_PQueue_throwOnTimeout,"f"),...t},new Promise((i,o)=>{__classPrivateFieldGet$1(this,_PQueue_queue,"f").enqueue(async()=>{var a,c,u;__classPrivateFieldSet$1(this,_PQueue_pending,(c=__classPrivateFieldGet$1(this,_PQueue_pending,"f"),c++,c),"f"),__classPrivateFieldSet$1(this,_PQueue_intervalCount,(u=__classPrivateFieldGet$1(this,_PQueue_intervalCount,"f"),u++,u),"f");try{if(!((a=t.signal)===null||a===void 0)&&a.aborted)throw new AbortError$1("The task was aborted.");let d=e({signal:t.signal});t.timeout&&(d=pTimeout$1(Promise.resolve(d),t.timeout)),t.signal&&(d=Promise.race([d,__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_throwOnAbort).call(this,t.signal)]));const p=await d;i(p),this.emit("completed",p)}catch(d){if(d instanceof TimeoutError$1&&!t.throwOnTimeout){i();return}o(d),this.emit("error",d)}finally{__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_next).call(this)}},t),this.emit("add"),__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this)})}async addAll(e,t){return Promise.all(e.map(async i=>this.add(i,t)))}start(){return __classPrivateFieldGet$1(this,_PQueue_isPaused,"f")?(__classPrivateFieldSet$1(this,_PQueue_isPaused,!1,"f"),__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_processQueue).call(this),this):this}pause(){__classPrivateFieldSet$1(this,_PQueue_isPaused,!0,"f")}clear(){__classPrivateFieldSet$1(this,_PQueue_queue,new(__classPrivateFieldGet$1(this,_PQueue_queueClass,"f")),"f")}async onEmpty(){__classPrivateFieldGet$1(this,_PQueue_queue,"f").size!==0&&await __classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"empty")}async onSizeLessThan(e){__classPrivateFieldGet$1(this,_PQueue_queue,"f").size<e||await __classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"next",()=>__classPrivateFieldGet$1(this,_PQueue_queue,"f").size<e)}async onIdle(){__classPrivateFieldGet$1(this,_PQueue_pending,"f")===0&&__classPrivateFieldGet$1(this,_PQueue_queue,"f").size===0||await __classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"idle")}get size(){return __classPrivateFieldGet$1(this,_PQueue_queue,"f").size}sizeBy(e){return __classPrivateFieldGet$1(this,_PQueue_queue,"f").filter(e).length}get pending(){return __classPrivateFieldGet$1(this,_PQueue_pending,"f")}get isPaused(){return __classPrivateFieldGet$1(this,_PQueue_isPaused,"f")}}_PQueue_carryoverConcurrencyCount=new WeakMap,_PQueue_isIntervalIgnored=new WeakMap,_PQueue_intervalCount=new WeakMap,_PQueue_intervalCap=new WeakMap,_PQueue_interval=new WeakMap,_PQueue_intervalEnd=new WeakMap,_PQueue_intervalId=new WeakMap,_PQueue_timeoutId=new WeakMap,_PQueue_queue=new WeakMap,_PQueue_queueClass=new WeakMap,_PQueue_pending=new WeakMap,_PQueue_concurrency=new WeakMap,_PQueue_isPaused=new WeakMap,_PQueue_throwOnTimeout=new WeakMap,_PQueue_instances=new WeakSet,_PQueue_doesIntervalAllowAnother_get=function n(){return __classPrivateFieldGet$1(this,_PQueue_isIntervalIgnored,"f")||__classPrivateFieldGet$1(this,_PQueue_intervalCount,"f")<__classPrivateFieldGet$1(this,_PQueue_intervalCap,"f")},_PQueue_doesConcurrentAllowAnother_get=function n(){return __classPrivateFieldGet$1(this,_PQueue_pending,"f")<__classPrivateFieldGet$1(this,_PQueue_concurrency,"f")},_PQueue_next=function n(){var e;__classPrivateFieldSet$1(this,_PQueue_pending,(e=__classPrivateFieldGet$1(this,_PQueue_pending,"f"),e--,e),"f"),__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this),this.emit("next")},_PQueue_onResumeInterval=function n(){__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_onInterval).call(this),__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_initializeIntervalIfNeeded).call(this),__classPrivateFieldSet$1(this,_PQueue_timeoutId,void 0,"f")},_PQueue_isIntervalPaused_get=function n(){const e=Date.now();if(__classPrivateFieldGet$1(this,_PQueue_intervalId,"f")===void 0){const t=__classPrivateFieldGet$1(this,_PQueue_intervalEnd,"f")-e;if(t<0)__classPrivateFieldSet$1(this,_PQueue_intervalCount,__classPrivateFieldGet$1(this,_PQueue_carryoverConcurrencyCount,"f")?__classPrivateFieldGet$1(this,_PQueue_pending,"f"):0,"f");else return __classPrivateFieldGet$1(this,_PQueue_timeoutId,"f")===void 0&&__classPrivateFieldSet$1(this,_PQueue_timeoutId,setTimeout(()=>{__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_onResumeInterval).call(this)},t),"f"),!0}return!1},_PQueue_tryToStartAnother=function n(){if(__classPrivateFieldGet$1(this,_PQueue_queue,"f").size===0)return __classPrivateFieldGet$1(this,_PQueue_intervalId,"f")&&clearInterval(__classPrivateFieldGet$1(this,_PQueue_intervalId,"f")),__classPrivateFieldSet$1(this,_PQueue_intervalId,void 0,"f"),this.emit("empty"),__classPrivateFieldGet$1(this,_PQueue_pending,"f")===0&&this.emit("idle"),!1;if(!__classPrivateFieldGet$1(this,_PQueue_isPaused,"f")){const e=!__classPrivateFieldGet$1(this,_PQueue_instances,"a",_PQueue_isIntervalPaused_get);if(__classPrivateFieldGet$1(this,_PQueue_instances,"a",_PQueue_doesIntervalAllowAnother_get)&&__classPrivateFieldGet$1(this,_PQueue_instances,"a",_PQueue_doesConcurrentAllowAnother_get)){const t=__classPrivateFieldGet$1(this,_PQueue_queue,"f").dequeue();return t?(this.emit("active"),t(),e&&__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_initializeIntervalIfNeeded).call(this),!0):!1}}return!1},_PQueue_initializeIntervalIfNeeded=function n(){__classPrivateFieldGet$1(this,_PQueue_isIntervalIgnored,"f")||__classPrivateFieldGet$1(this,_PQueue_intervalId,"f")!==void 0||(__classPrivateFieldSet$1(this,_PQueue_intervalId,setInterval(()=>{__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_onInterval).call(this)},__classPrivateFieldGet$1(this,_PQueue_interval,"f")),"f"),__classPrivateFieldSet$1(this,_PQueue_intervalEnd,Date.now()+__classPrivateFieldGet$1(this,_PQueue_interval,"f"),"f"))},_PQueue_onInterval=function n(){__classPrivateFieldGet$1(this,_PQueue_intervalCount,"f")===0&&__classPrivateFieldGet$1(this,_PQueue_pending,"f")===0&&__classPrivateFieldGet$1(this,_PQueue_intervalId,"f")&&(clearInterval(__classPrivateFieldGet$1(this,_PQueue_intervalId,"f")),__classPrivateFieldSet$1(this,_PQueue_intervalId,void 0,"f")),__classPrivateFieldSet$1(this,_PQueue_intervalCount,__classPrivateFieldGet$1(this,_PQueue_carryoverConcurrencyCount,"f")?__classPrivateFieldGet$1(this,_PQueue_pending,"f"):0,"f"),__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_processQueue).call(this)},_PQueue_processQueue=function n(){for(;__classPrivateFieldGet$1(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this););},_PQueue_throwOnAbort=async function n(e){return new Promise((t,i)=>{e.addEventListener("abort",()=>{i(new AbortError$1("The task was aborted."))},{once:!0})})},_PQueue_onEvent=async function n(e,t){return new Promise(i=>{const o=()=>{t&&!t()||(this.off(e,o),i())};this.on(e,o)})};const all$2=async n=>{const e=[];for await(const t of n)e.push(t);return e};var itAll=all$2;const all$3=getDefaultExportFromCjs(itAll);function dbOpenFailedError(n){return n=n||new Error("Cannot open database"),errcode(n,"ERR_DB_OPEN_FAILED")}function dbDeleteFailedError(n){return n=n||new Error("Delete failed"),errcode(n,"ERR_DB_DELETE_FAILED")}function dbWriteFailedError(n){return n=n||new Error("Write failed"),errcode(n,"ERR_DB_WRITE_FAILED")}function notFoundError(n){return n=n||new Error("Not Found"),errcode(n,"ERR_NOT_FOUND")}var cryptoBrowserify={},browser$b={exports:{}},safeBuffer={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(n,e){var t=buffer$2,i=t.Buffer;function o(c,u){for(var d in c)u[d]=c[d]}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?n.exports=t:(o(t,e),e.Buffer=a);function a(c,u,d){return i(c,u,d)}a.prototype=Object.create(i.prototype),o(i,a),a.from=function(c,u,d){if(typeof c=="number")throw new TypeError("Argument must not be a number");return i(c,u,d)},a.alloc=function(c,u,d){if(typeof c!="number")throw new TypeError("Argument must be a number");var p=i(c);return u!==void 0?typeof d=="string"?p.fill(u,d):p.fill(u):p.fill(0),p},a.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return i(c)},a.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(c)}})(safeBuffer,safeBuffer.exports);var safeBufferExports=safeBuffer.exports,hasRequiredBrowser$b;function requireBrowser$b(){if(hasRequiredBrowser$b)return browser$b.exports;hasRequiredBrowser$b=1;var n=65536,e=4294967295;function t(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var i=safeBufferExports.Buffer,o=commonjsGlobal.crypto||commonjsGlobal.msCrypto;o&&o.getRandomValues?browser$b.exports=a:browser$b.exports=t;function a(c,u){if(c>e)throw new RangeError("requested too many random bytes");var d=i.allocUnsafe(c);if(c>0)if(c>n)for(var p=0;p<c;p+=n)o.getRandomValues(d.slice(p,p+n));else o.getRandomValues(d);return typeof u=="function"?process$3.nextTick(function(){u(null,d)}):d}return browser$b.exports}var inherits_browser={exports:{}};typeof Object.create=="function"?inherits_browser.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}};var inherits_browserExports=inherits_browser.exports,readableBrowser={exports:{}},events$1={exports:{}},R=typeof Reflect=="object"?Reflect:null,ReflectApply=R&&typeof R.apply=="function"?R.apply:function n(e,t,i){return Function.prototype.apply.call(e,t,i)},ReflectOwnKeys;R&&typeof R.ownKeys=="function"?ReflectOwnKeys=R.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ReflectOwnKeys=function(e){return Object.getOwnPropertyNames(e)};function ProcessEmitWarning(n){console&&console.warn&&console.warn(n)}var NumberIsNaN=Number.isNaN||function n(e){return e!==e};function EventEmitter$2(){EventEmitter$2.init.call(this)}events$1.exports=EventEmitter$2;events$1.exports.once=once;EventEmitter$2.EventEmitter=EventEmitter$2;EventEmitter$2.prototype._events=void 0;EventEmitter$2.prototype._eventsCount=0;EventEmitter$2.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(EventEmitter$2,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(n){if(typeof n!="number"||n<0||NumberIsNaN(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");defaultMaxListeners=n}});EventEmitter$2.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};EventEmitter$2.prototype.setMaxListeners=function n(e){if(typeof e!="number"||e<0||NumberIsNaN(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function _getMaxListeners(n){return n._maxListeners===void 0?EventEmitter$2.defaultMaxListeners:n._maxListeners}EventEmitter$2.prototype.getMaxListeners=function n(){return _getMaxListeners(this)};EventEmitter$2.prototype.emit=function n(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var o=e==="error",a=this._events;if(a!==void 0)o=o&&a.error===void 0;else if(!o)return!1;if(o){var c;if(t.length>0&&(c=t[0]),c instanceof Error)throw c;var u=new Error("Unhandled error."+(c?" ("+c.message+")":""));throw u.context=c,u}var d=a[e];if(d===void 0)return!1;if(typeof d=="function")ReflectApply(d,this,t);else for(var p=d.length,h=arrayClone(d,p),i=0;i<p;++i)ReflectApply(h[i],this,t);return!0};function _addListener(n,e,t,i){var o,a,c;if(checkListener(t),a=n._events,a===void 0?(a=n._events=Object.create(null),n._eventsCount=0):(a.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),a=n._events),c=a[e]),c===void 0)c=a[e]=t,++n._eventsCount;else if(typeof c=="function"?c=a[e]=i?[t,c]:[c,t]:i?c.unshift(t):c.push(t),o=_getMaxListeners(n),o>0&&c.length>o&&!c.warned){c.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=n,u.type=e,u.count=c.length,ProcessEmitWarning(u)}return n}EventEmitter$2.prototype.addListener=function n(e,t){return _addListener(this,e,t,!1)};EventEmitter$2.prototype.on=EventEmitter$2.prototype.addListener;EventEmitter$2.prototype.prependListener=function n(e,t){return _addListener(this,e,t,!0)};function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(n,e,t){var i={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},o=onceWrapper.bind(i);return o.listener=t,i.wrapFn=o,o}EventEmitter$2.prototype.once=function n(e,t){return checkListener(t),this.on(e,_onceWrap(this,e,t)),this};EventEmitter$2.prototype.prependOnceListener=function n(e,t){return checkListener(t),this.prependListener(e,_onceWrap(this,e,t)),this};EventEmitter$2.prototype.removeListener=function n(e,t){var i,o,a,c,u;if(checkListener(t),o=this._events,o===void 0)return this;if(i=o[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(a=-1,c=i.length-1;c>=0;c--)if(i[c]===t||i[c].listener===t){u=i[c].listener,a=c;break}if(a<0)return this;a===0?i.shift():spliceOne(i,a),i.length===1&&(o[e]=i[0]),o.removeListener!==void 0&&this.emit("removeListener",e,u||t)}return this};EventEmitter$2.prototype.off=EventEmitter$2.prototype.removeListener;EventEmitter$2.prototype.removeAllListeners=function n(e){var t,i,o;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var a=Object.keys(i),c;for(o=0;o<a.length;++o)c=a[o],c!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this};function _listeners(n,e,t){var i=n._events;if(i===void 0)return[];var o=i[e];return o===void 0?[]:typeof o=="function"?t?[o.listener||o]:[o]:t?unwrapListeners(o):arrayClone(o,o.length)}EventEmitter$2.prototype.listeners=function n(e){return _listeners(this,e,!0)};EventEmitter$2.prototype.rawListeners=function n(e){return _listeners(this,e,!1)};EventEmitter$2.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):listenerCount.call(n,e)};EventEmitter$2.prototype.listenerCount=listenerCount;function listenerCount(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}EventEmitter$2.prototype.eventNames=function n(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(n,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=n[i];return t}function spliceOne(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function unwrapListeners(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function once(n,e){return new Promise(function(t,i){function o(c){n.removeListener(e,a),i(c)}function a(){typeof n.removeListener=="function"&&n.removeListener("error",o),t([].slice.call(arguments))}eventTargetAgnosticAddListener(n,e,a,{once:!0}),e!=="error"&&addErrorHandlerIfEventEmitter(n,o,{once:!0})})}function addErrorHandlerIfEventEmitter(n,e,t){typeof n.on=="function"&&eventTargetAgnosticAddListener(n,"error",e,t)}function eventTargetAgnosticAddListener(n,e,t,i){if(typeof n.on=="function")i.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function o(a){i.once&&n.removeEventListener(e,o),t(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var eventsExports=events$1.exports,streamBrowser,hasRequiredStreamBrowser;function requireStreamBrowser(){return hasRequiredStreamBrowser||(hasRequiredStreamBrowser=1,streamBrowser=eventsExports.EventEmitter),streamBrowser}var util={},types={},shams$1=function n(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var o=42;e[t]=o;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var c=Object.getOwnPropertyDescriptor(e,t);if(c.value!==o||c.enumerable!==!0)return!1}return!0},hasSymbols$2=shams$1,shams=function n(){return hasSymbols$2()&&!!Symbol.toStringTag},origSymbol=typeof Symbol<"u"&&Symbol,hasSymbolSham=shams$1,hasSymbols$1=function n(){return typeof origSymbol!="function"||typeof Symbol!="function"||typeof origSymbol("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:hasSymbolSham()},test={foo:{}},$Object=Object,hasProto$1=function n(){return{__proto__:test}.foo===test.foo&&!({__proto__:null}instanceof $Object)},ERROR_MESSAGE="Function.prototype.bind called on incompatible ",slice=Array.prototype.slice,toStr$3=Object.prototype.toString,funcType="[object Function]",implementation$i=function n(e){var t=this;if(typeof t!="function"||toStr$3.call(t)!==funcType)throw new TypeError(ERROR_MESSAGE+t);for(var i=slice.call(arguments,1),o,a=function(){if(this instanceof o){var h=t.apply(this,i.concat(slice.call(arguments)));return Object(h)===h?h:this}else return t.apply(e,i.concat(slice.call(arguments)))},c=Math.max(0,t.length-i.length),u=[],d=0;d<c;d++)u.push("$"+d);if(o=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(a),t.prototype){var p=function(){};p.prototype=t.prototype,o.prototype=new p,p.prototype=null}return o},implementation$h=implementation$i,functionBind=Function.prototype.bind||implementation$h,bind$1=functionBind,src$2=bind$1.call(Function.call,Object.prototype.hasOwnProperty),undefined$1,$SyntaxError=SyntaxError,$Function=Function,$TypeError=TypeError,getEvalledConstructor=function(n){try{return $Function('"use strict"; return ('+n+").constructor;")()}catch{}},$gOPD$1=Object.getOwnPropertyDescriptor;if($gOPD$1)try{$gOPD$1({},"")}catch{$gOPD$1=null}var throwTypeError=function(){throw new $TypeError},ThrowTypeError=$gOPD$1?function(){try{return arguments.callee,throwTypeError}catch{try{return $gOPD$1(arguments,"callee").get}catch{return throwTypeError}}}():throwTypeError,hasSymbols=hasSymbols$1(),hasProto=hasProto$1(),getProto$1=Object.getPrototypeOf||(hasProto?function(n){return n.__proto__}:null),needsEval={},TypedArray=typeof Uint8Array>"u"||!getProto$1?undefined$1:getProto$1(Uint8Array),INTRINSICS={"%AggregateError%":typeof AggregateError>"u"?undefined$1:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?undefined$1:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols&&getProto$1?getProto$1([][Symbol.iterator]()):undefined$1,"%AsyncFromSyncIteratorPrototype%":undefined$1,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":typeof Atomics>"u"?undefined$1:Atomics,"%BigInt%":typeof BigInt>"u"?undefined$1:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?undefined$1:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?undefined$1:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?undefined$1:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?undefined$1:Float32Array,"%Float64Array%":typeof Float64Array>"u"?undefined$1:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?undefined$1:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":typeof Int8Array>"u"?undefined$1:Int8Array,"%Int16Array%":typeof Int16Array>"u"?undefined$1:Int16Array,"%Int32Array%":typeof Int32Array>"u"?undefined$1:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols&&getProto$1?getProto$1(getProto$1([][Symbol.iterator]())):undefined$1,"%JSON%":typeof JSON=="object"?JSON:undefined$1,"%Map%":typeof Map>"u"?undefined$1:Map,"%MapIteratorPrototype%":typeof Map>"u"||!hasSymbols||!getProto$1?undefined$1:getProto$1(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?undefined$1:Promise,"%Proxy%":typeof Proxy>"u"?undefined$1:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?undefined$1:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?undefined$1:Set,"%SetIteratorPrototype%":typeof Set>"u"||!hasSymbols||!getProto$1?undefined$1:getProto$1(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?undefined$1:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols&&getProto$1?getProto$1(""[Symbol.iterator]()):undefined$1,"%Symbol%":hasSymbols?Symbol:undefined$1,"%SyntaxError%":$SyntaxError,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError,"%Uint8Array%":typeof Uint8Array>"u"?undefined$1:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?undefined$1:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?undefined$1:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?undefined$1:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?undefined$1:WeakMap,"%WeakRef%":typeof WeakRef>"u"?undefined$1:WeakRef,"%WeakSet%":typeof WeakSet>"u"?undefined$1:WeakSet};if(getProto$1)try{null.error}catch(n){var errorProto=getProto$1(getProto$1(n));INTRINSICS["%Error.prototype%"]=errorProto}var doEval=function n(e){var t;if(e==="%AsyncFunction%")t=getEvalledConstructor("async function () {}");else if(e==="%GeneratorFunction%")t=getEvalledConstructor("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=getEvalledConstructor("async function* () {}");else if(e==="%AsyncGenerator%"){var i=n("%AsyncGeneratorFunction%");i&&(t=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var o=n("%AsyncGenerator%");o&&getProto$1&&(t=getProto$1(o.prototype))}return INTRINSICS[e]=t,t},LEGACY_ALIASES={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},bind=functionBind,hasOwn=src$2,$concat=bind.call(Function.call,Array.prototype.concat),$spliceApply=bind.call(Function.apply,Array.prototype.splice),$replace=bind.call(Function.call,String.prototype.replace),$strSlice=bind.call(Function.call,String.prototype.slice),$exec=bind.call(Function.call,RegExp.prototype.exec),rePropName=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=function n(e){var t=$strSlice(e,0,1),i=$strSlice(e,-1);if(t==="%"&&i!=="%")throw new $SyntaxError("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&t!=="%")throw new $SyntaxError("invalid intrinsic syntax, expected opening `%`");var o=[];return $replace(e,rePropName,function(a,c,u,d){o[o.length]=u?$replace(d,reEscapeChar,"$1"):c||a}),o},getBaseIntrinsic=function n(e,t){var i=e,o;if(hasOwn(LEGACY_ALIASES,i)&&(o=LEGACY_ALIASES[i],i="%"+o[0]+"%"),hasOwn(INTRINSICS,i)){var a=INTRINSICS[i];if(a===needsEval&&(a=doEval(i)),typeof a>"u"&&!t)throw new $TypeError("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:o,name:i,value:a}}throw new $SyntaxError("intrinsic "+e+" does not exist!")},getIntrinsic=function n(e,t){if(typeof e!="string"||e.length===0)throw new $TypeError("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new $TypeError('"allowMissing" argument must be a boolean');if($exec(/^%?[^%]*%?$/,e)===null)throw new $SyntaxError("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=stringToPath(e),o=i.length>0?i[0]:"",a=getBaseIntrinsic("%"+o+"%",t),c=a.name,u=a.value,d=!1,p=a.alias;p&&(o=p[0],$spliceApply(i,$concat([0,1],p)));for(var h=1,b=!0;h<i.length;h+=1){var m=i[h],v=$strSlice(m,0,1),_=$strSlice(m,-1);if((v==='"'||v==="'"||v==="`"||_==='"'||_==="'"||_==="`")&&v!==_)throw new $SyntaxError("property names with quotes must have matching quotes");if((m==="constructor"||!b)&&(d=!0),o+="."+m,c="%"+o+"%",hasOwn(INTRINSICS,c))u=INTRINSICS[c];else if(u!=null){if(!(m in u)){if(!t)throw new $TypeError("base intrinsic for "+e+" exists, but the property is not available.");return}if($gOPD$1&&h+1>=i.length){var $=$gOPD$1(u,m);b=!!$,b&&"get"in $&&!("originalValue"in $.get)?u=$.get:u=u[m]}else b=hasOwn(u,m),u=u[m];b&&!d&&(INTRINSICS[c]=u)}}return u},callBind$1={exports:{}};(function(n){var e=functionBind,t=getIntrinsic,i=t("%Function.prototype.apply%"),o=t("%Function.prototype.call%"),a=t("%Reflect.apply%",!0)||e.call(o,i),c=t("%Object.getOwnPropertyDescriptor%",!0),u=t("%Object.defineProperty%",!0),d=t("%Math.max%");if(u)try{u({},"a",{value:1})}catch{u=null}n.exports=function(b){var m=a(e,o,arguments);if(c&&u){var v=c(m,"length");v.configurable&&u(m,"length",{value:1+d(0,b.length-(arguments.length-1))})}return m};var p=function(){return a(e,i,arguments)};u?u(n.exports,"apply",{value:p}):n.exports.apply=p})(callBind$1);var callBindExports=callBind$1.exports,GetIntrinsic$1=getIntrinsic,callBind=callBindExports,$indexOf$1=callBind(GetIntrinsic$1("String.prototype.indexOf")),callBound$3=function n(e,t){var i=GetIntrinsic$1(e,!!t);return typeof i=="function"&&$indexOf$1(e,".prototype.")>-1?callBind(i):i},hasToStringTag$4=shams(),callBound$2=callBound$3,$toString$2=callBound$2("Object.prototype.toString"),isStandardArguments=function n(e){return hasToStringTag$4&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:$toString$2(e)==="[object Arguments]"},isLegacyArguments=function n(e){return isStandardArguments(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&$toString$2(e)!=="[object Array]"&&$toString$2(e.callee)==="[object Function]"},supportsStandardArguments=function(){return isStandardArguments(arguments)}();isStandardArguments.isLegacyArguments=isLegacyArguments;var isArguments=supportsStandardArguments?isStandardArguments:isLegacyArguments,toStr$2=Object.prototype.toString,fnToStr$1=Function.prototype.toString,isFnRegex=/^\s*(?:function)?\*/,hasToStringTag$3=shams(),getProto=Object.getPrototypeOf,getGeneratorFunc=function(){if(!hasToStringTag$3)return!1;try{return Function("return function*() {}")()}catch{}},GeneratorFunction,isGeneratorFunction=function n(e){if(typeof e!="function")return!1;if(isFnRegex.test(fnToStr$1.call(e)))return!0;if(!hasToStringTag$3){var t=toStr$2.call(e);return t==="[object GeneratorFunction]"}if(!getProto)return!1;if(typeof GeneratorFunction>"u"){var i=getGeneratorFunc();GeneratorFunction=i?getProto(i):!1}return getProto(e)===GeneratorFunction},fnToStr=Function.prototype.toString,reflectApply=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,badArrayLike,isCallableMarker;if(typeof reflectApply=="function"&&typeof Object.defineProperty=="function")try{badArrayLike=Object.defineProperty({},"length",{get:function(){throw isCallableMarker}}),isCallableMarker={},reflectApply(function(){throw 42},null,badArrayLike)}catch(n){n!==isCallableMarker&&(reflectApply=null)}else reflectApply=null;var constructorRegex=/^\s*class\b/,isES6ClassFn=function n(e){try{var t=fnToStr.call(e);return constructorRegex.test(t)}catch{return!1}},tryFunctionObject=function n(e){try{return isES6ClassFn(e)?!1:(fnToStr.call(e),!0)}catch{return!1}},toStr$1=Object.prototype.toString,objectClass="[object Object]",fnClass="[object Function]",genClass="[object GeneratorFunction]",ddaClass="[object HTMLAllCollection]",ddaClass2="[object HTML document.all class]",ddaClass3="[object HTMLCollection]",hasToStringTag$2=typeof Symbol=="function"&&!!Symbol.toStringTag,isIE68=!(0 in[,]),isDDA=function n(){return!1};if(typeof document=="object"){var all$1=document.all;toStr$1.call(all$1)===toStr$1.call(document.all)&&(isDDA=function(e){if((isIE68||!e)&&(typeof e>"u"||typeof e=="object"))try{var t=toStr$1.call(e);return(t===ddaClass||t===ddaClass2||t===ddaClass3||t===objectClass)&&e("")==null}catch{}return!1})}var isCallable$1=reflectApply?function n(e){if(isDDA(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;try{reflectApply(e,null,badArrayLike)}catch(t){if(t!==isCallableMarker)return!1}return!isES6ClassFn(e)&&tryFunctionObject(e)}:function n(e){if(isDDA(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;if(hasToStringTag$2)return tryFunctionObject(e);if(isES6ClassFn(e))return!1;var t=toStr$1.call(e);return t!==fnClass&&t!==genClass&&!/^\[object HTML/.test(t)?!1:tryFunctionObject(e)},isCallable=isCallable$1,toStr=Object.prototype.toString,hasOwnProperty$1=Object.prototype.hasOwnProperty,forEachArray=function n(e,t,i){for(var o=0,a=e.length;o<a;o++)hasOwnProperty$1.call(e,o)&&(i==null?t(e[o],o,e):t.call(i,e[o],o,e))},forEachString=function n(e,t,i){for(var o=0,a=e.length;o<a;o++)i==null?t(e.charAt(o),o,e):t.call(i,e.charAt(o),o,e)},forEachObject=function n(e,t,i){for(var o in e)hasOwnProperty$1.call(e,o)&&(i==null?t(e[o],o,e):t.call(i,e[o],o,e))},forEach$2=function n(e,t,i){if(!isCallable(t))throw new TypeError("iterator must be a function");var o;arguments.length>=3&&(o=i),toStr.call(e)==="[object Array]"?forEachArray(e,t,o):typeof e=="string"?forEachString(e,t,o):forEachObject(e,t,o)},forEach_1=forEach$2,possibleNames=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],g$2=typeof globalThis>"u"?commonjsGlobal:globalThis,availableTypedArrays$2=function n(){for(var e=[],t=0;t<possibleNames.length;t++)typeof g$2[possibleNames[t]]=="function"&&(e[e.length]=possibleNames[t]);return e},GetIntrinsic=getIntrinsic,$gOPD=GetIntrinsic("%Object.getOwnPropertyDescriptor%",!0);if($gOPD)try{$gOPD([],"length")}catch{$gOPD=null}var gopd=$gOPD,forEach$1=forEach_1,availableTypedArrays$1=availableTypedArrays$2,callBound$1=callBound$3,$toString$1=callBound$1("Object.prototype.toString"),hasToStringTag$1=shams(),gOPD$1=gopd,g$1=typeof globalThis>"u"?commonjsGlobal:globalThis,typedArrays$1=availableTypedArrays$1(),$indexOf=callBound$1("Array.prototype.indexOf",!0)||function n(e,t){for(var i=0;i<e.length;i+=1)if(e[i]===t)return i;return-1},$slice$1=callBound$1("String.prototype.slice"),toStrTags$1={},getPrototypeOf$1=Object.getPrototypeOf;hasToStringTag$1&&gOPD$1&&getPrototypeOf$1&&forEach$1(typedArrays$1,function(n){var e=new g$1[n];if(Symbol.toStringTag in e){var t=getPrototypeOf$1(e),i=gOPD$1(t,Symbol.toStringTag);if(!i){var o=getPrototypeOf$1(t);i=gOPD$1(o,Symbol.toStringTag)}toStrTags$1[n]=i.get}});var tryTypedArrays$1=function n(e){var t=!1;return forEach$1(toStrTags$1,function(i,o){if(!t)try{t=i.call(e)===o}catch{}}),t},isTypedArray$1=function n(e){if(!e||typeof e!="object")return!1;if(!hasToStringTag$1||!(Symbol.toStringTag in e)){var t=$slice$1($toString$1(e),8,-1);return $indexOf(typedArrays$1,t)>-1}return gOPD$1?tryTypedArrays$1(e):!1},forEach=forEach_1,availableTypedArrays=availableTypedArrays$2,callBound=callBound$3,gOPD=gopd,$toString=callBound("Object.prototype.toString"),hasToStringTag=shams(),g=typeof globalThis>"u"?commonjsGlobal:globalThis,typedArrays=availableTypedArrays(),$slice=callBound("String.prototype.slice"),toStrTags={},getPrototypeOf=Object.getPrototypeOf;hasToStringTag&&gOPD&&getPrototypeOf&&forEach(typedArrays,function(n){if(typeof g[n]=="function"){var e=new g[n];if(Symbol.toStringTag in e){var t=getPrototypeOf(e),i=gOPD(t,Symbol.toStringTag);if(!i){var o=getPrototypeOf(t);i=gOPD(o,Symbol.toStringTag)}toStrTags[n]=i.get}}});var tryTypedArrays=function n(e){var t=!1;return forEach(toStrTags,function(i,o){if(!t)try{var a=i.call(e);a===o&&(t=a)}catch{}}),t},isTypedArray=isTypedArray$1,whichTypedArray=function n(e){return isTypedArray(e)?!hasToStringTag||!(Symbol.toStringTag in e)?$slice($toString(e),8,-1):tryTypedArrays(e):!1};(function(n){var e=isArguments,t=isGeneratorFunction,i=whichTypedArray,o=isTypedArray$1;function a(Me){return Me.call.bind(Me)}var c=typeof BigInt<"u",u=typeof Symbol<"u",d=a(Object.prototype.toString),p=a(Number.prototype.valueOf),h=a(String.prototype.valueOf),b=a(Boolean.prototype.valueOf);if(c)var m=a(BigInt.prototype.valueOf);if(u)var v=a(Symbol.prototype.valueOf);function _(Me,jt){if(typeof Me!="object")return!1;try{return jt(Me),!0}catch{return!1}}n.isArgumentsObject=e,n.isGeneratorFunction=t,n.isTypedArray=o;function $(Me){return typeof Promise<"u"&&Me instanceof Promise||Me!==null&&typeof Me=="object"&&typeof Me.then=="function"&&typeof Me.catch=="function"}n.isPromise=$;function k(Me){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(Me):o(Me)||z(Me)}n.isArrayBufferView=k;function D(Me){return i(Me)==="Uint8Array"}n.isUint8Array=D;function O(Me){return i(Me)==="Uint8ClampedArray"}n.isUint8ClampedArray=O;function H(Me){return i(Me)==="Uint16Array"}n.isUint16Array=H;function j(Me){return i(Me)==="Uint32Array"}n.isUint32Array=j;function W(Me){return i(Me)==="Int8Array"}n.isInt8Array=W;function ae(Me){return i(Me)==="Int16Array"}n.isInt16Array=ae;function fe(Me){return i(Me)==="Int32Array"}n.isInt32Array=fe;function pe(Me){return i(Me)==="Float32Array"}n.isFloat32Array=pe;function ve(Me){return i(Me)==="Float64Array"}n.isFloat64Array=ve;function Qe(Me){return i(Me)==="BigInt64Array"}n.isBigInt64Array=Qe;function re(Me){return i(Me)==="BigUint64Array"}n.isBigUint64Array=re;function C(Me){return d(Me)==="[object Map]"}C.working=typeof Map<"u"&&C(new Map);function S(Me){return typeof Map>"u"?!1:C.working?C(Me):Me instanceof Map}n.isMap=S;function w(Me){return d(Me)==="[object Set]"}w.working=typeof Set<"u"&&w(new Set);function E(Me){return typeof Set>"u"?!1:w.working?w(Me):Me instanceof Set}n.isSet=E;function I(Me){return d(Me)==="[object WeakMap]"}I.working=typeof WeakMap<"u"&&I(new WeakMap);function N(Me){return typeof WeakMap>"u"?!1:I.working?I(Me):Me instanceof WeakMap}n.isWeakMap=N;function U(Me){return d(Me)==="[object WeakSet]"}U.working=typeof WeakSet<"u"&&U(new WeakSet);function L(Me){return U(Me)}n.isWeakSet=L;function P(Me){return d(Me)==="[object ArrayBuffer]"}P.working=typeof ArrayBuffer<"u"&&P(new ArrayBuffer);function B(Me){return typeof ArrayBuffer>"u"?!1:P.working?P(Me):Me instanceof ArrayBuffer}n.isArrayBuffer=B;function A(Me){return d(Me)==="[object DataView]"}A.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&A(new DataView(new ArrayBuffer(1),0,1));function z(Me){return typeof DataView>"u"?!1:A.working?A(Me):Me instanceof DataView}n.isDataView=z;var de=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function we(Me){return d(Me)==="[object SharedArrayBuffer]"}function se(Me){return typeof de>"u"?!1:(typeof we.working>"u"&&(we.working=we(new de)),we.working?we(Me):Me instanceof de)}n.isSharedArrayBuffer=se;function he(Me){return d(Me)==="[object AsyncFunction]"}n.isAsyncFunction=he;function $e(Me){return d(Me)==="[object Map Iterator]"}n.isMapIterator=$e;function Ae(Me){return d(Me)==="[object Set Iterator]"}n.isSetIterator=Ae;function ze(Me){return d(Me)==="[object Generator]"}n.isGeneratorObject=ze;function oe(Me){return d(Me)==="[object WebAssembly.Module]"}n.isWebAssemblyCompiledModule=oe;function ie(Me){return _(Me,p)}n.isNumberObject=ie;function Ie(Me){return _(Me,h)}n.isStringObject=Ie;function qe(Me){return _(Me,b)}n.isBooleanObject=qe;function Ze(Me){return c&&_(Me,m)}n.isBigIntObject=Ze;function lt(Me){return u&&_(Me,v)}n.isSymbolObject=lt;function ht(Me){return ie(Me)||Ie(Me)||qe(Me)||Ze(Me)||lt(Me)}n.isBoxedPrimitive=ht;function gt(Me){return typeof Uint8Array<"u"&&(B(Me)||se(Me))}n.isAnyArrayBuffer=gt,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(Me){Object.defineProperty(n,Me,{enumerable:!1,value:function(){throw new Error(Me+" is not supported in userland")}})})})(types);var isBufferBrowser=function n(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"};(function(n){var e=Object.getOwnPropertyDescriptors||function(z){for(var de=Object.keys(z),we={},se=0;se<de.length;se++)we[de[se]]=Object.getOwnPropertyDescriptor(z,de[se]);return we},t=/%[sdj%]/g;n.format=function(A){if(!W(A)){for(var z=[],de=0;de<arguments.length;de++)z.push(c(arguments[de]));return z.join(" ")}for(var de=1,we=arguments,se=we.length,he=String(A).replace(t,function(Ae){if(Ae==="%%")return"%";if(de>=se)return Ae;switch(Ae){case"%s":return String(we[de++]);case"%d":return Number(we[de++]);case"%j":try{return JSON.stringify(we[de++])}catch{return"[Circular]"}default:return Ae}}),$e=we[de];de<se;$e=we[++de])O($e)||!ve($e)?he+=" "+$e:he+=" "+c($e);return he},n.deprecate=function(A,z){if(typeof process$3<"u"&&process$3.noDeprecation===!0)return A;if(typeof process$3>"u")return function(){return n.deprecate(A,z).apply(this,arguments)};var de=!1;function we(){if(!de){if(process$3.throwDeprecation)throw new Error(z);process$3.traceDeprecation?console.trace(z):console.error(z),de=!0}return A.apply(this,arguments)}return we};var i={},o=/^$/;if({}.NODE_DEBUG){var a={}.NODE_DEBUG;a=a.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),o=new RegExp("^"+a+"$","i")}n.debuglog=function(A){if(A=A.toUpperCase(),!i[A])if(o.test(A)){var z=process$3.pid;i[A]=function(){var de=n.format.apply(n,arguments);console.error("%s %d: %s",A,z,de)}}else i[A]=function(){};return i[A]};function c(A,z){var de={seen:[],stylize:d};return arguments.length>=3&&(de.depth=arguments[2]),arguments.length>=4&&(de.colors=arguments[3]),D(z)?de.showHidden=z:z&&n._extend(de,z),fe(de.showHidden)&&(de.showHidden=!1),fe(de.depth)&&(de.depth=2),fe(de.colors)&&(de.colors=!1),fe(de.customInspect)&&(de.customInspect=!0),de.colors&&(de.stylize=u),h(de,A,de.depth)}n.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function u(A,z){var de=c.styles[z];return de?"\x1B["+c.colors[de][0]+"m"+A+"\x1B["+c.colors[de][1]+"m":A}function d(A,z){return A}function p(A){var z={};return A.forEach(function(de,we){z[de]=!0}),z}function h(A,z,de){if(A.customInspect&&z&&C(z.inspect)&&z.inspect!==n.inspect&&!(z.constructor&&z.constructor.prototype===z)){var we=z.inspect(de,A);return W(we)||(we=h(A,we,de)),we}var se=b(A,z);if(se)return se;var he=Object.keys(z),$e=p(he);if(A.showHidden&&(he=Object.getOwnPropertyNames(z)),re(z)&&(he.indexOf("message")>=0||he.indexOf("description")>=0))return m(z);if(he.length===0){if(C(z)){var Ae=z.name?": "+z.name:"";return A.stylize("[Function"+Ae+"]","special")}if(pe(z))return A.stylize(RegExp.prototype.toString.call(z),"regexp");if(Qe(z))return A.stylize(Date.prototype.toString.call(z),"date");if(re(z))return m(z)}var ze="",oe=!1,ie=["{","}"];if(k(z)&&(oe=!0,ie=["[","]"]),C(z)){var Ie=z.name?": "+z.name:"";ze=" [Function"+Ie+"]"}if(pe(z)&&(ze=" "+RegExp.prototype.toString.call(z)),Qe(z)&&(ze=" "+Date.prototype.toUTCString.call(z)),re(z)&&(ze=" "+m(z)),he.length===0&&(!oe||z.length==0))return ie[0]+ze+ie[1];if(de<0)return pe(z)?A.stylize(RegExp.prototype.toString.call(z),"regexp"):A.stylize("[Object]","special");A.seen.push(z);var qe;return oe?qe=v(A,z,de,$e,he):qe=he.map(function(Ze){return _(A,z,de,$e,Ze,oe)}),A.seen.pop(),$(qe,ze,ie)}function b(A,z){if(fe(z))return A.stylize("undefined","undefined");if(W(z)){var de="'"+JSON.stringify(z).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return A.stylize(de,"string")}if(j(z))return A.stylize(""+z,"number");if(D(z))return A.stylize(""+z,"boolean");if(O(z))return A.stylize("null","null")}function m(A){return"["+Error.prototype.toString.call(A)+"]"}function v(A,z,de,we,se){for(var he=[],$e=0,Ae=z.length;$e<Ae;++$e)U(z,String($e))?he.push(_(A,z,de,we,String($e),!0)):he.push("");return se.forEach(function(ze){ze.match(/^\d+$/)||he.push(_(A,z,de,we,ze,!0))}),he}function _(A,z,de,we,se,he){var $e,Ae,ze;if(ze=Object.getOwnPropertyDescriptor(z,se)||{value:z[se]},ze.get?ze.set?Ae=A.stylize("[Getter/Setter]","special"):Ae=A.stylize("[Getter]","special"):ze.set&&(Ae=A.stylize("[Setter]","special")),U(we,se)||($e="["+se+"]"),Ae||(A.seen.indexOf(ze.value)<0?(O(de)?Ae=h(A,ze.value,null):Ae=h(A,ze.value,de-1),Ae.indexOf(`
`)>-1&&(he?Ae=Ae.split(`
`).map(function(oe){return"  "+oe}).join(`
`).slice(2):Ae=`
`+Ae.split(`
`).map(function(oe){return"   "+oe}).join(`
`))):Ae=A.stylize("[Circular]","special")),fe($e)){if(he&&se.match(/^\d+$/))return Ae;$e=JSON.stringify(""+se),$e.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?($e=$e.slice(1,-1),$e=A.stylize($e,"name")):($e=$e.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),$e=A.stylize($e,"string"))}return $e+": "+Ae}function $(A,z,de){var we=A.reduce(function(se,he){return he.indexOf(`
`)>=0,se+he.replace(/\u001b\[\d\d?m/g,"").length+1},0);return we>60?de[0]+(z===""?"":z+`
 `)+" "+A.join(`,
  `)+" "+de[1]:de[0]+z+" "+A.join(", ")+" "+de[1]}n.types=types;function k(A){return Array.isArray(A)}n.isArray=k;function D(A){return typeof A=="boolean"}n.isBoolean=D;function O(A){return A===null}n.isNull=O;function H(A){return A==null}n.isNullOrUndefined=H;function j(A){return typeof A=="number"}n.isNumber=j;function W(A){return typeof A=="string"}n.isString=W;function ae(A){return typeof A=="symbol"}n.isSymbol=ae;function fe(A){return A===void 0}n.isUndefined=fe;function pe(A){return ve(A)&&w(A)==="[object RegExp]"}n.isRegExp=pe,n.types.isRegExp=pe;function ve(A){return typeof A=="object"&&A!==null}n.isObject=ve;function Qe(A){return ve(A)&&w(A)==="[object Date]"}n.isDate=Qe,n.types.isDate=Qe;function re(A){return ve(A)&&(w(A)==="[object Error]"||A instanceof Error)}n.isError=re,n.types.isNativeError=re;function C(A){return typeof A=="function"}n.isFunction=C;function S(A){return A===null||typeof A=="boolean"||typeof A=="number"||typeof A=="string"||typeof A=="symbol"||typeof A>"u"}n.isPrimitive=S,n.isBuffer=isBufferBrowser;function w(A){return Object.prototype.toString.call(A)}function E(A){return A<10?"0"+A.toString(10):A.toString(10)}var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function N(){var A=new Date,z=[E(A.getHours()),E(A.getMinutes()),E(A.getSeconds())].join(":");return[A.getDate(),I[A.getMonth()],z].join(" ")}n.log=function(){console.log("%s - %s",N(),n.format.apply(n,arguments))},n.inherits=inherits_browserExports,n._extend=function(A,z){if(!z||!ve(z))return A;for(var de=Object.keys(z),we=de.length;we--;)A[de[we]]=z[de[we]];return A};function U(A,z){return Object.prototype.hasOwnProperty.call(A,z)}var L=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;n.promisify=function(z){if(typeof z!="function")throw new TypeError('The "original" argument must be of type Function');if(L&&z[L]){var de=z[L];if(typeof de!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(de,L,{value:de,enumerable:!1,writable:!1,configurable:!0}),de}function de(){for(var we,se,he=new Promise(function(ze,oe){we=ze,se=oe}),$e=[],Ae=0;Ae<arguments.length;Ae++)$e.push(arguments[Ae]);$e.push(function(ze,oe){ze?se(ze):we(oe)});try{z.apply(this,$e)}catch(ze){se(ze)}return he}return Object.setPrototypeOf(de,Object.getPrototypeOf(z)),L&&Object.defineProperty(de,L,{value:de,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(de,e(z))},n.promisify.custom=L;function P(A,z){if(!A){var de=new Error("Promise was rejected with a falsy value");de.reason=A,A=de}return z(A)}function B(A){if(typeof A!="function")throw new TypeError('The "original" argument must be of type Function');function z(){for(var de=[],we=0;we<arguments.length;we++)de.push(arguments[we]);var se=de.pop();if(typeof se!="function")throw new TypeError("The last argument must be of type Function");var he=this,$e=function(){return se.apply(he,arguments)};A.apply(this,de).then(function(Ae){process$3.nextTick($e.bind(null,null,Ae))},function(Ae){process$3.nextTick(P.bind(null,Ae,$e))})}return Object.setPrototypeOf(z,Object.getPrototypeOf(A)),Object.defineProperties(z,e(A)),z}n.callbackify=B})(util);var buffer_list,hasRequiredBuffer_list;function requireBuffer_list(){if(hasRequiredBuffer_list)return buffer_list;hasRequiredBuffer_list=1;function n(_,$){var k=Object.keys(_);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols(_);$&&(D=D.filter(function(O){return Object.getOwnPropertyDescriptor(_,O).enumerable})),k.push.apply(k,D)}return k}function e(_){for(var $=1;$<arguments.length;$++){var k=arguments[$]!=null?arguments[$]:{};$%2?n(Object(k),!0).forEach(function(D){t(_,D,k[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(k)):n(Object(k)).forEach(function(D){Object.defineProperty(_,D,Object.getOwnPropertyDescriptor(k,D))})}return _}function t(_,$,k){return $=c($),$ in _?Object.defineProperty(_,$,{value:k,enumerable:!0,configurable:!0,writable:!0}):_[$]=k,_}function i(_,$){if(!(_ instanceof $))throw new TypeError("Cannot call a class as a function")}function o(_,$){for(var k=0;k<$.length;k++){var D=$[k];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(_,c(D.key),D)}}function a(_,$,k){return $&&o(_.prototype,$),k&&o(_,k),Object.defineProperty(_,"prototype",{writable:!1}),_}function c(_){var $=u(_,"string");return typeof $=="symbol"?$:String($)}function u(_,$){if(typeof _!="object"||_===null)return _;var k=_[Symbol.toPrimitive];if(k!==void 0){var D=k.call(_,$||"default");if(typeof D!="object")return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(_)}var d=buffer$2,p=d.Buffer,h=util,b=h.inspect,m=b&&b.custom||"inspect";function v(_,$,k){p.prototype.copy.call(_,$,k)}return buffer_list=function(){function _(){i(this,_),this.head=null,this.tail=null,this.length=0}return a(_,[{key:"push",value:function(k){var D={data:k,next:null};this.length>0?this.tail.next=D:this.head=D,this.tail=D,++this.length}},{key:"unshift",value:function(k){var D={data:k,next:this.head};this.length===0&&(this.tail=D),this.head=D,++this.length}},{key:"shift",value:function(){if(this.length!==0){var k=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,k}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(k){if(this.length===0)return"";for(var D=this.head,O=""+D.data;D=D.next;)O+=k+D.data;return O}},{key:"concat",value:function(k){if(this.length===0)return p.alloc(0);for(var D=p.allocUnsafe(k>>>0),O=this.head,H=0;O;)v(O.data,D,H),H+=O.data.length,O=O.next;return D}},{key:"consume",value:function(k,D){var O;return k<this.head.data.length?(O=this.head.data.slice(0,k),this.head.data=this.head.data.slice(k)):k===this.head.data.length?O=this.shift():O=D?this._getString(k):this._getBuffer(k),O}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(k){var D=this.head,O=1,H=D.data;for(k-=H.length;D=D.next;){var j=D.data,W=k>j.length?j.length:k;if(W===j.length?H+=j:H+=j.slice(0,k),k-=W,k===0){W===j.length?(++O,D.next?this.head=D.next:this.head=this.tail=null):(this.head=D,D.data=j.slice(W));break}++O}return this.length-=O,H}},{key:"_getBuffer",value:function(k){var D=p.allocUnsafe(k),O=this.head,H=1;for(O.data.copy(D),k-=O.data.length;O=O.next;){var j=O.data,W=k>j.length?j.length:k;if(j.copy(D,D.length-k,0,W),k-=W,k===0){W===j.length?(++H,O.next?this.head=O.next:this.head=this.tail=null):(this.head=O,O.data=j.slice(W));break}++H}return this.length-=H,D}},{key:m,value:function(k,D){return b(this,e(e({},D),{},{depth:0,customInspect:!1}))}}]),_}(),buffer_list}var destroy_1,hasRequiredDestroy;function requireDestroy(){if(hasRequiredDestroy)return destroy_1;hasRequiredDestroy=1;function n(c,u){var d=this,p=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return p||h?(u?u(c):c&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process$3.nextTick(o,this,c)):process$3.nextTick(o,this,c)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(c||null,function(b){!u&&b?d._writableState?d._writableState.errorEmitted?process$3.nextTick(t,d):(d._writableState.errorEmitted=!0,process$3.nextTick(e,d,b)):process$3.nextTick(e,d,b):u?(process$3.nextTick(t,d),u(b)):process$3.nextTick(t,d)}),this)}function e(c,u){o(c,u),t(c)}function t(c){c._writableState&&!c._writableState.emitClose||c._readableState&&!c._readableState.emitClose||c.emit("close")}function i(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function o(c,u){c.emit("error",u)}function a(c,u){var d=c._readableState,p=c._writableState;d&&d.autoDestroy||p&&p.autoDestroy?c.destroy(u):c.emit("error",u)}return destroy_1={destroy:n,undestroy:i,errorOrDestroy:a},destroy_1}var errorsBrowser={},hasRequiredErrorsBrowser;function requireErrorsBrowser(){if(hasRequiredErrorsBrowser)return errorsBrowser;hasRequiredErrorsBrowser=1;function n(u,d){u.prototype=Object.create(d.prototype),u.prototype.constructor=u,u.__proto__=d}var e={};function t(u,d,p){p||(p=Error);function h(m,v,_){return typeof d=="string"?d:d(m,v,_)}var b=function(m){n(v,m);function v(_,$,k){return m.call(this,h(_,$,k))||this}return v}(p);b.prototype.name=p.name,b.prototype.code=u,e[u]=b}function i(u,d){if(Array.isArray(u)){var p=u.length;return u=u.map(function(h){return String(h)}),p>2?"one of ".concat(d," ").concat(u.slice(0,p-1).join(", "),", or ")+u[p-1]:p===2?"one of ".concat(d," ").concat(u[0]," or ").concat(u[1]):"of ".concat(d," ").concat(u[0])}else return"of ".concat(d," ").concat(String(u))}function o(u,d,p){return u.substr(!p||p<0?0:+p,d.length)===d}function a(u,d,p){return(p===void 0||p>u.length)&&(p=u.length),u.substring(p-d.length,p)===d}function c(u,d,p){return typeof p!="number"&&(p=0),p+d.length>u.length?!1:u.indexOf(d,p)!==-1}return t("ERR_INVALID_OPT_VALUE",function(u,d){return'The value "'+d+'" is invalid for option "'+u+'"'},TypeError),t("ERR_INVALID_ARG_TYPE",function(u,d,p){var h;typeof d=="string"&&o(d,"not ")?(h="must not be",d=d.replace(/^not /,"")):h="must be";var b;if(a(u," argument"))b="The ".concat(u," ").concat(h," ").concat(i(d,"type"));else{var m=c(u,".")?"property":"argument";b='The "'.concat(u,'" ').concat(m," ").concat(h," ").concat(i(d,"type"))}return b+=". Received type ".concat(typeof p),b},TypeError),t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),t("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),t("ERR_STREAM_PREMATURE_CLOSE","Premature close"),t("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),t("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),t("ERR_STREAM_WRITE_AFTER_END","write after end"),t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),t("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),errorsBrowser.codes=e,errorsBrowser}var state,hasRequiredState;function requireState(){if(hasRequiredState)return state;hasRequiredState=1;var n=requireErrorsBrowser().codes.ERR_INVALID_OPT_VALUE;function e(i,o,a){return i.highWaterMark!=null?i.highWaterMark:o?i[a]:null}function t(i,o,a,c){var u=e(o,c,a);if(u!=null){if(!(isFinite(u)&&Math.floor(u)===u)||u<0){var d=c?a:"highWaterMark";throw new n(d,u)}return Math.floor(u)}return i.objectMode?16:16*1024}return state={getHighWaterMark:t},state}var browser$a,hasRequiredBrowser$a;function requireBrowser$a(){if(hasRequiredBrowser$a)return browser$a;hasRequiredBrowser$a=1,browser$a=n;function n(t,i){if(e("noDeprecation"))return t;var o=!1;function a(){if(!o){if(e("throwDeprecation"))throw new Error(i);e("traceDeprecation")?console.trace(i):console.warn(i),o=!0}return t.apply(this,arguments)}return a}function e(t){try{if(!commonjsGlobal.localStorage)return!1}catch{return!1}var i=commonjsGlobal.localStorage[t];return i==null?!1:String(i).toLowerCase()==="true"}return browser$a}var _stream_writable,hasRequired_stream_writable;function require_stream_writable(){if(hasRequired_stream_writable)return _stream_writable;hasRequired_stream_writable=1,_stream_writable=pe;function n(se){var he=this;this.next=null,this.entry=null,this.finish=function(){we(he,se)}}var e;pe.WritableState=ae;var t={deprecate:requireBrowser$a()},i=requireStreamBrowser(),o=buffer$2.Buffer,a=(typeof commonjsGlobal<"u"?commonjsGlobal:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function c(se){return o.from(se)}function u(se){return o.isBuffer(se)||se instanceof a}var d=requireDestroy(),p=requireState(),h=p.getHighWaterMark,b=requireErrorsBrowser().codes,m=b.ERR_INVALID_ARG_TYPE,v=b.ERR_METHOD_NOT_IMPLEMENTED,_=b.ERR_MULTIPLE_CALLBACK,$=b.ERR_STREAM_CANNOT_PIPE,k=b.ERR_STREAM_DESTROYED,D=b.ERR_STREAM_NULL_VALUES,O=b.ERR_STREAM_WRITE_AFTER_END,H=b.ERR_UNKNOWN_ENCODING,j=d.errorOrDestroy;inherits_browserExports(pe,i);function W(){}function ae(se,he,$e){e=e||require_stream_duplex(),se=se||{},typeof $e!="boolean"&&($e=he instanceof e),this.objectMode=!!se.objectMode,$e&&(this.objectMode=this.objectMode||!!se.writableObjectMode),this.highWaterMark=h(this,se,"writableHighWaterMark",$e),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Ae=se.decodeStrings===!1;this.decodeStrings=!Ae,this.defaultEncoding=se.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ze){I(he,ze)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=se.emitClose!==!1,this.autoDestroy=!!se.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}ae.prototype.getBuffer=function(){for(var he=this.bufferedRequest,$e=[];he;)$e.push(he),he=he.next;return $e},function(){try{Object.defineProperty(ae.prototype,"buffer",{get:t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var fe;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(fe=Function.prototype[Symbol.hasInstance],Object.defineProperty(pe,Symbol.hasInstance,{value:function(he){return fe.call(this,he)?!0:this!==pe?!1:he&&he._writableState instanceof ae}})):fe=function(he){return he instanceof this};function pe(se){e=e||require_stream_duplex();var he=this instanceof e;if(!he&&!fe.call(pe,this))return new pe(se);this._writableState=new ae(se,this,he),this.writable=!0,se&&(typeof se.write=="function"&&(this._write=se.write),typeof se.writev=="function"&&(this._writev=se.writev),typeof se.destroy=="function"&&(this._destroy=se.destroy),typeof se.final=="function"&&(this._final=se.final)),i.call(this)}pe.prototype.pipe=function(){j(this,new $)};function ve(se,he){var $e=new O;j(se,$e),process$3.nextTick(he,$e)}function Qe(se,he,$e,Ae){var ze;return $e===null?ze=new D:typeof $e!="string"&&!he.objectMode&&(ze=new m("chunk",["string","Buffer"],$e)),ze?(j(se,ze),process$3.nextTick(Ae,ze),!1):!0}pe.prototype.write=function(se,he,$e){var Ae=this._writableState,ze=!1,oe=!Ae.objectMode&&u(se);return oe&&!o.isBuffer(se)&&(se=c(se)),typeof he=="function"&&($e=he,he=null),oe?he="buffer":he||(he=Ae.defaultEncoding),typeof $e!="function"&&($e=W),Ae.ending?ve(this,$e):(oe||Qe(this,Ae,se,$e))&&(Ae.pendingcb++,ze=C(this,Ae,oe,se,he,$e)),ze},pe.prototype.cork=function(){this._writableState.corked++},pe.prototype.uncork=function(){var se=this._writableState;se.corked&&(se.corked--,!se.writing&&!se.corked&&!se.bufferProcessing&&se.bufferedRequest&&L(this,se))},pe.prototype.setDefaultEncoding=function(he){if(typeof he=="string"&&(he=he.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((he+"").toLowerCase())>-1))throw new H(he);return this._writableState.defaultEncoding=he,this},Object.defineProperty(pe.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function re(se,he,$e){return!se.objectMode&&se.decodeStrings!==!1&&typeof he=="string"&&(he=o.from(he,$e)),he}Object.defineProperty(pe.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function C(se,he,$e,Ae,ze,oe){if(!$e){var ie=re(he,Ae,ze);Ae!==ie&&($e=!0,ze="buffer",Ae=ie)}var Ie=he.objectMode?1:Ae.length;he.length+=Ie;var qe=he.length<he.highWaterMark;if(qe||(he.needDrain=!0),he.writing||he.corked){var Ze=he.lastBufferedRequest;he.lastBufferedRequest={chunk:Ae,encoding:ze,isBuf:$e,callback:oe,next:null},Ze?Ze.next=he.lastBufferedRequest:he.bufferedRequest=he.lastBufferedRequest,he.bufferedRequestCount+=1}else S(se,he,!1,Ie,Ae,ze,oe);return qe}function S(se,he,$e,Ae,ze,oe,ie){he.writelen=Ae,he.writecb=ie,he.writing=!0,he.sync=!0,he.destroyed?he.onwrite(new k("write")):$e?se._writev(ze,he.onwrite):se._write(ze,oe,he.onwrite),he.sync=!1}function w(se,he,$e,Ae,ze){--he.pendingcb,$e?(process$3.nextTick(ze,Ae),process$3.nextTick(z,se,he),se._writableState.errorEmitted=!0,j(se,Ae)):(ze(Ae),se._writableState.errorEmitted=!0,j(se,Ae),z(se,he))}function E(se){se.writing=!1,se.writecb=null,se.length-=se.writelen,se.writelen=0}function I(se,he){var $e=se._writableState,Ae=$e.sync,ze=$e.writecb;if(typeof ze!="function")throw new _;if(E($e),he)w(se,$e,Ae,he,ze);else{var oe=P($e)||se.destroyed;!oe&&!$e.corked&&!$e.bufferProcessing&&$e.bufferedRequest&&L(se,$e),Ae?process$3.nextTick(N,se,$e,oe,ze):N(se,$e,oe,ze)}}function N(se,he,$e,Ae){$e||U(se,he),he.pendingcb--,Ae(),z(se,he)}function U(se,he){he.length===0&&he.needDrain&&(he.needDrain=!1,se.emit("drain"))}function L(se,he){he.bufferProcessing=!0;var $e=he.bufferedRequest;if(se._writev&&$e&&$e.next){var Ae=he.bufferedRequestCount,ze=new Array(Ae),oe=he.corkedRequestsFree;oe.entry=$e;for(var ie=0,Ie=!0;$e;)ze[ie]=$e,$e.isBuf||(Ie=!1),$e=$e.next,ie+=1;ze.allBuffers=Ie,S(se,he,!0,he.length,ze,"",oe.finish),he.pendingcb++,he.lastBufferedRequest=null,oe.next?(he.corkedRequestsFree=oe.next,oe.next=null):he.corkedRequestsFree=new n(he),he.bufferedRequestCount=0}else{for(;$e;){var qe=$e.chunk,Ze=$e.encoding,lt=$e.callback,ht=he.objectMode?1:qe.length;if(S(se,he,!1,ht,qe,Ze,lt),$e=$e.next,he.bufferedRequestCount--,he.writing)break}$e===null&&(he.lastBufferedRequest=null)}he.bufferedRequest=$e,he.bufferProcessing=!1}pe.prototype._write=function(se,he,$e){$e(new v("_write()"))},pe.prototype._writev=null,pe.prototype.end=function(se,he,$e){var Ae=this._writableState;return typeof se=="function"?($e=se,se=null,he=null):typeof he=="function"&&($e=he,he=null),se!=null&&this.write(se,he),Ae.corked&&(Ae.corked=1,this.uncork()),Ae.ending||de(this,Ae,$e),this},Object.defineProperty(pe.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function P(se){return se.ending&&se.length===0&&se.bufferedRequest===null&&!se.finished&&!se.writing}function B(se,he){se._final(function($e){he.pendingcb--,$e&&j(se,$e),he.prefinished=!0,se.emit("prefinish"),z(se,he)})}function A(se,he){!he.prefinished&&!he.finalCalled&&(typeof se._final=="function"&&!he.destroyed?(he.pendingcb++,he.finalCalled=!0,process$3.nextTick(B,se,he)):(he.prefinished=!0,se.emit("prefinish")))}function z(se,he){var $e=P(he);if($e&&(A(se,he),he.pendingcb===0&&(he.finished=!0,se.emit("finish"),he.autoDestroy))){var Ae=se._readableState;(!Ae||Ae.autoDestroy&&Ae.endEmitted)&&se.destroy()}return $e}function de(se,he,$e){he.ending=!0,z(se,he),$e&&(he.finished?process$3.nextTick($e):se.once("finish",$e)),he.ended=!0,se.writable=!1}function we(se,he,$e){var Ae=se.entry;for(se.entry=null;Ae;){var ze=Ae.callback;he.pendingcb--,ze($e),Ae=Ae.next}he.corkedRequestsFree.next=se}return Object.defineProperty(pe.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(he){this._writableState&&(this._writableState.destroyed=he)}}),pe.prototype.destroy=d.destroy,pe.prototype._undestroy=d.undestroy,pe.prototype._destroy=function(se,he){he(se)},_stream_writable}var _stream_duplex,hasRequired_stream_duplex;function require_stream_duplex(){if(hasRequired_stream_duplex)return _stream_duplex;hasRequired_stream_duplex=1;var n=Object.keys||function(p){var h=[];for(var b in p)h.push(b);return h};_stream_duplex=c;var e=require_stream_readable(),t=require_stream_writable();inherits_browserExports(c,e);for(var i=n(t.prototype),o=0;o<i.length;o++){var a=i[o];c.prototype[a]||(c.prototype[a]=t.prototype[a])}function c(p){if(!(this instanceof c))return new c(p);e.call(this,p),t.call(this,p),this.allowHalfOpen=!0,p&&(p.readable===!1&&(this.readable=!1),p.writable===!1&&(this.writable=!1),p.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",u)))}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function u(){this._writableState.ended||process$3.nextTick(d,this)}function d(p){p.end()}return Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(h){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=h,this._writableState.destroyed=h)}}),_stream_duplex}var string_decoder={},hasRequiredString_decoder;function requireString_decoder(){if(hasRequiredString_decoder)return string_decoder;hasRequiredString_decoder=1;var n=safeBufferExports.Buffer,e=n.isEncoding||function(D){switch(D=""+D,D&&D.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(D){if(!D)return"utf8";for(var O;;)switch(D){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return D;default:if(O)return;D=(""+D).toLowerCase(),O=!0}}function i(D){var O=t(D);if(typeof O!="string"&&(n.isEncoding===e||!e(D)))throw new Error("Unknown encoding: "+D);return O||D}string_decoder.StringDecoder=o;function o(D){this.encoding=i(D);var O;switch(this.encoding){case"utf16le":this.text=b,this.end=m,O=4;break;case"utf8":this.fillLast=d,O=4;break;case"base64":this.text=v,this.end=_,O=3;break;default:this.write=$,this.end=k;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(O)}o.prototype.write=function(D){if(D.length===0)return"";var O,H;if(this.lastNeed){if(O=this.fillLast(D),O===void 0)return"";H=this.lastNeed,this.lastNeed=0}else H=0;return H<D.length?O?O+this.text(D,H):this.text(D,H):O||""},o.prototype.end=h,o.prototype.text=p,o.prototype.fillLast=function(D){if(this.lastNeed<=D.length)return D.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);D.copy(this.lastChar,this.lastTotal-this.lastNeed,0,D.length),this.lastNeed-=D.length};function a(D){return D<=127?0:D>>5===6?2:D>>4===14?3:D>>3===30?4:D>>6===2?-1:-2}function c(D,O,H){var j=O.length-1;if(j<H)return 0;var W=a(O[j]);return W>=0?(W>0&&(D.lastNeed=W-1),W):--j<H||W===-2?0:(W=a(O[j]),W>=0?(W>0&&(D.lastNeed=W-2),W):--j<H||W===-2?0:(W=a(O[j]),W>=0?(W>0&&(W===2?W=0:D.lastNeed=W-3),W):0))}function u(D,O,H){if((O[0]&192)!==128)return D.lastNeed=0,"";if(D.lastNeed>1&&O.length>1){if((O[1]&192)!==128)return D.lastNeed=1,"";if(D.lastNeed>2&&O.length>2&&(O[2]&192)!==128)return D.lastNeed=2,""}}function d(D){var O=this.lastTotal-this.lastNeed,H=u(this,D);if(H!==void 0)return H;if(this.lastNeed<=D.length)return D.copy(this.lastChar,O,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);D.copy(this.lastChar,O,0,D.length),this.lastNeed-=D.length}function p(D,O){var H=c(this,D,O);if(!this.lastNeed)return D.toString("utf8",O);this.lastTotal=H;var j=D.length-(H-this.lastNeed);return D.copy(this.lastChar,0,j),D.toString("utf8",O,j)}function h(D){var O=D&&D.length?this.write(D):"";return this.lastNeed?O+"":O}function b(D,O){if((D.length-O)%2===0){var H=D.toString("utf16le",O);if(H){var j=H.charCodeAt(H.length-1);if(j>=55296&&j<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=D[D.length-2],this.lastChar[1]=D[D.length-1],H.slice(0,-1)}return H}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=D[D.length-1],D.toString("utf16le",O,D.length-1)}function m(D){var O=D&&D.length?this.write(D):"";if(this.lastNeed){var H=this.lastTotal-this.lastNeed;return O+this.lastChar.toString("utf16le",0,H)}return O}function v(D,O){var H=(D.length-O)%3;return H===0?D.toString("base64",O):(this.lastNeed=3-H,this.lastTotal=3,H===1?this.lastChar[0]=D[D.length-1]:(this.lastChar[0]=D[D.length-2],this.lastChar[1]=D[D.length-1]),D.toString("base64",O,D.length-H))}function _(D){var O=D&&D.length?this.write(D):"";return this.lastNeed?O+this.lastChar.toString("base64",0,3-this.lastNeed):O}function $(D){return D.toString(this.encoding)}function k(D){return D&&D.length?this.write(D):""}return string_decoder}var endOfStream,hasRequiredEndOfStream;function requireEndOfStream(){if(hasRequiredEndOfStream)return endOfStream;hasRequiredEndOfStream=1;var n=requireErrorsBrowser().codes.ERR_STREAM_PREMATURE_CLOSE;function e(a){var c=!1;return function(){if(!c){c=!0;for(var u=arguments.length,d=new Array(u),p=0;p<u;p++)d[p]=arguments[p];a.apply(this,d)}}}function t(){}function i(a){return a.setHeader&&typeof a.abort=="function"}function o(a,c,u){if(typeof c=="function")return o(a,null,c);c||(c={}),u=e(u||t);var d=c.readable||c.readable!==!1&&a.readable,p=c.writable||c.writable!==!1&&a.writable,h=function(){a.writable||m()},b=a._writableState&&a._writableState.finished,m=function(){p=!1,b=!0,d||u.call(a)},v=a._readableState&&a._readableState.endEmitted,_=function(){d=!1,v=!0,p||u.call(a)},$=function(H){u.call(a,H)},k=function(){var H;if(d&&!v)return(!a._readableState||!a._readableState.ended)&&(H=new n),u.call(a,H);if(p&&!b)return(!a._writableState||!a._writableState.ended)&&(H=new n),u.call(a,H)},D=function(){a.req.on("finish",m)};return i(a)?(a.on("complete",m),a.on("abort",k),a.req?D():a.on("request",D)):p&&!a._writableState&&(a.on("end",h),a.on("close",h)),a.on("end",_),a.on("finish",m),c.error!==!1&&a.on("error",$),a.on("close",k),function(){a.removeListener("complete",m),a.removeListener("abort",k),a.removeListener("request",D),a.req&&a.req.removeListener("finish",m),a.removeListener("end",h),a.removeListener("close",h),a.removeListener("finish",m),a.removeListener("end",_),a.removeListener("error",$),a.removeListener("close",k)}}return endOfStream=o,endOfStream}var async_iterator,hasRequiredAsync_iterator;function requireAsync_iterator(){if(hasRequiredAsync_iterator)return async_iterator;hasRequiredAsync_iterator=1;var n;function e(H,j,W){return j=t(j),j in H?Object.defineProperty(H,j,{value:W,enumerable:!0,configurable:!0,writable:!0}):H[j]=W,H}function t(H){var j=i(H,"string");return typeof j=="symbol"?j:String(j)}function i(H,j){if(typeof H!="object"||H===null)return H;var W=H[Symbol.toPrimitive];if(W!==void 0){var ae=W.call(H,j||"default");if(typeof ae!="object")return ae;throw new TypeError("@@toPrimitive must return a primitive value.")}return(j==="string"?String:Number)(H)}var o=requireEndOfStream(),a=Symbol("lastResolve"),c=Symbol("lastReject"),u=Symbol("error"),d=Symbol("ended"),p=Symbol("lastPromise"),h=Symbol("handlePromise"),b=Symbol("stream");function m(H,j){return{value:H,done:j}}function v(H){var j=H[a];if(j!==null){var W=H[b].read();W!==null&&(H[p]=null,H[a]=null,H[c]=null,j(m(W,!1)))}}function _(H){process$3.nextTick(v,H)}function $(H,j){return function(W,ae){H.then(function(){if(j[d]){W(m(void 0,!0));return}j[h](W,ae)},ae)}}var k=Object.getPrototypeOf(function(){}),D=Object.setPrototypeOf((n={get stream(){return this[b]},next:function(){var j=this,W=this[u];if(W!==null)return Promise.reject(W);if(this[d])return Promise.resolve(m(void 0,!0));if(this[b].destroyed)return new Promise(function(ve,Qe){process$3.nextTick(function(){j[u]?Qe(j[u]):ve(m(void 0,!0))})});var ae=this[p],fe;if(ae)fe=new Promise($(ae,this));else{var pe=this[b].read();if(pe!==null)return Promise.resolve(m(pe,!1));fe=new Promise(this[h])}return this[p]=fe,fe}},e(n,Symbol.asyncIterator,function(){return this}),e(n,"return",function(){var j=this;return new Promise(function(W,ae){j[b].destroy(null,function(fe){if(fe){ae(fe);return}W(m(void 0,!0))})})}),n),k),O=function(j){var W,ae=Object.create(D,(W={},e(W,b,{value:j,writable:!0}),e(W,a,{value:null,writable:!0}),e(W,c,{value:null,writable:!0}),e(W,u,{value:null,writable:!0}),e(W,d,{value:j._readableState.endEmitted,writable:!0}),e(W,h,{value:function(pe,ve){var Qe=ae[b].read();Qe?(ae[p]=null,ae[a]=null,ae[c]=null,pe(m(Qe,!1))):(ae[a]=pe,ae[c]=ve)},writable:!0}),W));return ae[p]=null,o(j,function(fe){if(fe&&fe.code!=="ERR_STREAM_PREMATURE_CLOSE"){var pe=ae[c];pe!==null&&(ae[p]=null,ae[a]=null,ae[c]=null,pe(fe)),ae[u]=fe;return}var ve=ae[a];ve!==null&&(ae[p]=null,ae[a]=null,ae[c]=null,ve(m(void 0,!0))),ae[d]=!0}),j.on("readable",_.bind(null,ae)),ae};return async_iterator=O,async_iterator}var fromBrowser,hasRequiredFromBrowser;function requireFromBrowser(){return hasRequiredFromBrowser||(hasRequiredFromBrowser=1,fromBrowser=function(){throw new Error("Readable.from is not available in the browser")}),fromBrowser}var _stream_readable,hasRequired_stream_readable;function require_stream_readable(){if(hasRequired_stream_readable)return _stream_readable;hasRequired_stream_readable=1,_stream_readable=ve;var n;ve.ReadableState=pe,eventsExports.EventEmitter;var e=function(ie,Ie){return ie.listeners(Ie).length},t=requireStreamBrowser(),i=buffer$2.Buffer,o=(typeof commonjsGlobal<"u"?commonjsGlobal:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function a(oe){return i.from(oe)}function c(oe){return i.isBuffer(oe)||oe instanceof o}var u=util,d;u&&u.debuglog?d=u.debuglog("stream"):d=function(){};var p=requireBuffer_list(),h=requireDestroy(),b=requireState(),m=b.getHighWaterMark,v=requireErrorsBrowser().codes,_=v.ERR_INVALID_ARG_TYPE,$=v.ERR_STREAM_PUSH_AFTER_EOF,k=v.ERR_METHOD_NOT_IMPLEMENTED,D=v.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,O,H,j;inherits_browserExports(ve,t);var W=h.errorOrDestroy,ae=["error","close","destroy","pause","resume"];function fe(oe,ie,Ie){if(typeof oe.prependListener=="function")return oe.prependListener(ie,Ie);!oe._events||!oe._events[ie]?oe.on(ie,Ie):Array.isArray(oe._events[ie])?oe._events[ie].unshift(Ie):oe._events[ie]=[Ie,oe._events[ie]]}function pe(oe,ie,Ie){n=n||require_stream_duplex(),oe=oe||{},typeof Ie!="boolean"&&(Ie=ie instanceof n),this.objectMode=!!oe.objectMode,Ie&&(this.objectMode=this.objectMode||!!oe.readableObjectMode),this.highWaterMark=m(this,oe,"readableHighWaterMark",Ie),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=oe.emitClose!==!1,this.autoDestroy=!!oe.autoDestroy,this.destroyed=!1,this.defaultEncoding=oe.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,oe.encoding&&(O||(O=requireString_decoder().StringDecoder),this.decoder=new O(oe.encoding),this.encoding=oe.encoding)}function ve(oe){if(n=n||require_stream_duplex(),!(this instanceof ve))return new ve(oe);var ie=this instanceof n;this._readableState=new pe(oe,this,ie),this.readable=!0,oe&&(typeof oe.read=="function"&&(this._read=oe.read),typeof oe.destroy=="function"&&(this._destroy=oe.destroy)),t.call(this)}Object.defineProperty(ve.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(ie){this._readableState&&(this._readableState.destroyed=ie)}}),ve.prototype.destroy=h.destroy,ve.prototype._undestroy=h.undestroy,ve.prototype._destroy=function(oe,ie){ie(oe)},ve.prototype.push=function(oe,ie){var Ie=this._readableState,qe;return Ie.objectMode?qe=!0:typeof oe=="string"&&(ie=ie||Ie.defaultEncoding,ie!==Ie.encoding&&(oe=i.from(oe,ie),ie=""),qe=!0),Qe(this,oe,ie,!1,qe)},ve.prototype.unshift=function(oe){return Qe(this,oe,null,!0,!1)};function Qe(oe,ie,Ie,qe,Ze){d("readableAddChunk",ie);var lt=oe._readableState;if(ie===null)lt.reading=!1,I(oe,lt);else{var ht;if(Ze||(ht=C(lt,ie)),ht)W(oe,ht);else if(lt.objectMode||ie&&ie.length>0)if(typeof ie!="string"&&!lt.objectMode&&Object.getPrototypeOf(ie)!==i.prototype&&(ie=a(ie)),qe)lt.endEmitted?W(oe,new D):re(oe,lt,ie,!0);else if(lt.ended)W(oe,new $);else{if(lt.destroyed)return!1;lt.reading=!1,lt.decoder&&!Ie?(ie=lt.decoder.write(ie),lt.objectMode||ie.length!==0?re(oe,lt,ie,!1):L(oe,lt)):re(oe,lt,ie,!1)}else qe||(lt.reading=!1,L(oe,lt))}return!lt.ended&&(lt.length<lt.highWaterMark||lt.length===0)}function re(oe,ie,Ie,qe){ie.flowing&&ie.length===0&&!ie.sync?(ie.awaitDrain=0,oe.emit("data",Ie)):(ie.length+=ie.objectMode?1:Ie.length,qe?ie.buffer.unshift(Ie):ie.buffer.push(Ie),ie.needReadable&&N(oe)),L(oe,ie)}function C(oe,ie){var Ie;return!c(ie)&&typeof ie!="string"&&ie!==void 0&&!oe.objectMode&&(Ie=new _("chunk",["string","Buffer","Uint8Array"],ie)),Ie}ve.prototype.isPaused=function(){return this._readableState.flowing===!1},ve.prototype.setEncoding=function(oe){O||(O=requireString_decoder().StringDecoder);var ie=new O(oe);this._readableState.decoder=ie,this._readableState.encoding=this._readableState.decoder.encoding;for(var Ie=this._readableState.buffer.head,qe="";Ie!==null;)qe+=ie.write(Ie.data),Ie=Ie.next;return this._readableState.buffer.clear(),qe!==""&&this._readableState.buffer.push(qe),this._readableState.length=qe.length,this};var S=1073741824;function w(oe){return oe>=S?oe=S:(oe--,oe|=oe>>>1,oe|=oe>>>2,oe|=oe>>>4,oe|=oe>>>8,oe|=oe>>>16,oe++),oe}function E(oe,ie){return oe<=0||ie.length===0&&ie.ended?0:ie.objectMode?1:oe!==oe?ie.flowing&&ie.length?ie.buffer.head.data.length:ie.length:(oe>ie.highWaterMark&&(ie.highWaterMark=w(oe)),oe<=ie.length?oe:ie.ended?ie.length:(ie.needReadable=!0,0))}ve.prototype.read=function(oe){d("read",oe),oe=parseInt(oe,10);var ie=this._readableState,Ie=oe;if(oe!==0&&(ie.emittedReadable=!1),oe===0&&ie.needReadable&&((ie.highWaterMark!==0?ie.length>=ie.highWaterMark:ie.length>0)||ie.ended))return d("read: emitReadable",ie.length,ie.ended),ie.length===0&&ie.ended?$e(this):N(this),null;if(oe=E(oe,ie),oe===0&&ie.ended)return ie.length===0&&$e(this),null;var qe=ie.needReadable;d("need readable",qe),(ie.length===0||ie.length-oe<ie.highWaterMark)&&(qe=!0,d("length less than watermark",qe)),ie.ended||ie.reading?(qe=!1,d("reading or ended",qe)):qe&&(d("do read"),ie.reading=!0,ie.sync=!0,ie.length===0&&(ie.needReadable=!0),this._read(ie.highWaterMark),ie.sync=!1,ie.reading||(oe=E(Ie,ie)));var Ze;return oe>0?Ze=he(oe,ie):Ze=null,Ze===null?(ie.needReadable=ie.length<=ie.highWaterMark,oe=0):(ie.length-=oe,ie.awaitDrain=0),ie.length===0&&(ie.ended||(ie.needReadable=!0),Ie!==oe&&ie.ended&&$e(this)),Ze!==null&&this.emit("data",Ze),Ze};function I(oe,ie){if(d("onEofChunk"),!ie.ended){if(ie.decoder){var Ie=ie.decoder.end();Ie&&Ie.length&&(ie.buffer.push(Ie),ie.length+=ie.objectMode?1:Ie.length)}ie.ended=!0,ie.sync?N(oe):(ie.needReadable=!1,ie.emittedReadable||(ie.emittedReadable=!0,U(oe)))}}function N(oe){var ie=oe._readableState;d("emitReadable",ie.needReadable,ie.emittedReadable),ie.needReadable=!1,ie.emittedReadable||(d("emitReadable",ie.flowing),ie.emittedReadable=!0,process$3.nextTick(U,oe))}function U(oe){var ie=oe._readableState;d("emitReadable_",ie.destroyed,ie.length,ie.ended),!ie.destroyed&&(ie.length||ie.ended)&&(oe.emit("readable"),ie.emittedReadable=!1),ie.needReadable=!ie.flowing&&!ie.ended&&ie.length<=ie.highWaterMark,se(oe)}function L(oe,ie){ie.readingMore||(ie.readingMore=!0,process$3.nextTick(P,oe,ie))}function P(oe,ie){for(;!ie.reading&&!ie.ended&&(ie.length<ie.highWaterMark||ie.flowing&&ie.length===0);){var Ie=ie.length;if(d("maybeReadMore read 0"),oe.read(0),Ie===ie.length)break}ie.readingMore=!1}ve.prototype._read=function(oe){W(this,new k("_read()"))},ve.prototype.pipe=function(oe,ie){var Ie=this,qe=this._readableState;switch(qe.pipesCount){case 0:qe.pipes=oe;break;case 1:qe.pipes=[qe.pipes,oe];break;default:qe.pipes.push(oe);break}qe.pipesCount+=1,d("pipe count=%d opts=%j",qe.pipesCount,ie);var Ze=(!ie||ie.end!==!1)&&oe!==process$3.stdout&&oe!==process$3.stderr,lt=Ze?gt:Be;qe.endEmitted?process$3.nextTick(lt):Ie.once("end",lt),oe.on("unpipe",ht);function ht(Re,Ye){d("onunpipe"),Re===Ie&&Ye&&Ye.hasUnpiped===!1&&(Ye.hasUnpiped=!0,ot())}function gt(){d("onend"),oe.end()}var Me=B(Ie);oe.on("drain",Me);var jt=!1;function ot(){d("cleanup"),oe.removeListener("close",be),oe.removeListener("finish",Pe),oe.removeListener("drain",Me),oe.removeListener("error",Ut),oe.removeListener("unpipe",ht),Ie.removeListener("end",gt),Ie.removeListener("end",Be),Ie.removeListener("data",Ot),jt=!0,qe.awaitDrain&&(!oe._writableState||oe._writableState.needDrain)&&Me()}Ie.on("data",Ot);function Ot(Re){d("ondata");var Ye=oe.write(Re);d("dest.write",Ye),Ye===!1&&((qe.pipesCount===1&&qe.pipes===oe||qe.pipesCount>1&&ze(qe.pipes,oe)!==-1)&&!jt&&(d("false write response, pause",qe.awaitDrain),qe.awaitDrain++),Ie.pause())}function Ut(Re){d("onerror",Re),Be(),oe.removeListener("error",Ut),e(oe,"error")===0&&W(oe,Re)}fe(oe,"error",Ut);function be(){oe.removeListener("finish",Pe),Be()}oe.once("close",be);function Pe(){d("onfinish"),oe.removeListener("close",be),Be()}oe.once("finish",Pe);function Be(){d("unpipe"),Ie.unpipe(oe)}return oe.emit("pipe",Ie),qe.flowing||(d("pipe resume"),Ie.resume()),oe};function B(oe){return function(){var Ie=oe._readableState;d("pipeOnDrain",Ie.awaitDrain),Ie.awaitDrain&&Ie.awaitDrain--,Ie.awaitDrain===0&&e(oe,"data")&&(Ie.flowing=!0,se(oe))}}ve.prototype.unpipe=function(oe){var ie=this._readableState,Ie={hasUnpiped:!1};if(ie.pipesCount===0)return this;if(ie.pipesCount===1)return oe&&oe!==ie.pipes?this:(oe||(oe=ie.pipes),ie.pipes=null,ie.pipesCount=0,ie.flowing=!1,oe&&oe.emit("unpipe",this,Ie),this);if(!oe){var qe=ie.pipes,Ze=ie.pipesCount;ie.pipes=null,ie.pipesCount=0,ie.flowing=!1;for(var lt=0;lt<Ze;lt++)qe[lt].emit("unpipe",this,{hasUnpiped:!1});return this}var ht=ze(ie.pipes,oe);return ht===-1?this:(ie.pipes.splice(ht,1),ie.pipesCount-=1,ie.pipesCount===1&&(ie.pipes=ie.pipes[0]),oe.emit("unpipe",this,Ie),this)},ve.prototype.on=function(oe,ie){var Ie=t.prototype.on.call(this,oe,ie),qe=this._readableState;return oe==="data"?(qe.readableListening=this.listenerCount("readable")>0,qe.flowing!==!1&&this.resume()):oe==="readable"&&!qe.endEmitted&&!qe.readableListening&&(qe.readableListening=qe.needReadable=!0,qe.flowing=!1,qe.emittedReadable=!1,d("on readable",qe.length,qe.reading),qe.length?N(this):qe.reading||process$3.nextTick(z,this)),Ie},ve.prototype.addListener=ve.prototype.on,ve.prototype.removeListener=function(oe,ie){var Ie=t.prototype.removeListener.call(this,oe,ie);return oe==="readable"&&process$3.nextTick(A,this),Ie},ve.prototype.removeAllListeners=function(oe){var ie=t.prototype.removeAllListeners.apply(this,arguments);return(oe==="readable"||oe===void 0)&&process$3.nextTick(A,this),ie};function A(oe){var ie=oe._readableState;ie.readableListening=oe.listenerCount("readable")>0,ie.resumeScheduled&&!ie.paused?ie.flowing=!0:oe.listenerCount("data")>0&&oe.resume()}function z(oe){d("readable nexttick read 0"),oe.read(0)}ve.prototype.resume=function(){var oe=this._readableState;return oe.flowing||(d("resume"),oe.flowing=!oe.readableListening,de(this,oe)),oe.paused=!1,this};function de(oe,ie){ie.resumeScheduled||(ie.resumeScheduled=!0,process$3.nextTick(we,oe,ie))}function we(oe,ie){d("resume",ie.reading),ie.reading||oe.read(0),ie.resumeScheduled=!1,oe.emit("resume"),se(oe),ie.flowing&&!ie.reading&&oe.read(0)}ve.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function se(oe){var ie=oe._readableState;for(d("flow",ie.flowing);ie.flowing&&oe.read()!==null;);}ve.prototype.wrap=function(oe){var ie=this,Ie=this._readableState,qe=!1;oe.on("end",function(){if(d("wrapped end"),Ie.decoder&&!Ie.ended){var ht=Ie.decoder.end();ht&&ht.length&&ie.push(ht)}ie.push(null)}),oe.on("data",function(ht){if(d("wrapped data"),Ie.decoder&&(ht=Ie.decoder.write(ht)),!(Ie.objectMode&&ht==null)&&!(!Ie.objectMode&&(!ht||!ht.length))){var gt=ie.push(ht);gt||(qe=!0,oe.pause())}});for(var Ze in oe)this[Ze]===void 0&&typeof oe[Ze]=="function"&&(this[Ze]=function(gt){return function(){return oe[gt].apply(oe,arguments)}}(Ze));for(var lt=0;lt<ae.length;lt++)oe.on(ae[lt],this.emit.bind(this,ae[lt]));return this._read=function(ht){d("wrapped _read",ht),qe&&(qe=!1,oe.resume())},this},typeof Symbol=="function"&&(ve.prototype[Symbol.asyncIterator]=function(){return H===void 0&&(H=requireAsync_iterator()),H(this)}),Object.defineProperty(ve.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(ve.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(ve.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(ie){this._readableState&&(this._readableState.flowing=ie)}}),ve._fromList=he,Object.defineProperty(ve.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function he(oe,ie){if(ie.length===0)return null;var Ie;return ie.objectMode?Ie=ie.buffer.shift():!oe||oe>=ie.length?(ie.decoder?Ie=ie.buffer.join(""):ie.buffer.length===1?Ie=ie.buffer.first():Ie=ie.buffer.concat(ie.length),ie.buffer.clear()):Ie=ie.buffer.consume(oe,ie.decoder),Ie}function $e(oe){var ie=oe._readableState;d("endReadable",ie.endEmitted),ie.endEmitted||(ie.ended=!0,process$3.nextTick(Ae,ie,oe))}function Ae(oe,ie){if(d("endReadableNT",oe.endEmitted,oe.length),!oe.endEmitted&&oe.length===0&&(oe.endEmitted=!0,ie.readable=!1,ie.emit("end"),oe.autoDestroy)){var Ie=ie._writableState;(!Ie||Ie.autoDestroy&&Ie.finished)&&ie.destroy()}}typeof Symbol=="function"&&(ve.from=function(oe,ie){return j===void 0&&(j=requireFromBrowser()),j(ve,oe,ie)});function ze(oe,ie){for(var Ie=0,qe=oe.length;Ie<qe;Ie++)if(oe[Ie]===ie)return Ie;return-1}return _stream_readable}var _stream_transform,hasRequired_stream_transform;function require_stream_transform(){if(hasRequired_stream_transform)return _stream_transform;hasRequired_stream_transform=1,_stream_transform=u;var n=requireErrorsBrowser().codes,e=n.ERR_METHOD_NOT_IMPLEMENTED,t=n.ERR_MULTIPLE_CALLBACK,i=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=n.ERR_TRANSFORM_WITH_LENGTH_0,a=require_stream_duplex();inherits_browserExports(u,a);function c(h,b){var m=this._transformState;m.transforming=!1;var v=m.writecb;if(v===null)return this.emit("error",new t);m.writechunk=null,m.writecb=null,b!=null&&this.push(b),v(h);var _=this._readableState;_.reading=!1,(_.needReadable||_.length<_.highWaterMark)&&this._read(_.highWaterMark)}function u(h){if(!(this instanceof u))return new u(h);a.call(this,h),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,h&&(typeof h.transform=="function"&&(this._transform=h.transform),typeof h.flush=="function"&&(this._flush=h.flush)),this.on("prefinish",d)}function d(){var h=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(b,m){p(h,b,m)}):p(this,null,null)}u.prototype.push=function(h,b){return this._transformState.needTransform=!1,a.prototype.push.call(this,h,b)},u.prototype._transform=function(h,b,m){m(new e("_transform()"))},u.prototype._write=function(h,b,m){var v=this._transformState;if(v.writecb=m,v.writechunk=h,v.writeencoding=b,!v.transforming){var _=this._readableState;(v.needTransform||_.needReadable||_.length<_.highWaterMark)&&this._read(_.highWaterMark)}},u.prototype._read=function(h){var b=this._transformState;b.writechunk!==null&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0},u.prototype._destroy=function(h,b){a.prototype._destroy.call(this,h,function(m){b(m)})};function p(h,b,m){if(b)return h.emit("error",b);if(m!=null&&h.push(m),h._writableState.length)throw new o;if(h._transformState.transforming)throw new i;return h.push(null)}return _stream_transform}var _stream_passthrough,hasRequired_stream_passthrough;function require_stream_passthrough(){if(hasRequired_stream_passthrough)return _stream_passthrough;hasRequired_stream_passthrough=1,_stream_passthrough=e;var n=require_stream_transform();inherits_browserExports(e,n);function e(t){if(!(this instanceof e))return new e(t);n.call(this,t)}return e.prototype._transform=function(t,i,o){o(null,t)},_stream_passthrough}var pipeline_1,hasRequiredPipeline;function requirePipeline(){if(hasRequiredPipeline)return pipeline_1;hasRequiredPipeline=1;var n;function e(m){var v=!1;return function(){v||(v=!0,m.apply(void 0,arguments))}}var t=requireErrorsBrowser().codes,i=t.ERR_MISSING_ARGS,o=t.ERR_STREAM_DESTROYED;function a(m){if(m)throw m}function c(m){return m.setHeader&&typeof m.abort=="function"}function u(m,v,_,$){$=e($);var k=!1;m.on("close",function(){k=!0}),n===void 0&&(n=requireEndOfStream()),n(m,{readable:v,writable:_},function(O){if(O)return $(O);k=!0,$()});var D=!1;return function(O){if(!k&&!D){if(D=!0,c(m))return m.abort();if(typeof m.destroy=="function")return m.destroy();$(O||new o("pipe"))}}}function d(m){m()}function p(m,v){return m.pipe(v)}function h(m){return!m.length||typeof m[m.length-1]!="function"?a:m.pop()}function b(){for(var m=arguments.length,v=new Array(m),_=0;_<m;_++)v[_]=arguments[_];var $=h(v);if(Array.isArray(v[0])&&(v=v[0]),v.length<2)throw new i("streams");var k,D=v.map(function(O,H){var j=H<v.length-1,W=H>0;return u(O,j,W,function(ae){k||(k=ae),ae&&D.forEach(d),!j&&(D.forEach(d),$(k))})});return v.reduce(p)}return pipeline_1=b,pipeline_1}var hasRequiredReadableBrowser;function requireReadableBrowser(){return hasRequiredReadableBrowser||(hasRequiredReadableBrowser=1,function(n,e){e=n.exports=require_stream_readable(),e.Stream=e,e.Readable=e,e.Writable=require_stream_writable(),e.Duplex=require_stream_duplex(),e.Transform=require_stream_transform(),e.PassThrough=require_stream_passthrough(),e.finished=requireEndOfStream(),e.pipeline=requirePipeline()}(readableBrowser,readableBrowser.exports)),readableBrowser.exports}var hashBase,hasRequiredHashBase;function requireHashBase(){if(hasRequiredHashBase)return hashBase;hasRequiredHashBase=1;var n=safeBufferExports.Buffer,e=requireReadableBrowser().Transform,t=inherits_browserExports;function i(a,c){if(!n.isBuffer(a)&&typeof a!="string")throw new TypeError(c+" must be a string or a buffer")}function o(a){e.call(this),this._block=n.allocUnsafe(a),this._blockSize=a,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}return t(o,e),o.prototype._transform=function(a,c,u){var d=null;try{this.update(a,c)}catch(p){d=p}u(d)},o.prototype._flush=function(a){var c=null;try{this.push(this.digest())}catch(u){c=u}a(c)},o.prototype.update=function(a,c){if(i(a,"Data"),this._finalized)throw new Error("Digest already called");n.isBuffer(a)||(a=n.from(a,c));for(var u=this._block,d=0;this._blockOffset+a.length-d>=this._blockSize;){for(var p=this._blockOffset;p<this._blockSize;)u[p++]=a[d++];this._update(),this._blockOffset=0}for(;d<a.length;)u[this._blockOffset++]=a[d++];for(var h=0,b=a.length*8;b>0;++h)this._length[h]+=b,b=this._length[h]/4294967296|0,b>0&&(this._length[h]-=4294967296*b);return this},o.prototype._update=function(){throw new Error("_update is not implemented")},o.prototype.digest=function(a){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var c=this._digest();a!==void 0&&(c=c.toString(a)),this._block.fill(0),this._blockOffset=0;for(var u=0;u<4;++u)this._length[u]=0;return c},o.prototype._digest=function(){throw new Error("_digest is not implemented")},hashBase=o,hashBase}var md5_js,hasRequiredMd5_js;function requireMd5_js(){if(hasRequiredMd5_js)return md5_js;hasRequiredMd5_js=1;var n=inherits_browserExports,e=requireHashBase(),t=safeBufferExports.Buffer,i=new Array(16);function o(){e.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}n(o,e),o.prototype._update=function(){for(var h=i,b=0;b<16;++b)h[b]=this._block.readInt32LE(b*4);var m=this._a,v=this._b,_=this._c,$=this._d;m=c(m,v,_,$,h[0],3614090360,7),$=c($,m,v,_,h[1],3905402710,12),_=c(_,$,m,v,h[2],606105819,17),v=c(v,_,$,m,h[3],3250441966,22),m=c(m,v,_,$,h[4],4118548399,7),$=c($,m,v,_,h[5],1200080426,12),_=c(_,$,m,v,h[6],2821735955,17),v=c(v,_,$,m,h[7],4249261313,22),m=c(m,v,_,$,h[8],1770035416,7),$=c($,m,v,_,h[9],2336552879,12),_=c(_,$,m,v,h[10],4294925233,17),v=c(v,_,$,m,h[11],2304563134,22),m=c(m,v,_,$,h[12],1804603682,7),$=c($,m,v,_,h[13],4254626195,12),_=c(_,$,m,v,h[14],2792965006,17),v=c(v,_,$,m,h[15],1236535329,22),m=u(m,v,_,$,h[1],4129170786,5),$=u($,m,v,_,h[6],3225465664,9),_=u(_,$,m,v,h[11],643717713,14),v=u(v,_,$,m,h[0],3921069994,20),m=u(m,v,_,$,h[5],3593408605,5),$=u($,m,v,_,h[10],38016083,9),_=u(_,$,m,v,h[15],3634488961,14),v=u(v,_,$,m,h[4],3889429448,20),m=u(m,v,_,$,h[9],568446438,5),$=u($,m,v,_,h[14],3275163606,9),_=u(_,$,m,v,h[3],4107603335,14),v=u(v,_,$,m,h[8],1163531501,20),m=u(m,v,_,$,h[13],2850285829,5),$=u($,m,v,_,h[2],4243563512,9),_=u(_,$,m,v,h[7],1735328473,14),v=u(v,_,$,m,h[12],2368359562,20),m=d(m,v,_,$,h[5],4294588738,4),$=d($,m,v,_,h[8],2272392833,11),_=d(_,$,m,v,h[11],1839030562,16),v=d(v,_,$,m,h[14],4259657740,23),m=d(m,v,_,$,h[1],2763975236,4),$=d($,m,v,_,h[4],1272893353,11),_=d(_,$,m,v,h[7],4139469664,16),v=d(v,_,$,m,h[10],3200236656,23),m=d(m,v,_,$,h[13],681279174,4),$=d($,m,v,_,h[0],3936430074,11),_=d(_,$,m,v,h[3],3572445317,16),v=d(v,_,$,m,h[6],76029189,23),m=d(m,v,_,$,h[9],3654602809,4),$=d($,m,v,_,h[12],3873151461,11),_=d(_,$,m,v,h[15],530742520,16),v=d(v,_,$,m,h[2],3299628645,23),m=p(m,v,_,$,h[0],4096336452,6),$=p($,m,v,_,h[7],1126891415,10),_=p(_,$,m,v,h[14],2878612391,15),v=p(v,_,$,m,h[5],4237533241,21),m=p(m,v,_,$,h[12],1700485571,6),$=p($,m,v,_,h[3],2399980690,10),_=p(_,$,m,v,h[10],4293915773,15),v=p(v,_,$,m,h[1],2240044497,21),m=p(m,v,_,$,h[8],1873313359,6),$=p($,m,v,_,h[15],4264355552,10),_=p(_,$,m,v,h[6],2734768916,15),v=p(v,_,$,m,h[13],1309151649,21),m=p(m,v,_,$,h[4],4149444226,6),$=p($,m,v,_,h[11],3174756917,10),_=p(_,$,m,v,h[2],718787259,15),v=p(v,_,$,m,h[9],3951481745,21),this._a=this._a+m|0,this._b=this._b+v|0,this._c=this._c+_|0,this._d=this._d+$|0},o.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var h=t.allocUnsafe(16);return h.writeInt32LE(this._a,0),h.writeInt32LE(this._b,4),h.writeInt32LE(this._c,8),h.writeInt32LE(this._d,12),h};function a(h,b){return h<<b|h>>>32-b}function c(h,b,m,v,_,$,k){return a(h+(b&m|~b&v)+_+$|0,k)+b|0}function u(h,b,m,v,_,$,k){return a(h+(b&v|m&~v)+_+$|0,k)+b|0}function d(h,b,m,v,_,$,k){return a(h+(b^m^v)+_+$|0,k)+b|0}function p(h,b,m,v,_,$,k){return a(h+(m^(b|~v))+_+$|0,k)+b|0}return md5_js=o,md5_js}var ripemd160,hasRequiredRipemd160;function requireRipemd160(){if(hasRequiredRipemd160)return ripemd160;hasRequiredRipemd160=1;var n=buffer$2.Buffer,e=inherits_browserExports,t=requireHashBase(),i=new Array(16),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],a=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],c=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],u=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],d=[0,1518500249,1859775393,2400959708,2840853838],p=[1352829926,1548603684,1836072691,2053994217,0];function h(){t.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}e(h,t),h.prototype._update=function(){for(var D=i,O=0;O<16;++O)D[O]=this._block.readInt32LE(O*4);for(var H=this._a|0,j=this._b|0,W=this._c|0,ae=this._d|0,fe=this._e|0,pe=this._a|0,ve=this._b|0,Qe=this._c|0,re=this._d|0,C=this._e|0,S=0;S<80;S+=1){var w,E;S<16?(w=m(H,j,W,ae,fe,D[o[S]],d[0],c[S]),E=k(pe,ve,Qe,re,C,D[a[S]],p[0],u[S])):S<32?(w=v(H,j,W,ae,fe,D[o[S]],d[1],c[S]),E=$(pe,ve,Qe,re,C,D[a[S]],p[1],u[S])):S<48?(w=_(H,j,W,ae,fe,D[o[S]],d[2],c[S]),E=_(pe,ve,Qe,re,C,D[a[S]],p[2],u[S])):S<64?(w=$(H,j,W,ae,fe,D[o[S]],d[3],c[S]),E=v(pe,ve,Qe,re,C,D[a[S]],p[3],u[S])):(w=k(H,j,W,ae,fe,D[o[S]],d[4],c[S]),E=m(pe,ve,Qe,re,C,D[a[S]],p[4],u[S])),H=fe,fe=ae,ae=b(W,10),W=j,j=w,pe=C,C=re,re=b(Qe,10),Qe=ve,ve=E}var I=this._b+W+re|0;this._b=this._c+ae+C|0,this._c=this._d+fe+pe|0,this._d=this._e+H+ve|0,this._e=this._a+j+Qe|0,this._a=I},h.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var D=n.alloc?n.alloc(20):new n(20);return D.writeInt32LE(this._a,0),D.writeInt32LE(this._b,4),D.writeInt32LE(this._c,8),D.writeInt32LE(this._d,12),D.writeInt32LE(this._e,16),D};function b(D,O){return D<<O|D>>>32-O}function m(D,O,H,j,W,ae,fe,pe){return b(D+(O^H^j)+ae+fe|0,pe)+W|0}function v(D,O,H,j,W,ae,fe,pe){return b(D+(O&H|~O&j)+ae+fe|0,pe)+W|0}function _(D,O,H,j,W,ae,fe,pe){return b(D+((O|~H)^j)+ae+fe|0,pe)+W|0}function $(D,O,H,j,W,ae,fe,pe){return b(D+(O&j|H&~j)+ae+fe|0,pe)+W|0}function k(D,O,H,j,W,ae,fe,pe){return b(D+(O^(H|~j))+ae+fe|0,pe)+W|0}return ripemd160=h,ripemd160}var sha_js={exports:{}},hash$5,hasRequiredHash;function requireHash(){if(hasRequiredHash)return hash$5;hasRequiredHash=1;var n=safeBufferExports.Buffer;function e(t,i){this._block=n.alloc(t),this._finalSize=i,this._blockSize=t,this._len=0}return e.prototype.update=function(t,i){typeof t=="string"&&(i=i||"utf8",t=n.from(t,i));for(var o=this._block,a=this._blockSize,c=t.length,u=this._len,d=0;d<c;){for(var p=u%a,h=Math.min(c-d,a-p),b=0;b<h;b++)o[p+b]=t[d+b];u+=h,d+=h,u%a===0&&this._update(o)}return this._len+=c,this},e.prototype.digest=function(t){var i=this._len%this._blockSize;this._block[i]=128,this._block.fill(0,i+1),i>=this._finalSize&&(this._update(this._block),this._block.fill(0));var o=this._len*8;if(o<=4294967295)this._block.writeUInt32BE(o,this._blockSize-4);else{var a=(o&4294967295)>>>0,c=(o-a)/4294967296;this._block.writeUInt32BE(c,this._blockSize-8),this._block.writeUInt32BE(a,this._blockSize-4)}this._update(this._block);var u=this._hash();return t?u.toString(t):u},e.prototype._update=function(){throw new Error("_update must be implemented by subclass")},hash$5=e,hash$5}var sha$2,hasRequiredSha;function requireSha(){if(hasRequiredSha)return sha$2;hasRequiredSha=1;var n=inherits_browserExports,e=requireHash(),t=safeBufferExports.Buffer,i=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function a(){this.init(),this._w=o,e.call(this,64,56)}n(a,e),a.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function c(p){return p<<5|p>>>27}function u(p){return p<<30|p>>>2}function d(p,h,b,m){return p===0?h&b|~h&m:p===2?h&b|h&m|b&m:h^b^m}return a.prototype._update=function(p){for(var h=this._w,b=this._a|0,m=this._b|0,v=this._c|0,_=this._d|0,$=this._e|0,k=0;k<16;++k)h[k]=p.readInt32BE(k*4);for(;k<80;++k)h[k]=h[k-3]^h[k-8]^h[k-14]^h[k-16];for(var D=0;D<80;++D){var O=~~(D/20),H=c(b)+d(O,m,v,_)+$+h[D]+i[O]|0;$=_,_=v,v=u(m),m=b,b=H}this._a=b+this._a|0,this._b=m+this._b|0,this._c=v+this._c|0,this._d=_+this._d|0,this._e=$+this._e|0},a.prototype._hash=function(){var p=t.allocUnsafe(20);return p.writeInt32BE(this._a|0,0),p.writeInt32BE(this._b|0,4),p.writeInt32BE(this._c|0,8),p.writeInt32BE(this._d|0,12),p.writeInt32BE(this._e|0,16),p},sha$2=a,sha$2}var sha1,hasRequiredSha1;function requireSha1(){if(hasRequiredSha1)return sha1;hasRequiredSha1=1;var n=inherits_browserExports,e=requireHash(),t=safeBufferExports.Buffer,i=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function a(){this.init(),this._w=o,e.call(this,64,56)}n(a,e),a.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function c(h){return h<<1|h>>>31}function u(h){return h<<5|h>>>27}function d(h){return h<<30|h>>>2}function p(h,b,m,v){return h===0?b&m|~b&v:h===2?b&m|b&v|m&v:b^m^v}return a.prototype._update=function(h){for(var b=this._w,m=this._a|0,v=this._b|0,_=this._c|0,$=this._d|0,k=this._e|0,D=0;D<16;++D)b[D]=h.readInt32BE(D*4);for(;D<80;++D)b[D]=c(b[D-3]^b[D-8]^b[D-14]^b[D-16]);for(var O=0;O<80;++O){var H=~~(O/20),j=u(m)+p(H,v,_,$)+k+b[O]+i[H]|0;k=$,$=_,_=d(v),v=m,m=j}this._a=m+this._a|0,this._b=v+this._b|0,this._c=_+this._c|0,this._d=$+this._d|0,this._e=k+this._e|0},a.prototype._hash=function(){var h=t.allocUnsafe(20);return h.writeInt32BE(this._a|0,0),h.writeInt32BE(this._b|0,4),h.writeInt32BE(this._c|0,8),h.writeInt32BE(this._d|0,12),h.writeInt32BE(this._e|0,16),h},sha1=a,sha1}var sha256$3,hasRequiredSha256;function requireSha256(){if(hasRequiredSha256)return sha256$3;hasRequiredSha256=1;var n=inherits_browserExports,e=requireHash(),t=safeBufferExports.Buffer,i=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=new Array(64);function a(){this.init(),this._w=o,e.call(this,64,56)}n(a,e),a.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function c(m,v,_){return _^m&(v^_)}function u(m,v,_){return m&v|_&(m|v)}function d(m){return(m>>>2|m<<30)^(m>>>13|m<<19)^(m>>>22|m<<10)}function p(m){return(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7)}function h(m){return(m>>>7|m<<25)^(m>>>18|m<<14)^m>>>3}function b(m){return(m>>>17|m<<15)^(m>>>19|m<<13)^m>>>10}return a.prototype._update=function(m){for(var v=this._w,_=this._a|0,$=this._b|0,k=this._c|0,D=this._d|0,O=this._e|0,H=this._f|0,j=this._g|0,W=this._h|0,ae=0;ae<16;++ae)v[ae]=m.readInt32BE(ae*4);for(;ae<64;++ae)v[ae]=b(v[ae-2])+v[ae-7]+h(v[ae-15])+v[ae-16]|0;for(var fe=0;fe<64;++fe){var pe=W+p(O)+c(O,H,j)+i[fe]+v[fe]|0,ve=d(_)+u(_,$,k)|0;W=j,j=H,H=O,O=D+pe|0,D=k,k=$,$=_,_=pe+ve|0}this._a=_+this._a|0,this._b=$+this._b|0,this._c=k+this._c|0,this._d=D+this._d|0,this._e=O+this._e|0,this._f=H+this._f|0,this._g=j+this._g|0,this._h=W+this._h|0},a.prototype._hash=function(){var m=t.allocUnsafe(32);return m.writeInt32BE(this._a,0),m.writeInt32BE(this._b,4),m.writeInt32BE(this._c,8),m.writeInt32BE(this._d,12),m.writeInt32BE(this._e,16),m.writeInt32BE(this._f,20),m.writeInt32BE(this._g,24),m.writeInt32BE(this._h,28),m},sha256$3=a,sha256$3}var sha224$1,hasRequiredSha224;function requireSha224(){if(hasRequiredSha224)return sha224$1;hasRequiredSha224=1;var n=inherits_browserExports,e=requireSha256(),t=requireHash(),i=safeBufferExports.Buffer,o=new Array(64);function a(){this.init(),this._w=o,t.call(this,64,56)}return n(a,e),a.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},a.prototype._hash=function(){var c=i.allocUnsafe(28);return c.writeInt32BE(this._a,0),c.writeInt32BE(this._b,4),c.writeInt32BE(this._c,8),c.writeInt32BE(this._d,12),c.writeInt32BE(this._e,16),c.writeInt32BE(this._f,20),c.writeInt32BE(this._g,24),c},sha224$1=a,sha224$1}var sha512$1,hasRequiredSha512;function requireSha512(){if(hasRequiredSha512)return sha512$1;hasRequiredSha512=1;var n=inherits_browserExports,e=requireHash(),t=safeBufferExports.Buffer,i=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],o=new Array(160);function a(){this.init(),this._w=o,e.call(this,128,112)}n(a,e),a.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function c($,k,D){return D^$&(k^D)}function u($,k,D){return $&k|D&($|k)}function d($,k){return($>>>28|k<<4)^(k>>>2|$<<30)^(k>>>7|$<<25)}function p($,k){return($>>>14|k<<18)^($>>>18|k<<14)^(k>>>9|$<<23)}function h($,k){return($>>>1|k<<31)^($>>>8|k<<24)^$>>>7}function b($,k){return($>>>1|k<<31)^($>>>8|k<<24)^($>>>7|k<<25)}function m($,k){return($>>>19|k<<13)^(k>>>29|$<<3)^$>>>6}function v($,k){return($>>>19|k<<13)^(k>>>29|$<<3)^($>>>6|k<<26)}function _($,k){return $>>>0<k>>>0?1:0}return a.prototype._update=function($){for(var k=this._w,D=this._ah|0,O=this._bh|0,H=this._ch|0,j=this._dh|0,W=this._eh|0,ae=this._fh|0,fe=this._gh|0,pe=this._hh|0,ve=this._al|0,Qe=this._bl|0,re=this._cl|0,C=this._dl|0,S=this._el|0,w=this._fl|0,E=this._gl|0,I=this._hl|0,N=0;N<32;N+=2)k[N]=$.readInt32BE(N*4),k[N+1]=$.readInt32BE(N*4+4);for(;N<160;N+=2){var U=k[N-30],L=k[N-15*2+1],P=h(U,L),B=b(L,U);U=k[N-2*2],L=k[N-2*2+1];var A=m(U,L),z=v(L,U),de=k[N-7*2],we=k[N-7*2+1],se=k[N-16*2],he=k[N-16*2+1],$e=B+we|0,Ae=P+de+_($e,B)|0;$e=$e+z|0,Ae=Ae+A+_($e,z)|0,$e=$e+he|0,Ae=Ae+se+_($e,he)|0,k[N]=Ae,k[N+1]=$e}for(var ze=0;ze<160;ze+=2){Ae=k[ze],$e=k[ze+1];var oe=u(D,O,H),ie=u(ve,Qe,re),Ie=d(D,ve),qe=d(ve,D),Ze=p(W,S),lt=p(S,W),ht=i[ze],gt=i[ze+1],Me=c(W,ae,fe),jt=c(S,w,E),ot=I+lt|0,Ot=pe+Ze+_(ot,I)|0;ot=ot+jt|0,Ot=Ot+Me+_(ot,jt)|0,ot=ot+gt|0,Ot=Ot+ht+_(ot,gt)|0,ot=ot+$e|0,Ot=Ot+Ae+_(ot,$e)|0;var Ut=qe+ie|0,be=Ie+oe+_(Ut,qe)|0;pe=fe,I=E,fe=ae,E=w,ae=W,w=S,S=C+ot|0,W=j+Ot+_(S,C)|0,j=H,C=re,H=O,re=Qe,O=D,Qe=ve,ve=ot+Ut|0,D=Ot+be+_(ve,ot)|0}this._al=this._al+ve|0,this._bl=this._bl+Qe|0,this._cl=this._cl+re|0,this._dl=this._dl+C|0,this._el=this._el+S|0,this._fl=this._fl+w|0,this._gl=this._gl+E|0,this._hl=this._hl+I|0,this._ah=this._ah+D+_(this._al,ve)|0,this._bh=this._bh+O+_(this._bl,Qe)|0,this._ch=this._ch+H+_(this._cl,re)|0,this._dh=this._dh+j+_(this._dl,C)|0,this._eh=this._eh+W+_(this._el,S)|0,this._fh=this._fh+ae+_(this._fl,w)|0,this._gh=this._gh+fe+_(this._gl,E)|0,this._hh=this._hh+pe+_(this._hl,I)|0},a.prototype._hash=function(){var $=t.allocUnsafe(64);function k(D,O,H){$.writeInt32BE(D,H),$.writeInt32BE(O,H+4)}return k(this._ah,this._al,0),k(this._bh,this._bl,8),k(this._ch,this._cl,16),k(this._dh,this._dl,24),k(this._eh,this._el,32),k(this._fh,this._fl,40),k(this._gh,this._gl,48),k(this._hh,this._hl,56),$},sha512$1=a,sha512$1}var sha384$1,hasRequiredSha384;function requireSha384(){if(hasRequiredSha384)return sha384$1;hasRequiredSha384=1;var n=inherits_browserExports,e=requireSha512(),t=requireHash(),i=safeBufferExports.Buffer,o=new Array(160);function a(){this.init(),this._w=o,t.call(this,128,112)}return n(a,e),a.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},a.prototype._hash=function(){var c=i.allocUnsafe(48);function u(d,p,h){c.writeInt32BE(d,h),c.writeInt32BE(p,h+4)}return u(this._ah,this._al,0),u(this._bh,this._bl,8),u(this._ch,this._cl,16),u(this._dh,this._dl,24),u(this._eh,this._el,32),u(this._fh,this._fl,40),c},sha384$1=a,sha384$1}var hasRequiredSha_js;function requireSha_js(){if(hasRequiredSha_js)return sha_js.exports;hasRequiredSha_js=1;var n=sha_js.exports=function(t){t=t.toLowerCase();var i=n[t];if(!i)throw new Error(t+" is not supported (we accept pull requests)");return new i};return n.sha=requireSha(),n.sha1=requireSha1(),n.sha224=requireSha224(),n.sha256=requireSha256(),n.sha384=requireSha384(),n.sha512=requireSha512(),sha_js.exports}var streamBrowserify,hasRequiredStreamBrowserify;function requireStreamBrowserify(){if(hasRequiredStreamBrowserify)return streamBrowserify;hasRequiredStreamBrowserify=1,streamBrowserify=t;var n=eventsExports.EventEmitter,e=inherits_browserExports;e(t,n),t.Readable=require_stream_readable(),t.Writable=require_stream_writable(),t.Duplex=require_stream_duplex(),t.Transform=require_stream_transform(),t.PassThrough=require_stream_passthrough(),t.finished=requireEndOfStream(),t.pipeline=requirePipeline(),t.Stream=t;function t(){n.call(this)}return t.prototype.pipe=function(i,o){var a=this;function c(v){i.writable&&i.write(v)===!1&&a.pause&&a.pause()}a.on("data",c);function u(){a.readable&&a.resume&&a.resume()}i.on("drain",u),!i._isStdio&&(!o||o.end!==!1)&&(a.on("end",p),a.on("close",h));var d=!1;function p(){d||(d=!0,i.end())}function h(){d||(d=!0,typeof i.destroy=="function"&&i.destroy())}function b(v){if(m(),n.listenerCount(this,"error")===0)throw v}a.on("error",b),i.on("error",b);function m(){a.removeListener("data",c),i.removeListener("drain",u),a.removeListener("end",p),a.removeListener("close",h),a.removeListener("error",b),i.removeListener("error",b),a.removeListener("end",m),a.removeListener("close",m),i.removeListener("close",m)}return a.on("end",m),a.on("close",m),i.on("close",m),i.emit("pipe",a),i},streamBrowserify}var cipherBase,hasRequiredCipherBase;function requireCipherBase(){if(hasRequiredCipherBase)return cipherBase;hasRequiredCipherBase=1;var n=safeBufferExports.Buffer,e=requireStreamBrowserify().Transform,t=requireString_decoder().StringDecoder,i=inherits_browserExports;function o(a){e.call(this),this.hashMode=typeof a=="string",this.hashMode?this[a]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}return i(o,e),o.prototype.update=function(a,c,u){typeof a=="string"&&(a=n.from(a,c));var d=this._update(a);return this.hashMode?this:(u&&(d=this._toString(d,u)),d)},o.prototype.setAutoPadding=function(){},o.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},o.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},o.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},o.prototype._transform=function(a,c,u){var d;try{this.hashMode?this._update(a):this.push(this._update(a))}catch(p){d=p}finally{u(d)}},o.prototype._flush=function(a){var c;try{this.push(this.__final())}catch(u){c=u}a(c)},o.prototype._finalOrDigest=function(a){var c=this.__final()||n.alloc(0);return a&&(c=this._toString(c,a,!0)),c},o.prototype._toString=function(a,c,u){if(this._decoder||(this._decoder=new t(c),this._encoding=c),this._encoding!==c)throw new Error("can't switch encodings");var d=this._decoder.write(a);return u&&(d+=this._decoder.end()),d},cipherBase=o,cipherBase}var browser$9,hasRequiredBrowser$9;function requireBrowser$9(){if(hasRequiredBrowser$9)return browser$9;hasRequiredBrowser$9=1;var n=inherits_browserExports,e=requireMd5_js(),t=requireRipemd160(),i=requireSha_js(),o=requireCipherBase();function a(c){o.call(this,"digest"),this._hash=c}return n(a,o),a.prototype._update=function(c){this._hash.update(c)},a.prototype._final=function(){return this._hash.digest()},browser$9=function(u){return u=u.toLowerCase(),u==="md5"?new e:u==="rmd160"||u==="ripemd160"?new t:new a(i(u))},browser$9}var legacy,hasRequiredLegacy;function requireLegacy(){if(hasRequiredLegacy)return legacy;hasRequiredLegacy=1;var n=inherits_browserExports,e=safeBufferExports.Buffer,t=requireCipherBase(),i=e.alloc(128),o=64;function a(c,u){t.call(this,"digest"),typeof u=="string"&&(u=e.from(u)),this._alg=c,this._key=u,u.length>o?u=c(u):u.length<o&&(u=e.concat([u,i],o));for(var d=this._ipad=e.allocUnsafe(o),p=this._opad=e.allocUnsafe(o),h=0;h<o;h++)d[h]=u[h]^54,p[h]=u[h]^92;this._hash=[d]}return n(a,t),a.prototype._update=function(c){this._hash.push(c)},a.prototype._final=function(){var c=this._alg(e.concat(this._hash));return this._alg(e.concat([this._opad,c]))},legacy=a,legacy}var md5,hasRequiredMd5;function requireMd5(){if(hasRequiredMd5)return md5;hasRequiredMd5=1;var n=requireMd5_js();return md5=function(e){return new n().update(e).digest()},md5}var browser$8,hasRequiredBrowser$8;function requireBrowser$8(){if(hasRequiredBrowser$8)return browser$8;hasRequiredBrowser$8=1;var n=inherits_browserExports,e=requireLegacy(),t=requireCipherBase(),i=safeBufferExports.Buffer,o=requireMd5(),a=requireRipemd160(),c=requireSha_js(),u=i.alloc(128);function d(p,h){t.call(this,"digest"),typeof h=="string"&&(h=i.from(h));var b=p==="sha512"||p==="sha384"?128:64;if(this._alg=p,this._key=h,h.length>b){var m=p==="rmd160"?new a:c(p);h=m.update(h).digest()}else h.length<b&&(h=i.concat([h,u],b));for(var v=this._ipad=i.allocUnsafe(b),_=this._opad=i.allocUnsafe(b),$=0;$<b;$++)v[$]=h[$]^54,_[$]=h[$]^92;this._hash=p==="rmd160"?new a:c(p),this._hash.update(v)}return n(d,t),d.prototype._update=function(p){this._hash.update(p)},d.prototype._final=function(){var p=this._hash.digest(),h=this._alg==="rmd160"?new a:c(this._alg);return h.update(this._opad).update(p).digest()},browser$8=function(h,b){return h=h.toLowerCase(),h==="rmd160"||h==="ripemd160"?new d("rmd160",b):h==="md5"?new e(o,b):new d(h,b)},browser$8}const sha224WithRSAEncryption={sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption={sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption={sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption={sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},sha256$2={sign:"ecdsa",hash:"sha256",id:""},sha224={sign:"ecdsa",hash:"sha224",id:""},sha384={sign:"ecdsa",hash:"sha384",id:""},sha512={sign:"ecdsa",hash:"sha512",id:""},DSA={sign:"dsa",hash:"sha1",id:""},ripemd160WithRSA={sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption={sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},require$$6={sha224WithRSAEncryption,"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption,"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption,"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption,"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:sha256$2,sha224,sha384,sha512,"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA,"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA,"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption,"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}};var algos,hasRequiredAlgos;function requireAlgos(){return hasRequiredAlgos||(hasRequiredAlgos=1,algos=require$$6),algos}var browser$7={},precondition,hasRequiredPrecondition;function requirePrecondition(){if(hasRequiredPrecondition)return precondition;hasRequiredPrecondition=1;var n=Math.pow(2,30)-1;return precondition=function(e,t){if(typeof e!="number")throw new TypeError("Iterations not a number");if(e<0)throw new TypeError("Bad iterations");if(typeof t!="number")throw new TypeError("Key length not a number");if(t<0||t>n||t!==t)throw new TypeError("Bad key length")},precondition}var defaultEncoding_1,hasRequiredDefaultEncoding;function requireDefaultEncoding(){if(hasRequiredDefaultEncoding)return defaultEncoding_1;hasRequiredDefaultEncoding=1;var n;if(commonjsGlobal.process&&commonjsGlobal.process.browser)n="utf-8";else if(commonjsGlobal.process&&commonjsGlobal.process.version){var e=parseInt(process$3.version.split(".")[0].slice(1),10);n=e>=6?"utf-8":"binary"}else n="utf-8";return defaultEncoding_1=n,defaultEncoding_1}var toBuffer,hasRequiredToBuffer;function requireToBuffer(){if(hasRequiredToBuffer)return toBuffer;hasRequiredToBuffer=1;var n=safeBufferExports.Buffer;return toBuffer=function(e,t,i){if(n.isBuffer(e))return e;if(typeof e=="string")return n.from(e,t);if(ArrayBuffer.isView(e))return n.from(e.buffer);throw new TypeError(i+" must be a string, a Buffer, a typed array or a DataView")},toBuffer}var syncBrowser,hasRequiredSyncBrowser;function requireSyncBrowser(){if(hasRequiredSyncBrowser)return syncBrowser;hasRequiredSyncBrowser=1;var n=requireMd5(),e=requireRipemd160(),t=requireSha_js(),i=safeBufferExports.Buffer,o=requirePrecondition(),a=requireDefaultEncoding(),c=requireToBuffer(),u=i.alloc(128),d={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function p(m,v,_){var $=h(m),k=m==="sha512"||m==="sha384"?128:64;v.length>k?v=$(v):v.length<k&&(v=i.concat([v,u],k));for(var D=i.allocUnsafe(k+d[m]),O=i.allocUnsafe(k+d[m]),H=0;H<k;H++)D[H]=v[H]^54,O[H]=v[H]^92;var j=i.allocUnsafe(k+_+4);D.copy(j,0,0,k),this.ipad1=j,this.ipad2=D,this.opad=O,this.alg=m,this.blocksize=k,this.hash=$,this.size=d[m]}p.prototype.run=function(m,v){m.copy(v,this.blocksize);var _=this.hash(v);return _.copy(this.opad,this.blocksize),this.hash(this.opad)};function h(m){function v($){return t(m).update($).digest()}function _($){return new e().update($).digest()}return m==="rmd160"||m==="ripemd160"?_:m==="md5"?n:v}function b(m,v,_,$,k){o(_,$),m=c(m,a,"Password"),v=c(v,a,"Salt"),k=k||"sha1";var D=new p(k,m,v.length),O=i.allocUnsafe($),H=i.allocUnsafe(v.length+4);v.copy(H,0,0,v.length);for(var j=0,W=d[k],ae=Math.ceil($/W),fe=1;fe<=ae;fe++){H.writeUInt32BE(fe,v.length);for(var pe=D.run(H,D.ipad1),ve=pe,Qe=1;Qe<_;Qe++){ve=D.run(ve,D.ipad2);for(var re=0;re<W;re++)pe[re]^=ve[re]}pe.copy(O,j),j+=W}return O}return syncBrowser=b,syncBrowser}var async,hasRequiredAsync;function requireAsync(){if(hasRequiredAsync)return async;hasRequiredAsync=1;var n=safeBufferExports.Buffer,e=requirePrecondition(),t=requireDefaultEncoding(),i=requireSyncBrowser(),o=requireToBuffer(),a,c=commonjsGlobal.crypto&&commonjsGlobal.crypto.subtle,u={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},d=[];function p(_){if(commonjsGlobal.process&&!commonjsGlobal.process.browser||!c||!c.importKey||!c.deriveBits)return Promise.resolve(!1);if(d[_]!==void 0)return d[_];a=a||n.alloc(8);var $=m(a,a,10,128,_).then(function(){return!0}).catch(function(){return!1});return d[_]=$,$}var h;function b(){return h||(commonjsGlobal.process&&commonjsGlobal.process.nextTick?h=commonjsGlobal.process.nextTick:commonjsGlobal.queueMicrotask?h=commonjsGlobal.queueMicrotask:commonjsGlobal.setImmediate?h=commonjsGlobal.setImmediate:h=commonjsGlobal.setTimeout,h)}function m(_,$,k,D,O){return c.importKey("raw",_,{name:"PBKDF2"},!1,["deriveBits"]).then(function(H){return c.deriveBits({name:"PBKDF2",salt:$,iterations:k,hash:{name:O}},H,D<<3)}).then(function(H){return n.from(H)})}function v(_,$){_.then(function(k){b()(function(){$(null,k)})},function(k){b()(function(){$(k)})})}return async=function(_,$,k,D,O,H){typeof O=="function"&&(H=O,O=void 0),O=O||"sha1";var j=u[O.toLowerCase()];if(!j||typeof commonjsGlobal.Promise!="function"){b()(function(){var W;try{W=i(_,$,k,D,O)}catch(ae){return H(ae)}H(null,W)});return}if(e(k,D),_=o(_,t,"Password"),$=o($,t,"Salt"),typeof H!="function")throw new Error("No callback provided to pbkdf2");v(p(j).then(function(W){return W?m(_,$,k,D,j):i(_,$,k,D,O)}),H)},async}var hasRequiredBrowser$7;function requireBrowser$7(){return hasRequiredBrowser$7||(hasRequiredBrowser$7=1,browser$7.pbkdf2=requireAsync(),browser$7.pbkdf2Sync=requireSyncBrowser()),browser$7}var browser$6={},des$1={},utils$q={},hasRequiredUtils;function requireUtils(){if(hasRequiredUtils)return utils$q;hasRequiredUtils=1,utils$q.readUInt32BE=function(o,a){var c=o[0+a]<<24|o[1+a]<<16|o[2+a]<<8|o[3+a];return c>>>0},utils$q.writeUInt32BE=function(o,a,c){o[0+c]=a>>>24,o[1+c]=a>>>16&255,o[2+c]=a>>>8&255,o[3+c]=a&255},utils$q.ip=function(o,a,c,u){for(var d=0,p=0,h=6;h>=0;h-=2){for(var b=0;b<=24;b+=8)d<<=1,d|=a>>>b+h&1;for(var b=0;b<=24;b+=8)d<<=1,d|=o>>>b+h&1}for(var h=6;h>=0;h-=2){for(var b=1;b<=25;b+=8)p<<=1,p|=a>>>b+h&1;for(var b=1;b<=25;b+=8)p<<=1,p|=o>>>b+h&1}c[u+0]=d>>>0,c[u+1]=p>>>0},utils$q.rip=function(o,a,c,u){for(var d=0,p=0,h=0;h<4;h++)for(var b=24;b>=0;b-=8)d<<=1,d|=a>>>b+h&1,d<<=1,d|=o>>>b+h&1;for(var h=4;h<8;h++)for(var b=24;b>=0;b-=8)p<<=1,p|=a>>>b+h&1,p<<=1,p|=o>>>b+h&1;c[u+0]=d>>>0,c[u+1]=p>>>0},utils$q.pc1=function(o,a,c,u){for(var d=0,p=0,h=7;h>=5;h--){for(var b=0;b<=24;b+=8)d<<=1,d|=a>>b+h&1;for(var b=0;b<=24;b+=8)d<<=1,d|=o>>b+h&1}for(var b=0;b<=24;b+=8)d<<=1,d|=a>>b+h&1;for(var h=1;h<=3;h++){for(var b=0;b<=24;b+=8)p<<=1,p|=a>>b+h&1;for(var b=0;b<=24;b+=8)p<<=1,p|=o>>b+h&1}for(var b=0;b<=24;b+=8)p<<=1,p|=o>>b+h&1;c[u+0]=d>>>0,c[u+1]=p>>>0},utils$q.r28shl=function(o,a){return o<<a&268435455|o>>>28-a};var n=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];utils$q.pc2=function(o,a,c,u){for(var d=0,p=0,h=n.length>>>1,b=0;b<h;b++)d<<=1,d|=o>>>n[b]&1;for(var b=h;b<n.length;b++)p<<=1,p|=a>>>n[b]&1;c[u+0]=d>>>0,c[u+1]=p>>>0},utils$q.expand=function(o,a,c){var u=0,d=0;u=(o&1)<<5|o>>>27;for(var p=23;p>=15;p-=4)u<<=6,u|=o>>>p&63;for(var p=11;p>=3;p-=4)d|=o>>>p&63,d<<=6;d|=(o&31)<<1|o>>>31,a[c+0]=u>>>0,a[c+1]=d>>>0};var e=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];utils$q.substitute=function(o,a){for(var c=0,u=0;u<4;u++){var d=o>>>18-u*6&63,p=e[u*64+d];c<<=4,c|=p}for(var u=0;u<4;u++){var d=a>>>18-u*6&63,p=e[4*64+u*64+d];c<<=4,c|=p}return c>>>0};var t=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];return utils$q.permute=function(o){for(var a=0,c=0;c<t.length;c++)a<<=1,a|=o>>>t[c]&1;return a>>>0},utils$q.padSplit=function(o,a,c){for(var u=o.toString(2);u.length<a;)u="0"+u;for(var d=[],p=0;p<a;p+=c)d.push(u.slice(p,p+c));return d.join(" ")},utils$q}var minimalisticAssert=assert$e;function assert$e(n,e){if(!n)throw new Error(e||"Assertion failed")}assert$e.equal=function n(e,t,i){if(e!=t)throw new Error(i||"Assertion failed: "+e+" != "+t)};var cipher,hasRequiredCipher;function requireCipher(){if(hasRequiredCipher)return cipher;hasRequiredCipher=1;var n=minimalisticAssert;function e(t){this.options=t,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}return cipher=e,e.prototype._init=function(){},e.prototype.update=function(i){return i.length===0?[]:this.type==="decrypt"?this._updateDecrypt(i):this._updateEncrypt(i)},e.prototype._buffer=function(i,o){for(var a=Math.min(this.buffer.length-this.bufferOff,i.length-o),c=0;c<a;c++)this.buffer[this.bufferOff+c]=i[o+c];return this.bufferOff+=a,a},e.prototype._flushBuffer=function(i,o){return this._update(this.buffer,0,i,o),this.bufferOff=0,this.blockSize},e.prototype._updateEncrypt=function(i){var o=0,a=0,c=(this.bufferOff+i.length)/this.blockSize|0,u=new Array(c*this.blockSize);this.bufferOff!==0&&(o+=this._buffer(i,o),this.bufferOff===this.buffer.length&&(a+=this._flushBuffer(u,a)));for(var d=i.length-(i.length-o)%this.blockSize;o<d;o+=this.blockSize)this._update(i,o,u,a),a+=this.blockSize;for(;o<i.length;o++,this.bufferOff++)this.buffer[this.bufferOff]=i[o];return u},e.prototype._updateDecrypt=function(i){for(var o=0,a=0,c=Math.ceil((this.bufferOff+i.length)/this.blockSize)-1,u=new Array(c*this.blockSize);c>0;c--)o+=this._buffer(i,o),a+=this._flushBuffer(u,a);return o+=this._buffer(i,o),u},e.prototype.final=function(i){var o;i&&(o=this.update(i));var a;return this.type==="encrypt"?a=this._finalEncrypt():a=this._finalDecrypt(),o?o.concat(a):a},e.prototype._pad=function(i,o){if(o===0)return!1;for(;o<i.length;)i[o++]=0;return!0},e.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var i=new Array(this.blockSize);return this._update(this.buffer,0,i,0),i},e.prototype._unpad=function(i){return i},e.prototype._finalDecrypt=function(){n.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var i=new Array(this.blockSize);return this._flushBuffer(i,0),this._unpad(i)},cipher}var des,hasRequiredDes$1;function requireDes$1(){if(hasRequiredDes$1)return des;hasRequiredDes$1=1;var n=minimalisticAssert,e=inherits_browserExports,t=requireUtils(),i=requireCipher();function o(){this.tmp=new Array(2),this.keys=null}function a(u){i.call(this,u);var d=new o;this._desState=d,this.deriveKeys(d,u.key)}e(a,i),des=a,a.create=function(d){return new a(d)};var c=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];return a.prototype.deriveKeys=function(d,p){d.keys=new Array(16*2),n.equal(p.length,this.blockSize,"Invalid key length");var h=t.readUInt32BE(p,0),b=t.readUInt32BE(p,4);t.pc1(h,b,d.tmp,0),h=d.tmp[0],b=d.tmp[1];for(var m=0;m<d.keys.length;m+=2){var v=c[m>>>1];h=t.r28shl(h,v),b=t.r28shl(b,v),t.pc2(h,b,d.keys,m)}},a.prototype._update=function(d,p,h,b){var m=this._desState,v=t.readUInt32BE(d,p),_=t.readUInt32BE(d,p+4);t.ip(v,_,m.tmp,0),v=m.tmp[0],_=m.tmp[1],this.type==="encrypt"?this._encrypt(m,v,_,m.tmp,0):this._decrypt(m,v,_,m.tmp,0),v=m.tmp[0],_=m.tmp[1],t.writeUInt32BE(h,v,b),t.writeUInt32BE(h,_,b+4)},a.prototype._pad=function(d,p){for(var h=d.length-p,b=p;b<d.length;b++)d[b]=h;return!0},a.prototype._unpad=function(d){for(var p=d[d.length-1],h=d.length-p;h<d.length;h++)n.equal(d[h],p);return d.slice(0,d.length-p)},a.prototype._encrypt=function(d,p,h,b,m){for(var v=p,_=h,$=0;$<d.keys.length;$+=2){var k=d.keys[$],D=d.keys[$+1];t.expand(_,d.tmp,0),k^=d.tmp[0],D^=d.tmp[1];var O=t.substitute(k,D),H=t.permute(O),j=_;_=(v^H)>>>0,v=j}t.rip(_,v,b,m)},a.prototype._decrypt=function(d,p,h,b,m){for(var v=h,_=p,$=d.keys.length-2;$>=0;$-=2){var k=d.keys[$],D=d.keys[$+1];t.expand(v,d.tmp,0),k^=d.tmp[0],D^=d.tmp[1];var O=t.substitute(k,D),H=t.permute(O),j=v;v=(_^H)>>>0,_=j}t.rip(v,_,b,m)},des}var cbc$1={},hasRequiredCbc$1;function requireCbc$1(){if(hasRequiredCbc$1)return cbc$1;hasRequiredCbc$1=1;var n=minimalisticAssert,e=inherits_browserExports,t={};function i(a){n.equal(a.length,8,"Invalid IV length"),this.iv=new Array(8);for(var c=0;c<this.iv.length;c++)this.iv[c]=a[c]}function o(a){function c(h){a.call(this,h),this._cbcInit()}e(c,a);for(var u=Object.keys(t),d=0;d<u.length;d++){var p=u[d];c.prototype[p]=t[p]}return c.create=function(b){return new c(b)},c}return cbc$1.instantiate=o,t._cbcInit=function(){var c=new i(this.options.iv);this._cbcState=c},t._update=function(c,u,d,p){var h=this._cbcState,b=this.constructor.super_.prototype,m=h.iv;if(this.type==="encrypt"){for(var v=0;v<this.blockSize;v++)m[v]^=c[u+v];b._update.call(this,m,0,d,p);for(var v=0;v<this.blockSize;v++)m[v]=d[p+v]}else{b._update.call(this,c,u,d,p);for(var v=0;v<this.blockSize;v++)d[p+v]^=m[v];for(var v=0;v<this.blockSize;v++)m[v]=c[u+v]}},cbc$1}var ede,hasRequiredEde;function requireEde(){if(hasRequiredEde)return ede;hasRequiredEde=1;var n=minimalisticAssert,e=inherits_browserExports,t=requireCipher(),i=requireDes$1();function o(c,u){n.equal(u.length,24,"Invalid key length");var d=u.slice(0,8),p=u.slice(8,16),h=u.slice(16,24);c==="encrypt"?this.ciphers=[i.create({type:"encrypt",key:d}),i.create({type:"decrypt",key:p}),i.create({type:"encrypt",key:h})]:this.ciphers=[i.create({type:"decrypt",key:h}),i.create({type:"encrypt",key:p}),i.create({type:"decrypt",key:d})]}function a(c){t.call(this,c);var u=new o(this.type,this.options.key);this._edeState=u}return e(a,t),ede=a,a.create=function(u){return new a(u)},a.prototype._update=function(u,d,p,h){var b=this._edeState;b.ciphers[0]._update(u,d,p,h),b.ciphers[1]._update(p,h,p,h),b.ciphers[2]._update(p,h,p,h)},a.prototype._pad=i.prototype._pad,a.prototype._unpad=i.prototype._unpad,ede}var hasRequiredDes;function requireDes(){return hasRequiredDes||(hasRequiredDes=1,des$1.utils=requireUtils(),des$1.Cipher=requireCipher(),des$1.DES=requireDes$1(),des$1.CBC=requireCbc$1(),des$1.EDE=requireEde()),des$1}var browserifyDes,hasRequiredBrowserifyDes;function requireBrowserifyDes(){if(hasRequiredBrowserifyDes)return browserifyDes;hasRequiredBrowserifyDes=1;var n=requireCipherBase(),e=requireDes(),t=inherits_browserExports,i=safeBufferExports.Buffer,o={"des-ede3-cbc":e.CBC.instantiate(e.EDE),"des-ede3":e.EDE,"des-ede-cbc":e.CBC.instantiate(e.EDE),"des-ede":e.EDE,"des-cbc":e.CBC.instantiate(e.DES),"des-ecb":e.DES};o.des=o["des-cbc"],o.des3=o["des-ede3-cbc"],browserifyDes=a,t(a,n);function a(c){n.call(this);var u=c.mode.toLowerCase(),d=o[u],p;c.decrypt?p="decrypt":p="encrypt";var h=c.key;i.isBuffer(h)||(h=i.from(h)),(u==="des-ede"||u==="des-ede-cbc")&&(h=i.concat([h,h.slice(0,8)]));var b=c.iv;i.isBuffer(b)||(b=i.from(b)),this._des=d.create({key:h,iv:b,type:p})}return a.prototype._update=function(c){return i.from(this._des.update(c))},a.prototype._final=function(){return i.from(this._des.final())},browserifyDes}var browser$5={},encrypter={},ecb={},hasRequiredEcb;function requireEcb(){return hasRequiredEcb||(hasRequiredEcb=1,ecb.encrypt=function(n,e){return n._cipher.encryptBlock(e)},ecb.decrypt=function(n,e){return n._cipher.decryptBlock(e)}),ecb}var cbc={},bufferXor,hasRequiredBufferXor;function requireBufferXor(){return hasRequiredBufferXor||(hasRequiredBufferXor=1,bufferXor=function(e,t){for(var i=Math.min(e.length,t.length),o=new buffer$2.Buffer(i),a=0;a<i;++a)o[a]=e[a]^t[a];return o}),bufferXor}var hasRequiredCbc;function requireCbc(){if(hasRequiredCbc)return cbc;hasRequiredCbc=1;var n=requireBufferXor();return cbc.encrypt=function(e,t){var i=n(t,e._prev);return e._prev=e._cipher.encryptBlock(i),e._prev},cbc.decrypt=function(e,t){var i=e._prev;e._prev=t;var o=e._cipher.decryptBlock(t);return n(o,i)},cbc}var cfb={},hasRequiredCfb;function requireCfb(){if(hasRequiredCfb)return cfb;hasRequiredCfb=1;var n=safeBufferExports.Buffer,e=requireBufferXor();function t(i,o,a){var c=o.length,u=e(o,i._cache);return i._cache=i._cache.slice(c),i._prev=n.concat([i._prev,a?o:u]),u}return cfb.encrypt=function(i,o,a){for(var c=n.allocUnsafe(0),u;o.length;)if(i._cache.length===0&&(i._cache=i._cipher.encryptBlock(i._prev),i._prev=n.allocUnsafe(0)),i._cache.length<=o.length)u=i._cache.length,c=n.concat([c,t(i,o.slice(0,u),a)]),o=o.slice(u);else{c=n.concat([c,t(i,o,a)]);break}return c},cfb}var cfb8={},hasRequiredCfb8;function requireCfb8(){if(hasRequiredCfb8)return cfb8;hasRequiredCfb8=1;var n=safeBufferExports.Buffer;function e(t,i,o){var a=t._cipher.encryptBlock(t._prev),c=a[0]^i;return t._prev=n.concat([t._prev.slice(1),n.from([o?i:c])]),c}return cfb8.encrypt=function(t,i,o){for(var a=i.length,c=n.allocUnsafe(a),u=-1;++u<a;)c[u]=e(t,i[u],o);return c},cfb8}var cfb1={},hasRequiredCfb1;function requireCfb1(){if(hasRequiredCfb1)return cfb1;hasRequiredCfb1=1;var n=safeBufferExports.Buffer;function e(i,o,a){for(var c,u=-1,d=8,p=0,h,b;++u<d;)c=i._cipher.encryptBlock(i._prev),h=o&1<<7-u?128:0,b=c[0]^h,p+=(b&128)>>u%8,i._prev=t(i._prev,a?h:b);return p}function t(i,o){var a=i.length,c=-1,u=n.allocUnsafe(i.length);for(i=n.concat([i,n.from([o])]);++c<a;)u[c]=i[c]<<1|i[c+1]>>7;return u}return cfb1.encrypt=function(i,o,a){for(var c=o.length,u=n.allocUnsafe(c),d=-1;++d<c;)u[d]=e(i,o[d],a);return u},cfb1}var ofb={},hasRequiredOfb;function requireOfb(){if(hasRequiredOfb)return ofb;hasRequiredOfb=1;var n=requireBufferXor();function e(t){return t._prev=t._cipher.encryptBlock(t._prev),t._prev}return ofb.encrypt=function(t,i){for(;t._cache.length<i.length;)t._cache=buffer$2.Buffer.concat([t._cache,e(t)]);var o=t._cache.slice(0,i.length);return t._cache=t._cache.slice(i.length),n(i,o)},ofb}var ctr={},incr32_1,hasRequiredIncr32;function requireIncr32(){if(hasRequiredIncr32)return incr32_1;hasRequiredIncr32=1;function n(e){for(var t=e.length,i;t--;)if(i=e.readUInt8(t),i===255)e.writeUInt8(0,t);else{i++,e.writeUInt8(i,t);break}}return incr32_1=n,incr32_1}var hasRequiredCtr;function requireCtr(){if(hasRequiredCtr)return ctr;hasRequiredCtr=1;var n=requireBufferXor(),e=safeBufferExports.Buffer,t=requireIncr32();function i(a){var c=a._cipher.encryptBlockRaw(a._prev);return t(a._prev),c}var o=16;return ctr.encrypt=function(a,c){var u=Math.ceil(c.length/o),d=a._cache.length;a._cache=e.concat([a._cache,e.allocUnsafe(u*o)]);for(var p=0;p<u;p++){var h=i(a),b=d+p*o;a._cache.writeUInt32BE(h[0],b+0),a._cache.writeUInt32BE(h[1],b+4),a._cache.writeUInt32BE(h[2],b+8),a._cache.writeUInt32BE(h[3],b+12)}var m=a._cache.slice(0,c.length);return a._cache=a._cache.slice(c.length),n(c,m)},ctr}const aes128={cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192={cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256={cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},require$$2={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128,aes192,aes256,"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}};var modes_1,hasRequiredModes$1;function requireModes$1(){if(hasRequiredModes$1)return modes_1;hasRequiredModes$1=1;var n={ECB:requireEcb(),CBC:requireCbc(),CFB:requireCfb(),CFB8:requireCfb8(),CFB1:requireCfb1(),OFB:requireOfb(),CTR:requireCtr(),GCM:requireCtr()},e=require$$2;for(var t in e)e[t].module=n[e[t].mode];return modes_1=e,modes_1}var aes$2={},hasRequiredAes;function requireAes(){if(hasRequiredAes)return aes$2;hasRequiredAes=1;var n=safeBufferExports.Buffer;function e(u){n.isBuffer(u)||(u=n.from(u));for(var d=u.length/4|0,p=new Array(d),h=0;h<d;h++)p[h]=u.readUInt32BE(h*4);return p}function t(u){for(var d=0;d<u.length;u++)u[d]=0}function i(u,d,p,h,b){for(var m=p[0],v=p[1],_=p[2],$=p[3],k=u[0]^d[0],D=u[1]^d[1],O=u[2]^d[2],H=u[3]^d[3],j,W,ae,fe,pe=4,ve=1;ve<b;ve++)j=m[k>>>24]^v[D>>>16&255]^_[O>>>8&255]^$[H&255]^d[pe++],W=m[D>>>24]^v[O>>>16&255]^_[H>>>8&255]^$[k&255]^d[pe++],ae=m[O>>>24]^v[H>>>16&255]^_[k>>>8&255]^$[D&255]^d[pe++],fe=m[H>>>24]^v[k>>>16&255]^_[D>>>8&255]^$[O&255]^d[pe++],k=j,D=W,O=ae,H=fe;return j=(h[k>>>24]<<24|h[D>>>16&255]<<16|h[O>>>8&255]<<8|h[H&255])^d[pe++],W=(h[D>>>24]<<24|h[O>>>16&255]<<16|h[H>>>8&255]<<8|h[k&255])^d[pe++],ae=(h[O>>>24]<<24|h[H>>>16&255]<<16|h[k>>>8&255]<<8|h[D&255])^d[pe++],fe=(h[H>>>24]<<24|h[k>>>16&255]<<16|h[D>>>8&255]<<8|h[O&255])^d[pe++],j=j>>>0,W=W>>>0,ae=ae>>>0,fe=fe>>>0,[j,W,ae,fe]}var o=[0,1,2,4,8,16,32,64,128,27,54],a=function(){for(var u=new Array(256),d=0;d<256;d++)d<128?u[d]=d<<1:u[d]=d<<1^283;for(var p=[],h=[],b=[[],[],[],[]],m=[[],[],[],[]],v=0,_=0,$=0;$<256;++$){var k=_^_<<1^_<<2^_<<3^_<<4;k=k>>>8^k&255^99,p[v]=k,h[k]=v;var D=u[v],O=u[D],H=u[O],j=u[k]*257^k*16843008;b[0][v]=j<<24|j>>>8,b[1][v]=j<<16|j>>>16,b[2][v]=j<<8|j>>>24,b[3][v]=j,j=H*16843009^O*65537^D*257^v*16843008,m[0][k]=j<<24|j>>>8,m[1][k]=j<<16|j>>>16,m[2][k]=j<<8|j>>>24,m[3][k]=j,v===0?v=_=1:(v=D^u[u[u[H^D]]],_^=u[u[_]])}return{SBOX:p,INV_SBOX:h,SUB_MIX:b,INV_SUB_MIX:m}}();function c(u){this._key=e(u),this._reset()}return c.blockSize=4*4,c.keySize=256/8,c.prototype.blockSize=c.blockSize,c.prototype.keySize=c.keySize,c.prototype._reset=function(){for(var u=this._key,d=u.length,p=d+6,h=(p+1)*4,b=[],m=0;m<d;m++)b[m]=u[m];for(m=d;m<h;m++){var v=b[m-1];m%d===0?(v=v<<8|v>>>24,v=a.SBOX[v>>>24]<<24|a.SBOX[v>>>16&255]<<16|a.SBOX[v>>>8&255]<<8|a.SBOX[v&255],v^=o[m/d|0]<<24):d>6&&m%d===4&&(v=a.SBOX[v>>>24]<<24|a.SBOX[v>>>16&255]<<16|a.SBOX[v>>>8&255]<<8|a.SBOX[v&255]),b[m]=b[m-d]^v}for(var _=[],$=0;$<h;$++){var k=h-$,D=b[k-($%4?0:4)];$<4||k<=4?_[$]=D:_[$]=a.INV_SUB_MIX[0][a.SBOX[D>>>24]]^a.INV_SUB_MIX[1][a.SBOX[D>>>16&255]]^a.INV_SUB_MIX[2][a.SBOX[D>>>8&255]]^a.INV_SUB_MIX[3][a.SBOX[D&255]]}this._nRounds=p,this._keySchedule=b,this._invKeySchedule=_},c.prototype.encryptBlockRaw=function(u){return u=e(u),i(u,this._keySchedule,a.SUB_MIX,a.SBOX,this._nRounds)},c.prototype.encryptBlock=function(u){var d=this.encryptBlockRaw(u),p=n.allocUnsafe(16);return p.writeUInt32BE(d[0],0),p.writeUInt32BE(d[1],4),p.writeUInt32BE(d[2],8),p.writeUInt32BE(d[3],12),p},c.prototype.decryptBlock=function(u){u=e(u);var d=u[1];u[1]=u[3],u[3]=d;var p=i(u,this._invKeySchedule,a.INV_SUB_MIX,a.INV_SBOX,this._nRounds),h=n.allocUnsafe(16);return h.writeUInt32BE(p[0],0),h.writeUInt32BE(p[3],4),h.writeUInt32BE(p[2],8),h.writeUInt32BE(p[1],12),h},c.prototype.scrub=function(){t(this._keySchedule),t(this._invKeySchedule),t(this._key)},aes$2.AES=c,aes$2}var ghash,hasRequiredGhash;function requireGhash(){if(hasRequiredGhash)return ghash;hasRequiredGhash=1;var n=safeBufferExports.Buffer,e=n.alloc(16,0);function t(a){return[a.readUInt32BE(0),a.readUInt32BE(4),a.readUInt32BE(8),a.readUInt32BE(12)]}function i(a){var c=n.allocUnsafe(16);return c.writeUInt32BE(a[0]>>>0,0),c.writeUInt32BE(a[1]>>>0,4),c.writeUInt32BE(a[2]>>>0,8),c.writeUInt32BE(a[3]>>>0,12),c}function o(a){this.h=a,this.state=n.alloc(16,0),this.cache=n.allocUnsafe(0)}return o.prototype.ghash=function(a){for(var c=-1;++c<a.length;)this.state[c]^=a[c];this._multiply()},o.prototype._multiply=function(){for(var a=t(this.h),c=[0,0,0,0],u,d,p,h=-1;++h<128;){for(d=(this.state[~~(h/8)]&1<<7-h%8)!==0,d&&(c[0]^=a[0],c[1]^=a[1],c[2]^=a[2],c[3]^=a[3]),p=(a[3]&1)!==0,u=3;u>0;u--)a[u]=a[u]>>>1|(a[u-1]&1)<<31;a[0]=a[0]>>>1,p&&(a[0]=a[0]^225<<24)}this.state=i(c)},o.prototype.update=function(a){this.cache=n.concat([this.cache,a]);for(var c;this.cache.length>=16;)c=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(c)},o.prototype.final=function(a,c){return this.cache.length&&this.ghash(n.concat([this.cache,e],16)),this.ghash(i([0,a,0,c])),this.state},ghash=o,ghash}var authCipher,hasRequiredAuthCipher;function requireAuthCipher(){if(hasRequiredAuthCipher)return authCipher;hasRequiredAuthCipher=1;var n=requireAes(),e=safeBufferExports.Buffer,t=requireCipherBase(),i=inherits_browserExports,o=requireGhash(),a=requireBufferXor(),c=requireIncr32();function u(h,b){var m=0;h.length!==b.length&&m++;for(var v=Math.min(h.length,b.length),_=0;_<v;++_)m+=h[_]^b[_];return m}function d(h,b,m){if(b.length===12)return h._finID=e.concat([b,e.from([0,0,0,1])]),e.concat([b,e.from([0,0,0,2])]);var v=new o(m),_=b.length,$=_%16;v.update(b),$&&($=16-$,v.update(e.alloc($,0))),v.update(e.alloc(8,0));var k=_*8,D=e.alloc(8);D.writeUIntBE(k,0,8),v.update(D),h._finID=v.state;var O=e.from(h._finID);return c(O),O}function p(h,b,m,v){t.call(this);var _=e.alloc(4,0);this._cipher=new n.AES(b);var $=this._cipher.encryptBlock(_);this._ghash=new o($),m=d(this,m,$),this._prev=e.from(m),this._cache=e.allocUnsafe(0),this._secCache=e.allocUnsafe(0),this._decrypt=v,this._alen=0,this._len=0,this._mode=h,this._authTag=null,this._called=!1}return i(p,t),p.prototype._update=function(h){if(!this._called&&this._alen){var b=16-this._alen%16;b<16&&(b=e.alloc(b,0),this._ghash.update(b))}this._called=!0;var m=this._mode.encrypt(this,h);return this._decrypt?this._ghash.update(h):this._ghash.update(m),this._len+=h.length,m},p.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var h=a(this._ghash.final(this._alen*8,this._len*8),this._cipher.encryptBlock(this._finID));if(this._decrypt&&u(h,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=h,this._cipher.scrub()},p.prototype.getAuthTag=function(){if(this._decrypt||!e.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},p.prototype.setAuthTag=function(b){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=b},p.prototype.setAAD=function(b){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(b),this._alen+=b.length},authCipher=p,authCipher}var streamCipher,hasRequiredStreamCipher;function requireStreamCipher(){if(hasRequiredStreamCipher)return streamCipher;hasRequiredStreamCipher=1;var n=requireAes(),e=safeBufferExports.Buffer,t=requireCipherBase(),i=inherits_browserExports;function o(a,c,u,d){t.call(this),this._cipher=new n.AES(c),this._prev=e.from(u),this._cache=e.allocUnsafe(0),this._secCache=e.allocUnsafe(0),this._decrypt=d,this._mode=a}return i(o,t),o.prototype._update=function(a){return this._mode.encrypt(this,a,this._decrypt)},o.prototype._final=function(){this._cipher.scrub()},streamCipher=o,streamCipher}var evp_bytestokey,hasRequiredEvp_bytestokey;function requireEvp_bytestokey(){if(hasRequiredEvp_bytestokey)return evp_bytestokey;hasRequiredEvp_bytestokey=1;var n=safeBufferExports.Buffer,e=requireMd5_js();function t(i,o,a,c){if(n.isBuffer(i)||(i=n.from(i,"binary")),o&&(n.isBuffer(o)||(o=n.from(o,"binary")),o.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var u=a/8,d=n.alloc(u),p=n.alloc(c||0),h=n.alloc(0);u>0||c>0;){var b=new e;b.update(h),b.update(i),o&&b.update(o),h=b.digest();var m=0;if(u>0){var v=d.length-u;m=Math.min(u,h.length),h.copy(d,v,0,m),u-=m}if(m<h.length&&c>0){var _=p.length-c,$=Math.min(c,h.length-m);h.copy(p,_,m,m+$),c-=$}}return h.fill(0),{key:d,iv:p}}return evp_bytestokey=t,evp_bytestokey}var hasRequiredEncrypter;function requireEncrypter(){if(hasRequiredEncrypter)return encrypter;hasRequiredEncrypter=1;var n=requireModes$1(),e=requireAuthCipher(),t=safeBufferExports.Buffer,i=requireStreamCipher(),o=requireCipherBase(),a=requireAes(),c=requireEvp_bytestokey(),u=inherits_browserExports;function d(v,_,$){o.call(this),this._cache=new h,this._cipher=new a.AES(_),this._prev=t.from($),this._mode=v,this._autopadding=!0}u(d,o),d.prototype._update=function(v){this._cache.add(v);for(var _,$,k=[];_=this._cache.get();)$=this._mode.encrypt(this,_),k.push($);return t.concat(k)};var p=t.alloc(16,16);d.prototype._final=function(){var v=this._cache.flush();if(this._autopadding)return v=this._mode.encrypt(this,v),this._cipher.scrub(),v;if(!v.equals(p))throw this._cipher.scrub(),new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(v){return this._autopadding=!!v,this};function h(){this.cache=t.allocUnsafe(0)}h.prototype.add=function(v){this.cache=t.concat([this.cache,v])},h.prototype.get=function(){if(this.cache.length>15){var v=this.cache.slice(0,16);return this.cache=this.cache.slice(16),v}return null},h.prototype.flush=function(){for(var v=16-this.cache.length,_=t.allocUnsafe(v),$=-1;++$<v;)_.writeUInt8(v,$);return t.concat([this.cache,_])};function b(v,_,$){var k=n[v.toLowerCase()];if(!k)throw new TypeError("invalid suite type");if(typeof _=="string"&&(_=t.from(_)),_.length!==k.key/8)throw new TypeError("invalid key length "+_.length);if(typeof $=="string"&&($=t.from($)),k.mode!=="GCM"&&$.length!==k.iv)throw new TypeError("invalid iv length "+$.length);return k.type==="stream"?new i(k.module,_,$):k.type==="auth"?new e(k.module,_,$):new d(k.module,_,$)}function m(v,_){var $=n[v.toLowerCase()];if(!$)throw new TypeError("invalid suite type");var k=c(_,!1,$.key,$.iv);return b(v,k.key,k.iv)}return encrypter.createCipheriv=b,encrypter.createCipher=m,encrypter}var decrypter={},hasRequiredDecrypter;function requireDecrypter(){if(hasRequiredDecrypter)return decrypter;hasRequiredDecrypter=1;var n=requireAuthCipher(),e=safeBufferExports.Buffer,t=requireModes$1(),i=requireStreamCipher(),o=requireCipherBase(),a=requireAes(),c=requireEvp_bytestokey(),u=inherits_browserExports;function d(v,_,$){o.call(this),this._cache=new p,this._last=void 0,this._cipher=new a.AES(_),this._prev=e.from($),this._mode=v,this._autopadding=!0}u(d,o),d.prototype._update=function(v){this._cache.add(v);for(var _,$,k=[];_=this._cache.get(this._autopadding);)$=this._mode.decrypt(this,_),k.push($);return e.concat(k)},d.prototype._final=function(){var v=this._cache.flush();if(this._autopadding)return h(this._mode.decrypt(this,v));if(v)throw new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(v){return this._autopadding=!!v,this};function p(){this.cache=e.allocUnsafe(0)}p.prototype.add=function(v){this.cache=e.concat([this.cache,v])},p.prototype.get=function(v){var _;if(v){if(this.cache.length>16)return _=this.cache.slice(0,16),this.cache=this.cache.slice(16),_}else if(this.cache.length>=16)return _=this.cache.slice(0,16),this.cache=this.cache.slice(16),_;return null},p.prototype.flush=function(){if(this.cache.length)return this.cache};function h(v){var _=v[15];if(_<1||_>16)throw new Error("unable to decrypt data");for(var $=-1;++$<_;)if(v[$+(16-_)]!==_)throw new Error("unable to decrypt data");if(_!==16)return v.slice(0,16-_)}function b(v,_,$){var k=t[v.toLowerCase()];if(!k)throw new TypeError("invalid suite type");if(typeof $=="string"&&($=e.from($)),k.mode!=="GCM"&&$.length!==k.iv)throw new TypeError("invalid iv length "+$.length);if(typeof _=="string"&&(_=e.from(_)),_.length!==k.key/8)throw new TypeError("invalid key length "+_.length);return k.type==="stream"?new i(k.module,_,$,!0):k.type==="auth"?new n(k.module,_,$,!0):new d(k.module,_,$)}function m(v,_){var $=t[v.toLowerCase()];if(!$)throw new TypeError("invalid suite type");var k=c(_,!1,$.key,$.iv);return b(v,k.key,k.iv)}return decrypter.createDecipher=m,decrypter.createDecipheriv=b,decrypter}var hasRequiredBrowser$6;function requireBrowser$6(){if(hasRequiredBrowser$6)return browser$5;hasRequiredBrowser$6=1;var n=requireEncrypter(),e=requireDecrypter(),t=require$$2;function i(){return Object.keys(t)}return browser$5.createCipher=browser$5.Cipher=n.createCipher,browser$5.createCipheriv=browser$5.Cipheriv=n.createCipheriv,browser$5.createDecipher=browser$5.Decipher=e.createDecipher,browser$5.createDecipheriv=browser$5.Decipheriv=e.createDecipheriv,browser$5.listCiphers=browser$5.getCiphers=i,browser$5}var modes={},hasRequiredModes;function requireModes(){return hasRequiredModes||(hasRequiredModes=1,function(n){n["des-ecb"]={key:8,iv:0},n["des-cbc"]=n.des={key:8,iv:8},n["des-ede3-cbc"]=n.des3={key:24,iv:8},n["des-ede3"]={key:24,iv:0},n["des-ede-cbc"]={key:16,iv:8},n["des-ede"]={key:16,iv:0}}(modes)),modes}var hasRequiredBrowser$5;function requireBrowser$5(){if(hasRequiredBrowser$5)return browser$6;hasRequiredBrowser$5=1;var n=requireBrowserifyDes(),e=requireBrowser$6(),t=requireModes$1(),i=requireModes(),o=requireEvp_bytestokey();function a(h,b){h=h.toLowerCase();var m,v;if(t[h])m=t[h].key,v=t[h].iv;else if(i[h])m=i[h].key*8,v=i[h].iv;else throw new TypeError("invalid suite type");var _=o(b,!1,m,v);return u(h,_.key,_.iv)}function c(h,b){h=h.toLowerCase();var m,v;if(t[h])m=t[h].key,v=t[h].iv;else if(i[h])m=i[h].key*8,v=i[h].iv;else throw new TypeError("invalid suite type");var _=o(b,!1,m,v);return d(h,_.key,_.iv)}function u(h,b,m){if(h=h.toLowerCase(),t[h])return e.createCipheriv(h,b,m);if(i[h])return new n({key:b,iv:m,mode:h});throw new TypeError("invalid suite type")}function d(h,b,m){if(h=h.toLowerCase(),t[h])return e.createDecipheriv(h,b,m);if(i[h])return new n({key:b,iv:m,mode:h,decrypt:!0});throw new TypeError("invalid suite type")}function p(){return Object.keys(i).concat(e.getCiphers())}return browser$6.createCipher=browser$6.Cipher=a,browser$6.createCipheriv=browser$6.Cipheriv=u,browser$6.createDecipher=browser$6.Decipher=c,browser$6.createDecipheriv=browser$6.Decipheriv=d,browser$6.listCiphers=browser$6.getCiphers=p,browser$6}var browser$4={},bn$1={exports:{}};bn$1.exports;(function(n){(function(e,t){function i(re,C){if(!re)throw new Error(C||"Assertion failed")}function o(re,C){re.super_=C;var S=function(){};S.prototype=C.prototype,re.prototype=new S,re.prototype.constructor=re}function a(re,C,S){if(a.isBN(re))return re;this.negative=0,this.words=null,this.length=0,this.red=null,re!==null&&((C==="le"||C==="be")&&(S=C,C=10),this._init(re||0,C||10,S||"be"))}typeof e=="object"?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;var c;try{typeof window<"u"&&typeof window.Buffer<"u"?c=window.Buffer:c=buffer$2.Buffer}catch{}a.isBN=function(C){return C instanceof a?!0:C!==null&&typeof C=="object"&&C.constructor.wordSize===a.wordSize&&Array.isArray(C.words)},a.max=function(C,S){return C.cmp(S)>0?C:S},a.min=function(C,S){return C.cmp(S)<0?C:S},a.prototype._init=function(C,S,w){if(typeof C=="number")return this._initNumber(C,S,w);if(typeof C=="object")return this._initArray(C,S,w);S==="hex"&&(S=16),i(S===(S|0)&&S>=2&&S<=36),C=C.toString().replace(/\s+/g,"");var E=0;C[0]==="-"&&(E++,this.negative=1),E<C.length&&(S===16?this._parseHex(C,E,w):(this._parseBase(C,S,E),w==="le"&&this._initArray(this.toArray(),S,w)))},a.prototype._initNumber=function(C,S,w){C<0&&(this.negative=1,C=-C),C<67108864?(this.words=[C&67108863],this.length=1):C<4503599627370496?(this.words=[C&67108863,C/67108864&67108863],this.length=2):(i(C<9007199254740992),this.words=[C&67108863,C/67108864&67108863,1],this.length=3),w==="le"&&this._initArray(this.toArray(),S,w)},a.prototype._initArray=function(C,S,w){if(i(typeof C.length=="number"),C.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(C.length/3),this.words=new Array(this.length);for(var E=0;E<this.length;E++)this.words[E]=0;var I,N,U=0;if(w==="be")for(E=C.length-1,I=0;E>=0;E-=3)N=C[E]|C[E-1]<<8|C[E-2]<<16,this.words[I]|=N<<U&67108863,this.words[I+1]=N>>>26-U&67108863,U+=24,U>=26&&(U-=26,I++);else if(w==="le")for(E=0,I=0;E<C.length;E+=3)N=C[E]|C[E+1]<<8|C[E+2]<<16,this.words[I]|=N<<U&67108863,this.words[I+1]=N>>>26-U&67108863,U+=24,U>=26&&(U-=26,I++);return this.strip()};function u(re,C){var S=re.charCodeAt(C);return S>=65&&S<=70?S-55:S>=97&&S<=102?S-87:S-48&15}function d(re,C,S){var w=u(re,S);return S-1>=C&&(w|=u(re,S-1)<<4),w}a.prototype._parseHex=function(C,S,w){this.length=Math.ceil((C.length-S)/6),this.words=new Array(this.length);for(var E=0;E<this.length;E++)this.words[E]=0;var I=0,N=0,U;if(w==="be")for(E=C.length-1;E>=S;E-=2)U=d(C,S,E)<<I,this.words[N]|=U&67108863,I>=18?(I-=18,N+=1,this.words[N]|=U>>>26):I+=8;else{var L=C.length-S;for(E=L%2===0?S+1:S;E<C.length;E+=2)U=d(C,S,E)<<I,this.words[N]|=U&67108863,I>=18?(I-=18,N+=1,this.words[N]|=U>>>26):I+=8}this.strip()};function p(re,C,S,w){for(var E=0,I=Math.min(re.length,S),N=C;N<I;N++){var U=re.charCodeAt(N)-48;E*=w,U>=49?E+=U-49+10:U>=17?E+=U-17+10:E+=U}return E}a.prototype._parseBase=function(C,S,w){this.words=[0],this.length=1;for(var E=0,I=1;I<=67108863;I*=S)E++;E--,I=I/S|0;for(var N=C.length-w,U=N%E,L=Math.min(N,N-U)+w,P=0,B=w;B<L;B+=E)P=p(C,B,B+E,S),this.imuln(I),this.words[0]+P<67108864?this.words[0]+=P:this._iaddn(P);if(U!==0){var A=1;for(P=p(C,B,C.length,S),B=0;B<U;B++)A*=S;this.imuln(A),this.words[0]+P<67108864?this.words[0]+=P:this._iaddn(P)}this.strip()},a.prototype.copy=function(C){C.words=new Array(this.length);for(var S=0;S<this.length;S++)C.words[S]=this.words[S];C.length=this.length,C.negative=this.negative,C.red=this.red},a.prototype.clone=function(){var C=new a(null);return this.copy(C),C},a.prototype._expand=function(C){for(;this.length<C;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],b=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],m=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(C,S){C=C||10,S=S|0||1;var w;if(C===16||C==="hex"){w="";for(var E=0,I=0,N=0;N<this.length;N++){var U=this.words[N],L=((U<<E|I)&16777215).toString(16);I=U>>>24-E&16777215,I!==0||N!==this.length-1?w=h[6-L.length]+L+w:w=L+w,E+=2,E>=26&&(E-=26,N--)}for(I!==0&&(w=I.toString(16)+w);w.length%S!==0;)w="0"+w;return this.negative!==0&&(w="-"+w),w}if(C===(C|0)&&C>=2&&C<=36){var P=b[C],B=m[C];w="";var A=this.clone();for(A.negative=0;!A.isZero();){var z=A.modn(B).toString(C);A=A.idivn(B),A.isZero()?w=z+w:w=h[P-z.length]+z+w}for(this.isZero()&&(w="0"+w);w.length%S!==0;)w="0"+w;return this.negative!==0&&(w="-"+w),w}i(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var C=this.words[0];return this.length===2?C+=this.words[1]*67108864:this.length===3&&this.words[2]===1?C+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-C:C},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(C,S){return i(typeof c<"u"),this.toArrayLike(c,C,S)},a.prototype.toArray=function(C,S){return this.toArrayLike(Array,C,S)},a.prototype.toArrayLike=function(C,S,w){var E=this.byteLength(),I=w||Math.max(1,E);i(E<=I,"byte array longer than desired length"),i(I>0,"Requested array length <= 0"),this.strip();var N=S==="le",U=new C(I),L,P,B=this.clone();if(N){for(P=0;!B.isZero();P++)L=B.andln(255),B.iushrn(8),U[P]=L;for(;P<I;P++)U[P]=0}else{for(P=0;P<I-E;P++)U[P]=0;for(P=0;!B.isZero();P++)L=B.andln(255),B.iushrn(8),U[I-P-1]=L}return U},Math.clz32?a.prototype._countBits=function(C){return 32-Math.clz32(C)}:a.prototype._countBits=function(C){var S=C,w=0;return S>=4096&&(w+=13,S>>>=13),S>=64&&(w+=7,S>>>=7),S>=8&&(w+=4,S>>>=4),S>=2&&(w+=2,S>>>=2),w+S},a.prototype._zeroBits=function(C){if(C===0)return 26;var S=C,w=0;return S&8191||(w+=13,S>>>=13),S&127||(w+=7,S>>>=7),S&15||(w+=4,S>>>=4),S&3||(w+=2,S>>>=2),S&1||w++,w},a.prototype.bitLength=function(){var C=this.words[this.length-1],S=this._countBits(C);return(this.length-1)*26+S};function v(re){for(var C=new Array(re.bitLength()),S=0;S<C.length;S++){var w=S/26|0,E=S%26;C[S]=(re.words[w]&1<<E)>>>E}return C}a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var C=0,S=0;S<this.length;S++){var w=this._zeroBits(this.words[S]);if(C+=w,w!==26)break}return C},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(C){return this.negative!==0?this.abs().inotn(C).iaddn(1):this.clone()},a.prototype.fromTwos=function(C){return this.testn(C-1)?this.notn(C).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(C){for(;this.length<C.length;)this.words[this.length++]=0;for(var S=0;S<C.length;S++)this.words[S]=this.words[S]|C.words[S];return this.strip()},a.prototype.ior=function(C){return i((this.negative|C.negative)===0),this.iuor(C)},a.prototype.or=function(C){return this.length>C.length?this.clone().ior(C):C.clone().ior(this)},a.prototype.uor=function(C){return this.length>C.length?this.clone().iuor(C):C.clone().iuor(this)},a.prototype.iuand=function(C){var S;this.length>C.length?S=C:S=this;for(var w=0;w<S.length;w++)this.words[w]=this.words[w]&C.words[w];return this.length=S.length,this.strip()},a.prototype.iand=function(C){return i((this.negative|C.negative)===0),this.iuand(C)},a.prototype.and=function(C){return this.length>C.length?this.clone().iand(C):C.clone().iand(this)},a.prototype.uand=function(C){return this.length>C.length?this.clone().iuand(C):C.clone().iuand(this)},a.prototype.iuxor=function(C){var S,w;this.length>C.length?(S=this,w=C):(S=C,w=this);for(var E=0;E<w.length;E++)this.words[E]=S.words[E]^w.words[E];if(this!==S)for(;E<S.length;E++)this.words[E]=S.words[E];return this.length=S.length,this.strip()},a.prototype.ixor=function(C){return i((this.negative|C.negative)===0),this.iuxor(C)},a.prototype.xor=function(C){return this.length>C.length?this.clone().ixor(C):C.clone().ixor(this)},a.prototype.uxor=function(C){return this.length>C.length?this.clone().iuxor(C):C.clone().iuxor(this)},a.prototype.inotn=function(C){i(typeof C=="number"&&C>=0);var S=Math.ceil(C/26)|0,w=C%26;this._expand(S),w>0&&S--;for(var E=0;E<S;E++)this.words[E]=~this.words[E]&67108863;return w>0&&(this.words[E]=~this.words[E]&67108863>>26-w),this.strip()},a.prototype.notn=function(C){return this.clone().inotn(C)},a.prototype.setn=function(C,S){i(typeof C=="number"&&C>=0);var w=C/26|0,E=C%26;return this._expand(w+1),S?this.words[w]=this.words[w]|1<<E:this.words[w]=this.words[w]&~(1<<E),this.strip()},a.prototype.iadd=function(C){var S;if(this.negative!==0&&C.negative===0)return this.negative=0,S=this.isub(C),this.negative^=1,this._normSign();if(this.negative===0&&C.negative!==0)return C.negative=0,S=this.isub(C),C.negative=1,S._normSign();var w,E;this.length>C.length?(w=this,E=C):(w=C,E=this);for(var I=0,N=0;N<E.length;N++)S=(w.words[N]|0)+(E.words[N]|0)+I,this.words[N]=S&67108863,I=S>>>26;for(;I!==0&&N<w.length;N++)S=(w.words[N]|0)+I,this.words[N]=S&67108863,I=S>>>26;if(this.length=w.length,I!==0)this.words[this.length]=I,this.length++;else if(w!==this)for(;N<w.length;N++)this.words[N]=w.words[N];return this},a.prototype.add=function(C){var S;return C.negative!==0&&this.negative===0?(C.negative=0,S=this.sub(C),C.negative^=1,S):C.negative===0&&this.negative!==0?(this.negative=0,S=C.sub(this),this.negative=1,S):this.length>C.length?this.clone().iadd(C):C.clone().iadd(this)},a.prototype.isub=function(C){if(C.negative!==0){C.negative=0;var S=this.iadd(C);return C.negative=1,S._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(C),this.negative=1,this._normSign();var w=this.cmp(C);if(w===0)return this.negative=0,this.length=1,this.words[0]=0,this;var E,I;w>0?(E=this,I=C):(E=C,I=this);for(var N=0,U=0;U<I.length;U++)S=(E.words[U]|0)-(I.words[U]|0)+N,N=S>>26,this.words[U]=S&67108863;for(;N!==0&&U<E.length;U++)S=(E.words[U]|0)+N,N=S>>26,this.words[U]=S&67108863;if(N===0&&U<E.length&&E!==this)for(;U<E.length;U++)this.words[U]=E.words[U];return this.length=Math.max(this.length,U),E!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(C){return this.clone().isub(C)};function _(re,C,S){S.negative=C.negative^re.negative;var w=re.length+C.length|0;S.length=w,w=w-1|0;var E=re.words[0]|0,I=C.words[0]|0,N=E*I,U=N&67108863,L=N/67108864|0;S.words[0]=U;for(var P=1;P<w;P++){for(var B=L>>>26,A=L&67108863,z=Math.min(P,C.length-1),de=Math.max(0,P-re.length+1);de<=z;de++){var we=P-de|0;E=re.words[we]|0,I=C.words[de]|0,N=E*I+A,B+=N/67108864|0,A=N&67108863}S.words[P]=A|0,L=B|0}return L!==0?S.words[P]=L|0:S.length--,S.strip()}var $=function(C,S,w){var E=C.words,I=S.words,N=w.words,U=0,L,P,B,A=E[0]|0,z=A&8191,de=A>>>13,we=E[1]|0,se=we&8191,he=we>>>13,$e=E[2]|0,Ae=$e&8191,ze=$e>>>13,oe=E[3]|0,ie=oe&8191,Ie=oe>>>13,qe=E[4]|0,Ze=qe&8191,lt=qe>>>13,ht=E[5]|0,gt=ht&8191,Me=ht>>>13,jt=E[6]|0,ot=jt&8191,Ot=jt>>>13,Ut=E[7]|0,be=Ut&8191,Pe=Ut>>>13,Be=E[8]|0,Re=Be&8191,Ye=Be>>>13,Tt=E[9]|0,Je=Tt&8191,dt=Tt>>>13,rt=I[0]|0,et=rt&8191,pt=rt>>>13,Kt=I[1]|0,Ct=Kt&8191,er=Kt>>>13,nr=I[2]|0,It=nr&8191,Qt=nr>>>13,fr=I[3]|0,qt=fr&8191,lr=fr>>>13,Xt=I[4]|0,Dt=Xt&8191,ir=Xt>>>13,ar=I[5]|0,Lt=ar&8191,dr=ar>>>13,yr=I[6]|0,_t=yr&8191,hr=yr>>>13,F=I[7]|0,Y=F&8191,Q=F>>>13,M=I[8]|0,X=M&8191,ge=M>>>13,_e=I[9]|0,Ce=_e&8191,je=_e>>>13;w.negative=C.negative^S.negative,w.length=19,L=Math.imul(z,et),P=Math.imul(z,pt),P=P+Math.imul(de,et)|0,B=Math.imul(de,pt);var Xe=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,L=Math.imul(se,et),P=Math.imul(se,pt),P=P+Math.imul(he,et)|0,B=Math.imul(he,pt),L=L+Math.imul(z,Ct)|0,P=P+Math.imul(z,er)|0,P=P+Math.imul(de,Ct)|0,B=B+Math.imul(de,er)|0;var Ve=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(Ve>>>26)|0,Ve&=67108863,L=Math.imul(Ae,et),P=Math.imul(Ae,pt),P=P+Math.imul(ze,et)|0,B=Math.imul(ze,pt),L=L+Math.imul(se,Ct)|0,P=P+Math.imul(se,er)|0,P=P+Math.imul(he,Ct)|0,B=B+Math.imul(he,er)|0,L=L+Math.imul(z,It)|0,P=P+Math.imul(z,Qt)|0,P=P+Math.imul(de,It)|0,B=B+Math.imul(de,Qt)|0;var zt=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(zt>>>26)|0,zt&=67108863,L=Math.imul(ie,et),P=Math.imul(ie,pt),P=P+Math.imul(Ie,et)|0,B=Math.imul(Ie,pt),L=L+Math.imul(Ae,Ct)|0,P=P+Math.imul(Ae,er)|0,P=P+Math.imul(ze,Ct)|0,B=B+Math.imul(ze,er)|0,L=L+Math.imul(se,It)|0,P=P+Math.imul(se,Qt)|0,P=P+Math.imul(he,It)|0,B=B+Math.imul(he,Qt)|0,L=L+Math.imul(z,qt)|0,P=P+Math.imul(z,lr)|0,P=P+Math.imul(de,qt)|0,B=B+Math.imul(de,lr)|0;var at=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(at>>>26)|0,at&=67108863,L=Math.imul(Ze,et),P=Math.imul(Ze,pt),P=P+Math.imul(lt,et)|0,B=Math.imul(lt,pt),L=L+Math.imul(ie,Ct)|0,P=P+Math.imul(ie,er)|0,P=P+Math.imul(Ie,Ct)|0,B=B+Math.imul(Ie,er)|0,L=L+Math.imul(Ae,It)|0,P=P+Math.imul(Ae,Qt)|0,P=P+Math.imul(ze,It)|0,B=B+Math.imul(ze,Qt)|0,L=L+Math.imul(se,qt)|0,P=P+Math.imul(se,lr)|0,P=P+Math.imul(he,qt)|0,B=B+Math.imul(he,lr)|0,L=L+Math.imul(z,Dt)|0,P=P+Math.imul(z,ir)|0,P=P+Math.imul(de,Dt)|0,B=B+Math.imul(de,ir)|0;var xt=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(xt>>>26)|0,xt&=67108863,L=Math.imul(gt,et),P=Math.imul(gt,pt),P=P+Math.imul(Me,et)|0,B=Math.imul(Me,pt),L=L+Math.imul(Ze,Ct)|0,P=P+Math.imul(Ze,er)|0,P=P+Math.imul(lt,Ct)|0,B=B+Math.imul(lt,er)|0,L=L+Math.imul(ie,It)|0,P=P+Math.imul(ie,Qt)|0,P=P+Math.imul(Ie,It)|0,B=B+Math.imul(Ie,Qt)|0,L=L+Math.imul(Ae,qt)|0,P=P+Math.imul(Ae,lr)|0,P=P+Math.imul(ze,qt)|0,B=B+Math.imul(ze,lr)|0,L=L+Math.imul(se,Dt)|0,P=P+Math.imul(se,ir)|0,P=P+Math.imul(he,Dt)|0,B=B+Math.imul(he,ir)|0,L=L+Math.imul(z,Lt)|0,P=P+Math.imul(z,dr)|0,P=P+Math.imul(de,Lt)|0,B=B+Math.imul(de,dr)|0;var St=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(St>>>26)|0,St&=67108863,L=Math.imul(ot,et),P=Math.imul(ot,pt),P=P+Math.imul(Ot,et)|0,B=Math.imul(Ot,pt),L=L+Math.imul(gt,Ct)|0,P=P+Math.imul(gt,er)|0,P=P+Math.imul(Me,Ct)|0,B=B+Math.imul(Me,er)|0,L=L+Math.imul(Ze,It)|0,P=P+Math.imul(Ze,Qt)|0,P=P+Math.imul(lt,It)|0,B=B+Math.imul(lt,Qt)|0,L=L+Math.imul(ie,qt)|0,P=P+Math.imul(ie,lr)|0,P=P+Math.imul(Ie,qt)|0,B=B+Math.imul(Ie,lr)|0,L=L+Math.imul(Ae,Dt)|0,P=P+Math.imul(Ae,ir)|0,P=P+Math.imul(ze,Dt)|0,B=B+Math.imul(ze,ir)|0,L=L+Math.imul(se,Lt)|0,P=P+Math.imul(se,dr)|0,P=P+Math.imul(he,Lt)|0,B=B+Math.imul(he,dr)|0,L=L+Math.imul(z,_t)|0,P=P+Math.imul(z,hr)|0,P=P+Math.imul(de,_t)|0,B=B+Math.imul(de,hr)|0;var kt=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(kt>>>26)|0,kt&=67108863,L=Math.imul(be,et),P=Math.imul(be,pt),P=P+Math.imul(Pe,et)|0,B=Math.imul(Pe,pt),L=L+Math.imul(ot,Ct)|0,P=P+Math.imul(ot,er)|0,P=P+Math.imul(Ot,Ct)|0,B=B+Math.imul(Ot,er)|0,L=L+Math.imul(gt,It)|0,P=P+Math.imul(gt,Qt)|0,P=P+Math.imul(Me,It)|0,B=B+Math.imul(Me,Qt)|0,L=L+Math.imul(Ze,qt)|0,P=P+Math.imul(Ze,lr)|0,P=P+Math.imul(lt,qt)|0,B=B+Math.imul(lt,lr)|0,L=L+Math.imul(ie,Dt)|0,P=P+Math.imul(ie,ir)|0,P=P+Math.imul(Ie,Dt)|0,B=B+Math.imul(Ie,ir)|0,L=L+Math.imul(Ae,Lt)|0,P=P+Math.imul(Ae,dr)|0,P=P+Math.imul(ze,Lt)|0,B=B+Math.imul(ze,dr)|0,L=L+Math.imul(se,_t)|0,P=P+Math.imul(se,hr)|0,P=P+Math.imul(he,_t)|0,B=B+Math.imul(he,hr)|0,L=L+Math.imul(z,Y)|0,P=P+Math.imul(z,Q)|0,P=P+Math.imul(de,Y)|0,B=B+Math.imul(de,Q)|0;var At=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(At>>>26)|0,At&=67108863,L=Math.imul(Re,et),P=Math.imul(Re,pt),P=P+Math.imul(Ye,et)|0,B=Math.imul(Ye,pt),L=L+Math.imul(be,Ct)|0,P=P+Math.imul(be,er)|0,P=P+Math.imul(Pe,Ct)|0,B=B+Math.imul(Pe,er)|0,L=L+Math.imul(ot,It)|0,P=P+Math.imul(ot,Qt)|0,P=P+Math.imul(Ot,It)|0,B=B+Math.imul(Ot,Qt)|0,L=L+Math.imul(gt,qt)|0,P=P+Math.imul(gt,lr)|0,P=P+Math.imul(Me,qt)|0,B=B+Math.imul(Me,lr)|0,L=L+Math.imul(Ze,Dt)|0,P=P+Math.imul(Ze,ir)|0,P=P+Math.imul(lt,Dt)|0,B=B+Math.imul(lt,ir)|0,L=L+Math.imul(ie,Lt)|0,P=P+Math.imul(ie,dr)|0,P=P+Math.imul(Ie,Lt)|0,B=B+Math.imul(Ie,dr)|0,L=L+Math.imul(Ae,_t)|0,P=P+Math.imul(Ae,hr)|0,P=P+Math.imul(ze,_t)|0,B=B+Math.imul(ze,hr)|0,L=L+Math.imul(se,Y)|0,P=P+Math.imul(se,Q)|0,P=P+Math.imul(he,Y)|0,B=B+Math.imul(he,Q)|0,L=L+Math.imul(z,X)|0,P=P+Math.imul(z,ge)|0,P=P+Math.imul(de,X)|0,B=B+Math.imul(de,ge)|0;var $t=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+($t>>>26)|0,$t&=67108863,L=Math.imul(Je,et),P=Math.imul(Je,pt),P=P+Math.imul(dt,et)|0,B=Math.imul(dt,pt),L=L+Math.imul(Re,Ct)|0,P=P+Math.imul(Re,er)|0,P=P+Math.imul(Ye,Ct)|0,B=B+Math.imul(Ye,er)|0,L=L+Math.imul(be,It)|0,P=P+Math.imul(be,Qt)|0,P=P+Math.imul(Pe,It)|0,B=B+Math.imul(Pe,Qt)|0,L=L+Math.imul(ot,qt)|0,P=P+Math.imul(ot,lr)|0,P=P+Math.imul(Ot,qt)|0,B=B+Math.imul(Ot,lr)|0,L=L+Math.imul(gt,Dt)|0,P=P+Math.imul(gt,ir)|0,P=P+Math.imul(Me,Dt)|0,B=B+Math.imul(Me,ir)|0,L=L+Math.imul(Ze,Lt)|0,P=P+Math.imul(Ze,dr)|0,P=P+Math.imul(lt,Lt)|0,B=B+Math.imul(lt,dr)|0,L=L+Math.imul(ie,_t)|0,P=P+Math.imul(ie,hr)|0,P=P+Math.imul(Ie,_t)|0,B=B+Math.imul(Ie,hr)|0,L=L+Math.imul(Ae,Y)|0,P=P+Math.imul(Ae,Q)|0,P=P+Math.imul(ze,Y)|0,B=B+Math.imul(ze,Q)|0,L=L+Math.imul(se,X)|0,P=P+Math.imul(se,ge)|0,P=P+Math.imul(he,X)|0,B=B+Math.imul(he,ge)|0,L=L+Math.imul(z,Ce)|0,P=P+Math.imul(z,je)|0,P=P+Math.imul(de,Ce)|0,B=B+Math.imul(de,je)|0;var vt=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(vt>>>26)|0,vt&=67108863,L=Math.imul(Je,Ct),P=Math.imul(Je,er),P=P+Math.imul(dt,Ct)|0,B=Math.imul(dt,er),L=L+Math.imul(Re,It)|0,P=P+Math.imul(Re,Qt)|0,P=P+Math.imul(Ye,It)|0,B=B+Math.imul(Ye,Qt)|0,L=L+Math.imul(be,qt)|0,P=P+Math.imul(be,lr)|0,P=P+Math.imul(Pe,qt)|0,B=B+Math.imul(Pe,lr)|0,L=L+Math.imul(ot,Dt)|0,P=P+Math.imul(ot,ir)|0,P=P+Math.imul(Ot,Dt)|0,B=B+Math.imul(Ot,ir)|0,L=L+Math.imul(gt,Lt)|0,P=P+Math.imul(gt,dr)|0,P=P+Math.imul(Me,Lt)|0,B=B+Math.imul(Me,dr)|0,L=L+Math.imul(Ze,_t)|0,P=P+Math.imul(Ze,hr)|0,P=P+Math.imul(lt,_t)|0,B=B+Math.imul(lt,hr)|0,L=L+Math.imul(ie,Y)|0,P=P+Math.imul(ie,Q)|0,P=P+Math.imul(Ie,Y)|0,B=B+Math.imul(Ie,Q)|0,L=L+Math.imul(Ae,X)|0,P=P+Math.imul(Ae,ge)|0,P=P+Math.imul(ze,X)|0,B=B+Math.imul(ze,ge)|0,L=L+Math.imul(se,Ce)|0,P=P+Math.imul(se,je)|0,P=P+Math.imul(he,Ce)|0,B=B+Math.imul(he,je)|0;var Et=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(Et>>>26)|0,Et&=67108863,L=Math.imul(Je,It),P=Math.imul(Je,Qt),P=P+Math.imul(dt,It)|0,B=Math.imul(dt,Qt),L=L+Math.imul(Re,qt)|0,P=P+Math.imul(Re,lr)|0,P=P+Math.imul(Ye,qt)|0,B=B+Math.imul(Ye,lr)|0,L=L+Math.imul(be,Dt)|0,P=P+Math.imul(be,ir)|0,P=P+Math.imul(Pe,Dt)|0,B=B+Math.imul(Pe,ir)|0,L=L+Math.imul(ot,Lt)|0,P=P+Math.imul(ot,dr)|0,P=P+Math.imul(Ot,Lt)|0,B=B+Math.imul(Ot,dr)|0,L=L+Math.imul(gt,_t)|0,P=P+Math.imul(gt,hr)|0,P=P+Math.imul(Me,_t)|0,B=B+Math.imul(Me,hr)|0,L=L+Math.imul(Ze,Y)|0,P=P+Math.imul(Ze,Q)|0,P=P+Math.imul(lt,Y)|0,B=B+Math.imul(lt,Q)|0,L=L+Math.imul(ie,X)|0,P=P+Math.imul(ie,ge)|0,P=P+Math.imul(Ie,X)|0,B=B+Math.imul(Ie,ge)|0,L=L+Math.imul(Ae,Ce)|0,P=P+Math.imul(Ae,je)|0,P=P+Math.imul(ze,Ce)|0,B=B+Math.imul(ze,je)|0;var it=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(it>>>26)|0,it&=67108863,L=Math.imul(Je,qt),P=Math.imul(Je,lr),P=P+Math.imul(dt,qt)|0,B=Math.imul(dt,lr),L=L+Math.imul(Re,Dt)|0,P=P+Math.imul(Re,ir)|0,P=P+Math.imul(Ye,Dt)|0,B=B+Math.imul(Ye,ir)|0,L=L+Math.imul(be,Lt)|0,P=P+Math.imul(be,dr)|0,P=P+Math.imul(Pe,Lt)|0,B=B+Math.imul(Pe,dr)|0,L=L+Math.imul(ot,_t)|0,P=P+Math.imul(ot,hr)|0,P=P+Math.imul(Ot,_t)|0,B=B+Math.imul(Ot,hr)|0,L=L+Math.imul(gt,Y)|0,P=P+Math.imul(gt,Q)|0,P=P+Math.imul(Me,Y)|0,B=B+Math.imul(Me,Q)|0,L=L+Math.imul(Ze,X)|0,P=P+Math.imul(Ze,ge)|0,P=P+Math.imul(lt,X)|0,B=B+Math.imul(lt,ge)|0,L=L+Math.imul(ie,Ce)|0,P=P+Math.imul(ie,je)|0,P=P+Math.imul(Ie,Ce)|0,B=B+Math.imul(Ie,je)|0;var yt=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(yt>>>26)|0,yt&=67108863,L=Math.imul(Je,Dt),P=Math.imul(Je,ir),P=P+Math.imul(dt,Dt)|0,B=Math.imul(dt,ir),L=L+Math.imul(Re,Lt)|0,P=P+Math.imul(Re,dr)|0,P=P+Math.imul(Ye,Lt)|0,B=B+Math.imul(Ye,dr)|0,L=L+Math.imul(be,_t)|0,P=P+Math.imul(be,hr)|0,P=P+Math.imul(Pe,_t)|0,B=B+Math.imul(Pe,hr)|0,L=L+Math.imul(ot,Y)|0,P=P+Math.imul(ot,Q)|0,P=P+Math.imul(Ot,Y)|0,B=B+Math.imul(Ot,Q)|0,L=L+Math.imul(gt,X)|0,P=P+Math.imul(gt,ge)|0,P=P+Math.imul(Me,X)|0,B=B+Math.imul(Me,ge)|0,L=L+Math.imul(Ze,Ce)|0,P=P+Math.imul(Ze,je)|0,P=P+Math.imul(lt,Ce)|0,B=B+Math.imul(lt,je)|0;var tt=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(tt>>>26)|0,tt&=67108863,L=Math.imul(Je,Lt),P=Math.imul(Je,dr),P=P+Math.imul(dt,Lt)|0,B=Math.imul(dt,dr),L=L+Math.imul(Re,_t)|0,P=P+Math.imul(Re,hr)|0,P=P+Math.imul(Ye,_t)|0,B=B+Math.imul(Ye,hr)|0,L=L+Math.imul(be,Y)|0,P=P+Math.imul(be,Q)|0,P=P+Math.imul(Pe,Y)|0,B=B+Math.imul(Pe,Q)|0,L=L+Math.imul(ot,X)|0,P=P+Math.imul(ot,ge)|0,P=P+Math.imul(Ot,X)|0,B=B+Math.imul(Ot,ge)|0,L=L+Math.imul(gt,Ce)|0,P=P+Math.imul(gt,je)|0,P=P+Math.imul(Me,Ce)|0,B=B+Math.imul(Me,je)|0;var st=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(st>>>26)|0,st&=67108863,L=Math.imul(Je,_t),P=Math.imul(Je,hr),P=P+Math.imul(dt,_t)|0,B=Math.imul(dt,hr),L=L+Math.imul(Re,Y)|0,P=P+Math.imul(Re,Q)|0,P=P+Math.imul(Ye,Y)|0,B=B+Math.imul(Ye,Q)|0,L=L+Math.imul(be,X)|0,P=P+Math.imul(be,ge)|0,P=P+Math.imul(Pe,X)|0,B=B+Math.imul(Pe,ge)|0,L=L+Math.imul(ot,Ce)|0,P=P+Math.imul(ot,je)|0,P=P+Math.imul(Ot,Ce)|0,B=B+Math.imul(Ot,je)|0;var ft=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(ft>>>26)|0,ft&=67108863,L=Math.imul(Je,Y),P=Math.imul(Je,Q),P=P+Math.imul(dt,Y)|0,B=Math.imul(dt,Q),L=L+Math.imul(Re,X)|0,P=P+Math.imul(Re,ge)|0,P=P+Math.imul(Ye,X)|0,B=B+Math.imul(Ye,ge)|0,L=L+Math.imul(be,Ce)|0,P=P+Math.imul(be,je)|0,P=P+Math.imul(Pe,Ce)|0,B=B+Math.imul(Pe,je)|0;var nt=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(nt>>>26)|0,nt&=67108863,L=Math.imul(Je,X),P=Math.imul(Je,ge),P=P+Math.imul(dt,X)|0,B=Math.imul(dt,ge),L=L+Math.imul(Re,Ce)|0,P=P+Math.imul(Re,je)|0,P=P+Math.imul(Ye,Ce)|0,B=B+Math.imul(Ye,je)|0;var ke=(U+L|0)+((P&8191)<<13)|0;U=(B+(P>>>13)|0)+(ke>>>26)|0,ke&=67108863,L=Math.imul(Je,Ce),P=Math.imul(Je,je),P=P+Math.imul(dt,Ce)|0,B=Math.imul(dt,je);var De=(U+L|0)+((P&8191)<<13)|0;return U=(B+(P>>>13)|0)+(De>>>26)|0,De&=67108863,N[0]=Xe,N[1]=Ve,N[2]=zt,N[3]=at,N[4]=xt,N[5]=St,N[6]=kt,N[7]=At,N[8]=$t,N[9]=vt,N[10]=Et,N[11]=it,N[12]=yt,N[13]=tt,N[14]=st,N[15]=ft,N[16]=nt,N[17]=ke,N[18]=De,U!==0&&(N[19]=U,w.length++),w};Math.imul||($=_);function k(re,C,S){S.negative=C.negative^re.negative,S.length=re.length+C.length;for(var w=0,E=0,I=0;I<S.length-1;I++){var N=E;E=0;for(var U=w&67108863,L=Math.min(I,C.length-1),P=Math.max(0,I-re.length+1);P<=L;P++){var B=I-P,A=re.words[B]|0,z=C.words[P]|0,de=A*z,we=de&67108863;N=N+(de/67108864|0)|0,we=we+U|0,U=we&67108863,N=N+(we>>>26)|0,E+=N>>>26,N&=67108863}S.words[I]=U,w=N,N=E}return w!==0?S.words[I]=w:S.length--,S.strip()}function D(re,C,S){var w=new O;return w.mulp(re,C,S)}a.prototype.mulTo=function(C,S){var w,E=this.length+C.length;return this.length===10&&C.length===10?w=$(this,C,S):E<63?w=_(this,C,S):E<1024?w=k(this,C,S):w=D(this,C,S),w};function O(re,C){this.x=re,this.y=C}O.prototype.makeRBT=function(C){for(var S=new Array(C),w=a.prototype._countBits(C)-1,E=0;E<C;E++)S[E]=this.revBin(E,w,C);return S},O.prototype.revBin=function(C,S,w){if(C===0||C===w-1)return C;for(var E=0,I=0;I<S;I++)E|=(C&1)<<S-I-1,C>>=1;return E},O.prototype.permute=function(C,S,w,E,I,N){for(var U=0;U<N;U++)E[U]=S[C[U]],I[U]=w[C[U]]},O.prototype.transform=function(C,S,w,E,I,N){this.permute(N,C,S,w,E,I);for(var U=1;U<I;U<<=1)for(var L=U<<1,P=Math.cos(2*Math.PI/L),B=Math.sin(2*Math.PI/L),A=0;A<I;A+=L)for(var z=P,de=B,we=0;we<U;we++){var se=w[A+we],he=E[A+we],$e=w[A+we+U],Ae=E[A+we+U],ze=z*$e-de*Ae;Ae=z*Ae+de*$e,$e=ze,w[A+we]=se+$e,E[A+we]=he+Ae,w[A+we+U]=se-$e,E[A+we+U]=he-Ae,we!==L&&(ze=P*z-B*de,de=P*de+B*z,z=ze)}},O.prototype.guessLen13b=function(C,S){var w=Math.max(S,C)|1,E=w&1,I=0;for(w=w/2|0;w;w=w>>>1)I++;return 1<<I+1+E},O.prototype.conjugate=function(C,S,w){if(!(w<=1))for(var E=0;E<w/2;E++){var I=C[E];C[E]=C[w-E-1],C[w-E-1]=I,I=S[E],S[E]=-S[w-E-1],S[w-E-1]=-I}},O.prototype.normalize13b=function(C,S){for(var w=0,E=0;E<S/2;E++){var I=Math.round(C[2*E+1]/S)*8192+Math.round(C[2*E]/S)+w;C[E]=I&67108863,I<67108864?w=0:w=I/67108864|0}return C},O.prototype.convert13b=function(C,S,w,E){for(var I=0,N=0;N<S;N++)I=I+(C[N]|0),w[2*N]=I&8191,I=I>>>13,w[2*N+1]=I&8191,I=I>>>13;for(N=2*S;N<E;++N)w[N]=0;i(I===0),i((I&-8192)===0)},O.prototype.stub=function(C){for(var S=new Array(C),w=0;w<C;w++)S[w]=0;return S},O.prototype.mulp=function(C,S,w){var E=2*this.guessLen13b(C.length,S.length),I=this.makeRBT(E),N=this.stub(E),U=new Array(E),L=new Array(E),P=new Array(E),B=new Array(E),A=new Array(E),z=new Array(E),de=w.words;de.length=E,this.convert13b(C.words,C.length,U,E),this.convert13b(S.words,S.length,B,E),this.transform(U,N,L,P,E,I),this.transform(B,N,A,z,E,I);for(var we=0;we<E;we++){var se=L[we]*A[we]-P[we]*z[we];P[we]=L[we]*z[we]+P[we]*A[we],L[we]=se}return this.conjugate(L,P,E),this.transform(L,P,de,N,E,I),this.conjugate(de,N,E),this.normalize13b(de,E),w.negative=C.negative^S.negative,w.length=C.length+S.length,w.strip()},a.prototype.mul=function(C){var S=new a(null);return S.words=new Array(this.length+C.length),this.mulTo(C,S)},a.prototype.mulf=function(C){var S=new a(null);return S.words=new Array(this.length+C.length),D(this,C,S)},a.prototype.imul=function(C){return this.clone().mulTo(C,this)},a.prototype.imuln=function(C){i(typeof C=="number"),i(C<67108864);for(var S=0,w=0;w<this.length;w++){var E=(this.words[w]|0)*C,I=(E&67108863)+(S&67108863);S>>=26,S+=E/67108864|0,S+=I>>>26,this.words[w]=I&67108863}return S!==0&&(this.words[w]=S,this.length++),this},a.prototype.muln=function(C){return this.clone().imuln(C)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(C){var S=v(C);if(S.length===0)return new a(1);for(var w=this,E=0;E<S.length&&S[E]===0;E++,w=w.sqr());if(++E<S.length)for(var I=w.sqr();E<S.length;E++,I=I.sqr())S[E]!==0&&(w=w.mul(I));return w},a.prototype.iushln=function(C){i(typeof C=="number"&&C>=0);var S=C%26,w=(C-S)/26,E=67108863>>>26-S<<26-S,I;if(S!==0){var N=0;for(I=0;I<this.length;I++){var U=this.words[I]&E,L=(this.words[I]|0)-U<<S;this.words[I]=L|N,N=U>>>26-S}N&&(this.words[I]=N,this.length++)}if(w!==0){for(I=this.length-1;I>=0;I--)this.words[I+w]=this.words[I];for(I=0;I<w;I++)this.words[I]=0;this.length+=w}return this.strip()},a.prototype.ishln=function(C){return i(this.negative===0),this.iushln(C)},a.prototype.iushrn=function(C,S,w){i(typeof C=="number"&&C>=0);var E;S?E=(S-S%26)/26:E=0;var I=C%26,N=Math.min((C-I)/26,this.length),U=67108863^67108863>>>I<<I,L=w;if(E-=N,E=Math.max(0,E),L){for(var P=0;P<N;P++)L.words[P]=this.words[P];L.length=N}if(N!==0)if(this.length>N)for(this.length-=N,P=0;P<this.length;P++)this.words[P]=this.words[P+N];else this.words[0]=0,this.length=1;var B=0;for(P=this.length-1;P>=0&&(B!==0||P>=E);P--){var A=this.words[P]|0;this.words[P]=B<<26-I|A>>>I,B=A&U}return L&&B!==0&&(L.words[L.length++]=B),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(C,S,w){return i(this.negative===0),this.iushrn(C,S,w)},a.prototype.shln=function(C){return this.clone().ishln(C)},a.prototype.ushln=function(C){return this.clone().iushln(C)},a.prototype.shrn=function(C){return this.clone().ishrn(C)},a.prototype.ushrn=function(C){return this.clone().iushrn(C)},a.prototype.testn=function(C){i(typeof C=="number"&&C>=0);var S=C%26,w=(C-S)/26,E=1<<S;if(this.length<=w)return!1;var I=this.words[w];return!!(I&E)},a.prototype.imaskn=function(C){i(typeof C=="number"&&C>=0);var S=C%26,w=(C-S)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=w)return this;if(S!==0&&w++,this.length=Math.min(w,this.length),S!==0){var E=67108863^67108863>>>S<<S;this.words[this.length-1]&=E}return this.strip()},a.prototype.maskn=function(C){return this.clone().imaskn(C)},a.prototype.iaddn=function(C){return i(typeof C=="number"),i(C<67108864),C<0?this.isubn(-C):this.negative!==0?this.length===1&&(this.words[0]|0)<C?(this.words[0]=C-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(C),this.negative=1,this):this._iaddn(C)},a.prototype._iaddn=function(C){this.words[0]+=C;for(var S=0;S<this.length&&this.words[S]>=67108864;S++)this.words[S]-=67108864,S===this.length-1?this.words[S+1]=1:this.words[S+1]++;return this.length=Math.max(this.length,S+1),this},a.prototype.isubn=function(C){if(i(typeof C=="number"),i(C<67108864),C<0)return this.iaddn(-C);if(this.negative!==0)return this.negative=0,this.iaddn(C),this.negative=1,this;if(this.words[0]-=C,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var S=0;S<this.length&&this.words[S]<0;S++)this.words[S]+=67108864,this.words[S+1]-=1;return this.strip()},a.prototype.addn=function(C){return this.clone().iaddn(C)},a.prototype.subn=function(C){return this.clone().isubn(C)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(C,S,w){var E=C.length+w,I;this._expand(E);var N,U=0;for(I=0;I<C.length;I++){N=(this.words[I+w]|0)+U;var L=(C.words[I]|0)*S;N-=L&67108863,U=(N>>26)-(L/67108864|0),this.words[I+w]=N&67108863}for(;I<this.length-w;I++)N=(this.words[I+w]|0)+U,U=N>>26,this.words[I+w]=N&67108863;if(U===0)return this.strip();for(i(U===-1),U=0,I=0;I<this.length;I++)N=-(this.words[I]|0)+U,U=N>>26,this.words[I]=N&67108863;return this.negative=1,this.strip()},a.prototype._wordDiv=function(C,S){var w=this.length-C.length,E=this.clone(),I=C,N=I.words[I.length-1]|0,U=this._countBits(N);w=26-U,w!==0&&(I=I.ushln(w),E.iushln(w),N=I.words[I.length-1]|0);var L=E.length-I.length,P;if(S!=="mod"){P=new a(null),P.length=L+1,P.words=new Array(P.length);for(var B=0;B<P.length;B++)P.words[B]=0}var A=E.clone()._ishlnsubmul(I,1,L);A.negative===0&&(E=A,P&&(P.words[L]=1));for(var z=L-1;z>=0;z--){var de=(E.words[I.length+z]|0)*67108864+(E.words[I.length+z-1]|0);for(de=Math.min(de/N|0,67108863),E._ishlnsubmul(I,de,z);E.negative!==0;)de--,E.negative=0,E._ishlnsubmul(I,1,z),E.isZero()||(E.negative^=1);P&&(P.words[z]=de)}return P&&P.strip(),E.strip(),S!=="div"&&w!==0&&E.iushrn(w),{div:P||null,mod:E}},a.prototype.divmod=function(C,S,w){if(i(!C.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var E,I,N;return this.negative!==0&&C.negative===0?(N=this.neg().divmod(C,S),S!=="mod"&&(E=N.div.neg()),S!=="div"&&(I=N.mod.neg(),w&&I.negative!==0&&I.iadd(C)),{div:E,mod:I}):this.negative===0&&C.negative!==0?(N=this.divmod(C.neg(),S),S!=="mod"&&(E=N.div.neg()),{div:E,mod:N.mod}):this.negative&C.negative?(N=this.neg().divmod(C.neg(),S),S!=="div"&&(I=N.mod.neg(),w&&I.negative!==0&&I.isub(C)),{div:N.div,mod:I}):C.length>this.length||this.cmp(C)<0?{div:new a(0),mod:this}:C.length===1?S==="div"?{div:this.divn(C.words[0]),mod:null}:S==="mod"?{div:null,mod:new a(this.modn(C.words[0]))}:{div:this.divn(C.words[0]),mod:new a(this.modn(C.words[0]))}:this._wordDiv(C,S)},a.prototype.div=function(C){return this.divmod(C,"div",!1).div},a.prototype.mod=function(C){return this.divmod(C,"mod",!1).mod},a.prototype.umod=function(C){return this.divmod(C,"mod",!0).mod},a.prototype.divRound=function(C){var S=this.divmod(C);if(S.mod.isZero())return S.div;var w=S.div.negative!==0?S.mod.isub(C):S.mod,E=C.ushrn(1),I=C.andln(1),N=w.cmp(E);return N<0||I===1&&N===0?S.div:S.div.negative!==0?S.div.isubn(1):S.div.iaddn(1)},a.prototype.modn=function(C){i(C<=67108863);for(var S=(1<<26)%C,w=0,E=this.length-1;E>=0;E--)w=(S*w+(this.words[E]|0))%C;return w},a.prototype.idivn=function(C){i(C<=67108863);for(var S=0,w=this.length-1;w>=0;w--){var E=(this.words[w]|0)+S*67108864;this.words[w]=E/C|0,S=E%C}return this.strip()},a.prototype.divn=function(C){return this.clone().idivn(C)},a.prototype.egcd=function(C){i(C.negative===0),i(!C.isZero());var S=this,w=C.clone();S.negative!==0?S=S.umod(C):S=S.clone();for(var E=new a(1),I=new a(0),N=new a(0),U=new a(1),L=0;S.isEven()&&w.isEven();)S.iushrn(1),w.iushrn(1),++L;for(var P=w.clone(),B=S.clone();!S.isZero();){for(var A=0,z=1;!(S.words[0]&z)&&A<26;++A,z<<=1);if(A>0)for(S.iushrn(A);A-- >0;)(E.isOdd()||I.isOdd())&&(E.iadd(P),I.isub(B)),E.iushrn(1),I.iushrn(1);for(var de=0,we=1;!(w.words[0]&we)&&de<26;++de,we<<=1);if(de>0)for(w.iushrn(de);de-- >0;)(N.isOdd()||U.isOdd())&&(N.iadd(P),U.isub(B)),N.iushrn(1),U.iushrn(1);S.cmp(w)>=0?(S.isub(w),E.isub(N),I.isub(U)):(w.isub(S),N.isub(E),U.isub(I))}return{a:N,b:U,gcd:w.iushln(L)}},a.prototype._invmp=function(C){i(C.negative===0),i(!C.isZero());var S=this,w=C.clone();S.negative!==0?S=S.umod(C):S=S.clone();for(var E=new a(1),I=new a(0),N=w.clone();S.cmpn(1)>0&&w.cmpn(1)>0;){for(var U=0,L=1;!(S.words[0]&L)&&U<26;++U,L<<=1);if(U>0)for(S.iushrn(U);U-- >0;)E.isOdd()&&E.iadd(N),E.iushrn(1);for(var P=0,B=1;!(w.words[0]&B)&&P<26;++P,B<<=1);if(P>0)for(w.iushrn(P);P-- >0;)I.isOdd()&&I.iadd(N),I.iushrn(1);S.cmp(w)>=0?(S.isub(w),E.isub(I)):(w.isub(S),I.isub(E))}var A;return S.cmpn(1)===0?A=E:A=I,A.cmpn(0)<0&&A.iadd(C),A},a.prototype.gcd=function(C){if(this.isZero())return C.abs();if(C.isZero())return this.abs();var S=this.clone(),w=C.clone();S.negative=0,w.negative=0;for(var E=0;S.isEven()&&w.isEven();E++)S.iushrn(1),w.iushrn(1);do{for(;S.isEven();)S.iushrn(1);for(;w.isEven();)w.iushrn(1);var I=S.cmp(w);if(I<0){var N=S;S=w,w=N}else if(I===0||w.cmpn(1)===0)break;S.isub(w)}while(!0);return w.iushln(E)},a.prototype.invm=function(C){return this.egcd(C).a.umod(C)},a.prototype.isEven=function(){return(this.words[0]&1)===0},a.prototype.isOdd=function(){return(this.words[0]&1)===1},a.prototype.andln=function(C){return this.words[0]&C},a.prototype.bincn=function(C){i(typeof C=="number");var S=C%26,w=(C-S)/26,E=1<<S;if(this.length<=w)return this._expand(w+1),this.words[w]|=E,this;for(var I=E,N=w;I!==0&&N<this.length;N++){var U=this.words[N]|0;U+=I,I=U>>>26,U&=67108863,this.words[N]=U}return I!==0&&(this.words[N]=I,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(C){var S=C<0;if(this.negative!==0&&!S)return-1;if(this.negative===0&&S)return 1;this.strip();var w;if(this.length>1)w=1;else{S&&(C=-C),i(C<=67108863,"Number is too big");var E=this.words[0]|0;w=E===C?0:E<C?-1:1}return this.negative!==0?-w|0:w},a.prototype.cmp=function(C){if(this.negative!==0&&C.negative===0)return-1;if(this.negative===0&&C.negative!==0)return 1;var S=this.ucmp(C);return this.negative!==0?-S|0:S},a.prototype.ucmp=function(C){if(this.length>C.length)return 1;if(this.length<C.length)return-1;for(var S=0,w=this.length-1;w>=0;w--){var E=this.words[w]|0,I=C.words[w]|0;if(E!==I){E<I?S=-1:E>I&&(S=1);break}}return S},a.prototype.gtn=function(C){return this.cmpn(C)===1},a.prototype.gt=function(C){return this.cmp(C)===1},a.prototype.gten=function(C){return this.cmpn(C)>=0},a.prototype.gte=function(C){return this.cmp(C)>=0},a.prototype.ltn=function(C){return this.cmpn(C)===-1},a.prototype.lt=function(C){return this.cmp(C)===-1},a.prototype.lten=function(C){return this.cmpn(C)<=0},a.prototype.lte=function(C){return this.cmp(C)<=0},a.prototype.eqn=function(C){return this.cmpn(C)===0},a.prototype.eq=function(C){return this.cmp(C)===0},a.red=function(C){return new ve(C)},a.prototype.toRed=function(C){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),C.convertTo(this)._forceRed(C)},a.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(C){return this.red=C,this},a.prototype.forceRed=function(C){return i(!this.red,"Already a number in reduction context"),this._forceRed(C)},a.prototype.redAdd=function(C){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,C)},a.prototype.redIAdd=function(C){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,C)},a.prototype.redSub=function(C){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,C)},a.prototype.redISub=function(C){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,C)},a.prototype.redShl=function(C){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,C)},a.prototype.redMul=function(C){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,C),this.red.mul(this,C)},a.prototype.redIMul=function(C){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,C),this.red.imul(this,C)},a.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(C){return i(this.red&&!C.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,C)};var H={k256:null,p224:null,p192:null,p25519:null};function j(re,C){this.name=re,this.p=new a(C,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}j.prototype._tmp=function(){var C=new a(null);return C.words=new Array(Math.ceil(this.n/13)),C},j.prototype.ireduce=function(C){var S=C,w;do this.split(S,this.tmp),S=this.imulK(S),S=S.iadd(this.tmp),w=S.bitLength();while(w>this.n);var E=w<this.n?-1:S.ucmp(this.p);return E===0?(S.words[0]=0,S.length=1):E>0?S.isub(this.p):S.strip!==void 0?S.strip():S._strip(),S},j.prototype.split=function(C,S){C.iushrn(this.n,0,S)},j.prototype.imulK=function(C){return C.imul(this.k)};function W(){j.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}o(W,j),W.prototype.split=function(C,S){for(var w=4194303,E=Math.min(C.length,9),I=0;I<E;I++)S.words[I]=C.words[I];if(S.length=E,C.length<=9){C.words[0]=0,C.length=1;return}var N=C.words[9];for(S.words[S.length++]=N&w,I=10;I<C.length;I++){var U=C.words[I]|0;C.words[I-10]=(U&w)<<4|N>>>22,N=U}N>>>=22,C.words[I-10]=N,N===0&&C.length>10?C.length-=10:C.length-=9},W.prototype.imulK=function(C){C.words[C.length]=0,C.words[C.length+1]=0,C.length+=2;for(var S=0,w=0;w<C.length;w++){var E=C.words[w]|0;S+=E*977,C.words[w]=S&67108863,S=E*64+(S/67108864|0)}return C.words[C.length-1]===0&&(C.length--,C.words[C.length-1]===0&&C.length--),C};function ae(){j.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}o(ae,j);function fe(){j.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}o(fe,j);function pe(){j.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}o(pe,j),pe.prototype.imulK=function(C){for(var S=0,w=0;w<C.length;w++){var E=(C.words[w]|0)*19+S,I=E&67108863;E>>>=26,C.words[w]=I,S=E}return S!==0&&(C.words[C.length++]=S),C},a._prime=function(C){if(H[C])return H[C];var S;if(C==="k256")S=new W;else if(C==="p224")S=new ae;else if(C==="p192")S=new fe;else if(C==="p25519")S=new pe;else throw new Error("Unknown prime "+C);return H[C]=S,S};function ve(re){if(typeof re=="string"){var C=a._prime(re);this.m=C.p,this.prime=C}else i(re.gtn(1),"modulus must be greater than 1"),this.m=re,this.prime=null}ve.prototype._verify1=function(C){i(C.negative===0,"red works only with positives"),i(C.red,"red works only with red numbers")},ve.prototype._verify2=function(C,S){i((C.negative|S.negative)===0,"red works only with positives"),i(C.red&&C.red===S.red,"red works only with red numbers")},ve.prototype.imod=function(C){return this.prime?this.prime.ireduce(C)._forceRed(this):C.umod(this.m)._forceRed(this)},ve.prototype.neg=function(C){return C.isZero()?C.clone():this.m.sub(C)._forceRed(this)},ve.prototype.add=function(C,S){this._verify2(C,S);var w=C.add(S);return w.cmp(this.m)>=0&&w.isub(this.m),w._forceRed(this)},ve.prototype.iadd=function(C,S){this._verify2(C,S);var w=C.iadd(S);return w.cmp(this.m)>=0&&w.isub(this.m),w},ve.prototype.sub=function(C,S){this._verify2(C,S);var w=C.sub(S);return w.cmpn(0)<0&&w.iadd(this.m),w._forceRed(this)},ve.prototype.isub=function(C,S){this._verify2(C,S);var w=C.isub(S);return w.cmpn(0)<0&&w.iadd(this.m),w},ve.prototype.shl=function(C,S){return this._verify1(C),this.imod(C.ushln(S))},ve.prototype.imul=function(C,S){return this._verify2(C,S),this.imod(C.imul(S))},ve.prototype.mul=function(C,S){return this._verify2(C,S),this.imod(C.mul(S))},ve.prototype.isqr=function(C){return this.imul(C,C.clone())},ve.prototype.sqr=function(C){return this.mul(C,C)},ve.prototype.sqrt=function(C){if(C.isZero())return C.clone();var S=this.m.andln(3);if(i(S%2===1),S===3){var w=this.m.add(new a(1)).iushrn(2);return this.pow(C,w)}for(var E=this.m.subn(1),I=0;!E.isZero()&&E.andln(1)===0;)I++,E.iushrn(1);i(!E.isZero());var N=new a(1).toRed(this),U=N.redNeg(),L=this.m.subn(1).iushrn(1),P=this.m.bitLength();for(P=new a(2*P*P).toRed(this);this.pow(P,L).cmp(U)!==0;)P.redIAdd(U);for(var B=this.pow(P,E),A=this.pow(C,E.addn(1).iushrn(1)),z=this.pow(C,E),de=I;z.cmp(N)!==0;){for(var we=z,se=0;we.cmp(N)!==0;se++)we=we.redSqr();i(se<de);var he=this.pow(B,new a(1).iushln(de-se-1));A=A.redMul(he),B=he.redSqr(),z=z.redMul(B),de=se}return A},ve.prototype.invm=function(C){var S=C._invmp(this.m);return S.negative!==0?(S.negative=0,this.imod(S).redNeg()):this.imod(S)},ve.prototype.pow=function(C,S){if(S.isZero())return new a(1).toRed(this);if(S.cmpn(1)===0)return C.clone();var w=4,E=new Array(1<<w);E[0]=new a(1).toRed(this),E[1]=C;for(var I=2;I<E.length;I++)E[I]=this.mul(E[I-1],C);var N=E[0],U=0,L=0,P=S.bitLength()%26;for(P===0&&(P=26),I=S.length-1;I>=0;I--){for(var B=S.words[I],A=P-1;A>=0;A--){var z=B>>A&1;if(N!==E[0]&&(N=this.sqr(N)),z===0&&U===0){L=0;continue}U<<=1,U|=z,L++,!(L!==w&&(I!==0||A!==0))&&(N=this.mul(N,E[U]),L=0,U=0)}P=26}return N},ve.prototype.convertTo=function(C){var S=C.umod(this.m);return S===C?S.clone():S},ve.prototype.convertFrom=function(C){var S=C.clone();return S.red=null,S},a.mont=function(C){return new Qe(C)};function Qe(re){ve.call(this,re),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}o(Qe,ve),Qe.prototype.convertTo=function(C){return this.imod(C.ushln(this.shift))},Qe.prototype.convertFrom=function(C){var S=this.imod(C.mul(this.rinv));return S.red=null,S},Qe.prototype.imul=function(C,S){if(C.isZero()||S.isZero())return C.words[0]=0,C.length=1,C;var w=C.imul(S),E=w.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),I=w.isub(E).iushrn(this.shift),N=I;return I.cmp(this.m)>=0?N=I.isub(this.m):I.cmpn(0)<0&&(N=I.iadd(this.m)),N._forceRed(this)},Qe.prototype.mul=function(C,S){if(C.isZero()||S.isZero())return new a(0)._forceRed(this);var w=C.mul(S),E=w.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),I=w.isub(E).iushrn(this.shift),N=I;return I.cmp(this.m)>=0?N=I.isub(this.m):I.cmpn(0)<0&&(N=I.iadd(this.m)),N._forceRed(this)},Qe.prototype.invm=function(C){var S=this.imod(C._invmp(this.m).mul(this.r2));return S._forceRed(this)}})(n,commonjsGlobal)})(bn$1);var bnExports=bn$1.exports,brorand={exports:{}},hasRequiredBrorand;function requireBrorand(){if(hasRequiredBrorand)return brorand.exports;hasRequiredBrorand=1;var n;brorand.exports=function(o){return n||(n=new e(null)),n.generate(o)};function e(i){this.rand=i}if(brorand.exports.Rand=e,e.prototype.generate=function(o){return this._rand(o)},e.prototype._rand=function(o){if(this.rand.getBytes)return this.rand.getBytes(o);for(var a=new Uint8Array(o),c=0;c<a.length;c++)a[c]=this.rand.getByte();return a},typeof self=="object")self.crypto&&self.crypto.getRandomValues?e.prototype._rand=function(o){var a=new Uint8Array(o);return self.crypto.getRandomValues(a),a}:self.msCrypto&&self.msCrypto.getRandomValues?e.prototype._rand=function(o){var a=new Uint8Array(o);return self.msCrypto.getRandomValues(a),a}:typeof window=="object"&&(e.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var t=requireCryptoBrowserify();if(typeof t.randomBytes!="function")throw new Error("Not supported");e.prototype._rand=function(o){return t.randomBytes(o)}}catch{}return brorand.exports}var mr,hasRequiredMr;function requireMr(){if(hasRequiredMr)return mr;hasRequiredMr=1;var n=bnExports,e=requireBrorand();function t(i){this.rand=i||new e.Rand}return mr=t,t.create=function(o){return new t(o)},t.prototype._randbelow=function(o){var a=o.bitLength(),c=Math.ceil(a/8);do var u=new n(this.rand.generate(c));while(u.cmp(o)>=0);return u},t.prototype._randrange=function(o,a){var c=a.sub(o);return o.add(this._randbelow(c))},t.prototype.test=function(o,a,c){var u=o.bitLength(),d=n.mont(o),p=new n(1).toRed(d);a||(a=Math.max(1,u/48|0));for(var h=o.subn(1),b=0;!h.testn(b);b++);for(var m=o.shrn(b),v=h.toRed(d),_=!0;a>0;a--){var $=this._randrange(new n(2),h);c&&c($);var k=$.toRed(d).redPow(m);if(!(k.cmp(p)===0||k.cmp(v)===0)){for(var D=1;D<b;D++){if(k=k.redSqr(),k.cmp(p)===0)return!1;if(k.cmp(v)===0)break}if(D===b)return!1}}return _},t.prototype.getDivisor=function(o,a){var c=o.bitLength(),u=n.mont(o),d=new n(1).toRed(u);a||(a=Math.max(1,c/48|0));for(var p=o.subn(1),h=0;!p.testn(h);h++);for(var b=o.shrn(h),m=p.toRed(u);a>0;a--){var v=this._randrange(new n(2),p),_=o.gcd(v);if(_.cmpn(1)!==0)return _;var $=v.toRed(u).redPow(b);if(!($.cmp(d)===0||$.cmp(m)===0)){for(var k=1;k<h;k++){if($=$.redSqr(),$.cmp(d)===0)return $.fromRed().subn(1).gcd(o);if($.cmp(m)===0)break}if(k===h)return $=$.redSqr(),$.fromRed().subn(1).gcd(o)}}return!1},mr}var generatePrime,hasRequiredGeneratePrime;function requireGeneratePrime(){if(hasRequiredGeneratePrime)return generatePrime;hasRequiredGeneratePrime=1;var n=requireBrowser$b();generatePrime=k,k.simpleSieve=_,k.fermatTest=$;var e=bnExports,t=new e(24),i=requireMr(),o=new i,a=new e(1),c=new e(2),u=new e(5);new e(16),new e(8);var d=new e(10),p=new e(3);new e(7);var h=new e(11),b=new e(4);new e(12);var m=null;function v(){if(m!==null)return m;var D=1048576,O=[];O[0]=2;for(var H=1,j=3;j<D;j+=2){for(var W=Math.ceil(Math.sqrt(j)),ae=0;ae<H&&O[ae]<=W&&j%O[ae]!==0;ae++);H!==ae&&O[ae]<=W||(O[H++]=j)}return m=O,O}function _(D){for(var O=v(),H=0;H<O.length;H++)if(D.modn(O[H])===0)return D.cmpn(O[H])===0;return!0}function $(D){var O=e.mont(D);return c.toRed(O).redPow(D.subn(1)).fromRed().cmpn(1)===0}function k(D,O){if(D<16)return O===2||O===5?new e([140,123]):new e([140,39]);O=new e(O);for(var H,j;;){for(H=new e(n(Math.ceil(D/8)));H.bitLength()>D;)H.ishrn(1);if(H.isEven()&&H.iadd(a),H.testn(1)||H.iadd(c),O.cmp(c)){if(!O.cmp(u))for(;H.mod(d).cmp(p);)H.iadd(b)}else for(;H.mod(t).cmp(h);)H.iadd(b);if(j=H.shrn(1),_(j)&&_(H)&&$(j)&&$(H)&&o.test(j)&&o.test(H))return H}}return generatePrime}const modp1={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"},require$$1$1={modp1,modp2,modp5,modp14,modp15,modp16,modp17,modp18};var dh,hasRequiredDh;function requireDh(){if(hasRequiredDh)return dh;hasRequiredDh=1;var n=bnExports,e=requireMr(),t=new e,i=new n(24),o=new n(11),a=new n(10),c=new n(3),u=new n(7),d=requireGeneratePrime(),p=requireBrowser$b();dh=_;function h(k,D){return D=D||"utf8",buffer$2.Buffer.isBuffer(k)||(k=new buffer$2.Buffer(k,D)),this._pub=new n(k),this}function b(k,D){return D=D||"utf8",buffer$2.Buffer.isBuffer(k)||(k=new buffer$2.Buffer(k,D)),this._priv=new n(k),this}var m={};function v(k,D){var O=D.toString("hex"),H=[O,k.toString(16)].join("_");if(H in m)return m[H];var j=0;if(k.isEven()||!d.simpleSieve||!d.fermatTest(k)||!t.test(k))return j+=1,O==="02"||O==="05"?j+=8:j+=4,m[H]=j,j;t.test(k.shrn(1))||(j+=2);var W;switch(O){case"02":k.mod(i).cmp(o)&&(j+=8);break;case"05":W=k.mod(a),W.cmp(c)&&W.cmp(u)&&(j+=8);break;default:j+=4}return m[H]=j,j}function _(k,D,O){this.setGenerator(D),this.__prime=new n(k),this._prime=n.mont(this.__prime),this._primeLen=k.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,O?(this.setPublicKey=h,this.setPrivateKey=b):this._primeCode=8}Object.defineProperty(_.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=v(this.__prime,this.__gen)),this._primeCode}}),_.prototype.generateKeys=function(){return this._priv||(this._priv=new n(p(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},_.prototype.computeSecret=function(k){k=new n(k),k=k.toRed(this._prime);var D=k.redPow(this._priv).fromRed(),O=new buffer$2.Buffer(D.toArray()),H=this.getPrime();if(O.length<H.length){var j=new buffer$2.Buffer(H.length-O.length);j.fill(0),O=buffer$2.Buffer.concat([j,O])}return O},_.prototype.getPublicKey=function(D){return $(this._pub,D)},_.prototype.getPrivateKey=function(D){return $(this._priv,D)},_.prototype.getPrime=function(k){return $(this.__prime,k)},_.prototype.getGenerator=function(k){return $(this._gen,k)},_.prototype.setGenerator=function(k,D){return D=D||"utf8",buffer$2.Buffer.isBuffer(k)||(k=new buffer$2.Buffer(k,D)),this.__gen=k,this._gen=new n(k),this};function $(k,D){var O=new buffer$2.Buffer(k.toArray());return D?O.toString(D):O}return dh}var hasRequiredBrowser$4;function requireBrowser$4(){if(hasRequiredBrowser$4)return browser$4;hasRequiredBrowser$4=1;var n=requireGeneratePrime(),e=require$$1$1,t=requireDh();function i(c){var u=new buffer$2.Buffer(e[c].prime,"hex"),d=new buffer$2.Buffer(e[c].gen,"hex");return new t(u,d)}var o={binary:!0,hex:!0,base64:!0};function a(c,u,d,p){return buffer$2.Buffer.isBuffer(u)||o[u]===void 0?a(c,"binary",u,d):(u=u||"binary",p=p||"binary",d=d||new buffer$2.Buffer([2]),buffer$2.Buffer.isBuffer(d)||(d=new buffer$2.Buffer(d,p)),typeof c=="number"?new t(n(c,d),d,!0):(buffer$2.Buffer.isBuffer(c)||(c=new buffer$2.Buffer(c,u)),new t(c,d,!0)))}return browser$4.DiffieHellmanGroup=browser$4.createDiffieHellmanGroup=browser$4.getDiffieHellman=i,browser$4.createDiffieHellman=browser$4.DiffieHellman=a,browser$4}var sign$2={exports:{}},bn={exports:{}};bn.exports;var hasRequiredBn;function requireBn(){return hasRequiredBn||(hasRequiredBn=1,function(n){(function(e,t){function i(S,w){if(!S)throw new Error(w||"Assertion failed")}function o(S,w){S.super_=w;var E=function(){};E.prototype=w.prototype,S.prototype=new E,S.prototype.constructor=S}function a(S,w,E){if(a.isBN(S))return S;this.negative=0,this.words=null,this.length=0,this.red=null,S!==null&&((w==="le"||w==="be")&&(E=w,w=10),this._init(S||0,w||10,E||"be"))}typeof e=="object"?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;var c;try{typeof window<"u"&&typeof window.Buffer<"u"?c=window.Buffer:c=buffer$2.Buffer}catch{}a.isBN=function(w){return w instanceof a?!0:w!==null&&typeof w=="object"&&w.constructor.wordSize===a.wordSize&&Array.isArray(w.words)},a.max=function(w,E){return w.cmp(E)>0?w:E},a.min=function(w,E){return w.cmp(E)<0?w:E},a.prototype._init=function(w,E,I){if(typeof w=="number")return this._initNumber(w,E,I);if(typeof w=="object")return this._initArray(w,E,I);E==="hex"&&(E=16),i(E===(E|0)&&E>=2&&E<=36),w=w.toString().replace(/\s+/g,"");var N=0;w[0]==="-"&&(N++,this.negative=1),N<w.length&&(E===16?this._parseHex(w,N,I):(this._parseBase(w,E,N),I==="le"&&this._initArray(this.toArray(),E,I)))},a.prototype._initNumber=function(w,E,I){w<0&&(this.negative=1,w=-w),w<67108864?(this.words=[w&67108863],this.length=1):w<4503599627370496?(this.words=[w&67108863,w/67108864&67108863],this.length=2):(i(w<9007199254740992),this.words=[w&67108863,w/67108864&67108863,1],this.length=3),I==="le"&&this._initArray(this.toArray(),E,I)},a.prototype._initArray=function(w,E,I){if(i(typeof w.length=="number"),w.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(w.length/3),this.words=new Array(this.length);for(var N=0;N<this.length;N++)this.words[N]=0;var U,L,P=0;if(I==="be")for(N=w.length-1,U=0;N>=0;N-=3)L=w[N]|w[N-1]<<8|w[N-2]<<16,this.words[U]|=L<<P&67108863,this.words[U+1]=L>>>26-P&67108863,P+=24,P>=26&&(P-=26,U++);else if(I==="le")for(N=0,U=0;N<w.length;N+=3)L=w[N]|w[N+1]<<8|w[N+2]<<16,this.words[U]|=L<<P&67108863,this.words[U+1]=L>>>26-P&67108863,P+=24,P>=26&&(P-=26,U++);return this._strip()};function u(S,w){var E=S.charCodeAt(w);if(E>=48&&E<=57)return E-48;if(E>=65&&E<=70)return E-55;if(E>=97&&E<=102)return E-87;i(!1,"Invalid character in "+S)}function d(S,w,E){var I=u(S,E);return E-1>=w&&(I|=u(S,E-1)<<4),I}a.prototype._parseHex=function(w,E,I){this.length=Math.ceil((w.length-E)/6),this.words=new Array(this.length);for(var N=0;N<this.length;N++)this.words[N]=0;var U=0,L=0,P;if(I==="be")for(N=w.length-1;N>=E;N-=2)P=d(w,E,N)<<U,this.words[L]|=P&67108863,U>=18?(U-=18,L+=1,this.words[L]|=P>>>26):U+=8;else{var B=w.length-E;for(N=B%2===0?E+1:E;N<w.length;N+=2)P=d(w,E,N)<<U,this.words[L]|=P&67108863,U>=18?(U-=18,L+=1,this.words[L]|=P>>>26):U+=8}this._strip()};function p(S,w,E,I){for(var N=0,U=0,L=Math.min(S.length,E),P=w;P<L;P++){var B=S.charCodeAt(P)-48;N*=I,B>=49?U=B-49+10:B>=17?U=B-17+10:U=B,i(B>=0&&U<I,"Invalid character"),N+=U}return N}a.prototype._parseBase=function(w,E,I){this.words=[0],this.length=1;for(var N=0,U=1;U<=67108863;U*=E)N++;N--,U=U/E|0;for(var L=w.length-I,P=L%N,B=Math.min(L,L-P)+I,A=0,z=I;z<B;z+=N)A=p(w,z,z+N,E),this.imuln(U),this.words[0]+A<67108864?this.words[0]+=A:this._iaddn(A);if(P!==0){var de=1;for(A=p(w,z,w.length,E),z=0;z<P;z++)de*=E;this.imuln(de),this.words[0]+A<67108864?this.words[0]+=A:this._iaddn(A)}this._strip()},a.prototype.copy=function(w){w.words=new Array(this.length);for(var E=0;E<this.length;E++)w.words[E]=this.words[E];w.length=this.length,w.negative=this.negative,w.red=this.red};function h(S,w){S.words=w.words,S.length=w.length,S.negative=w.negative,S.red=w.red}if(a.prototype._move=function(w){h(w,this)},a.prototype.clone=function(){var w=new a(null);return this.copy(w),w},a.prototype._expand=function(w){for(;this.length<w;)this.words[this.length++]=0;return this},a.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{a.prototype[Symbol.for("nodejs.util.inspect.custom")]=b}catch{a.prototype.inspect=b}else a.prototype.inspect=b;function b(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var m=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],_=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(w,E){w=w||10,E=E|0||1;var I;if(w===16||w==="hex"){I="";for(var N=0,U=0,L=0;L<this.length;L++){var P=this.words[L],B=((P<<N|U)&16777215).toString(16);U=P>>>24-N&16777215,N+=2,N>=26&&(N-=26,L--),U!==0||L!==this.length-1?I=m[6-B.length]+B+I:I=B+I}for(U!==0&&(I=U.toString(16)+I);I.length%E!==0;)I="0"+I;return this.negative!==0&&(I="-"+I),I}if(w===(w|0)&&w>=2&&w<=36){var A=v[w],z=_[w];I="";var de=this.clone();for(de.negative=0;!de.isZero();){var we=de.modrn(z).toString(w);de=de.idivn(z),de.isZero()?I=we+I:I=m[A-we.length]+we+I}for(this.isZero()&&(I="0"+I);I.length%E!==0;)I="0"+I;return this.negative!==0&&(I="-"+I),I}i(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var w=this.words[0];return this.length===2?w+=this.words[1]*67108864:this.length===3&&this.words[2]===1?w+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-w:w},a.prototype.toJSON=function(){return this.toString(16,2)},c&&(a.prototype.toBuffer=function(w,E){return this.toArrayLike(c,w,E)}),a.prototype.toArray=function(w,E){return this.toArrayLike(Array,w,E)};var $=function(w,E){return w.allocUnsafe?w.allocUnsafe(E):new w(E)};a.prototype.toArrayLike=function(w,E,I){this._strip();var N=this.byteLength(),U=I||Math.max(1,N);i(N<=U,"byte array longer than desired length"),i(U>0,"Requested array length <= 0");var L=$(w,U),P=E==="le"?"LE":"BE";return this["_toArrayLike"+P](L,N),L},a.prototype._toArrayLikeLE=function(w,E){for(var I=0,N=0,U=0,L=0;U<this.length;U++){var P=this.words[U]<<L|N;w[I++]=P&255,I<w.length&&(w[I++]=P>>8&255),I<w.length&&(w[I++]=P>>16&255),L===6?(I<w.length&&(w[I++]=P>>24&255),N=0,L=0):(N=P>>>24,L+=2)}if(I<w.length)for(w[I++]=N;I<w.length;)w[I++]=0},a.prototype._toArrayLikeBE=function(w,E){for(var I=w.length-1,N=0,U=0,L=0;U<this.length;U++){var P=this.words[U]<<L|N;w[I--]=P&255,I>=0&&(w[I--]=P>>8&255),I>=0&&(w[I--]=P>>16&255),L===6?(I>=0&&(w[I--]=P>>24&255),N=0,L=0):(N=P>>>24,L+=2)}if(I>=0)for(w[I--]=N;I>=0;)w[I--]=0},Math.clz32?a.prototype._countBits=function(w){return 32-Math.clz32(w)}:a.prototype._countBits=function(w){var E=w,I=0;return E>=4096&&(I+=13,E>>>=13),E>=64&&(I+=7,E>>>=7),E>=8&&(I+=4,E>>>=4),E>=2&&(I+=2,E>>>=2),I+E},a.prototype._zeroBits=function(w){if(w===0)return 26;var E=w,I=0;return E&8191||(I+=13,E>>>=13),E&127||(I+=7,E>>>=7),E&15||(I+=4,E>>>=4),E&3||(I+=2,E>>>=2),E&1||I++,I},a.prototype.bitLength=function(){var w=this.words[this.length-1],E=this._countBits(w);return(this.length-1)*26+E};function k(S){for(var w=new Array(S.bitLength()),E=0;E<w.length;E++){var I=E/26|0,N=E%26;w[E]=S.words[I]>>>N&1}return w}a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var w=0,E=0;E<this.length;E++){var I=this._zeroBits(this.words[E]);if(w+=I,I!==26)break}return w},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(w){return this.negative!==0?this.abs().inotn(w).iaddn(1):this.clone()},a.prototype.fromTwos=function(w){return this.testn(w-1)?this.notn(w).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(w){for(;this.length<w.length;)this.words[this.length++]=0;for(var E=0;E<w.length;E++)this.words[E]=this.words[E]|w.words[E];return this._strip()},a.prototype.ior=function(w){return i((this.negative|w.negative)===0),this.iuor(w)},a.prototype.or=function(w){return this.length>w.length?this.clone().ior(w):w.clone().ior(this)},a.prototype.uor=function(w){return this.length>w.length?this.clone().iuor(w):w.clone().iuor(this)},a.prototype.iuand=function(w){var E;this.length>w.length?E=w:E=this;for(var I=0;I<E.length;I++)this.words[I]=this.words[I]&w.words[I];return this.length=E.length,this._strip()},a.prototype.iand=function(w){return i((this.negative|w.negative)===0),this.iuand(w)},a.prototype.and=function(w){return this.length>w.length?this.clone().iand(w):w.clone().iand(this)},a.prototype.uand=function(w){return this.length>w.length?this.clone().iuand(w):w.clone().iuand(this)},a.prototype.iuxor=function(w){var E,I;this.length>w.length?(E=this,I=w):(E=w,I=this);for(var N=0;N<I.length;N++)this.words[N]=E.words[N]^I.words[N];if(this!==E)for(;N<E.length;N++)this.words[N]=E.words[N];return this.length=E.length,this._strip()},a.prototype.ixor=function(w){return i((this.negative|w.negative)===0),this.iuxor(w)},a.prototype.xor=function(w){return this.length>w.length?this.clone().ixor(w):w.clone().ixor(this)},a.prototype.uxor=function(w){return this.length>w.length?this.clone().iuxor(w):w.clone().iuxor(this)},a.prototype.inotn=function(w){i(typeof w=="number"&&w>=0);var E=Math.ceil(w/26)|0,I=w%26;this._expand(E),I>0&&E--;for(var N=0;N<E;N++)this.words[N]=~this.words[N]&67108863;return I>0&&(this.words[N]=~this.words[N]&67108863>>26-I),this._strip()},a.prototype.notn=function(w){return this.clone().inotn(w)},a.prototype.setn=function(w,E){i(typeof w=="number"&&w>=0);var I=w/26|0,N=w%26;return this._expand(I+1),E?this.words[I]=this.words[I]|1<<N:this.words[I]=this.words[I]&~(1<<N),this._strip()},a.prototype.iadd=function(w){var E;if(this.negative!==0&&w.negative===0)return this.negative=0,E=this.isub(w),this.negative^=1,this._normSign();if(this.negative===0&&w.negative!==0)return w.negative=0,E=this.isub(w),w.negative=1,E._normSign();var I,N;this.length>w.length?(I=this,N=w):(I=w,N=this);for(var U=0,L=0;L<N.length;L++)E=(I.words[L]|0)+(N.words[L]|0)+U,this.words[L]=E&67108863,U=E>>>26;for(;U!==0&&L<I.length;L++)E=(I.words[L]|0)+U,this.words[L]=E&67108863,U=E>>>26;if(this.length=I.length,U!==0)this.words[this.length]=U,this.length++;else if(I!==this)for(;L<I.length;L++)this.words[L]=I.words[L];return this},a.prototype.add=function(w){var E;return w.negative!==0&&this.negative===0?(w.negative=0,E=this.sub(w),w.negative^=1,E):w.negative===0&&this.negative!==0?(this.negative=0,E=w.sub(this),this.negative=1,E):this.length>w.length?this.clone().iadd(w):w.clone().iadd(this)},a.prototype.isub=function(w){if(w.negative!==0){w.negative=0;var E=this.iadd(w);return w.negative=1,E._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(w),this.negative=1,this._normSign();var I=this.cmp(w);if(I===0)return this.negative=0,this.length=1,this.words[0]=0,this;var N,U;I>0?(N=this,U=w):(N=w,U=this);for(var L=0,P=0;P<U.length;P++)E=(N.words[P]|0)-(U.words[P]|0)+L,L=E>>26,this.words[P]=E&67108863;for(;L!==0&&P<N.length;P++)E=(N.words[P]|0)+L,L=E>>26,this.words[P]=E&67108863;if(L===0&&P<N.length&&N!==this)for(;P<N.length;P++)this.words[P]=N.words[P];return this.length=Math.max(this.length,P),N!==this&&(this.negative=1),this._strip()},a.prototype.sub=function(w){return this.clone().isub(w)};function D(S,w,E){E.negative=w.negative^S.negative;var I=S.length+w.length|0;E.length=I,I=I-1|0;var N=S.words[0]|0,U=w.words[0]|0,L=N*U,P=L&67108863,B=L/67108864|0;E.words[0]=P;for(var A=1;A<I;A++){for(var z=B>>>26,de=B&67108863,we=Math.min(A,w.length-1),se=Math.max(0,A-S.length+1);se<=we;se++){var he=A-se|0;N=S.words[he]|0,U=w.words[se]|0,L=N*U+de,z+=L/67108864|0,de=L&67108863}E.words[A]=de|0,B=z|0}return B!==0?E.words[A]=B|0:E.length--,E._strip()}var O=function(w,E,I){var N=w.words,U=E.words,L=I.words,P=0,B,A,z,de=N[0]|0,we=de&8191,se=de>>>13,he=N[1]|0,$e=he&8191,Ae=he>>>13,ze=N[2]|0,oe=ze&8191,ie=ze>>>13,Ie=N[3]|0,qe=Ie&8191,Ze=Ie>>>13,lt=N[4]|0,ht=lt&8191,gt=lt>>>13,Me=N[5]|0,jt=Me&8191,ot=Me>>>13,Ot=N[6]|0,Ut=Ot&8191,be=Ot>>>13,Pe=N[7]|0,Be=Pe&8191,Re=Pe>>>13,Ye=N[8]|0,Tt=Ye&8191,Je=Ye>>>13,dt=N[9]|0,rt=dt&8191,et=dt>>>13,pt=U[0]|0,Kt=pt&8191,Ct=pt>>>13,er=U[1]|0,nr=er&8191,It=er>>>13,Qt=U[2]|0,fr=Qt&8191,qt=Qt>>>13,lr=U[3]|0,Xt=lr&8191,Dt=lr>>>13,ir=U[4]|0,ar=ir&8191,Lt=ir>>>13,dr=U[5]|0,yr=dr&8191,_t=dr>>>13,hr=U[6]|0,F=hr&8191,Y=hr>>>13,Q=U[7]|0,M=Q&8191,X=Q>>>13,ge=U[8]|0,_e=ge&8191,Ce=ge>>>13,je=U[9]|0,Xe=je&8191,Ve=je>>>13;I.negative=w.negative^E.negative,I.length=19,B=Math.imul(we,Kt),A=Math.imul(we,Ct),A=A+Math.imul(se,Kt)|0,z=Math.imul(se,Ct);var zt=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(zt>>>26)|0,zt&=67108863,B=Math.imul($e,Kt),A=Math.imul($e,Ct),A=A+Math.imul(Ae,Kt)|0,z=Math.imul(Ae,Ct),B=B+Math.imul(we,nr)|0,A=A+Math.imul(we,It)|0,A=A+Math.imul(se,nr)|0,z=z+Math.imul(se,It)|0;var at=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(at>>>26)|0,at&=67108863,B=Math.imul(oe,Kt),A=Math.imul(oe,Ct),A=A+Math.imul(ie,Kt)|0,z=Math.imul(ie,Ct),B=B+Math.imul($e,nr)|0,A=A+Math.imul($e,It)|0,A=A+Math.imul(Ae,nr)|0,z=z+Math.imul(Ae,It)|0,B=B+Math.imul(we,fr)|0,A=A+Math.imul(we,qt)|0,A=A+Math.imul(se,fr)|0,z=z+Math.imul(se,qt)|0;var xt=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(xt>>>26)|0,xt&=67108863,B=Math.imul(qe,Kt),A=Math.imul(qe,Ct),A=A+Math.imul(Ze,Kt)|0,z=Math.imul(Ze,Ct),B=B+Math.imul(oe,nr)|0,A=A+Math.imul(oe,It)|0,A=A+Math.imul(ie,nr)|0,z=z+Math.imul(ie,It)|0,B=B+Math.imul($e,fr)|0,A=A+Math.imul($e,qt)|0,A=A+Math.imul(Ae,fr)|0,z=z+Math.imul(Ae,qt)|0,B=B+Math.imul(we,Xt)|0,A=A+Math.imul(we,Dt)|0,A=A+Math.imul(se,Xt)|0,z=z+Math.imul(se,Dt)|0;var St=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(St>>>26)|0,St&=67108863,B=Math.imul(ht,Kt),A=Math.imul(ht,Ct),A=A+Math.imul(gt,Kt)|0,z=Math.imul(gt,Ct),B=B+Math.imul(qe,nr)|0,A=A+Math.imul(qe,It)|0,A=A+Math.imul(Ze,nr)|0,z=z+Math.imul(Ze,It)|0,B=B+Math.imul(oe,fr)|0,A=A+Math.imul(oe,qt)|0,A=A+Math.imul(ie,fr)|0,z=z+Math.imul(ie,qt)|0,B=B+Math.imul($e,Xt)|0,A=A+Math.imul($e,Dt)|0,A=A+Math.imul(Ae,Xt)|0,z=z+Math.imul(Ae,Dt)|0,B=B+Math.imul(we,ar)|0,A=A+Math.imul(we,Lt)|0,A=A+Math.imul(se,ar)|0,z=z+Math.imul(se,Lt)|0;var kt=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(kt>>>26)|0,kt&=67108863,B=Math.imul(jt,Kt),A=Math.imul(jt,Ct),A=A+Math.imul(ot,Kt)|0,z=Math.imul(ot,Ct),B=B+Math.imul(ht,nr)|0,A=A+Math.imul(ht,It)|0,A=A+Math.imul(gt,nr)|0,z=z+Math.imul(gt,It)|0,B=B+Math.imul(qe,fr)|0,A=A+Math.imul(qe,qt)|0,A=A+Math.imul(Ze,fr)|0,z=z+Math.imul(Ze,qt)|0,B=B+Math.imul(oe,Xt)|0,A=A+Math.imul(oe,Dt)|0,A=A+Math.imul(ie,Xt)|0,z=z+Math.imul(ie,Dt)|0,B=B+Math.imul($e,ar)|0,A=A+Math.imul($e,Lt)|0,A=A+Math.imul(Ae,ar)|0,z=z+Math.imul(Ae,Lt)|0,B=B+Math.imul(we,yr)|0,A=A+Math.imul(we,_t)|0,A=A+Math.imul(se,yr)|0,z=z+Math.imul(se,_t)|0;var At=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(At>>>26)|0,At&=67108863,B=Math.imul(Ut,Kt),A=Math.imul(Ut,Ct),A=A+Math.imul(be,Kt)|0,z=Math.imul(be,Ct),B=B+Math.imul(jt,nr)|0,A=A+Math.imul(jt,It)|0,A=A+Math.imul(ot,nr)|0,z=z+Math.imul(ot,It)|0,B=B+Math.imul(ht,fr)|0,A=A+Math.imul(ht,qt)|0,A=A+Math.imul(gt,fr)|0,z=z+Math.imul(gt,qt)|0,B=B+Math.imul(qe,Xt)|0,A=A+Math.imul(qe,Dt)|0,A=A+Math.imul(Ze,Xt)|0,z=z+Math.imul(Ze,Dt)|0,B=B+Math.imul(oe,ar)|0,A=A+Math.imul(oe,Lt)|0,A=A+Math.imul(ie,ar)|0,z=z+Math.imul(ie,Lt)|0,B=B+Math.imul($e,yr)|0,A=A+Math.imul($e,_t)|0,A=A+Math.imul(Ae,yr)|0,z=z+Math.imul(Ae,_t)|0,B=B+Math.imul(we,F)|0,A=A+Math.imul(we,Y)|0,A=A+Math.imul(se,F)|0,z=z+Math.imul(se,Y)|0;var $t=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+($t>>>26)|0,$t&=67108863,B=Math.imul(Be,Kt),A=Math.imul(Be,Ct),A=A+Math.imul(Re,Kt)|0,z=Math.imul(Re,Ct),B=B+Math.imul(Ut,nr)|0,A=A+Math.imul(Ut,It)|0,A=A+Math.imul(be,nr)|0,z=z+Math.imul(be,It)|0,B=B+Math.imul(jt,fr)|0,A=A+Math.imul(jt,qt)|0,A=A+Math.imul(ot,fr)|0,z=z+Math.imul(ot,qt)|0,B=B+Math.imul(ht,Xt)|0,A=A+Math.imul(ht,Dt)|0,A=A+Math.imul(gt,Xt)|0,z=z+Math.imul(gt,Dt)|0,B=B+Math.imul(qe,ar)|0,A=A+Math.imul(qe,Lt)|0,A=A+Math.imul(Ze,ar)|0,z=z+Math.imul(Ze,Lt)|0,B=B+Math.imul(oe,yr)|0,A=A+Math.imul(oe,_t)|0,A=A+Math.imul(ie,yr)|0,z=z+Math.imul(ie,_t)|0,B=B+Math.imul($e,F)|0,A=A+Math.imul($e,Y)|0,A=A+Math.imul(Ae,F)|0,z=z+Math.imul(Ae,Y)|0,B=B+Math.imul(we,M)|0,A=A+Math.imul(we,X)|0,A=A+Math.imul(se,M)|0,z=z+Math.imul(se,X)|0;var vt=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(vt>>>26)|0,vt&=67108863,B=Math.imul(Tt,Kt),A=Math.imul(Tt,Ct),A=A+Math.imul(Je,Kt)|0,z=Math.imul(Je,Ct),B=B+Math.imul(Be,nr)|0,A=A+Math.imul(Be,It)|0,A=A+Math.imul(Re,nr)|0,z=z+Math.imul(Re,It)|0,B=B+Math.imul(Ut,fr)|0,A=A+Math.imul(Ut,qt)|0,A=A+Math.imul(be,fr)|0,z=z+Math.imul(be,qt)|0,B=B+Math.imul(jt,Xt)|0,A=A+Math.imul(jt,Dt)|0,A=A+Math.imul(ot,Xt)|0,z=z+Math.imul(ot,Dt)|0,B=B+Math.imul(ht,ar)|0,A=A+Math.imul(ht,Lt)|0,A=A+Math.imul(gt,ar)|0,z=z+Math.imul(gt,Lt)|0,B=B+Math.imul(qe,yr)|0,A=A+Math.imul(qe,_t)|0,A=A+Math.imul(Ze,yr)|0,z=z+Math.imul(Ze,_t)|0,B=B+Math.imul(oe,F)|0,A=A+Math.imul(oe,Y)|0,A=A+Math.imul(ie,F)|0,z=z+Math.imul(ie,Y)|0,B=B+Math.imul($e,M)|0,A=A+Math.imul($e,X)|0,A=A+Math.imul(Ae,M)|0,z=z+Math.imul(Ae,X)|0,B=B+Math.imul(we,_e)|0,A=A+Math.imul(we,Ce)|0,A=A+Math.imul(se,_e)|0,z=z+Math.imul(se,Ce)|0;var Et=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(Et>>>26)|0,Et&=67108863,B=Math.imul(rt,Kt),A=Math.imul(rt,Ct),A=A+Math.imul(et,Kt)|0,z=Math.imul(et,Ct),B=B+Math.imul(Tt,nr)|0,A=A+Math.imul(Tt,It)|0,A=A+Math.imul(Je,nr)|0,z=z+Math.imul(Je,It)|0,B=B+Math.imul(Be,fr)|0,A=A+Math.imul(Be,qt)|0,A=A+Math.imul(Re,fr)|0,z=z+Math.imul(Re,qt)|0,B=B+Math.imul(Ut,Xt)|0,A=A+Math.imul(Ut,Dt)|0,A=A+Math.imul(be,Xt)|0,z=z+Math.imul(be,Dt)|0,B=B+Math.imul(jt,ar)|0,A=A+Math.imul(jt,Lt)|0,A=A+Math.imul(ot,ar)|0,z=z+Math.imul(ot,Lt)|0,B=B+Math.imul(ht,yr)|0,A=A+Math.imul(ht,_t)|0,A=A+Math.imul(gt,yr)|0,z=z+Math.imul(gt,_t)|0,B=B+Math.imul(qe,F)|0,A=A+Math.imul(qe,Y)|0,A=A+Math.imul(Ze,F)|0,z=z+Math.imul(Ze,Y)|0,B=B+Math.imul(oe,M)|0,A=A+Math.imul(oe,X)|0,A=A+Math.imul(ie,M)|0,z=z+Math.imul(ie,X)|0,B=B+Math.imul($e,_e)|0,A=A+Math.imul($e,Ce)|0,A=A+Math.imul(Ae,_e)|0,z=z+Math.imul(Ae,Ce)|0,B=B+Math.imul(we,Xe)|0,A=A+Math.imul(we,Ve)|0,A=A+Math.imul(se,Xe)|0,z=z+Math.imul(se,Ve)|0;var it=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(it>>>26)|0,it&=67108863,B=Math.imul(rt,nr),A=Math.imul(rt,It),A=A+Math.imul(et,nr)|0,z=Math.imul(et,It),B=B+Math.imul(Tt,fr)|0,A=A+Math.imul(Tt,qt)|0,A=A+Math.imul(Je,fr)|0,z=z+Math.imul(Je,qt)|0,B=B+Math.imul(Be,Xt)|0,A=A+Math.imul(Be,Dt)|0,A=A+Math.imul(Re,Xt)|0,z=z+Math.imul(Re,Dt)|0,B=B+Math.imul(Ut,ar)|0,A=A+Math.imul(Ut,Lt)|0,A=A+Math.imul(be,ar)|0,z=z+Math.imul(be,Lt)|0,B=B+Math.imul(jt,yr)|0,A=A+Math.imul(jt,_t)|0,A=A+Math.imul(ot,yr)|0,z=z+Math.imul(ot,_t)|0,B=B+Math.imul(ht,F)|0,A=A+Math.imul(ht,Y)|0,A=A+Math.imul(gt,F)|0,z=z+Math.imul(gt,Y)|0,B=B+Math.imul(qe,M)|0,A=A+Math.imul(qe,X)|0,A=A+Math.imul(Ze,M)|0,z=z+Math.imul(Ze,X)|0,B=B+Math.imul(oe,_e)|0,A=A+Math.imul(oe,Ce)|0,A=A+Math.imul(ie,_e)|0,z=z+Math.imul(ie,Ce)|0,B=B+Math.imul($e,Xe)|0,A=A+Math.imul($e,Ve)|0,A=A+Math.imul(Ae,Xe)|0,z=z+Math.imul(Ae,Ve)|0;var yt=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(yt>>>26)|0,yt&=67108863,B=Math.imul(rt,fr),A=Math.imul(rt,qt),A=A+Math.imul(et,fr)|0,z=Math.imul(et,qt),B=B+Math.imul(Tt,Xt)|0,A=A+Math.imul(Tt,Dt)|0,A=A+Math.imul(Je,Xt)|0,z=z+Math.imul(Je,Dt)|0,B=B+Math.imul(Be,ar)|0,A=A+Math.imul(Be,Lt)|0,A=A+Math.imul(Re,ar)|0,z=z+Math.imul(Re,Lt)|0,B=B+Math.imul(Ut,yr)|0,A=A+Math.imul(Ut,_t)|0,A=A+Math.imul(be,yr)|0,z=z+Math.imul(be,_t)|0,B=B+Math.imul(jt,F)|0,A=A+Math.imul(jt,Y)|0,A=A+Math.imul(ot,F)|0,z=z+Math.imul(ot,Y)|0,B=B+Math.imul(ht,M)|0,A=A+Math.imul(ht,X)|0,A=A+Math.imul(gt,M)|0,z=z+Math.imul(gt,X)|0,B=B+Math.imul(qe,_e)|0,A=A+Math.imul(qe,Ce)|0,A=A+Math.imul(Ze,_e)|0,z=z+Math.imul(Ze,Ce)|0,B=B+Math.imul(oe,Xe)|0,A=A+Math.imul(oe,Ve)|0,A=A+Math.imul(ie,Xe)|0,z=z+Math.imul(ie,Ve)|0;var tt=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(tt>>>26)|0,tt&=67108863,B=Math.imul(rt,Xt),A=Math.imul(rt,Dt),A=A+Math.imul(et,Xt)|0,z=Math.imul(et,Dt),B=B+Math.imul(Tt,ar)|0,A=A+Math.imul(Tt,Lt)|0,A=A+Math.imul(Je,ar)|0,z=z+Math.imul(Je,Lt)|0,B=B+Math.imul(Be,yr)|0,A=A+Math.imul(Be,_t)|0,A=A+Math.imul(Re,yr)|0,z=z+Math.imul(Re,_t)|0,B=B+Math.imul(Ut,F)|0,A=A+Math.imul(Ut,Y)|0,A=A+Math.imul(be,F)|0,z=z+Math.imul(be,Y)|0,B=B+Math.imul(jt,M)|0,A=A+Math.imul(jt,X)|0,A=A+Math.imul(ot,M)|0,z=z+Math.imul(ot,X)|0,B=B+Math.imul(ht,_e)|0,A=A+Math.imul(ht,Ce)|0,A=A+Math.imul(gt,_e)|0,z=z+Math.imul(gt,Ce)|0,B=B+Math.imul(qe,Xe)|0,A=A+Math.imul(qe,Ve)|0,A=A+Math.imul(Ze,Xe)|0,z=z+Math.imul(Ze,Ve)|0;var st=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(st>>>26)|0,st&=67108863,B=Math.imul(rt,ar),A=Math.imul(rt,Lt),A=A+Math.imul(et,ar)|0,z=Math.imul(et,Lt),B=B+Math.imul(Tt,yr)|0,A=A+Math.imul(Tt,_t)|0,A=A+Math.imul(Je,yr)|0,z=z+Math.imul(Je,_t)|0,B=B+Math.imul(Be,F)|0,A=A+Math.imul(Be,Y)|0,A=A+Math.imul(Re,F)|0,z=z+Math.imul(Re,Y)|0,B=B+Math.imul(Ut,M)|0,A=A+Math.imul(Ut,X)|0,A=A+Math.imul(be,M)|0,z=z+Math.imul(be,X)|0,B=B+Math.imul(jt,_e)|0,A=A+Math.imul(jt,Ce)|0,A=A+Math.imul(ot,_e)|0,z=z+Math.imul(ot,Ce)|0,B=B+Math.imul(ht,Xe)|0,A=A+Math.imul(ht,Ve)|0,A=A+Math.imul(gt,Xe)|0,z=z+Math.imul(gt,Ve)|0;var ft=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(ft>>>26)|0,ft&=67108863,B=Math.imul(rt,yr),A=Math.imul(rt,_t),A=A+Math.imul(et,yr)|0,z=Math.imul(et,_t),B=B+Math.imul(Tt,F)|0,A=A+Math.imul(Tt,Y)|0,A=A+Math.imul(Je,F)|0,z=z+Math.imul(Je,Y)|0,B=B+Math.imul(Be,M)|0,A=A+Math.imul(Be,X)|0,A=A+Math.imul(Re,M)|0,z=z+Math.imul(Re,X)|0,B=B+Math.imul(Ut,_e)|0,A=A+Math.imul(Ut,Ce)|0,A=A+Math.imul(be,_e)|0,z=z+Math.imul(be,Ce)|0,B=B+Math.imul(jt,Xe)|0,A=A+Math.imul(jt,Ve)|0,A=A+Math.imul(ot,Xe)|0,z=z+Math.imul(ot,Ve)|0;var nt=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(nt>>>26)|0,nt&=67108863,B=Math.imul(rt,F),A=Math.imul(rt,Y),A=A+Math.imul(et,F)|0,z=Math.imul(et,Y),B=B+Math.imul(Tt,M)|0,A=A+Math.imul(Tt,X)|0,A=A+Math.imul(Je,M)|0,z=z+Math.imul(Je,X)|0,B=B+Math.imul(Be,_e)|0,A=A+Math.imul(Be,Ce)|0,A=A+Math.imul(Re,_e)|0,z=z+Math.imul(Re,Ce)|0,B=B+Math.imul(Ut,Xe)|0,A=A+Math.imul(Ut,Ve)|0,A=A+Math.imul(be,Xe)|0,z=z+Math.imul(be,Ve)|0;var ke=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(ke>>>26)|0,ke&=67108863,B=Math.imul(rt,M),A=Math.imul(rt,X),A=A+Math.imul(et,M)|0,z=Math.imul(et,X),B=B+Math.imul(Tt,_e)|0,A=A+Math.imul(Tt,Ce)|0,A=A+Math.imul(Je,_e)|0,z=z+Math.imul(Je,Ce)|0,B=B+Math.imul(Be,Xe)|0,A=A+Math.imul(Be,Ve)|0,A=A+Math.imul(Re,Xe)|0,z=z+Math.imul(Re,Ve)|0;var De=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(De>>>26)|0,De&=67108863,B=Math.imul(rt,_e),A=Math.imul(rt,Ce),A=A+Math.imul(et,_e)|0,z=Math.imul(et,Ce),B=B+Math.imul(Tt,Xe)|0,A=A+Math.imul(Tt,Ve)|0,A=A+Math.imul(Je,Xe)|0,z=z+Math.imul(Je,Ve)|0;var He=(P+B|0)+((A&8191)<<13)|0;P=(z+(A>>>13)|0)+(He>>>26)|0,He&=67108863,B=Math.imul(rt,Xe),A=Math.imul(rt,Ve),A=A+Math.imul(et,Xe)|0,z=Math.imul(et,Ve);var q=(P+B|0)+((A&8191)<<13)|0;return P=(z+(A>>>13)|0)+(q>>>26)|0,q&=67108863,L[0]=zt,L[1]=at,L[2]=xt,L[3]=St,L[4]=kt,L[5]=At,L[6]=$t,L[7]=vt,L[8]=Et,L[9]=it,L[10]=yt,L[11]=tt,L[12]=st,L[13]=ft,L[14]=nt,L[15]=ke,L[16]=De,L[17]=He,L[18]=q,P!==0&&(L[19]=P,I.length++),I};Math.imul||(O=D);function H(S,w,E){E.negative=w.negative^S.negative,E.length=S.length+w.length;for(var I=0,N=0,U=0;U<E.length-1;U++){var L=N;N=0;for(var P=I&67108863,B=Math.min(U,w.length-1),A=Math.max(0,U-S.length+1);A<=B;A++){var z=U-A,de=S.words[z]|0,we=w.words[A]|0,se=de*we,he=se&67108863;L=L+(se/67108864|0)|0,he=he+P|0,P=he&67108863,L=L+(he>>>26)|0,N+=L>>>26,L&=67108863}E.words[U]=P,I=L,L=N}return I!==0?E.words[U]=I:E.length--,E._strip()}function j(S,w,E){return H(S,w,E)}a.prototype.mulTo=function(w,E){var I,N=this.length+w.length;return this.length===10&&w.length===10?I=O(this,w,E):N<63?I=D(this,w,E):N<1024?I=H(this,w,E):I=j(this,w,E),I},a.prototype.mul=function(w){var E=new a(null);return E.words=new Array(this.length+w.length),this.mulTo(w,E)},a.prototype.mulf=function(w){var E=new a(null);return E.words=new Array(this.length+w.length),j(this,w,E)},a.prototype.imul=function(w){return this.clone().mulTo(w,this)},a.prototype.imuln=function(w){var E=w<0;E&&(w=-w),i(typeof w=="number"),i(w<67108864);for(var I=0,N=0;N<this.length;N++){var U=(this.words[N]|0)*w,L=(U&67108863)+(I&67108863);I>>=26,I+=U/67108864|0,I+=L>>>26,this.words[N]=L&67108863}return I!==0&&(this.words[N]=I,this.length++),E?this.ineg():this},a.prototype.muln=function(w){return this.clone().imuln(w)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(w){var E=k(w);if(E.length===0)return new a(1);for(var I=this,N=0;N<E.length&&E[N]===0;N++,I=I.sqr());if(++N<E.length)for(var U=I.sqr();N<E.length;N++,U=U.sqr())E[N]!==0&&(I=I.mul(U));return I},a.prototype.iushln=function(w){i(typeof w=="number"&&w>=0);var E=w%26,I=(w-E)/26,N=67108863>>>26-E<<26-E,U;if(E!==0){var L=0;for(U=0;U<this.length;U++){var P=this.words[U]&N,B=(this.words[U]|0)-P<<E;this.words[U]=B|L,L=P>>>26-E}L&&(this.words[U]=L,this.length++)}if(I!==0){for(U=this.length-1;U>=0;U--)this.words[U+I]=this.words[U];for(U=0;U<I;U++)this.words[U]=0;this.length+=I}return this._strip()},a.prototype.ishln=function(w){return i(this.negative===0),this.iushln(w)},a.prototype.iushrn=function(w,E,I){i(typeof w=="number"&&w>=0);var N;E?N=(E-E%26)/26:N=0;var U=w%26,L=Math.min((w-U)/26,this.length),P=67108863^67108863>>>U<<U,B=I;if(N-=L,N=Math.max(0,N),B){for(var A=0;A<L;A++)B.words[A]=this.words[A];B.length=L}if(L!==0)if(this.length>L)for(this.length-=L,A=0;A<this.length;A++)this.words[A]=this.words[A+L];else this.words[0]=0,this.length=1;var z=0;for(A=this.length-1;A>=0&&(z!==0||A>=N);A--){var de=this.words[A]|0;this.words[A]=z<<26-U|de>>>U,z=de&P}return B&&z!==0&&(B.words[B.length++]=z),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},a.prototype.ishrn=function(w,E,I){return i(this.negative===0),this.iushrn(w,E,I)},a.prototype.shln=function(w){return this.clone().ishln(w)},a.prototype.ushln=function(w){return this.clone().iushln(w)},a.prototype.shrn=function(w){return this.clone().ishrn(w)},a.prototype.ushrn=function(w){return this.clone().iushrn(w)},a.prototype.testn=function(w){i(typeof w=="number"&&w>=0);var E=w%26,I=(w-E)/26,N=1<<E;if(this.length<=I)return!1;var U=this.words[I];return!!(U&N)},a.prototype.imaskn=function(w){i(typeof w=="number"&&w>=0);var E=w%26,I=(w-E)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=I)return this;if(E!==0&&I++,this.length=Math.min(I,this.length),E!==0){var N=67108863^67108863>>>E<<E;this.words[this.length-1]&=N}return this._strip()},a.prototype.maskn=function(w){return this.clone().imaskn(w)},a.prototype.iaddn=function(w){return i(typeof w=="number"),i(w<67108864),w<0?this.isubn(-w):this.negative!==0?this.length===1&&(this.words[0]|0)<=w?(this.words[0]=w-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(w),this.negative=1,this):this._iaddn(w)},a.prototype._iaddn=function(w){this.words[0]+=w;for(var E=0;E<this.length&&this.words[E]>=67108864;E++)this.words[E]-=67108864,E===this.length-1?this.words[E+1]=1:this.words[E+1]++;return this.length=Math.max(this.length,E+1),this},a.prototype.isubn=function(w){if(i(typeof w=="number"),i(w<67108864),w<0)return this.iaddn(-w);if(this.negative!==0)return this.negative=0,this.iaddn(w),this.negative=1,this;if(this.words[0]-=w,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var E=0;E<this.length&&this.words[E]<0;E++)this.words[E]+=67108864,this.words[E+1]-=1;return this._strip()},a.prototype.addn=function(w){return this.clone().iaddn(w)},a.prototype.subn=function(w){return this.clone().isubn(w)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(w,E,I){var N=w.length+I,U;this._expand(N);var L,P=0;for(U=0;U<w.length;U++){L=(this.words[U+I]|0)+P;var B=(w.words[U]|0)*E;L-=B&67108863,P=(L>>26)-(B/67108864|0),this.words[U+I]=L&67108863}for(;U<this.length-I;U++)L=(this.words[U+I]|0)+P,P=L>>26,this.words[U+I]=L&67108863;if(P===0)return this._strip();for(i(P===-1),P=0,U=0;U<this.length;U++)L=-(this.words[U]|0)+P,P=L>>26,this.words[U]=L&67108863;return this.negative=1,this._strip()},a.prototype._wordDiv=function(w,E){var I=this.length-w.length,N=this.clone(),U=w,L=U.words[U.length-1]|0,P=this._countBits(L);I=26-P,I!==0&&(U=U.ushln(I),N.iushln(I),L=U.words[U.length-1]|0);var B=N.length-U.length,A;if(E!=="mod"){A=new a(null),A.length=B+1,A.words=new Array(A.length);for(var z=0;z<A.length;z++)A.words[z]=0}var de=N.clone()._ishlnsubmul(U,1,B);de.negative===0&&(N=de,A&&(A.words[B]=1));for(var we=B-1;we>=0;we--){var se=(N.words[U.length+we]|0)*67108864+(N.words[U.length+we-1]|0);for(se=Math.min(se/L|0,67108863),N._ishlnsubmul(U,se,we);N.negative!==0;)se--,N.negative=0,N._ishlnsubmul(U,1,we),N.isZero()||(N.negative^=1);A&&(A.words[we]=se)}return A&&A._strip(),N._strip(),E!=="div"&&I!==0&&N.iushrn(I),{div:A||null,mod:N}},a.prototype.divmod=function(w,E,I){if(i(!w.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var N,U,L;return this.negative!==0&&w.negative===0?(L=this.neg().divmod(w,E),E!=="mod"&&(N=L.div.neg()),E!=="div"&&(U=L.mod.neg(),I&&U.negative!==0&&U.iadd(w)),{div:N,mod:U}):this.negative===0&&w.negative!==0?(L=this.divmod(w.neg(),E),E!=="mod"&&(N=L.div.neg()),{div:N,mod:L.mod}):this.negative&w.negative?(L=this.neg().divmod(w.neg(),E),E!=="div"&&(U=L.mod.neg(),I&&U.negative!==0&&U.isub(w)),{div:L.div,mod:U}):w.length>this.length||this.cmp(w)<0?{div:new a(0),mod:this}:w.length===1?E==="div"?{div:this.divn(w.words[0]),mod:null}:E==="mod"?{div:null,mod:new a(this.modrn(w.words[0]))}:{div:this.divn(w.words[0]),mod:new a(this.modrn(w.words[0]))}:this._wordDiv(w,E)},a.prototype.div=function(w){return this.divmod(w,"div",!1).div},a.prototype.mod=function(w){return this.divmod(w,"mod",!1).mod},a.prototype.umod=function(w){return this.divmod(w,"mod",!0).mod},a.prototype.divRound=function(w){var E=this.divmod(w);if(E.mod.isZero())return E.div;var I=E.div.negative!==0?E.mod.isub(w):E.mod,N=w.ushrn(1),U=w.andln(1),L=I.cmp(N);return L<0||U===1&&L===0?E.div:E.div.negative!==0?E.div.isubn(1):E.div.iaddn(1)},a.prototype.modrn=function(w){var E=w<0;E&&(w=-w),i(w<=67108863);for(var I=(1<<26)%w,N=0,U=this.length-1;U>=0;U--)N=(I*N+(this.words[U]|0))%w;return E?-N:N},a.prototype.modn=function(w){return this.modrn(w)},a.prototype.idivn=function(w){var E=w<0;E&&(w=-w),i(w<=67108863);for(var I=0,N=this.length-1;N>=0;N--){var U=(this.words[N]|0)+I*67108864;this.words[N]=U/w|0,I=U%w}return this._strip(),E?this.ineg():this},a.prototype.divn=function(w){return this.clone().idivn(w)},a.prototype.egcd=function(w){i(w.negative===0),i(!w.isZero());var E=this,I=w.clone();E.negative!==0?E=E.umod(w):E=E.clone();for(var N=new a(1),U=new a(0),L=new a(0),P=new a(1),B=0;E.isEven()&&I.isEven();)E.iushrn(1),I.iushrn(1),++B;for(var A=I.clone(),z=E.clone();!E.isZero();){for(var de=0,we=1;!(E.words[0]&we)&&de<26;++de,we<<=1);if(de>0)for(E.iushrn(de);de-- >0;)(N.isOdd()||U.isOdd())&&(N.iadd(A),U.isub(z)),N.iushrn(1),U.iushrn(1);for(var se=0,he=1;!(I.words[0]&he)&&se<26;++se,he<<=1);if(se>0)for(I.iushrn(se);se-- >0;)(L.isOdd()||P.isOdd())&&(L.iadd(A),P.isub(z)),L.iushrn(1),P.iushrn(1);E.cmp(I)>=0?(E.isub(I),N.isub(L),U.isub(P)):(I.isub(E),L.isub(N),P.isub(U))}return{a:L,b:P,gcd:I.iushln(B)}},a.prototype._invmp=function(w){i(w.negative===0),i(!w.isZero());var E=this,I=w.clone();E.negative!==0?E=E.umod(w):E=E.clone();for(var N=new a(1),U=new a(0),L=I.clone();E.cmpn(1)>0&&I.cmpn(1)>0;){for(var P=0,B=1;!(E.words[0]&B)&&P<26;++P,B<<=1);if(P>0)for(E.iushrn(P);P-- >0;)N.isOdd()&&N.iadd(L),N.iushrn(1);for(var A=0,z=1;!(I.words[0]&z)&&A<26;++A,z<<=1);if(A>0)for(I.iushrn(A);A-- >0;)U.isOdd()&&U.iadd(L),U.iushrn(1);E.cmp(I)>=0?(E.isub(I),N.isub(U)):(I.isub(E),U.isub(N))}var de;return E.cmpn(1)===0?de=N:de=U,de.cmpn(0)<0&&de.iadd(w),de},a.prototype.gcd=function(w){if(this.isZero())return w.abs();if(w.isZero())return this.abs();var E=this.clone(),I=w.clone();E.negative=0,I.negative=0;for(var N=0;E.isEven()&&I.isEven();N++)E.iushrn(1),I.iushrn(1);do{for(;E.isEven();)E.iushrn(1);for(;I.isEven();)I.iushrn(1);var U=E.cmp(I);if(U<0){var L=E;E=I,I=L}else if(U===0||I.cmpn(1)===0)break;E.isub(I)}while(!0);return I.iushln(N)},a.prototype.invm=function(w){return this.egcd(w).a.umod(w)},a.prototype.isEven=function(){return(this.words[0]&1)===0},a.prototype.isOdd=function(){return(this.words[0]&1)===1},a.prototype.andln=function(w){return this.words[0]&w},a.prototype.bincn=function(w){i(typeof w=="number");var E=w%26,I=(w-E)/26,N=1<<E;if(this.length<=I)return this._expand(I+1),this.words[I]|=N,this;for(var U=N,L=I;U!==0&&L<this.length;L++){var P=this.words[L]|0;P+=U,U=P>>>26,P&=67108863,this.words[L]=P}return U!==0&&(this.words[L]=U,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(w){var E=w<0;if(this.negative!==0&&!E)return-1;if(this.negative===0&&E)return 1;this._strip();var I;if(this.length>1)I=1;else{E&&(w=-w),i(w<=67108863,"Number is too big");var N=this.words[0]|0;I=N===w?0:N<w?-1:1}return this.negative!==0?-I|0:I},a.prototype.cmp=function(w){if(this.negative!==0&&w.negative===0)return-1;if(this.negative===0&&w.negative!==0)return 1;var E=this.ucmp(w);return this.negative!==0?-E|0:E},a.prototype.ucmp=function(w){if(this.length>w.length)return 1;if(this.length<w.length)return-1;for(var E=0,I=this.length-1;I>=0;I--){var N=this.words[I]|0,U=w.words[I]|0;if(N!==U){N<U?E=-1:N>U&&(E=1);break}}return E},a.prototype.gtn=function(w){return this.cmpn(w)===1},a.prototype.gt=function(w){return this.cmp(w)===1},a.prototype.gten=function(w){return this.cmpn(w)>=0},a.prototype.gte=function(w){return this.cmp(w)>=0},a.prototype.ltn=function(w){return this.cmpn(w)===-1},a.prototype.lt=function(w){return this.cmp(w)===-1},a.prototype.lten=function(w){return this.cmpn(w)<=0},a.prototype.lte=function(w){return this.cmp(w)<=0},a.prototype.eqn=function(w){return this.cmpn(w)===0},a.prototype.eq=function(w){return this.cmp(w)===0},a.red=function(w){return new re(w)},a.prototype.toRed=function(w){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),w.convertTo(this)._forceRed(w)},a.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(w){return this.red=w,this},a.prototype.forceRed=function(w){return i(!this.red,"Already a number in reduction context"),this._forceRed(w)},a.prototype.redAdd=function(w){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,w)},a.prototype.redIAdd=function(w){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,w)},a.prototype.redSub=function(w){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,w)},a.prototype.redISub=function(w){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,w)},a.prototype.redShl=function(w){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,w)},a.prototype.redMul=function(w){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,w),this.red.mul(this,w)},a.prototype.redIMul=function(w){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,w),this.red.imul(this,w)},a.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(w){return i(this.red&&!w.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,w)};var W={k256:null,p224:null,p192:null,p25519:null};function ae(S,w){this.name=S,this.p=new a(w,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}ae.prototype._tmp=function(){var w=new a(null);return w.words=new Array(Math.ceil(this.n/13)),w},ae.prototype.ireduce=function(w){var E=w,I;do this.split(E,this.tmp),E=this.imulK(E),E=E.iadd(this.tmp),I=E.bitLength();while(I>this.n);var N=I<this.n?-1:E.ucmp(this.p);return N===0?(E.words[0]=0,E.length=1):N>0?E.isub(this.p):E.strip!==void 0?E.strip():E._strip(),E},ae.prototype.split=function(w,E){w.iushrn(this.n,0,E)},ae.prototype.imulK=function(w){return w.imul(this.k)};function fe(){ae.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}o(fe,ae),fe.prototype.split=function(w,E){for(var I=4194303,N=Math.min(w.length,9),U=0;U<N;U++)E.words[U]=w.words[U];if(E.length=N,w.length<=9){w.words[0]=0,w.length=1;return}var L=w.words[9];for(E.words[E.length++]=L&I,U=10;U<w.length;U++){var P=w.words[U]|0;w.words[U-10]=(P&I)<<4|L>>>22,L=P}L>>>=22,w.words[U-10]=L,L===0&&w.length>10?w.length-=10:w.length-=9},fe.prototype.imulK=function(w){w.words[w.length]=0,w.words[w.length+1]=0,w.length+=2;for(var E=0,I=0;I<w.length;I++){var N=w.words[I]|0;E+=N*977,w.words[I]=E&67108863,E=N*64+(E/67108864|0)}return w.words[w.length-1]===0&&(w.length--,w.words[w.length-1]===0&&w.length--),w};function pe(){ae.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}o(pe,ae);function ve(){ae.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}o(ve,ae);function Qe(){ae.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}o(Qe,ae),Qe.prototype.imulK=function(w){for(var E=0,I=0;I<w.length;I++){var N=(w.words[I]|0)*19+E,U=N&67108863;N>>>=26,w.words[I]=U,E=N}return E!==0&&(w.words[w.length++]=E),w},a._prime=function(w){if(W[w])return W[w];var E;if(w==="k256")E=new fe;else if(w==="p224")E=new pe;else if(w==="p192")E=new ve;else if(w==="p25519")E=new Qe;else throw new Error("Unknown prime "+w);return W[w]=E,E};function re(S){if(typeof S=="string"){var w=a._prime(S);this.m=w.p,this.prime=w}else i(S.gtn(1),"modulus must be greater than 1"),this.m=S,this.prime=null}re.prototype._verify1=function(w){i(w.negative===0,"red works only with positives"),i(w.red,"red works only with red numbers")},re.prototype._verify2=function(w,E){i((w.negative|E.negative)===0,"red works only with positives"),i(w.red&&w.red===E.red,"red works only with red numbers")},re.prototype.imod=function(w){return this.prime?this.prime.ireduce(w)._forceRed(this):(h(w,w.umod(this.m)._forceRed(this)),w)},re.prototype.neg=function(w){return w.isZero()?w.clone():this.m.sub(w)._forceRed(this)},re.prototype.add=function(w,E){this._verify2(w,E);var I=w.add(E);return I.cmp(this.m)>=0&&I.isub(this.m),I._forceRed(this)},re.prototype.iadd=function(w,E){this._verify2(w,E);var I=w.iadd(E);return I.cmp(this.m)>=0&&I.isub(this.m),I},re.prototype.sub=function(w,E){this._verify2(w,E);var I=w.sub(E);return I.cmpn(0)<0&&I.iadd(this.m),I._forceRed(this)},re.prototype.isub=function(w,E){this._verify2(w,E);var I=w.isub(E);return I.cmpn(0)<0&&I.iadd(this.m),I},re.prototype.shl=function(w,E){return this._verify1(w),this.imod(w.ushln(E))},re.prototype.imul=function(w,E){return this._verify2(w,E),this.imod(w.imul(E))},re.prototype.mul=function(w,E){return this._verify2(w,E),this.imod(w.mul(E))},re.prototype.isqr=function(w){return this.imul(w,w.clone())},re.prototype.sqr=function(w){return this.mul(w,w)},re.prototype.sqrt=function(w){if(w.isZero())return w.clone();var E=this.m.andln(3);if(i(E%2===1),E===3){var I=this.m.add(new a(1)).iushrn(2);return this.pow(w,I)}for(var N=this.m.subn(1),U=0;!N.isZero()&&N.andln(1)===0;)U++,N.iushrn(1);i(!N.isZero());var L=new a(1).toRed(this),P=L.redNeg(),B=this.m.subn(1).iushrn(1),A=this.m.bitLength();for(A=new a(2*A*A).toRed(this);this.pow(A,B).cmp(P)!==0;)A.redIAdd(P);for(var z=this.pow(A,N),de=this.pow(w,N.addn(1).iushrn(1)),we=this.pow(w,N),se=U;we.cmp(L)!==0;){for(var he=we,$e=0;he.cmp(L)!==0;$e++)he=he.redSqr();i($e<se);var Ae=this.pow(z,new a(1).iushln(se-$e-1));de=de.redMul(Ae),z=Ae.redSqr(),we=we.redMul(z),se=$e}return de},re.prototype.invm=function(w){var E=w._invmp(this.m);return E.negative!==0?(E.negative=0,this.imod(E).redNeg()):this.imod(E)},re.prototype.pow=function(w,E){if(E.isZero())return new a(1).toRed(this);if(E.cmpn(1)===0)return w.clone();var I=4,N=new Array(1<<I);N[0]=new a(1).toRed(this),N[1]=w;for(var U=2;U<N.length;U++)N[U]=this.mul(N[U-1],w);var L=N[0],P=0,B=0,A=E.bitLength()%26;for(A===0&&(A=26),U=E.length-1;U>=0;U--){for(var z=E.words[U],de=A-1;de>=0;de--){var we=z>>de&1;if(L!==N[0]&&(L=this.sqr(L)),we===0&&P===0){B=0;continue}P<<=1,P|=we,B++,!(B!==I&&(U!==0||de!==0))&&(L=this.mul(L,N[P]),B=0,P=0)}A=26}return L},re.prototype.convertTo=function(w){var E=w.umod(this.m);return E===w?E.clone():E},re.prototype.convertFrom=function(w){var E=w.clone();return E.red=null,E},a.mont=function(w){return new C(w)};function C(S){re.call(this,S),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}o(C,re),C.prototype.convertTo=function(w){return this.imod(w.ushln(this.shift))},C.prototype.convertFrom=function(w){var E=this.imod(w.mul(this.rinv));return E.red=null,E},C.prototype.imul=function(w,E){if(w.isZero()||E.isZero())return w.words[0]=0,w.length=1,w;var I=w.imul(E),N=I.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),U=I.isub(N).iushrn(this.shift),L=U;return U.cmp(this.m)>=0?L=U.isub(this.m):U.cmpn(0)<0&&(L=U.iadd(this.m)),L._forceRed(this)},C.prototype.mul=function(w,E){if(w.isZero()||E.isZero())return new a(0)._forceRed(this);var I=w.mul(E),N=I.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),U=I.isub(N).iushrn(this.shift),L=U;return U.cmp(this.m)>=0?L=U.isub(this.m):U.cmpn(0)<0&&(L=U.iadd(this.m)),L._forceRed(this)},C.prototype.invm=function(w){var E=this.imod(w._invmp(this.m).mul(this.r2));return E._forceRed(this)}})(n,commonjsGlobal)}(bn)),bn.exports}var browserifyRsa,hasRequiredBrowserifyRsa;function requireBrowserifyRsa(){if(hasRequiredBrowserifyRsa)return browserifyRsa;hasRequiredBrowserifyRsa=1;var n=requireBn(),e=requireBrowser$b();function t(a){var c=i(a),u=c.toRed(n.mont(a.modulus)).redPow(new n(a.publicExponent)).fromRed();return{blinder:u,unblinder:c.invm(a.modulus)}}function i(a){var c=a.modulus.byteLength(),u;do u=new n(e(c));while(u.cmp(a.modulus)>=0||!u.umod(a.prime1)||!u.umod(a.prime2));return u}function o(a,c){var u=t(c),d=c.modulus.byteLength(),p=new n(a).mul(u.blinder).umod(c.modulus),h=p.toRed(n.mont(c.prime1)),b=p.toRed(n.mont(c.prime2)),m=c.coefficient,v=c.prime1,_=c.prime2,$=h.redPow(c.exponent1).fromRed(),k=b.redPow(c.exponent2).fromRed(),D=$.isub(k).imul(m).umod(v).imul(_);return k.iadd(D).imul(u.unblinder).umod(c.modulus).toArrayLike(buffer$2.Buffer,"be",d)}return o.getr=i,browserifyRsa=o,browserifyRsa}var elliptic={};const name$4="elliptic",version$1="6.5.4",description="EC cryptography",main="lib/elliptic.js",files=["lib"],scripts={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository={type:"git",url:"git@github.com:indutny/elliptic"},keywords=["EC","Elliptic","curve","Cryptography"],author="Fedor Indutny <fedor@indutny.com>",license="MIT",bugs={url:"https://github.com/indutny/elliptic/issues"},homepage="https://github.com/indutny/elliptic",devDependencies={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},require$$0={name:name$4,version:version$1,description,main,files,scripts,repository,keywords,author,license,bugs,homepage,devDependencies,dependencies};var utils$p={},utils$o={};(function(n){var e=n;function t(a,c){if(Array.isArray(a))return a.slice();if(!a)return[];var u=[];if(typeof a!="string"){for(var d=0;d<a.length;d++)u[d]=a[d]|0;return u}if(c==="hex"){a=a.replace(/[^a-z0-9]+/ig,""),a.length%2!==0&&(a="0"+a);for(var d=0;d<a.length;d+=2)u.push(parseInt(a[d]+a[d+1],16))}else for(var d=0;d<a.length;d++){var p=a.charCodeAt(d),h=p>>8,b=p&255;h?u.push(h,b):u.push(b)}return u}e.toArray=t;function i(a){return a.length===1?"0"+a:a}e.zero2=i;function o(a){for(var c="",u=0;u<a.length;u++)c+=i(a[u].toString(16));return c}e.toHex=o,e.encode=function(c,u){return u==="hex"?o(c):c}})(utils$o);(function(n){var e=n,t=bnExports,i=minimalisticAssert,o=utils$o;e.assert=i,e.toArray=o.toArray,e.zero2=o.zero2,e.toHex=o.toHex,e.encode=o.encode;function a(h,b,m){var v=new Array(Math.max(h.bitLength(),m)+1);v.fill(0);for(var _=1<<b+1,$=h.clone(),k=0;k<v.length;k++){var D,O=$.andln(_-1);$.isOdd()?(O>(_>>1)-1?D=(_>>1)-O:D=O,$.isubn(D)):D=0,v[k]=D,$.iushrn(1)}return v}e.getNAF=a;function c(h,b){var m=[[],[]];h=h.clone(),b=b.clone();for(var v=0,_=0,$;h.cmpn(-v)>0||b.cmpn(-_)>0;){var k=h.andln(3)+v&3,D=b.andln(3)+_&3;k===3&&(k=-1),D===3&&(D=-1);var O;k&1?($=h.andln(7)+v&7,($===3||$===5)&&D===2?O=-k:O=k):O=0,m[0].push(O);var H;D&1?($=b.andln(7)+_&7,($===3||$===5)&&k===2?H=-D:H=D):H=0,m[1].push(H),2*v===O+1&&(v=1-v),2*_===H+1&&(_=1-_),h.iushrn(1),b.iushrn(1)}return m}e.getJSF=c;function u(h,b,m){var v="_"+b;h.prototype[b]=function(){return this[v]!==void 0?this[v]:this[v]=m.call(this)}}e.cachedProperty=u;function d(h){return typeof h=="string"?e.toArray(h,"hex"):h}e.parseBytes=d;function p(h){return new t(h,"hex","le")}e.intFromLE=p})(utils$p);var curve={},BN$6=bnExports,utils$n=utils$p,getNAF=utils$n.getNAF,getJSF=utils$n.getJSF,assert$d=utils$n.assert;function BaseCurve(n,e){this.type=n,this.p=new BN$6(e.p,16),this.red=e.prime?BN$6.red(e.prime):BN$6.mont(this.p),this.zero=new BN$6(0).toRed(this.red),this.one=new BN$6(1).toRed(this.red),this.two=new BN$6(2).toRed(this.red),this.n=e.n&&new BN$6(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var base$3=BaseCurve;BaseCurve.prototype.point=function n(){throw new Error("Not implemented")};BaseCurve.prototype.validate=function n(){throw new Error("Not implemented")};BaseCurve.prototype._fixedNafMul=function n(e,t){assert$d(e.precomputed);var i=e._getDoubles(),o=getNAF(t,1,this._bitLength),a=(1<<i.step+1)-(i.step%2===0?2:1);a/=3;var c=[],u,d;for(u=0;u<o.length;u+=i.step){d=0;for(var p=u+i.step-1;p>=u;p--)d=(d<<1)+o[p];c.push(d)}for(var h=this.jpoint(null,null,null),b=this.jpoint(null,null,null),m=a;m>0;m--){for(u=0;u<c.length;u++)d=c[u],d===m?b=b.mixedAdd(i.points[u]):d===-m&&(b=b.mixedAdd(i.points[u].neg()));h=h.add(b)}return h.toP()};BaseCurve.prototype._wnafMul=function n(e,t){var i=4,o=e._getNAFPoints(i);i=o.wnd;for(var a=o.points,c=getNAF(t,i,this._bitLength),u=this.jpoint(null,null,null),d=c.length-1;d>=0;d--){for(var p=0;d>=0&&c[d]===0;d--)p++;if(d>=0&&p++,u=u.dblp(p),d<0)break;var h=c[d];assert$d(h!==0),e.type==="affine"?h>0?u=u.mixedAdd(a[h-1>>1]):u=u.mixedAdd(a[-h-1>>1].neg()):h>0?u=u.add(a[h-1>>1]):u=u.add(a[-h-1>>1].neg())}return e.type==="affine"?u.toP():u};BaseCurve.prototype._wnafMulAdd=function n(e,t,i,o,a){var c=this._wnafT1,u=this._wnafT2,d=this._wnafT3,p=0,h,b,m;for(h=0;h<o;h++){m=t[h];var v=m._getNAFPoints(e);c[h]=v.wnd,u[h]=v.points}for(h=o-1;h>=1;h-=2){var _=h-1,$=h;if(c[_]!==1||c[$]!==1){d[_]=getNAF(i[_],c[_],this._bitLength),d[$]=getNAF(i[$],c[$],this._bitLength),p=Math.max(d[_].length,p),p=Math.max(d[$].length,p);continue}var k=[t[_],null,null,t[$]];t[_].y.cmp(t[$].y)===0?(k[1]=t[_].add(t[$]),k[2]=t[_].toJ().mixedAdd(t[$].neg())):t[_].y.cmp(t[$].y.redNeg())===0?(k[1]=t[_].toJ().mixedAdd(t[$]),k[2]=t[_].add(t[$].neg())):(k[1]=t[_].toJ().mixedAdd(t[$]),k[2]=t[_].toJ().mixedAdd(t[$].neg()));var D=[-3,-1,-5,-7,0,7,5,1,3],O=getJSF(i[_],i[$]);for(p=Math.max(O[0].length,p),d[_]=new Array(p),d[$]=new Array(p),b=0;b<p;b++){var H=O[0][b]|0,j=O[1][b]|0;d[_][b]=D[(H+1)*3+(j+1)],d[$][b]=0,u[_]=k}}var W=this.jpoint(null,null,null),ae=this._wnafT4;for(h=p;h>=0;h--){for(var fe=0;h>=0;){var pe=!0;for(b=0;b<o;b++)ae[b]=d[b][h]|0,ae[b]!==0&&(pe=!1);if(!pe)break;fe++,h--}if(h>=0&&fe++,W=W.dblp(fe),h<0)break;for(b=0;b<o;b++){var ve=ae[b];ve!==0&&(ve>0?m=u[b][ve-1>>1]:ve<0&&(m=u[b][-ve-1>>1].neg()),m.type==="affine"?W=W.mixedAdd(m):W=W.add(m))}}for(h=0;h<o;h++)u[h]=null;return a?W:W.toP()};function BasePoint(n,e){this.curve=n,this.type=e,this.precomputed=null}BaseCurve.BasePoint=BasePoint;BasePoint.prototype.eq=function n(){throw new Error("Not implemented")};BasePoint.prototype.validate=function n(){return this.curve.validate(this)};BaseCurve.prototype.decodePoint=function n(e,t){e=utils$n.toArray(e,t);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*i){e[0]===6?assert$d(e[e.length-1]%2===0):e[0]===7&&assert$d(e[e.length-1]%2===1);var o=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return o}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};BasePoint.prototype.encodeCompressed=function n(e){return this.encode(e,!0)};BasePoint.prototype._encode=function n(e){var t=this.curve.p.byteLength(),i=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",t))};BasePoint.prototype.encode=function n(e,t){return utils$n.encode(this._encode(t),e)};BasePoint.prototype.precompute=function n(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};BasePoint.prototype._hasDoubles=function n(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};BasePoint.prototype._getDoubles=function n(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],o=this,a=0;a<t;a+=e){for(var c=0;c<e;c++)o=o.dbl();i.push(o)}return{step:e,points:i}};BasePoint.prototype._getNAFPoints=function n(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],i=(1<<e)-1,o=i===1?null:this.dbl(),a=1;a<i;a++)t[a]=t[a-1].add(o);return{wnd:e,points:t}};BasePoint.prototype._getBeta=function n(){return null};BasePoint.prototype.dblp=function n(e){for(var t=this,i=0;i<e;i++)t=t.dbl();return t};var utils$m=utils$p,BN$5=bnExports,inherits$3=inherits_browserExports,Base$2=base$3,assert$c=utils$m.assert;function ShortCurve(n){Base$2.call(this,"short",n),this.a=new BN$5(n.a,16).toRed(this.red),this.b=new BN$5(n.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(n),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}inherits$3(ShortCurve,Base$2);var short=ShortCurve;ShortCurve.prototype._getEndomorphism=function n(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,i;if(e.beta)t=new BN$5(e.beta,16).toRed(this.red);else{var o=this._getEndoRoots(this.p);t=o[0].cmp(o[1])<0?o[0]:o[1],t=t.toRed(this.red)}if(e.lambda)i=new BN$5(e.lambda,16);else{var a=this._getEndoRoots(this.n);this.g.mul(a[0]).x.cmp(this.g.x.redMul(t))===0?i=a[0]:(i=a[1],assert$c(this.g.mul(i).x.cmp(this.g.x.redMul(t))===0))}var c;return e.basis?c=e.basis.map(function(u){return{a:new BN$5(u.a,16),b:new BN$5(u.b,16)}}):c=this._getEndoBasis(i),{beta:t,lambda:i,basis:c}}};ShortCurve.prototype._getEndoRoots=function n(e){var t=e===this.p?this.red:BN$5.mont(e),i=new BN$5(2).toRed(t).redInvm(),o=i.redNeg(),a=new BN$5(3).toRed(t).redNeg().redSqrt().redMul(i),c=o.redAdd(a).fromRed(),u=o.redSub(a).fromRed();return[c,u]};ShortCurve.prototype._getEndoBasis=function n(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,o=this.n.clone(),a=new BN$5(1),c=new BN$5(0),u=new BN$5(0),d=new BN$5(1),p,h,b,m,v,_,$,k=0,D,O;i.cmpn(0)!==0;){var H=o.div(i);D=o.sub(H.mul(i)),O=u.sub(H.mul(a));var j=d.sub(H.mul(c));if(!b&&D.cmp(t)<0)p=$.neg(),h=a,b=D.neg(),m=O;else if(b&&++k===2)break;$=D,o=i,i=D,u=a,a=O,d=c,c=j}v=D.neg(),_=O;var W=b.sqr().add(m.sqr()),ae=v.sqr().add(_.sqr());return ae.cmp(W)>=0&&(v=p,_=h),b.negative&&(b=b.neg(),m=m.neg()),v.negative&&(v=v.neg(),_=_.neg()),[{a:b,b:m},{a:v,b:_}]};ShortCurve.prototype._endoSplit=function n(e){var t=this.endo.basis,i=t[0],o=t[1],a=o.b.mul(e).divRound(this.n),c=i.b.neg().mul(e).divRound(this.n),u=a.mul(i.a),d=c.mul(o.a),p=a.mul(i.b),h=c.mul(o.b),b=e.sub(u).sub(d),m=p.add(h).neg();return{k1:b,k2:m}};ShortCurve.prototype.pointFromX=function n(e,t){e=new BN$5(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),o=i.redSqrt();if(o.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var a=o.fromRed().isOdd();return(t&&!a||!t&&a)&&(o=o.redNeg()),this.point(e,o)};ShortCurve.prototype.validate=function n(e){if(e.inf)return!0;var t=e.x,i=e.y,o=this.a.redMul(t),a=t.redSqr().redMul(t).redIAdd(o).redIAdd(this.b);return i.redSqr().redISub(a).cmpn(0)===0};ShortCurve.prototype._endoWnafMulAdd=function n(e,t,i){for(var o=this._endoWnafT1,a=this._endoWnafT2,c=0;c<e.length;c++){var u=this._endoSplit(t[c]),d=e[c],p=d._getBeta();u.k1.negative&&(u.k1.ineg(),d=d.neg(!0)),u.k2.negative&&(u.k2.ineg(),p=p.neg(!0)),o[c*2]=d,o[c*2+1]=p,a[c*2]=u.k1,a[c*2+1]=u.k2}for(var h=this._wnafMulAdd(1,o,a,c*2,i),b=0;b<c*2;b++)o[b]=null,a[b]=null;return h};function Point$2(n,e,t,i){Base$2.BasePoint.call(this,n,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new BN$5(e,16),this.y=new BN$5(t,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}inherits$3(Point$2,Base$2.BasePoint);ShortCurve.prototype.point=function n(e,t,i){return new Point$2(this,e,t,i)};ShortCurve.prototype.pointFromJSON=function n(e,t){return Point$2.fromJSON(this,e,t)};Point$2.prototype._getBeta=function n(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,o=function(a){return i.point(a.x.redMul(i.endo.beta),a.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(o)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(o)}}}return t}};Point$2.prototype.toJSON=function n(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Point$2.fromJSON=function n(e,t,i){typeof t=="string"&&(t=JSON.parse(t));var o=e.point(t[0],t[1],i);if(!t[2])return o;function a(u){return e.point(u[0],u[1],i)}var c=t[2];return o.precomputed={beta:null,doubles:c.doubles&&{step:c.doubles.step,points:[o].concat(c.doubles.points.map(a))},naf:c.naf&&{wnd:c.naf.wnd,points:[o].concat(c.naf.points.map(a))}},o};Point$2.prototype.inspect=function n(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Point$2.prototype.isInfinity=function n(){return this.inf};Point$2.prototype.add=function n(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var i=t.redSqr().redISub(this.x).redISub(e.x),o=t.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,o)};Point$2.prototype.dbl=function n(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,i=this.x.redSqr(),o=e.redInvm(),a=i.redAdd(i).redIAdd(i).redIAdd(t).redMul(o),c=a.redSqr().redISub(this.x.redAdd(this.x)),u=a.redMul(this.x.redSub(c)).redISub(this.y);return this.curve.point(c,u)};Point$2.prototype.getX=function n(){return this.x.fromRed()};Point$2.prototype.getY=function n(){return this.y.fromRed()};Point$2.prototype.mul=function n(e){return e=new BN$5(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Point$2.prototype.mulAdd=function n(e,t,i){var o=[this,t],a=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(o,a):this.curve._wnafMulAdd(1,o,a,2)};Point$2.prototype.jmulAdd=function n(e,t,i){var o=[this,t],a=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(o,a,!0):this.curve._wnafMulAdd(1,o,a,2,!0)};Point$2.prototype.eq=function n(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Point$2.prototype.neg=function n(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,o=function(a){return a.neg()};t.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(o)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(o)}}}return t};Point$2.prototype.toJ=function n(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function JPoint(n,e,t,i){Base$2.BasePoint.call(this,n,"jacobian"),e===null&&t===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new BN$5(0)):(this.x=new BN$5(e,16),this.y=new BN$5(t,16),this.z=new BN$5(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}inherits$3(JPoint,Base$2.BasePoint);ShortCurve.prototype.jpoint=function n(e,t,i){return new JPoint(this,e,t,i)};JPoint.prototype.toP=function n(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),i=this.x.redMul(t),o=this.y.redMul(t).redMul(e);return this.curve.point(i,o)};JPoint.prototype.neg=function n(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};JPoint.prototype.add=function n(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),i=this.z.redSqr(),o=this.x.redMul(t),a=e.x.redMul(i),c=this.y.redMul(t.redMul(e.z)),u=e.y.redMul(i.redMul(this.z)),d=o.redSub(a),p=c.redSub(u);if(d.cmpn(0)===0)return p.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var h=d.redSqr(),b=h.redMul(d),m=o.redMul(h),v=p.redSqr().redIAdd(b).redISub(m).redISub(m),_=p.redMul(m.redISub(v)).redISub(c.redMul(b)),$=this.z.redMul(e.z).redMul(d);return this.curve.jpoint(v,_,$)};JPoint.prototype.mixedAdd=function n(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),i=this.x,o=e.x.redMul(t),a=this.y,c=e.y.redMul(t).redMul(this.z),u=i.redSub(o),d=a.redSub(c);if(u.cmpn(0)===0)return d.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var p=u.redSqr(),h=p.redMul(u),b=i.redMul(p),m=d.redSqr().redIAdd(h).redISub(b).redISub(b),v=d.redMul(b.redISub(m)).redISub(a.redMul(h)),_=this.z.redMul(u);return this.curve.jpoint(m,v,_)};JPoint.prototype.dblp=function n(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var i=this;for(t=0;t<e;t++)i=i.dbl();return i}var o=this.curve.a,a=this.curve.tinv,c=this.x,u=this.y,d=this.z,p=d.redSqr().redSqr(),h=u.redAdd(u);for(t=0;t<e;t++){var b=c.redSqr(),m=h.redSqr(),v=m.redSqr(),_=b.redAdd(b).redIAdd(b).redIAdd(o.redMul(p)),$=c.redMul(m),k=_.redSqr().redISub($.redAdd($)),D=$.redISub(k),O=_.redMul(D);O=O.redIAdd(O).redISub(v);var H=h.redMul(d);t+1<e&&(p=p.redMul(v)),c=k,d=H,h=O}return this.curve.jpoint(c,h.redMul(a),d)};JPoint.prototype.dbl=function n(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};JPoint.prototype._zeroDbl=function n(){var e,t,i;if(this.zOne){var o=this.x.redSqr(),a=this.y.redSqr(),c=a.redSqr(),u=this.x.redAdd(a).redSqr().redISub(o).redISub(c);u=u.redIAdd(u);var d=o.redAdd(o).redIAdd(o),p=d.redSqr().redISub(u).redISub(u),h=c.redIAdd(c);h=h.redIAdd(h),h=h.redIAdd(h),e=p,t=d.redMul(u.redISub(p)).redISub(h),i=this.y.redAdd(this.y)}else{var b=this.x.redSqr(),m=this.y.redSqr(),v=m.redSqr(),_=this.x.redAdd(m).redSqr().redISub(b).redISub(v);_=_.redIAdd(_);var $=b.redAdd(b).redIAdd(b),k=$.redSqr(),D=v.redIAdd(v);D=D.redIAdd(D),D=D.redIAdd(D),e=k.redISub(_).redISub(_),t=$.redMul(_.redISub(e)).redISub(D),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,t,i)};JPoint.prototype._threeDbl=function n(){var e,t,i;if(this.zOne){var o=this.x.redSqr(),a=this.y.redSqr(),c=a.redSqr(),u=this.x.redAdd(a).redSqr().redISub(o).redISub(c);u=u.redIAdd(u);var d=o.redAdd(o).redIAdd(o).redIAdd(this.curve.a),p=d.redSqr().redISub(u).redISub(u);e=p;var h=c.redIAdd(c);h=h.redIAdd(h),h=h.redIAdd(h),t=d.redMul(u.redISub(p)).redISub(h),i=this.y.redAdd(this.y)}else{var b=this.z.redSqr(),m=this.y.redSqr(),v=this.x.redMul(m),_=this.x.redSub(b).redMul(this.x.redAdd(b));_=_.redAdd(_).redIAdd(_);var $=v.redIAdd(v);$=$.redIAdd($);var k=$.redAdd($);e=_.redSqr().redISub(k),i=this.y.redAdd(this.z).redSqr().redISub(m).redISub(b);var D=m.redSqr();D=D.redIAdd(D),D=D.redIAdd(D),D=D.redIAdd(D),t=_.redMul($.redISub(e)).redISub(D)}return this.curve.jpoint(e,t,i)};JPoint.prototype._dbl=function n(){var e=this.curve.a,t=this.x,i=this.y,o=this.z,a=o.redSqr().redSqr(),c=t.redSqr(),u=i.redSqr(),d=c.redAdd(c).redIAdd(c).redIAdd(e.redMul(a)),p=t.redAdd(t);p=p.redIAdd(p);var h=p.redMul(u),b=d.redSqr().redISub(h.redAdd(h)),m=h.redISub(b),v=u.redSqr();v=v.redIAdd(v),v=v.redIAdd(v),v=v.redIAdd(v);var _=d.redMul(m).redISub(v),$=i.redAdd(i).redMul(o);return this.curve.jpoint(b,_,$)};JPoint.prototype.trpl=function n(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr(),o=t.redSqr(),a=e.redAdd(e).redIAdd(e),c=a.redSqr(),u=this.x.redAdd(t).redSqr().redISub(e).redISub(o);u=u.redIAdd(u),u=u.redAdd(u).redIAdd(u),u=u.redISub(c);var d=u.redSqr(),p=o.redIAdd(o);p=p.redIAdd(p),p=p.redIAdd(p),p=p.redIAdd(p);var h=a.redIAdd(u).redSqr().redISub(c).redISub(d).redISub(p),b=t.redMul(h);b=b.redIAdd(b),b=b.redIAdd(b);var m=this.x.redMul(d).redISub(b);m=m.redIAdd(m),m=m.redIAdd(m);var v=this.y.redMul(h.redMul(p.redISub(h)).redISub(u.redMul(d)));v=v.redIAdd(v),v=v.redIAdd(v),v=v.redIAdd(v);var _=this.z.redAdd(u).redSqr().redISub(i).redISub(d);return this.curve.jpoint(m,v,_)};JPoint.prototype.mul=function n(e,t){return e=new BN$5(e,t),this.curve._wnafMul(this,e)};JPoint.prototype.eq=function n(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var o=t.redMul(this.z),a=i.redMul(e.z);return this.y.redMul(a).redISub(e.y.redMul(o)).cmpn(0)===0};JPoint.prototype.eqXToP=function n(e){var t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(i)===0)return!0;for(var o=e.clone(),a=this.curve.redN.redMul(t);;){if(o.iadd(this.curve.n),o.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(a),this.x.cmp(i)===0)return!0}};JPoint.prototype.inspect=function n(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};JPoint.prototype.isInfinity=function n(){return this.z.cmpn(0)===0};var BN$4=bnExports,inherits$2=inherits_browserExports,Base$1=base$3,utils$l=utils$p;function MontCurve(n){Base$1.call(this,"mont",n),this.a=new BN$4(n.a,16).toRed(this.red),this.b=new BN$4(n.b,16).toRed(this.red),this.i4=new BN$4(4).toRed(this.red).redInvm(),this.two=new BN$4(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}inherits$2(MontCurve,Base$1);var mont=MontCurve;MontCurve.prototype.validate=function n(e){var t=e.normalize().x,i=t.redSqr(),o=i.redMul(t).redAdd(i.redMul(this.a)).redAdd(t),a=o.redSqrt();return a.redSqr().cmp(o)===0};function Point$1(n,e,t){Base$1.BasePoint.call(this,n,"projective"),e===null&&t===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new BN$4(e,16),this.z=new BN$4(t,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}inherits$2(Point$1,Base$1.BasePoint);MontCurve.prototype.decodePoint=function n(e,t){return this.point(utils$l.toArray(e,t),1)};MontCurve.prototype.point=function n(e,t){return new Point$1(this,e,t)};MontCurve.prototype.pointFromJSON=function n(e){return Point$1.fromJSON(this,e)};Point$1.prototype.precompute=function n(){};Point$1.prototype._encode=function n(){return this.getX().toArray("be",this.curve.p.byteLength())};Point$1.fromJSON=function n(e,t){return new Point$1(e,t[0],t[1]||e.one)};Point$1.prototype.inspect=function n(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Point$1.prototype.isInfinity=function n(){return this.z.cmpn(0)===0};Point$1.prototype.dbl=function n(){var e=this.x.redAdd(this.z),t=e.redSqr(),i=this.x.redSub(this.z),o=i.redSqr(),a=t.redSub(o),c=t.redMul(o),u=a.redMul(o.redAdd(this.curve.a24.redMul(a)));return this.curve.point(c,u)};Point$1.prototype.add=function n(){throw new Error("Not supported on Montgomery curve")};Point$1.prototype.diffAdd=function n(e,t){var i=this.x.redAdd(this.z),o=this.x.redSub(this.z),a=e.x.redAdd(e.z),c=e.x.redSub(e.z),u=c.redMul(i),d=a.redMul(o),p=t.z.redMul(u.redAdd(d).redSqr()),h=t.x.redMul(u.redISub(d).redSqr());return this.curve.point(p,h)};Point$1.prototype.mul=function n(e){for(var t=e.clone(),i=this,o=this.curve.point(null,null),a=this,c=[];t.cmpn(0)!==0;t.iushrn(1))c.push(t.andln(1));for(var u=c.length-1;u>=0;u--)c[u]===0?(i=i.diffAdd(o,a),o=o.dbl()):(o=i.diffAdd(o,a),i=i.dbl());return o};Point$1.prototype.mulAdd=function n(){throw new Error("Not supported on Montgomery curve")};Point$1.prototype.jumlAdd=function n(){throw new Error("Not supported on Montgomery curve")};Point$1.prototype.eq=function n(e){return this.getX().cmp(e.getX())===0};Point$1.prototype.normalize=function n(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Point$1.prototype.getX=function n(){return this.normalize(),this.x.fromRed()};var utils$k=utils$p,BN$3=bnExports,inherits$1=inherits_browserExports,Base=base$3,assert$b=utils$k.assert;function EdwardsCurve(n){this.twisted=(n.a|0)!==1,this.mOneA=this.twisted&&(n.a|0)===-1,this.extended=this.mOneA,Base.call(this,"edwards",n),this.a=new BN$3(n.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new BN$3(n.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new BN$3(n.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),assert$b(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(n.c|0)===1}inherits$1(EdwardsCurve,Base);var edwards=EdwardsCurve;EdwardsCurve.prototype._mulA=function n(e){return this.mOneA?e.redNeg():this.a.redMul(e)};EdwardsCurve.prototype._mulC=function n(e){return this.oneC?e:this.c.redMul(e)};EdwardsCurve.prototype.jpoint=function n(e,t,i,o){return this.point(e,t,i,o)};EdwardsCurve.prototype.pointFromX=function n(e,t){e=new BN$3(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),o=this.c2.redSub(this.a.redMul(i)),a=this.one.redSub(this.c2.redMul(this.d).redMul(i)),c=o.redMul(a.redInvm()),u=c.redSqrt();if(u.redSqr().redSub(c).cmp(this.zero)!==0)throw new Error("invalid point");var d=u.fromRed().isOdd();return(t&&!d||!t&&d)&&(u=u.redNeg()),this.point(e,u)};EdwardsCurve.prototype.pointFromY=function n(e,t){e=new BN$3(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),o=i.redSub(this.c2),a=i.redMul(this.d).redMul(this.c2).redSub(this.a),c=o.redMul(a.redInvm());if(c.cmp(this.zero)===0){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var u=c.redSqrt();if(u.redSqr().redSub(c).cmp(this.zero)!==0)throw new Error("invalid point");return u.fromRed().isOdd()!==t&&(u=u.redNeg()),this.point(u,e)};EdwardsCurve.prototype.validate=function n(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),i=e.y.redSqr(),o=t.redMul(this.a).redAdd(i),a=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(i)));return o.cmp(a)===0};function Point(n,e,t,i,o){Base.BasePoint.call(this,n,"projective"),e===null&&t===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new BN$3(e,16),this.y=new BN$3(t,16),this.z=i?new BN$3(i,16):this.curve.one,this.t=o&&new BN$3(o,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}inherits$1(Point,Base.BasePoint);EdwardsCurve.prototype.pointFromJSON=function n(e){return Point.fromJSON(this,e)};EdwardsCurve.prototype.point=function n(e,t,i,o){return new Point(this,e,t,i,o)};Point.fromJSON=function n(e,t){return new Point(e,t[0],t[1],t[2])};Point.prototype.inspect=function n(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Point.prototype.isInfinity=function n(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};Point.prototype._extDbl=function n(){var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var o=this.curve._mulA(e),a=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),c=o.redAdd(t),u=c.redSub(i),d=o.redSub(t),p=a.redMul(u),h=c.redMul(d),b=a.redMul(d),m=u.redMul(c);return this.curve.point(p,h,m,b)};Point.prototype._projDbl=function n(){var e=this.x.redAdd(this.y).redSqr(),t=this.x.redSqr(),i=this.y.redSqr(),o,a,c,u,d,p;if(this.curve.twisted){u=this.curve._mulA(t);var h=u.redAdd(i);this.zOne?(o=e.redSub(t).redSub(i).redMul(h.redSub(this.curve.two)),a=h.redMul(u.redSub(i)),c=h.redSqr().redSub(h).redSub(h)):(d=this.z.redSqr(),p=h.redSub(d).redISub(d),o=e.redSub(t).redISub(i).redMul(p),a=h.redMul(u.redSub(i)),c=h.redMul(p))}else u=t.redAdd(i),d=this.curve._mulC(this.z).redSqr(),p=u.redSub(d).redSub(d),o=this.curve._mulC(e.redISub(u)).redMul(p),a=this.curve._mulC(u).redMul(t.redISub(i)),c=u.redMul(p);return this.curve.point(o,a,c)};Point.prototype.dbl=function n(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};Point.prototype._extAdd=function n(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),o=this.t.redMul(this.curve.dd).redMul(e.t),a=this.z.redMul(e.z.redAdd(e.z)),c=i.redSub(t),u=a.redSub(o),d=a.redAdd(o),p=i.redAdd(t),h=c.redMul(u),b=d.redMul(p),m=c.redMul(p),v=u.redMul(d);return this.curve.point(h,b,v,m)};Point.prototype._projAdd=function n(e){var t=this.z.redMul(e.z),i=t.redSqr(),o=this.x.redMul(e.x),a=this.y.redMul(e.y),c=this.curve.d.redMul(o).redMul(a),u=i.redSub(c),d=i.redAdd(c),p=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(o).redISub(a),h=t.redMul(u).redMul(p),b,m;return this.curve.twisted?(b=t.redMul(d).redMul(a.redSub(this.curve._mulA(o))),m=u.redMul(d)):(b=t.redMul(d).redMul(a.redSub(o)),m=this.curve._mulC(u).redMul(d)),this.curve.point(h,b,m)};Point.prototype.add=function n(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};Point.prototype.mul=function n(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};Point.prototype.mulAdd=function n(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!1)};Point.prototype.jmulAdd=function n(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!0)};Point.prototype.normalize=function n(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};Point.prototype.neg=function n(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};Point.prototype.getX=function n(){return this.normalize(),this.x.fromRed()};Point.prototype.getY=function n(){return this.normalize(),this.y.fromRed()};Point.prototype.eq=function n(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};Point.prototype.eqXToP=function n(e){var t=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(t)===0)return!0;for(var i=e.clone(),o=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(o),this.x.cmp(t)===0)return!0}};Point.prototype.toP=Point.prototype.normalize;Point.prototype.mixedAdd=Point.prototype.add;(function(n){var e=n;e.base=base$3,e.short=short,e.mont=mont,e.edwards=edwards})(curve);var curves$1={},hash$4={},utils$j={},assert$a=minimalisticAssert,inherits=inherits_browserExports;utils$j.inherits=inherits;function isSurrogatePair(n,e){return(n.charCodeAt(e)&64512)!==55296||e<0||e+1>=n.length?!1:(n.charCodeAt(e+1)&64512)===56320}function toArray(n,e){if(Array.isArray(n))return n.slice();if(!n)return[];var t=[];if(typeof n=="string")if(e){if(e==="hex")for(n=n.replace(/[^a-z0-9]+/ig,""),n.length%2!==0&&(n="0"+n),o=0;o<n.length;o+=2)t.push(parseInt(n[o]+n[o+1],16))}else for(var i=0,o=0;o<n.length;o++){var a=n.charCodeAt(o);a<128?t[i++]=a:a<2048?(t[i++]=a>>6|192,t[i++]=a&63|128):isSurrogatePair(n,o)?(a=65536+((a&1023)<<10)+(n.charCodeAt(++o)&1023),t[i++]=a>>18|240,t[i++]=a>>12&63|128,t[i++]=a>>6&63|128,t[i++]=a&63|128):(t[i++]=a>>12|224,t[i++]=a>>6&63|128,t[i++]=a&63|128)}else for(o=0;o<n.length;o++)t[o]=n[o]|0;return t}utils$j.toArray=toArray;function toHex$1(n){for(var e="",t=0;t<n.length;t++)e+=zero2(n[t].toString(16));return e}utils$j.toHex=toHex$1;function htonl(n){var e=n>>>24|n>>>8&65280|n<<8&16711680|(n&255)<<24;return e>>>0}utils$j.htonl=htonl;function toHex32(n,e){for(var t="",i=0;i<n.length;i++){var o=n[i];e==="little"&&(o=htonl(o)),t+=zero8(o.toString(16))}return t}utils$j.toHex32=toHex32;function zero2(n){return n.length===1?"0"+n:n}utils$j.zero2=zero2;function zero8(n){return n.length===7?"0"+n:n.length===6?"00"+n:n.length===5?"000"+n:n.length===4?"0000"+n:n.length===3?"00000"+n:n.length===2?"000000"+n:n.length===1?"0000000"+n:n}utils$j.zero8=zero8;function join32(n,e,t,i){var o=t-e;assert$a(o%4===0);for(var a=new Array(o/4),c=0,u=e;c<a.length;c++,u+=4){var d;i==="big"?d=n[u]<<24|n[u+1]<<16|n[u+2]<<8|n[u+3]:d=n[u+3]<<24|n[u+2]<<16|n[u+1]<<8|n[u],a[c]=d>>>0}return a}utils$j.join32=join32;function split32(n,e){for(var t=new Array(n.length*4),i=0,o=0;i<n.length;i++,o+=4){var a=n[i];e==="big"?(t[o]=a>>>24,t[o+1]=a>>>16&255,t[o+2]=a>>>8&255,t[o+3]=a&255):(t[o+3]=a>>>24,t[o+2]=a>>>16&255,t[o+1]=a>>>8&255,t[o]=a&255)}return t}utils$j.split32=split32;function rotr32$1(n,e){return n>>>e|n<<32-e}utils$j.rotr32=rotr32$1;function rotl32$2(n,e){return n<<e|n>>>32-e}utils$j.rotl32=rotl32$2;function sum32$3(n,e){return n+e>>>0}utils$j.sum32=sum32$3;function sum32_3$1(n,e,t){return n+e+t>>>0}utils$j.sum32_3=sum32_3$1;function sum32_4$2(n,e,t,i){return n+e+t+i>>>0}utils$j.sum32_4=sum32_4$2;function sum32_5$2(n,e,t,i,o){return n+e+t+i+o>>>0}utils$j.sum32_5=sum32_5$2;function sum64$1(n,e,t,i){var o=n[e],a=n[e+1],c=i+a>>>0,u=(c<i?1:0)+t+o;n[e]=u>>>0,n[e+1]=c}utils$j.sum64=sum64$1;function sum64_hi$1(n,e,t,i){var o=e+i>>>0,a=(o<e?1:0)+n+t;return a>>>0}utils$j.sum64_hi=sum64_hi$1;function sum64_lo$1(n,e,t,i){var o=e+i;return o>>>0}utils$j.sum64_lo=sum64_lo$1;function sum64_4_hi$1(n,e,t,i,o,a,c,u){var d=0,p=e;p=p+i>>>0,d+=p<e?1:0,p=p+a>>>0,d+=p<a?1:0,p=p+u>>>0,d+=p<u?1:0;var h=n+t+o+c+d;return h>>>0}utils$j.sum64_4_hi=sum64_4_hi$1;function sum64_4_lo$1(n,e,t,i,o,a,c,u){var d=e+i+a+u;return d>>>0}utils$j.sum64_4_lo=sum64_4_lo$1;function sum64_5_hi$1(n,e,t,i,o,a,c,u,d,p){var h=0,b=e;b=b+i>>>0,h+=b<e?1:0,b=b+a>>>0,h+=b<a?1:0,b=b+u>>>0,h+=b<u?1:0,b=b+p>>>0,h+=b<p?1:0;var m=n+t+o+c+d+h;return m>>>0}utils$j.sum64_5_hi=sum64_5_hi$1;function sum64_5_lo$1(n,e,t,i,o,a,c,u,d,p){var h=e+i+a+u+p;return h>>>0}utils$j.sum64_5_lo=sum64_5_lo$1;function rotr64_hi$1(n,e,t){var i=e<<32-t|n>>>t;return i>>>0}utils$j.rotr64_hi=rotr64_hi$1;function rotr64_lo$1(n,e,t){var i=n<<32-t|e>>>t;return i>>>0}utils$j.rotr64_lo=rotr64_lo$1;function shr64_hi$1(n,e,t){return n>>>t}utils$j.shr64_hi=shr64_hi$1;function shr64_lo$1(n,e,t){var i=n<<32-t|e>>>t;return i>>>0}utils$j.shr64_lo=shr64_lo$1;var common$6={},utils$i=utils$j,assert$9=minimalisticAssert;function BlockHash$4(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}common$6.BlockHash=BlockHash$4;BlockHash$4.prototype.update=function n(e,t){if(e=utils$i.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=utils$i.join32(e,0,e.length-i,this.endian);for(var o=0;o<e.length;o+=this._delta32)this._update(e,o,o+this._delta32)}return this};BlockHash$4.prototype.digest=function n(e){return this.update(this._pad()),assert$9(this.pending===null),this._digest(e)};BlockHash$4.prototype._pad=function n(){var e=this.pendingTotal,t=this._delta8,i=t-(e+this.padLength)%t,o=new Array(i+this.padLength);o[0]=128;for(var a=1;a<i;a++)o[a]=0;if(e<<=3,this.endian==="big"){for(var c=8;c<this.padLength;c++)o[a++]=0;o[a++]=0,o[a++]=0,o[a++]=0,o[a++]=0,o[a++]=e>>>24&255,o[a++]=e>>>16&255,o[a++]=e>>>8&255,o[a++]=e&255}else for(o[a++]=e&255,o[a++]=e>>>8&255,o[a++]=e>>>16&255,o[a++]=e>>>24&255,o[a++]=0,o[a++]=0,o[a++]=0,o[a++]=0,c=8;c<this.padLength;c++)o[a++]=0;return o};var sha$1={},common$5={},utils$h=utils$j,rotr32=utils$h.rotr32;function ft_1$1(n,e,t,i){if(n===0)return ch32$1(e,t,i);if(n===1||n===3)return p32(e,t,i);if(n===2)return maj32$1(e,t,i)}common$5.ft_1=ft_1$1;function ch32$1(n,e,t){return n&e^~n&t}common$5.ch32=ch32$1;function maj32$1(n,e,t){return n&e^n&t^e&t}common$5.maj32=maj32$1;function p32(n,e,t){return n^e^t}common$5.p32=p32;function s0_256$1(n){return rotr32(n,2)^rotr32(n,13)^rotr32(n,22)}common$5.s0_256=s0_256$1;function s1_256$1(n){return rotr32(n,6)^rotr32(n,11)^rotr32(n,25)}common$5.s1_256=s1_256$1;function g0_256$1(n){return rotr32(n,7)^rotr32(n,18)^n>>>3}common$5.g0_256=g0_256$1;function g1_256$1(n){return rotr32(n,17)^rotr32(n,19)^n>>>10}common$5.g1_256=g1_256$1;var utils$g=utils$j,common$4=common$6,shaCommon$1=common$5,rotl32$1=utils$g.rotl32,sum32$2=utils$g.sum32,sum32_5$1=utils$g.sum32_5,ft_1=shaCommon$1.ft_1,BlockHash$3=common$4.BlockHash,sha1_K=[1518500249,1859775393,2400959708,3395469782];function SHA1(){if(!(this instanceof SHA1))return new SHA1;BlockHash$3.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}utils$g.inherits(SHA1,BlockHash$3);var _1=SHA1;SHA1.blockSize=512;SHA1.outSize=160;SHA1.hmacStrength=80;SHA1.padLength=64;SHA1.prototype._update=function n(e,t){for(var i=this.W,o=0;o<16;o++)i[o]=e[t+o];for(;o<i.length;o++)i[o]=rotl32$1(i[o-3]^i[o-8]^i[o-14]^i[o-16],1);var a=this.h[0],c=this.h[1],u=this.h[2],d=this.h[3],p=this.h[4];for(o=0;o<i.length;o++){var h=~~(o/20),b=sum32_5$1(rotl32$1(a,5),ft_1(h,c,u,d),p,i[o],sha1_K[h]);p=d,d=u,u=rotl32$1(c,30),c=a,a=b}this.h[0]=sum32$2(this.h[0],a),this.h[1]=sum32$2(this.h[1],c),this.h[2]=sum32$2(this.h[2],u),this.h[3]=sum32$2(this.h[3],d),this.h[4]=sum32$2(this.h[4],p)};SHA1.prototype._digest=function n(e){return e==="hex"?utils$g.toHex32(this.h,"big"):utils$g.split32(this.h,"big")};var utils$f=utils$j,common$3=common$6,shaCommon=common$5,assert$8=minimalisticAssert,sum32$1=utils$f.sum32,sum32_4$1=utils$f.sum32_4,sum32_5=utils$f.sum32_5,ch32=shaCommon.ch32,maj32=shaCommon.maj32,s0_256=shaCommon.s0_256,s1_256=shaCommon.s1_256,g0_256=shaCommon.g0_256,g1_256=shaCommon.g1_256,BlockHash$2=common$3.BlockHash,sha256_K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function SHA256$1(){if(!(this instanceof SHA256$1))return new SHA256$1;BlockHash$2.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=sha256_K,this.W=new Array(64)}utils$f.inherits(SHA256$1,BlockHash$2);var _256=SHA256$1;SHA256$1.blockSize=512;SHA256$1.outSize=256;SHA256$1.hmacStrength=192;SHA256$1.padLength=64;SHA256$1.prototype._update=function n(e,t){for(var i=this.W,o=0;o<16;o++)i[o]=e[t+o];for(;o<i.length;o++)i[o]=sum32_4$1(g1_256(i[o-2]),i[o-7],g0_256(i[o-15]),i[o-16]);var a=this.h[0],c=this.h[1],u=this.h[2],d=this.h[3],p=this.h[4],h=this.h[5],b=this.h[6],m=this.h[7];for(assert$8(this.k.length===i.length),o=0;o<i.length;o++){var v=sum32_5(m,s1_256(p),ch32(p,h,b),this.k[o],i[o]),_=sum32$1(s0_256(a),maj32(a,c,u));m=b,b=h,h=p,p=sum32$1(d,v),d=u,u=c,c=a,a=sum32$1(v,_)}this.h[0]=sum32$1(this.h[0],a),this.h[1]=sum32$1(this.h[1],c),this.h[2]=sum32$1(this.h[2],u),this.h[3]=sum32$1(this.h[3],d),this.h[4]=sum32$1(this.h[4],p),this.h[5]=sum32$1(this.h[5],h),this.h[6]=sum32$1(this.h[6],b),this.h[7]=sum32$1(this.h[7],m)};SHA256$1.prototype._digest=function n(e){return e==="hex"?utils$f.toHex32(this.h,"big"):utils$f.split32(this.h,"big")};var utils$e=utils$j,SHA256=_256;function SHA224(){if(!(this instanceof SHA224))return new SHA224;SHA256.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}utils$e.inherits(SHA224,SHA256);var _224=SHA224;SHA224.blockSize=512;SHA224.outSize=224;SHA224.hmacStrength=192;SHA224.padLength=64;SHA224.prototype._digest=function n(e){return e==="hex"?utils$e.toHex32(this.h.slice(0,7),"big"):utils$e.split32(this.h.slice(0,7),"big")};var utils$d=utils$j,common$2=common$6,assert$7=minimalisticAssert,rotr64_hi=utils$d.rotr64_hi,rotr64_lo=utils$d.rotr64_lo,shr64_hi=utils$d.shr64_hi,shr64_lo=utils$d.shr64_lo,sum64=utils$d.sum64,sum64_hi=utils$d.sum64_hi,sum64_lo=utils$d.sum64_lo,sum64_4_hi=utils$d.sum64_4_hi,sum64_4_lo=utils$d.sum64_4_lo,sum64_5_hi=utils$d.sum64_5_hi,sum64_5_lo=utils$d.sum64_5_lo,BlockHash$1=common$2.BlockHash,sha512_K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function SHA512$1(){if(!(this instanceof SHA512$1))return new SHA512$1;BlockHash$1.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=sha512_K,this.W=new Array(160)}utils$d.inherits(SHA512$1,BlockHash$1);var _512=SHA512$1;SHA512$1.blockSize=1024;SHA512$1.outSize=512;SHA512$1.hmacStrength=192;SHA512$1.padLength=128;SHA512$1.prototype._prepareBlock=function n(e,t){for(var i=this.W,o=0;o<32;o++)i[o]=e[t+o];for(;o<i.length;o+=2){var a=g1_512_hi(i[o-4],i[o-3]),c=g1_512_lo(i[o-4],i[o-3]),u=i[o-14],d=i[o-13],p=g0_512_hi(i[o-30],i[o-29]),h=g0_512_lo(i[o-30],i[o-29]),b=i[o-32],m=i[o-31];i[o]=sum64_4_hi(a,c,u,d,p,h,b,m),i[o+1]=sum64_4_lo(a,c,u,d,p,h,b,m)}};SHA512$1.prototype._update=function n(e,t){this._prepareBlock(e,t);var i=this.W,o=this.h[0],a=this.h[1],c=this.h[2],u=this.h[3],d=this.h[4],p=this.h[5],h=this.h[6],b=this.h[7],m=this.h[8],v=this.h[9],_=this.h[10],$=this.h[11],k=this.h[12],D=this.h[13],O=this.h[14],H=this.h[15];assert$7(this.k.length===i.length);for(var j=0;j<i.length;j+=2){var W=O,ae=H,fe=s1_512_hi(m,v),pe=s1_512_lo(m,v),ve=ch64_hi(m,v,_,$,k),Qe=ch64_lo(m,v,_,$,k,D),re=this.k[j],C=this.k[j+1],S=i[j],w=i[j+1],E=sum64_5_hi(W,ae,fe,pe,ve,Qe,re,C,S,w),I=sum64_5_lo(W,ae,fe,pe,ve,Qe,re,C,S,w);W=s0_512_hi(o,a),ae=s0_512_lo(o,a),fe=maj64_hi(o,a,c,u,d),pe=maj64_lo(o,a,c,u,d,p);var N=sum64_hi(W,ae,fe,pe),U=sum64_lo(W,ae,fe,pe);O=k,H=D,k=_,D=$,_=m,$=v,m=sum64_hi(h,b,E,I),v=sum64_lo(b,b,E,I),h=d,b=p,d=c,p=u,c=o,u=a,o=sum64_hi(E,I,N,U),a=sum64_lo(E,I,N,U)}sum64(this.h,0,o,a),sum64(this.h,2,c,u),sum64(this.h,4,d,p),sum64(this.h,6,h,b),sum64(this.h,8,m,v),sum64(this.h,10,_,$),sum64(this.h,12,k,D),sum64(this.h,14,O,H)};SHA512$1.prototype._digest=function n(e){return e==="hex"?utils$d.toHex32(this.h,"big"):utils$d.split32(this.h,"big")};function ch64_hi(n,e,t,i,o){var a=n&t^~n&o;return a<0&&(a+=4294967296),a}function ch64_lo(n,e,t,i,o,a){var c=e&i^~e&a;return c<0&&(c+=4294967296),c}function maj64_hi(n,e,t,i,o){var a=n&t^n&o^t&o;return a<0&&(a+=4294967296),a}function maj64_lo(n,e,t,i,o,a){var c=e&i^e&a^i&a;return c<0&&(c+=4294967296),c}function s0_512_hi(n,e){var t=rotr64_hi(n,e,28),i=rotr64_hi(e,n,2),o=rotr64_hi(e,n,7),a=t^i^o;return a<0&&(a+=4294967296),a}function s0_512_lo(n,e){var t=rotr64_lo(n,e,28),i=rotr64_lo(e,n,2),o=rotr64_lo(e,n,7),a=t^i^o;return a<0&&(a+=4294967296),a}function s1_512_hi(n,e){var t=rotr64_hi(n,e,14),i=rotr64_hi(n,e,18),o=rotr64_hi(e,n,9),a=t^i^o;return a<0&&(a+=4294967296),a}function s1_512_lo(n,e){var t=rotr64_lo(n,e,14),i=rotr64_lo(n,e,18),o=rotr64_lo(e,n,9),a=t^i^o;return a<0&&(a+=4294967296),a}function g0_512_hi(n,e){var t=rotr64_hi(n,e,1),i=rotr64_hi(n,e,8),o=shr64_hi(n,e,7),a=t^i^o;return a<0&&(a+=4294967296),a}function g0_512_lo(n,e){var t=rotr64_lo(n,e,1),i=rotr64_lo(n,e,8),o=shr64_lo(n,e,7),a=t^i^o;return a<0&&(a+=4294967296),a}function g1_512_hi(n,e){var t=rotr64_hi(n,e,19),i=rotr64_hi(e,n,29),o=shr64_hi(n,e,6),a=t^i^o;return a<0&&(a+=4294967296),a}function g1_512_lo(n,e){var t=rotr64_lo(n,e,19),i=rotr64_lo(e,n,29),o=shr64_lo(n,e,6),a=t^i^o;return a<0&&(a+=4294967296),a}var utils$c=utils$j,SHA512=_512;function SHA384(){if(!(this instanceof SHA384))return new SHA384;SHA512.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}utils$c.inherits(SHA384,SHA512);var _384=SHA384;SHA384.blockSize=1024;SHA384.outSize=384;SHA384.hmacStrength=192;SHA384.padLength=128;SHA384.prototype._digest=function n(e){return e==="hex"?utils$c.toHex32(this.h.slice(0,12),"big"):utils$c.split32(this.h.slice(0,12),"big")};sha$1.sha1=_1;sha$1.sha224=_224;sha$1.sha256=_256;sha$1.sha384=_384;sha$1.sha512=_512;var ripemd={},utils$b=utils$j,common$1=common$6,rotl32=utils$b.rotl32,sum32=utils$b.sum32,sum32_3=utils$b.sum32_3,sum32_4=utils$b.sum32_4,BlockHash=common$1.BlockHash;function RIPEMD160(){if(!(this instanceof RIPEMD160))return new RIPEMD160;BlockHash.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}utils$b.inherits(RIPEMD160,BlockHash);ripemd.ripemd160=RIPEMD160;RIPEMD160.blockSize=512;RIPEMD160.outSize=160;RIPEMD160.hmacStrength=192;RIPEMD160.padLength=64;RIPEMD160.prototype._update=function n(e,t){for(var i=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],u=this.h[4],d=i,p=o,h=a,b=c,m=u,v=0;v<80;v++){var _=sum32(rotl32(sum32_4(i,f(v,o,a,c),e[r[v]+t],K(v)),s[v]),u);i=u,u=c,c=rotl32(a,10),a=o,o=_,_=sum32(rotl32(sum32_4(d,f(79-v,p,h,b),e[rh[v]+t],Kh(v)),sh[v]),m),d=m,m=b,b=rotl32(h,10),h=p,p=_}_=sum32_3(this.h[1],a,b),this.h[1]=sum32_3(this.h[2],c,m),this.h[2]=sum32_3(this.h[3],u,d),this.h[3]=sum32_3(this.h[4],i,p),this.h[4]=sum32_3(this.h[0],o,h),this.h[0]=_};RIPEMD160.prototype._digest=function n(e){return e==="hex"?utils$b.toHex32(this.h,"little"):utils$b.split32(this.h,"little")};function f(n,e,t,i){return n<=15?e^t^i:n<=31?e&t|~e&i:n<=47?(e|~t)^i:n<=63?e&i|t&~i:e^(t|~i)}function K(n){return n<=15?0:n<=31?1518500249:n<=47?1859775393:n<=63?2400959708:2840853838}function Kh(n){return n<=15?1352829926:n<=31?1548603684:n<=47?1836072691:n<=63?2053994217:0}var r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],rh=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],s=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],sh=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],utils$a=utils$j,assert$6=minimalisticAssert;function Hmac(n,e,t){if(!(this instanceof Hmac))return new Hmac(n,e,t);this.Hash=n,this.blockSize=n.blockSize/8,this.outSize=n.outSize/8,this.inner=null,this.outer=null,this._init(utils$a.toArray(e,t))}var hmac=Hmac;Hmac.prototype._init=function n(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),assert$6(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=new this.Hash().update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)};Hmac.prototype.update=function n(e,t){return this.inner.update(e,t),this};Hmac.prototype.digest=function n(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)};(function(n){var e=n;e.utils=utils$j,e.common=common$6,e.sha=sha$1,e.ripemd=ripemd,e.hmac=hmac,e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160})(hash$4);var secp256k1,hasRequiredSecp256k1;function requireSecp256k1(){return hasRequiredSecp256k1||(hasRequiredSecp256k1=1,secp256k1={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),secp256k1}(function(n){var e=n,t=hash$4,i=curve,o=utils$p,a=o.assert;function c(p){p.type==="short"?this.curve=new i.short(p):p.type==="edwards"?this.curve=new i.edwards(p):this.curve=new i.mont(p),this.g=this.curve.g,this.n=this.curve.n,this.hash=p.hash,a(this.g.validate(),"Invalid curve"),a(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=c;function u(p,h){Object.defineProperty(e,p,{configurable:!0,enumerable:!0,get:function(){var b=new c(h);return Object.defineProperty(e,p,{configurable:!0,enumerable:!0,value:b}),b}})}u("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:t.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),u("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:t.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),u("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:t.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),u("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:t.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),u("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:t.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),u("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:t.sha256,gRed:!1,g:["9"]}),u("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:t.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var d;try{d=requireSecp256k1()}catch{d=void 0}u("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:t.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",d]})})(curves$1);var hash$3=hash$4,utils$9=utils$o,assert$5=minimalisticAssert;function HmacDRBG(n){if(!(this instanceof HmacDRBG))return new HmacDRBG(n);this.hash=n.hash,this.predResist=!!n.predResist,this.outLen=this.hash.outSize,this.minEntropy=n.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=utils$9.toArray(n.entropy,n.entropyEnc||"hex"),t=utils$9.toArray(n.nonce,n.nonceEnc||"hex"),i=utils$9.toArray(n.pers,n.persEnc||"hex");assert$5(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,i)}var hmacDrbg=HmacDRBG;HmacDRBG.prototype._init=function n(e,t,i){var o=e.concat(t).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var a=0;a<this.V.length;a++)this.K[a]=0,this.V[a]=1;this._update(o),this._reseed=1,this.reseedInterval=281474976710656};HmacDRBG.prototype._hmac=function n(){return new hash$3.hmac(this.hash,this.K)};HmacDRBG.prototype._update=function n(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};HmacDRBG.prototype.reseed=function n(e,t,i,o){typeof t!="string"&&(o=i,i=t,t=null),e=utils$9.toArray(e,t),i=utils$9.toArray(i,o),assert$5(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};HmacDRBG.prototype.generate=function n(e,t,i,o){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(o=i,i=t,t=null),i&&(i=utils$9.toArray(i,o||"hex"),this._update(i));for(var a=[];a.length<e;)this.V=this._hmac().update(this.V).digest(),a=a.concat(this.V);var c=a.slice(0,e);return this._update(i),this._reseed++,utils$9.encode(c,t)};var BN$2=bnExports,utils$8=utils$p,assert$4=utils$8.assert;function KeyPair$2(n,e){this.ec=n,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var key$1=KeyPair$2;KeyPair$2.fromPublic=function n(e,t,i){return t instanceof KeyPair$2?t:new KeyPair$2(e,{pub:t,pubEnc:i})};KeyPair$2.fromPrivate=function n(e,t,i){return t instanceof KeyPair$2?t:new KeyPair$2(e,{priv:t,privEnc:i})};KeyPair$2.prototype.validate=function n(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};KeyPair$2.prototype.getPublic=function n(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};KeyPair$2.prototype.getPrivate=function n(e){return e==="hex"?this.priv.toString(16,2):this.priv};KeyPair$2.prototype._importPrivate=function n(e,t){this.priv=new BN$2(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};KeyPair$2.prototype._importPublic=function n(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?assert$4(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&assert$4(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};KeyPair$2.prototype.derive=function n(e){return e.validate()||assert$4(e.validate(),"public point not validated"),e.mul(this.priv).getX()};KeyPair$2.prototype.sign=function n(e,t,i){return this.ec.sign(e,this,t,i)};KeyPair$2.prototype.verify=function n(e,t){return this.ec.verify(e,t,this)};KeyPair$2.prototype.inspect=function n(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var BN$1=bnExports,utils$7=utils$p,assert$3=utils$7.assert;function Signature$2(n,e){if(n instanceof Signature$2)return n;this._importDER(n,e)||(assert$3(n.r&&n.s,"Signature without r or s"),this.r=new BN$1(n.r,16),this.s=new BN$1(n.s,16),n.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=n.recoveryParam)}var signature$1=Signature$2;function Position(){this.place=0}function getLength(n,e){var t=n[e.place++];if(!(t&128))return t;var i=t&15;if(i===0||i>4)return!1;for(var o=0,a=0,c=e.place;a<i;a++,c++)o<<=8,o|=n[c],o>>>=0;return o<=127?!1:(e.place=c,o)}function rmPadding(n){for(var e=0,t=n.length-1;!n[e]&&!(n[e+1]&128)&&e<t;)e++;return e===0?n:n.slice(e)}Signature$2.prototype._importDER=function n(e,t){e=utils$7.toArray(e,t);var i=new Position;if(e[i.place++]!==48)return!1;var o=getLength(e,i);if(o===!1||o+i.place!==e.length||e[i.place++]!==2)return!1;var a=getLength(e,i);if(a===!1)return!1;var c=e.slice(i.place,a+i.place);if(i.place+=a,e[i.place++]!==2)return!1;var u=getLength(e,i);if(u===!1||e.length!==u+i.place)return!1;var d=e.slice(i.place,u+i.place);if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;if(d[0]===0)if(d[1]&128)d=d.slice(1);else return!1;return this.r=new BN$1(c),this.s=new BN$1(d),this.recoveryParam=null,!0};function constructLength(n,e){if(e<128){n.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(n.push(t|128);--t;)n.push(e>>>(t<<3)&255);n.push(e)}Signature$2.prototype.toDER=function n(e){var t=this.r.toArray(),i=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),i[0]&128&&(i=[0].concat(i)),t=rmPadding(t),i=rmPadding(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var o=[2];constructLength(o,t.length),o=o.concat(t),o.push(2),constructLength(o,i.length);var a=o.concat(i),c=[48];return constructLength(c,a.length),c=c.concat(a),utils$7.encode(c,e)};var ec,hasRequiredEc;function requireEc(){if(hasRequiredEc)return ec;hasRequiredEc=1;var n=bnExports,e=hmacDrbg,t=utils$p,i=curves$1,o=requireBrorand(),a=t.assert,c=key$1,u=signature$1;function d(p){if(!(this instanceof d))return new d(p);typeof p=="string"&&(a(Object.prototype.hasOwnProperty.call(i,p),"Unknown curve "+p),p=i[p]),p instanceof i.PresetCurve&&(p={curve:p}),this.curve=p.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=p.curve.g,this.g.precompute(p.curve.n.bitLength()+1),this.hash=p.hash||p.curve.hash}return ec=d,d.prototype.keyPair=function(h){return new c(this,h)},d.prototype.keyFromPrivate=function(h,b){return c.fromPrivate(this,h,b)},d.prototype.keyFromPublic=function(h,b){return c.fromPublic(this,h,b)},d.prototype.genKeyPair=function(h){h||(h={});for(var b=new e({hash:this.hash,pers:h.pers,persEnc:h.persEnc||"utf8",entropy:h.entropy||o(this.hash.hmacStrength),entropyEnc:h.entropy&&h.entropyEnc||"utf8",nonce:this.n.toArray()}),m=this.n.byteLength(),v=this.n.sub(new n(2));;){var _=new n(b.generate(m));if(!(_.cmp(v)>0))return _.iaddn(1),this.keyFromPrivate(_)}},d.prototype._truncateToN=function(h,b){var m=h.byteLength()*8-this.n.bitLength();return m>0&&(h=h.ushrn(m)),!b&&h.cmp(this.n)>=0?h.sub(this.n):h},d.prototype.sign=function(h,b,m,v){typeof m=="object"&&(v=m,m=null),v||(v={}),b=this.keyFromPrivate(b,m),h=this._truncateToN(new n(h,16));for(var _=this.n.byteLength(),$=b.getPrivate().toArray("be",_),k=h.toArray("be",_),D=new e({hash:this.hash,entropy:$,nonce:k,pers:v.pers,persEnc:v.persEnc||"utf8"}),O=this.n.sub(new n(1)),H=0;;H++){var j=v.k?v.k(H):new n(D.generate(this.n.byteLength()));if(j=this._truncateToN(j,!0),!(j.cmpn(1)<=0||j.cmp(O)>=0)){var W=this.g.mul(j);if(!W.isInfinity()){var ae=W.getX(),fe=ae.umod(this.n);if(fe.cmpn(0)!==0){var pe=j.invm(this.n).mul(fe.mul(b.getPrivate()).iadd(h));if(pe=pe.umod(this.n),pe.cmpn(0)!==0){var ve=(W.getY().isOdd()?1:0)|(ae.cmp(fe)!==0?2:0);return v.canonical&&pe.cmp(this.nh)>0&&(pe=this.n.sub(pe),ve^=1),new u({r:fe,s:pe,recoveryParam:ve})}}}}}},d.prototype.verify=function(h,b,m,v){h=this._truncateToN(new n(h,16)),m=this.keyFromPublic(m,v),b=new u(b,"hex");var _=b.r,$=b.s;if(_.cmpn(1)<0||_.cmp(this.n)>=0||$.cmpn(1)<0||$.cmp(this.n)>=0)return!1;var k=$.invm(this.n),D=k.mul(h).umod(this.n),O=k.mul(_).umod(this.n),H;return this.curve._maxwellTrick?(H=this.g.jmulAdd(D,m.getPublic(),O),H.isInfinity()?!1:H.eqXToP(_)):(H=this.g.mulAdd(D,m.getPublic(),O),H.isInfinity()?!1:H.getX().umod(this.n).cmp(_)===0)},d.prototype.recoverPubKey=function(p,h,b,m){a((3&b)===b,"The recovery param is more than two bits"),h=new u(h,m);var v=this.n,_=new n(p),$=h.r,k=h.s,D=b&1,O=b>>1;if($.cmp(this.curve.p.umod(this.curve.n))>=0&&O)throw new Error("Unable to find sencond key candinate");O?$=this.curve.pointFromX($.add(this.curve.n),D):$=this.curve.pointFromX($,D);var H=h.r.invm(v),j=v.sub(_).mul(H).umod(v),W=k.mul(H).umod(v);return this.g.mulAdd(j,$,W)},d.prototype.getKeyRecoveryParam=function(p,h,b,m){if(h=new u(h,m),h.recoveryParam!==null)return h.recoveryParam;for(var v=0;v<4;v++){var _;try{_=this.recoverPubKey(p,h,v)}catch{continue}if(_.eq(b))return v}throw new Error("Unable to find valid recovery factor")},ec}var utils$6=utils$p,assert$2=utils$6.assert,parseBytes$2=utils$6.parseBytes,cachedProperty$1=utils$6.cachedProperty;function KeyPair$1(n,e){this.eddsa=n,this._secret=parseBytes$2(e.secret),n.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=parseBytes$2(e.pub)}KeyPair$1.fromPublic=function n(e,t){return t instanceof KeyPair$1?t:new KeyPair$1(e,{pub:t})};KeyPair$1.fromSecret=function n(e,t){return t instanceof KeyPair$1?t:new KeyPair$1(e,{secret:t})};KeyPair$1.prototype.secret=function n(){return this._secret};cachedProperty$1(KeyPair$1,"pubBytes",function n(){return this.eddsa.encodePoint(this.pub())});cachedProperty$1(KeyPair$1,"pub",function n(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});cachedProperty$1(KeyPair$1,"privBytes",function n(){var e=this.eddsa,t=this.hash(),i=e.encodingLength-1,o=t.slice(0,e.encodingLength);return o[0]&=248,o[i]&=127,o[i]|=64,o});cachedProperty$1(KeyPair$1,"priv",function n(){return this.eddsa.decodeInt(this.privBytes())});cachedProperty$1(KeyPair$1,"hash",function n(){return this.eddsa.hash().update(this.secret()).digest()});cachedProperty$1(KeyPair$1,"messagePrefix",function n(){return this.hash().slice(this.eddsa.encodingLength)});KeyPair$1.prototype.sign=function n(e){return assert$2(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};KeyPair$1.prototype.verify=function n(e,t){return this.eddsa.verify(e,t,this)};KeyPair$1.prototype.getSecret=function n(e){return assert$2(this._secret,"KeyPair is public only"),utils$6.encode(this.secret(),e)};KeyPair$1.prototype.getPublic=function n(e){return utils$6.encode(this.pubBytes(),e)};var key=KeyPair$1,BN=bnExports,utils$5=utils$p,assert$1=utils$5.assert,cachedProperty=utils$5.cachedProperty,parseBytes$1=utils$5.parseBytes;function Signature$1(n,e){this.eddsa=n,typeof e!="object"&&(e=parseBytes$1(e)),Array.isArray(e)&&(e={R:e.slice(0,n.encodingLength),S:e.slice(n.encodingLength)}),assert$1(e.R&&e.S,"Signature without R or S"),n.isPoint(e.R)&&(this._R=e.R),e.S instanceof BN&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}cachedProperty(Signature$1,"S",function n(){return this.eddsa.decodeInt(this.Sencoded())});cachedProperty(Signature$1,"R",function n(){return this.eddsa.decodePoint(this.Rencoded())});cachedProperty(Signature$1,"Rencoded",function n(){return this.eddsa.encodePoint(this.R())});cachedProperty(Signature$1,"Sencoded",function n(){return this.eddsa.encodeInt(this.S())});Signature$1.prototype.toBytes=function n(){return this.Rencoded().concat(this.Sencoded())};Signature$1.prototype.toHex=function n(){return utils$5.encode(this.toBytes(),"hex").toUpperCase()};var signature=Signature$1,hash$2=hash$4,curves=curves$1,utils$4=utils$p,assert=utils$4.assert,parseBytes=utils$4.parseBytes,KeyPair=key,Signature=signature;function EDDSA(n){if(assert(n==="ed25519","only tested with ed25519 so far"),!(this instanceof EDDSA))return new EDDSA(n);n=curves[n].curve,this.curve=n,this.g=n.g,this.g.precompute(n.n.bitLength()+1),this.pointClass=n.point().constructor,this.encodingLength=Math.ceil(n.n.bitLength()/8),this.hash=hash$2.sha512}var eddsa=EDDSA;EDDSA.prototype.sign=function n(e,t){e=parseBytes(e);var i=this.keyFromSecret(t),o=this.hashInt(i.messagePrefix(),e),a=this.g.mul(o),c=this.encodePoint(a),u=this.hashInt(c,i.pubBytes(),e).mul(i.priv()),d=o.add(u).umod(this.curve.n);return this.makeSignature({R:a,S:d,Rencoded:c})};EDDSA.prototype.verify=function n(e,t,i){e=parseBytes(e),t=this.makeSignature(t);var o=this.keyFromPublic(i),a=this.hashInt(t.Rencoded(),o.pubBytes(),e),c=this.g.mul(t.S()),u=t.R().add(o.pub().mul(a));return u.eq(c)};EDDSA.prototype.hashInt=function n(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return utils$4.intFromLE(e.digest()).umod(this.curve.n)};EDDSA.prototype.keyFromPublic=function n(e){return KeyPair.fromPublic(this,e)};EDDSA.prototype.keyFromSecret=function n(e){return KeyPair.fromSecret(this,e)};EDDSA.prototype.makeSignature=function n(e){return e instanceof Signature?e:new Signature(this,e)};EDDSA.prototype.encodePoint=function n(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t};EDDSA.prototype.decodePoint=function n(e){e=utils$4.parseBytes(e);var t=e.length-1,i=e.slice(0,t).concat(e[t]&-129),o=(e[t]&128)!==0,a=utils$4.intFromLE(i);return this.curve.pointFromY(a,o)};EDDSA.prototype.encodeInt=function n(e){return e.toArray("le",this.encodingLength)};EDDSA.prototype.decodeInt=function n(e){return utils$4.intFromLE(e)};EDDSA.prototype.isPoint=function n(e){return e instanceof this.pointClass};var hasRequiredElliptic;function requireElliptic(){return hasRequiredElliptic||(hasRequiredElliptic=1,function(n){var e=n;e.version=require$$0.version,e.utils=utils$p,e.rand=requireBrorand(),e.curve=curve,e.curves=curves$1,e.ec=requireEc(),e.eddsa=eddsa}(elliptic)),elliptic}var asn1$1={},asn1={},api$1={},encoders={},safer_1,hasRequiredSafer;function requireSafer(){if(hasRequiredSafer)return safer_1;hasRequiredSafer=1;var n=buffer$2,e=n.Buffer,t={},i;for(i in n)n.hasOwnProperty(i)&&(i==="SlowBuffer"||i==="Buffer"||(t[i]=n[i]));var o=t.Buffer={};for(i in e)e.hasOwnProperty(i)&&(i==="allocUnsafe"||i==="allocUnsafeSlow"||(o[i]=e[i]));if(t.Buffer.prototype=e.prototype,(!o.from||o.from===Uint8Array.from)&&(o.from=function(a,c,u){if(typeof a=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof a);if(a&&typeof a.length>"u")throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);return e(a,c,u)}),o.alloc||(o.alloc=function(a,c,u){if(typeof a!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof a);if(a<0||a>=2*(1<<30))throw new RangeError('The value "'+a+'" is invalid for option "size"');var d=e(a);return!c||c.length===0?d.fill(0):typeof u=="string"?d.fill(c,u):d.fill(c),d}),!t.kStringMaxLength)try{t.kStringMaxLength=process$3.binding("buffer").kStringMaxLength}catch{}return t.constants||(t.constants={MAX_LENGTH:t.kMaxLength},t.kStringMaxLength&&(t.constants.MAX_STRING_LENGTH=t.kStringMaxLength)),safer_1=t,safer_1}var reporter={},hasRequiredReporter;function requireReporter(){if(hasRequiredReporter)return reporter;hasRequiredReporter=1;const n=inherits_browserExports;function e(i){this._reporterState={obj:null,path:[],options:i||{},errors:[]}}reporter.Reporter=e,e.prototype.isError=function(o){return o instanceof t},e.prototype.save=function(){const o=this._reporterState;return{obj:o.obj,pathLen:o.path.length}},e.prototype.restore=function(o){const a=this._reporterState;a.obj=o.obj,a.path=a.path.slice(0,o.pathLen)},e.prototype.enterKey=function(o){return this._reporterState.path.push(o)},e.prototype.exitKey=function(o){const a=this._reporterState;a.path=a.path.slice(0,o-1)},e.prototype.leaveKey=function(o,a,c){const u=this._reporterState;this.exitKey(o),u.obj!==null&&(u.obj[a]=c)},e.prototype.path=function(){return this._reporterState.path.join("/")},e.prototype.enterObject=function(){const o=this._reporterState,a=o.obj;return o.obj={},a},e.prototype.leaveObject=function(o){const a=this._reporterState,c=a.obj;return a.obj=o,c},e.prototype.error=function(o){let a;const c=this._reporterState,u=o instanceof t;if(u?a=o:a=new t(c.path.map(function(d){return"["+JSON.stringify(d)+"]"}).join(""),o.message||o,o.stack),!c.options.partial)throw a;return u||c.errors.push(a),a},e.prototype.wrapResult=function(o){const a=this._reporterState;return a.options.partial?{result:this.isError(o)?null:o,errors:a.errors}:o};function t(i,o){this.path=i,this.rethrow(o)}return n(t,Error),t.prototype.rethrow=function(o){if(this.message=o+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,t),!this.stack)try{throw new Error(this.message)}catch(a){this.stack=a.stack}return this},reporter}var buffer={},hasRequiredBuffer;function requireBuffer(){if(hasRequiredBuffer)return buffer;hasRequiredBuffer=1;const n=inherits_browserExports,e=requireReporter().Reporter,t=requireSafer().Buffer;function i(a,c){if(e.call(this,c),!t.isBuffer(a)){this.error("Input not Buffer");return}this.base=a,this.offset=0,this.length=a.length}n(i,e),buffer.DecoderBuffer=i,i.isDecoderBuffer=function(c){return c instanceof i?!0:typeof c=="object"&&t.isBuffer(c.base)&&c.constructor.name==="DecoderBuffer"&&typeof c.offset=="number"&&typeof c.length=="number"&&typeof c.save=="function"&&typeof c.restore=="function"&&typeof c.isEmpty=="function"&&typeof c.readUInt8=="function"&&typeof c.skip=="function"&&typeof c.raw=="function"},i.prototype.save=function(){return{offset:this.offset,reporter:e.prototype.save.call(this)}},i.prototype.restore=function(c){const u=new i(this.base);return u.offset=c.offset,u.length=this.offset,this.offset=c.offset,e.prototype.restore.call(this,c.reporter),u},i.prototype.isEmpty=function(){return this.offset===this.length},i.prototype.readUInt8=function(c){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(c||"DecoderBuffer overrun")},i.prototype.skip=function(c,u){if(!(this.offset+c<=this.length))return this.error(u||"DecoderBuffer overrun");const d=new i(this.base);return d._reporterState=this._reporterState,d.offset=this.offset,d.length=this.offset+c,this.offset+=c,d},i.prototype.raw=function(c){return this.base.slice(c?c.offset:this.offset,this.length)};function o(a,c){if(Array.isArray(a))this.length=0,this.value=a.map(function(u){return o.isEncoderBuffer(u)||(u=new o(u,c)),this.length+=u.length,u},this);else if(typeof a=="number"){if(!(0<=a&&a<=255))return c.error("non-byte EncoderBuffer value");this.value=a,this.length=1}else if(typeof a=="string")this.value=a,this.length=t.byteLength(a);else if(t.isBuffer(a))this.value=a,this.length=a.length;else return c.error("Unsupported type: "+typeof a)}return buffer.EncoderBuffer=o,o.isEncoderBuffer=function(c){return c instanceof o?!0:typeof c=="object"&&c.constructor.name==="EncoderBuffer"&&typeof c.length=="number"&&typeof c.join=="function"},o.prototype.join=function(c,u){return c||(c=t.alloc(this.length)),u||(u=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(d){d.join(c,u),u+=d.length}):(typeof this.value=="number"?c[u]=this.value:typeof this.value=="string"?c.write(this.value,u):t.isBuffer(this.value)&&this.value.copy(c,u),u+=this.length)),c},buffer}var node,hasRequiredNode;function requireNode(){if(hasRequiredNode)return node;hasRequiredNode=1;const n=requireReporter().Reporter,e=requireBuffer().EncoderBuffer,t=requireBuffer().DecoderBuffer,i=minimalisticAssert,o=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],a=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(o),c=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function u(p,h,b){const m={};this._baseState=m,m.name=b,m.enc=p,m.parent=h||null,m.children=null,m.tag=null,m.args=null,m.reverseArgs=null,m.choice=null,m.optional=!1,m.any=!1,m.obj=!1,m.use=null,m.useDecoder=null,m.key=null,m.default=null,m.explicit=null,m.implicit=null,m.contains=null,m.parent||(m.children=[],this._wrap())}node=u;const d=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];return u.prototype.clone=function(){const h=this._baseState,b={};d.forEach(function(v){b[v]=h[v]});const m=new this.constructor(b.parent);return m._baseState=b,m},u.prototype._wrap=function(){const h=this._baseState;a.forEach(function(b){this[b]=function(){const v=new this.constructor(this);return h.children.push(v),v[b].apply(v,arguments)}},this)},u.prototype._init=function(h){const b=this._baseState;i(b.parent===null),h.call(this),b.children=b.children.filter(function(m){return m._baseState.parent===this},this),i.equal(b.children.length,1,"Root node can have only one child")},u.prototype._useArgs=function(h){const b=this._baseState,m=h.filter(function(v){return v instanceof this.constructor},this);h=h.filter(function(v){return!(v instanceof this.constructor)},this),m.length!==0&&(i(b.children===null),b.children=m,m.forEach(function(v){v._baseState.parent=this},this)),h.length!==0&&(i(b.args===null),b.args=h,b.reverseArgs=h.map(function(v){if(typeof v!="object"||v.constructor!==Object)return v;const _={};return Object.keys(v).forEach(function($){$==($|0)&&($|=0);const k=v[$];_[k]=$}),_}))},c.forEach(function(p){u.prototype[p]=function(){const b=this._baseState;throw new Error(p+" not implemented for encoding: "+b.enc)}}),o.forEach(function(p){u.prototype[p]=function(){const b=this._baseState,m=Array.prototype.slice.call(arguments);return i(b.tag===null),b.tag=p,this._useArgs(m),this}}),u.prototype.use=function(h){i(h);const b=this._baseState;return i(b.use===null),b.use=h,this},u.prototype.optional=function(){const h=this._baseState;return h.optional=!0,this},u.prototype.def=function(h){const b=this._baseState;return i(b.default===null),b.default=h,b.optional=!0,this},u.prototype.explicit=function(h){const b=this._baseState;return i(b.explicit===null&&b.implicit===null),b.explicit=h,this},u.prototype.implicit=function(h){const b=this._baseState;return i(b.explicit===null&&b.implicit===null),b.implicit=h,this},u.prototype.obj=function(){const h=this._baseState,b=Array.prototype.slice.call(arguments);return h.obj=!0,b.length!==0&&this._useArgs(b),this},u.prototype.key=function(h){const b=this._baseState;return i(b.key===null),b.key=h,this},u.prototype.any=function(){const h=this._baseState;return h.any=!0,this},u.prototype.choice=function(h){const b=this._baseState;return i(b.choice===null),b.choice=h,this._useArgs(Object.keys(h).map(function(m){return h[m]})),this},u.prototype.contains=function(h){const b=this._baseState;return i(b.use===null),b.contains=h,this},u.prototype._decode=function(h,b){const m=this._baseState;if(m.parent===null)return h.wrapResult(m.children[0]._decode(h,b));let v=m.default,_=!0,$=null;if(m.key!==null&&($=h.enterKey(m.key)),m.optional){let D=null;if(m.explicit!==null?D=m.explicit:m.implicit!==null?D=m.implicit:m.tag!==null&&(D=m.tag),D===null&&!m.any){const O=h.save();try{m.choice===null?this._decodeGeneric(m.tag,h,b):this._decodeChoice(h,b),_=!0}catch{_=!1}h.restore(O)}else if(_=this._peekTag(h,D,m.any),h.isError(_))return _}let k;if(m.obj&&_&&(k=h.enterObject()),_){if(m.explicit!==null){const O=this._decodeTag(h,m.explicit);if(h.isError(O))return O;h=O}const D=h.offset;if(m.use===null&&m.choice===null){let O;m.any&&(O=h.save());const H=this._decodeTag(h,m.implicit!==null?m.implicit:m.tag,m.any);if(h.isError(H))return H;m.any?v=h.raw(O):h=H}if(b&&b.track&&m.tag!==null&&b.track(h.path(),D,h.length,"tagged"),b&&b.track&&m.tag!==null&&b.track(h.path(),h.offset,h.length,"content"),m.any||(m.choice===null?v=this._decodeGeneric(m.tag,h,b):v=this._decodeChoice(h,b)),h.isError(v))return v;if(!m.any&&m.choice===null&&m.children!==null&&m.children.forEach(function(H){H._decode(h,b)}),m.contains&&(m.tag==="octstr"||m.tag==="bitstr")){const O=new t(v);v=this._getUse(m.contains,h._reporterState.obj)._decode(O,b)}}return m.obj&&_&&(v=h.leaveObject(k)),m.key!==null&&(v!==null||_===!0)?h.leaveKey($,m.key,v):$!==null&&h.exitKey($),v},u.prototype._decodeGeneric=function(h,b,m){const v=this._baseState;return h==="seq"||h==="set"?null:h==="seqof"||h==="setof"?this._decodeList(b,h,v.args[0],m):/str$/.test(h)?this._decodeStr(b,h,m):h==="objid"&&v.args?this._decodeObjid(b,v.args[0],v.args[1],m):h==="objid"?this._decodeObjid(b,null,null,m):h==="gentime"||h==="utctime"?this._decodeTime(b,h,m):h==="null_"?this._decodeNull(b,m):h==="bool"?this._decodeBool(b,m):h==="objDesc"?this._decodeStr(b,h,m):h==="int"||h==="enum"?this._decodeInt(b,v.args&&v.args[0],m):v.use!==null?this._getUse(v.use,b._reporterState.obj)._decode(b,m):b.error("unknown tag: "+h)},u.prototype._getUse=function(h,b){const m=this._baseState;return m.useDecoder=this._use(h,b),i(m.useDecoder._baseState.parent===null),m.useDecoder=m.useDecoder._baseState.children[0],m.implicit!==m.useDecoder._baseState.implicit&&(m.useDecoder=m.useDecoder.clone(),m.useDecoder._baseState.implicit=m.implicit),m.useDecoder},u.prototype._decodeChoice=function(h,b){const m=this._baseState;let v=null,_=!1;return Object.keys(m.choice).some(function($){const k=h.save(),D=m.choice[$];try{const O=D._decode(h,b);if(h.isError(O))return!1;v={type:$,value:O},_=!0}catch{return h.restore(k),!1}return!0},this),_?v:h.error("Choice not matched")},u.prototype._createEncoderBuffer=function(h){return new e(h,this.reporter)},u.prototype._encode=function(h,b,m){const v=this._baseState;if(v.default!==null&&v.default===h)return;const _=this._encodeValue(h,b,m);if(_!==void 0&&!this._skipDefault(_,b,m))return _},u.prototype._encodeValue=function(h,b,m){const v=this._baseState;if(v.parent===null)return v.children[0]._encode(h,b||new n);let _=null;if(this.reporter=b,v.optional&&h===void 0)if(v.default!==null)h=v.default;else return;let $=null,k=!1;if(v.any)_=this._createEncoderBuffer(h);else if(v.choice)_=this._encodeChoice(h,b);else if(v.contains)$=this._getUse(v.contains,m)._encode(h,b),k=!0;else if(v.children)$=v.children.map(function(D){if(D._baseState.tag==="null_")return D._encode(null,b,h);if(D._baseState.key===null)return b.error("Child should have a key");const O=b.enterKey(D._baseState.key);if(typeof h!="object")return b.error("Child expected, but input is not object");const H=D._encode(h[D._baseState.key],b,h);return b.leaveKey(O),H},this).filter(function(D){return D}),$=this._createEncoderBuffer($);else if(v.tag==="seqof"||v.tag==="setof"){if(!(v.args&&v.args.length===1))return b.error("Too many args for : "+v.tag);if(!Array.isArray(h))return b.error("seqof/setof, but data is not Array");const D=this.clone();D._baseState.implicit=null,$=this._createEncoderBuffer(h.map(function(O){const H=this._baseState;return this._getUse(H.args[0],h)._encode(O,b)},D))}else v.use!==null?_=this._getUse(v.use,m)._encode(h,b):($=this._encodePrimitive(v.tag,h),k=!0);if(!v.any&&v.choice===null){const D=v.implicit!==null?v.implicit:v.tag,O=v.implicit===null?"universal":"context";D===null?v.use===null&&b.error("Tag could be omitted only for .use()"):v.use===null&&(_=this._encodeComposite(D,k,O,$))}return v.explicit!==null&&(_=this._encodeComposite(v.explicit,!1,"context",_)),_},u.prototype._encodeChoice=function(h,b){const m=this._baseState,v=m.choice[h.type];return v||i(!1,h.type+" not found in "+JSON.stringify(Object.keys(m.choice))),v._encode(h.value,b)},u.prototype._encodePrimitive=function(h,b){const m=this._baseState;if(/str$/.test(h))return this._encodeStr(b,h);if(h==="objid"&&m.args)return this._encodeObjid(b,m.reverseArgs[0],m.args[1]);if(h==="objid")return this._encodeObjid(b,null,null);if(h==="gentime"||h==="utctime")return this._encodeTime(b,h);if(h==="null_")return this._encodeNull();if(h==="int"||h==="enum")return this._encodeInt(b,m.args&&m.reverseArgs[0]);if(h==="bool")return this._encodeBool(b);if(h==="objDesc")return this._encodeStr(b,h);throw new Error("Unsupported tag: "+h)},u.prototype._isNumstr=function(h){return/^[0-9 ]*$/.test(h)},u.prototype._isPrintstr=function(h){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(h)},node}var der={},hasRequiredDer$2;function requireDer$2(){return hasRequiredDer$2||(hasRequiredDer$2=1,function(n){function e(t){const i={};return Object.keys(t).forEach(function(o){(o|0)==o&&(o=o|0);const a=t[o];i[a]=o}),i}n.tagClass={0:"universal",1:"application",2:"context",3:"private"},n.tagClassByName=e(n.tagClass),n.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},n.tagByName=e(n.tag)}(der)),der}var der_1$1,hasRequiredDer$1;function requireDer$1(){if(hasRequiredDer$1)return der_1$1;hasRequiredDer$1=1;const n=inherits_browserExports,e=requireSafer().Buffer,t=requireNode(),i=requireDer$2();function o(d){this.enc="der",this.name=d.name,this.entity=d,this.tree=new a,this.tree._init(d.body)}der_1$1=o,o.prototype.encode=function(p,h){return this.tree._encode(p,h).join()};function a(d){t.call(this,"der",d)}n(a,t),a.prototype._encodeComposite=function(p,h,b,m){const v=u(p,h,b,this.reporter);if(m.length<128){const k=e.alloc(2);return k[0]=v,k[1]=m.length,this._createEncoderBuffer([k,m])}let _=1;for(let k=m.length;k>=256;k>>=8)_++;const $=e.alloc(1+1+_);$[0]=v,$[1]=128|_;for(let k=1+_,D=m.length;D>0;k--,D>>=8)$[k]=D&255;return this._createEncoderBuffer([$,m])},a.prototype._encodeStr=function(p,h){if(h==="bitstr")return this._createEncoderBuffer([p.unused|0,p.data]);if(h==="bmpstr"){const b=e.alloc(p.length*2);for(let m=0;m<p.length;m++)b.writeUInt16BE(p.charCodeAt(m),m*2);return this._createEncoderBuffer(b)}else return h==="numstr"?this._isNumstr(p)?this._createEncoderBuffer(p):this.reporter.error("Encoding of string type: numstr supports only digits and space"):h==="printstr"?this._isPrintstr(p)?this._createEncoderBuffer(p):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(h)?this._createEncoderBuffer(p):h==="objDesc"?this._createEncoderBuffer(p):this.reporter.error("Encoding of string type: "+h+" unsupported")},a.prototype._encodeObjid=function(p,h,b){if(typeof p=="string"){if(!h)return this.reporter.error("string objid given, but no values map found");if(!h.hasOwnProperty(p))return this.reporter.error("objid not found in values map");p=h[p].split(/[\s.]+/g);for(let $=0;$<p.length;$++)p[$]|=0}else if(Array.isArray(p)){p=p.slice();for(let $=0;$<p.length;$++)p[$]|=0}if(!Array.isArray(p))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(p));if(!b){if(p[1]>=40)return this.reporter.error("Second objid identifier OOB");p.splice(0,2,p[0]*40+p[1])}let m=0;for(let $=0;$<p.length;$++){let k=p[$];for(m++;k>=128;k>>=7)m++}const v=e.alloc(m);let _=v.length-1;for(let $=p.length-1;$>=0;$--){let k=p[$];for(v[_--]=k&127;(k>>=7)>0;)v[_--]=128|k&127}return this._createEncoderBuffer(v)};function c(d){return d<10?"0"+d:d}a.prototype._encodeTime=function(p,h){let b;const m=new Date(p);return h==="gentime"?b=[c(m.getUTCFullYear()),c(m.getUTCMonth()+1),c(m.getUTCDate()),c(m.getUTCHours()),c(m.getUTCMinutes()),c(m.getUTCSeconds()),"Z"].join(""):h==="utctime"?b=[c(m.getUTCFullYear()%100),c(m.getUTCMonth()+1),c(m.getUTCDate()),c(m.getUTCHours()),c(m.getUTCMinutes()),c(m.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+h+" time is not supported yet"),this._encodeStr(b,"octstr")},a.prototype._encodeNull=function(){return this._createEncoderBuffer("")},a.prototype._encodeInt=function(p,h){if(typeof p=="string"){if(!h)return this.reporter.error("String int or enum given, but no values map");if(!h.hasOwnProperty(p))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(p));p=h[p]}if(typeof p!="number"&&!e.isBuffer(p)){const v=p.toArray();!p.sign&&v[0]&128&&v.unshift(0),p=e.from(v)}if(e.isBuffer(p)){let v=p.length;p.length===0&&v++;const _=e.alloc(v);return p.copy(_),p.length===0&&(_[0]=0),this._createEncoderBuffer(_)}if(p<128)return this._createEncoderBuffer(p);if(p<256)return this._createEncoderBuffer([0,p]);let b=1;for(let v=p;v>=256;v>>=8)b++;const m=new Array(b);for(let v=m.length-1;v>=0;v--)m[v]=p&255,p>>=8;return m[0]&128&&m.unshift(0),this._createEncoderBuffer(e.from(m))},a.prototype._encodeBool=function(p){return this._createEncoderBuffer(p?255:0)},a.prototype._use=function(p,h){return typeof p=="function"&&(p=p(h)),p._getEncoder("der").tree},a.prototype._skipDefault=function(p,h,b){const m=this._baseState;let v;if(m.default===null)return!1;const _=p.join();if(m.defaultBuffer===void 0&&(m.defaultBuffer=this._encodeValue(m.default,h,b).join()),_.length!==m.defaultBuffer.length)return!1;for(v=0;v<_.length;v++)if(_[v]!==m.defaultBuffer[v])return!1;return!0};function u(d,p,h,b){let m;if(d==="seqof"?d="seq":d==="setof"&&(d="set"),i.tagByName.hasOwnProperty(d))m=i.tagByName[d];else if(typeof d=="number"&&(d|0)===d)m=d;else return b.error("Unknown tag: "+d);return m>=31?b.error("Multi-octet tag encoding unsupported"):(p||(m|=32),m|=i.tagClassByName[h||"universal"]<<6,m)}return der_1$1}var pem$1,hasRequiredPem$1;function requirePem$1(){if(hasRequiredPem$1)return pem$1;hasRequiredPem$1=1;const n=inherits_browserExports,e=requireDer$1();function t(i){e.call(this,i),this.enc="pem"}return n(t,e),pem$1=t,t.prototype.encode=function(o,a){const u=e.prototype.encode.call(this,o).toString("base64"),d=["-----BEGIN "+a.label+"-----"];for(let p=0;p<u.length;p+=64)d.push(u.slice(p,p+64));return d.push("-----END "+a.label+"-----"),d.join(`
`)},pem$1}var hasRequiredEncoders;function requireEncoders(){return hasRequiredEncoders||(hasRequiredEncoders=1,function(n){const e=n;e.der=requireDer$1(),e.pem=requirePem$1()}(encoders)),encoders}var decoders={},der_1,hasRequiredDer;function requireDer(){if(hasRequiredDer)return der_1;hasRequiredDer=1;const n=inherits_browserExports,e=bnExports,t=requireBuffer().DecoderBuffer,i=requireNode(),o=requireDer$2();function a(p){this.enc="der",this.name=p.name,this.entity=p,this.tree=new c,this.tree._init(p.body)}der_1=a,a.prototype.decode=function(h,b){return t.isDecoderBuffer(h)||(h=new t(h,b)),this.tree._decode(h,b)};function c(p){i.call(this,"der",p)}n(c,i),c.prototype._peekTag=function(h,b,m){if(h.isEmpty())return!1;const v=h.save(),_=u(h,'Failed to peek tag: "'+b+'"');return h.isError(_)?_:(h.restore(v),_.tag===b||_.tagStr===b||_.tagStr+"of"===b||m)},c.prototype._decodeTag=function(h,b,m){const v=u(h,'Failed to decode tag of "'+b+'"');if(h.isError(v))return v;let _=d(h,v.primitive,'Failed to get length of "'+b+'"');if(h.isError(_))return _;if(!m&&v.tag!==b&&v.tagStr!==b&&v.tagStr+"of"!==b)return h.error('Failed to match tag: "'+b+'"');if(v.primitive||_!==null)return h.skip(_,'Failed to match body of: "'+b+'"');const $=h.save(),k=this._skipUntilEnd(h,'Failed to skip indefinite length body: "'+this.tag+'"');return h.isError(k)?k:(_=h.offset-$.offset,h.restore($),h.skip(_,'Failed to match body of: "'+b+'"'))},c.prototype._skipUntilEnd=function(h,b){for(;;){const m=u(h,b);if(h.isError(m))return m;const v=d(h,m.primitive,b);if(h.isError(v))return v;let _;if(m.primitive||v!==null?_=h.skip(v):_=this._skipUntilEnd(h,b),h.isError(_))return _;if(m.tagStr==="end")break}},c.prototype._decodeList=function(h,b,m,v){const _=[];for(;!h.isEmpty();){const $=this._peekTag(h,"end");if(h.isError($))return $;const k=m.decode(h,"der",v);if(h.isError(k)&&$)break;_.push(k)}return _},c.prototype._decodeStr=function(h,b){if(b==="bitstr"){const m=h.readUInt8();return h.isError(m)?m:{unused:m,data:h.raw()}}else if(b==="bmpstr"){const m=h.raw();if(m.length%2===1)return h.error("Decoding of string type: bmpstr length mismatch");let v="";for(let _=0;_<m.length/2;_++)v+=String.fromCharCode(m.readUInt16BE(_*2));return v}else if(b==="numstr"){const m=h.raw().toString("ascii");return this._isNumstr(m)?m:h.error("Decoding of string type: numstr unsupported characters")}else{if(b==="octstr")return h.raw();if(b==="objDesc")return h.raw();if(b==="printstr"){const m=h.raw().toString("ascii");return this._isPrintstr(m)?m:h.error("Decoding of string type: printstr unsupported characters")}else return/str$/.test(b)?h.raw().toString():h.error("Decoding of string type: "+b+" unsupported")}},c.prototype._decodeObjid=function(h,b,m){let v;const _=[];let $=0,k=0;for(;!h.isEmpty();)k=h.readUInt8(),$<<=7,$|=k&127,k&128||(_.push($),$=0);k&128&&_.push($);const D=_[0]/40|0,O=_[0]%40;if(m?v=_:v=[D,O].concat(_.slice(1)),b){let H=b[v.join(" ")];H===void 0&&(H=b[v.join(".")]),H!==void 0&&(v=H)}return v},c.prototype._decodeTime=function(h,b){const m=h.raw().toString();let v,_,$,k,D,O;if(b==="gentime")v=m.slice(0,4)|0,_=m.slice(4,6)|0,$=m.slice(6,8)|0,k=m.slice(8,10)|0,D=m.slice(10,12)|0,O=m.slice(12,14)|0;else if(b==="utctime")v=m.slice(0,2)|0,_=m.slice(2,4)|0,$=m.slice(4,6)|0,k=m.slice(6,8)|0,D=m.slice(8,10)|0,O=m.slice(10,12)|0,v<70?v=2e3+v:v=1900+v;else return h.error("Decoding "+b+" time is not supported yet");return Date.UTC(v,_-1,$,k,D,O,0)},c.prototype._decodeNull=function(){return null},c.prototype._decodeBool=function(h){const b=h.readUInt8();return h.isError(b)?b:b!==0},c.prototype._decodeInt=function(h,b){const m=h.raw();let v=new e(m);return b&&(v=b[v.toString(10)]||v),v},c.prototype._use=function(h,b){return typeof h=="function"&&(h=h(b)),h._getDecoder("der").tree};function u(p,h){let b=p.readUInt8(h);if(p.isError(b))return b;const m=o.tagClass[b>>6],v=(b&32)===0;if((b&31)===31){let $=b;for(b=0;($&128)===128;){if($=p.readUInt8(h),p.isError($))return $;b<<=7,b|=$&127}}else b&=31;const _=o.tag[b];return{cls:m,primitive:v,tag:b,tagStr:_}}function d(p,h,b){let m=p.readUInt8(b);if(p.isError(m))return m;if(!h&&m===128)return null;if(!(m&128))return m;const v=m&127;if(v>4)return p.error("length octect is too long");m=0;for(let _=0;_<v;_++){m<<=8;const $=p.readUInt8(b);if(p.isError($))return $;m|=$}return m}return der_1}var pem,hasRequiredPem;function requirePem(){if(hasRequiredPem)return pem;hasRequiredPem=1;const n=inherits_browserExports,e=requireSafer().Buffer,t=requireDer();function i(o){t.call(this,o),this.enc="pem"}return n(i,t),pem=i,i.prototype.decode=function(a,c){const u=a.toString().split(/[\r\n]+/g),d=c.label.toUpperCase(),p=/^-----(BEGIN|END) ([^-]+)-----$/;let h=-1,b=-1;for(let _=0;_<u.length;_++){const $=u[_].match(p);if($!==null&&$[2]===d)if(h===-1){if($[1]!=="BEGIN")break;h=_}else{if($[1]!=="END")break;b=_;break}}if(h===-1||b===-1)throw new Error("PEM section not found for: "+d);const m=u.slice(h+1,b).join("");m.replace(/[^a-z0-9+/=]+/gi,"");const v=e.from(m,"base64");return t.prototype.decode.call(this,v,c)},pem}var hasRequiredDecoders;function requireDecoders(){return hasRequiredDecoders||(hasRequiredDecoders=1,function(n){const e=n;e.der=requireDer(),e.pem=requirePem()}(decoders)),decoders}var hasRequiredApi;function requireApi(){return hasRequiredApi||(hasRequiredApi=1,function(n){const e=requireEncoders(),t=requireDecoders(),i=inherits_browserExports,o=n;o.define=function(u,d){return new a(u,d)};function a(c,u){this.name=c,this.body=u,this.decoders={},this.encoders={}}a.prototype._createNamed=function(u){const d=this.name;function p(h){this._initNamed(h,d)}return i(p,u),p.prototype._initNamed=function(b,m){u.call(this,b,m)},new p(this)},a.prototype._getDecoder=function(u){return u=u||"der",this.decoders.hasOwnProperty(u)||(this.decoders[u]=this._createNamed(t[u])),this.decoders[u]},a.prototype.decode=function(u,d,p){return this._getDecoder(d).decode(u,p)},a.prototype._getEncoder=function(u){return u=u||"der",this.encoders.hasOwnProperty(u)||(this.encoders[u]=this._createNamed(e[u])),this.encoders[u]},a.prototype.encode=function(u,d,p){return this._getEncoder(d).encode(u,p)}}(api$1)),api$1}var base$2={},hasRequiredBase;function requireBase(){return hasRequiredBase||(hasRequiredBase=1,function(n){const e=n;e.Reporter=requireReporter().Reporter,e.DecoderBuffer=requireBuffer().DecoderBuffer,e.EncoderBuffer=requireBuffer().EncoderBuffer,e.Node=requireNode()}(base$2)),base$2}var constants={},hasRequiredConstants;function requireConstants(){return hasRequiredConstants||(hasRequiredConstants=1,function(n){const e=n;e._reverse=function(i){const o={};return Object.keys(i).forEach(function(a){(a|0)==a&&(a=a|0);const c=i[a];o[c]=a}),o},e.der=requireDer$2()}(constants)),constants}var hasRequiredAsn1$1;function requireAsn1$1(){return hasRequiredAsn1$1||(hasRequiredAsn1$1=1,function(n){const e=n;e.bignum=bnExports,e.define=requireApi().define,e.base=requireBase(),e.constants=requireConstants(),e.decoders=requireDecoders(),e.encoders=requireEncoders()}(asn1)),asn1}var certificate,hasRequiredCertificate;function requireCertificate(){if(hasRequiredCertificate)return certificate;hasRequiredCertificate=1;var n=requireAsn1$1(),e=n.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),t=n.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),i=n.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),o=n.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(i),this.key("subjectPublicKey").bitstr())}),a=n.define("RelativeDistinguishedName",function(){this.setof(t)}),c=n.define("RDNSequence",function(){this.seqof(a)}),u=n.define("Name",function(){this.choice({rdnSequence:this.use(c)})}),d=n.define("Validity",function(){this.seq().obj(this.key("notBefore").use(e),this.key("notAfter").use(e))}),p=n.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),h=n.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(i),this.key("issuer").use(u),this.key("validity").use(d),this.key("subject").use(u),this.key("subjectPublicKeyInfo").use(o),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(p).optional())}),b=n.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(h),this.key("signatureAlgorithm").use(i),this.key("signatureValue").bitstr())});return certificate=b,certificate}var hasRequiredAsn1;function requireAsn1(){if(hasRequiredAsn1)return asn1$1;hasRequiredAsn1=1;var n=requireAsn1$1();asn1$1.certificate=requireCertificate();var e=n.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});asn1$1.RSAPrivateKey=e;var t=n.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});asn1$1.RSAPublicKey=t;var i=n.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(o),this.key("subjectPublicKey").bitstr())});asn1$1.PublicKey=i;var o=n.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),a=n.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(o),this.key("subjectPrivateKey").octstr())});asn1$1.PrivateKey=a;var c=n.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});asn1$1.EncryptedPrivateKey=c;var u=n.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});asn1$1.DSAPrivateKey=u,asn1$1.DSAparam=n.define("DSAparam",function(){this.int()});var d=n.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(p),this.key("publicKey").optional().explicit(1).bitstr())});asn1$1.ECPrivateKey=d;var p=n.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});return asn1$1.signature=n.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())}),asn1$1}const require$$1={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"};var fixProc,hasRequiredFixProc;function requireFixProc(){if(hasRequiredFixProc)return fixProc;hasRequiredFixProc=1;var n=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,e=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,t=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,i=requireEvp_bytestokey(),o=requireBrowser$6(),a=safeBufferExports.Buffer;return fixProc=function(c,u){var d=c.toString(),p=d.match(n),h;if(p){var m="aes"+p[1],v=a.from(p[2],"hex"),_=a.from(p[3].replace(/[\r\n]/g,""),"base64"),$=i(u,v.slice(0,8),parseInt(p[1],10)).key,k=[],D=o.createDecipheriv(m,$,v);k.push(D.update(_)),k.push(D.final()),h=a.concat(k)}else{var b=d.match(t);h=a.from(b[2].replace(/[\r\n]/g,""),"base64")}var O=d.match(e)[1];return{tag:O,data:h}},fixProc}var parseAsn1,hasRequiredParseAsn1;function requireParseAsn1(){if(hasRequiredParseAsn1)return parseAsn1;hasRequiredParseAsn1=1;var n=requireAsn1(),e=require$$1,t=requireFixProc(),i=requireBrowser$6(),o=requireBrowser$7(),a=safeBufferExports.Buffer;parseAsn1=c;function c(d){var p;typeof d=="object"&&!a.isBuffer(d)&&(p=d.passphrase,d=d.key),typeof d=="string"&&(d=a.from(d));var h=t(d,p),b=h.tag,m=h.data,v,_;switch(b){case"CERTIFICATE":_=n.certificate.decode(m,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(_||(_=n.PublicKey.decode(m,"der")),v=_.algorithm.algorithm.join("."),v){case"1.2.840.113549.1.1.1":return n.RSAPublicKey.decode(_.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return _.subjectPrivateKey=_.subjectPublicKey,{type:"ec",data:_};case"1.2.840.10040.4.1":return _.algorithm.params.pub_key=n.DSAparam.decode(_.subjectPublicKey.data,"der"),{type:"dsa",data:_.algorithm.params};default:throw new Error("unknown key id "+v)}case"ENCRYPTED PRIVATE KEY":m=n.EncryptedPrivateKey.decode(m,"der"),m=u(m,p);case"PRIVATE KEY":switch(_=n.PrivateKey.decode(m,"der"),v=_.algorithm.algorithm.join("."),v){case"1.2.840.113549.1.1.1":return n.RSAPrivateKey.decode(_.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:_.algorithm.curve,privateKey:n.ECPrivateKey.decode(_.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return _.algorithm.params.priv_key=n.DSAparam.decode(_.subjectPrivateKey,"der"),{type:"dsa",params:_.algorithm.params};default:throw new Error("unknown key id "+v)}case"RSA PUBLIC KEY":return n.RSAPublicKey.decode(m,"der");case"RSA PRIVATE KEY":return n.RSAPrivateKey.decode(m,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:n.DSAPrivateKey.decode(m,"der")};case"EC PRIVATE KEY":return m=n.ECPrivateKey.decode(m,"der"),{curve:m.parameters.value,privateKey:m.privateKey};default:throw new Error("unknown key type "+b)}}c.signature=n.signature;function u(d,p){var h=d.algorithm.decrypt.kde.kdeparams.salt,b=parseInt(d.algorithm.decrypt.kde.kdeparams.iters.toString(),10),m=e[d.algorithm.decrypt.cipher.algo.join(".")],v=d.algorithm.decrypt.cipher.iv,_=d.subjectPrivateKey,$=parseInt(m.split("-")[1],10)/8,k=o.pbkdf2Sync(p,h,b,$,"sha1"),D=i.createDecipheriv(m,k,v),O=[];return O.push(D.update(_)),O.push(D.final()),a.concat(O)}return parseAsn1}const require$$4={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"};var hasRequiredSign;function requireSign(){if(hasRequiredSign)return sign$2.exports;hasRequiredSign=1;var n=safeBufferExports.Buffer,e=requireBrowser$8(),t=requireBrowserifyRsa(),i=requireElliptic().ec,o=requireBn(),a=requireParseAsn1(),c=require$$4;function u(k,D,O,H,j){var W=a(D);if(W.curve){if(H!=="ecdsa"&&H!=="ecdsa/rsa")throw new Error("wrong private key type");return d(k,W)}else if(W.type==="dsa"){if(H!=="dsa")throw new Error("wrong private key type");return p(k,W,O)}else if(H!=="rsa"&&H!=="ecdsa/rsa")throw new Error("wrong private key type");k=n.concat([j,k]);for(var ae=W.modulus.byteLength(),fe=[0,1];k.length+fe.length+1<ae;)fe.push(255);fe.push(0);for(var pe=-1;++pe<k.length;)fe.push(k[pe]);var ve=t(fe,W);return ve}function d(k,D){var O=c[D.curve.join(".")];if(!O)throw new Error("unknown curve "+D.curve.join("."));var H=new i(O),j=H.keyFromPrivate(D.privateKey),W=j.sign(k);return n.from(W.toDER())}function p(k,D,O){for(var H=D.params.priv_key,j=D.params.p,W=D.params.q,ae=D.params.g,fe=new o(0),pe,ve=m(k,W).mod(W),Qe=!1,re=b(H,W,k,O);Qe===!1;)pe=_(W,re,O),fe=$(ae,pe,j,W),Qe=pe.invm(W).imul(ve.add(H.mul(fe))).mod(W),Qe.cmpn(0)===0&&(Qe=!1,fe=new o(0));return h(fe,Qe)}function h(k,D){k=k.toArray(),D=D.toArray(),k[0]&128&&(k=[0].concat(k)),D[0]&128&&(D=[0].concat(D));var O=k.length+D.length+4,H=[48,O,2,k.length];return H=H.concat(k,[2,D.length],D),n.from(H)}function b(k,D,O,H){if(k=n.from(k.toArray()),k.length<D.byteLength()){var j=n.alloc(D.byteLength()-k.length);k=n.concat([j,k])}var W=O.length,ae=v(O,D),fe=n.alloc(W);fe.fill(1);var pe=n.alloc(W);return pe=e(H,pe).update(fe).update(n.from([0])).update(k).update(ae).digest(),fe=e(H,pe).update(fe).digest(),pe=e(H,pe).update(fe).update(n.from([1])).update(k).update(ae).digest(),fe=e(H,pe).update(fe).digest(),{k:pe,v:fe}}function m(k,D){var O=new o(k),H=(k.length<<3)-D.bitLength();return H>0&&O.ishrn(H),O}function v(k,D){k=m(k,D),k=k.mod(D);var O=n.from(k.toArray());if(O.length<D.byteLength()){var H=n.alloc(D.byteLength()-O.length);O=n.concat([H,O])}return O}function _(k,D,O){var H,j;do{for(H=n.alloc(0);H.length*8<k.bitLength();)D.v=e(O,D.k).update(D.v).digest(),H=n.concat([H,D.v]);j=m(H,k),D.k=e(O,D.k).update(D.v).update(n.from([0])).digest(),D.v=e(O,D.k).update(D.v).digest()}while(j.cmp(k)!==-1);return j}function $(k,D,O,H){return k.toRed(o.mont(O)).redPow(D).fromRed().mod(H)}return sign$2.exports=u,sign$2.exports.getKey=b,sign$2.exports.makeKey=_,sign$2.exports}var verify_1,hasRequiredVerify;function requireVerify(){if(hasRequiredVerify)return verify_1;hasRequiredVerify=1;var n=safeBufferExports.Buffer,e=requireBn(),t=requireElliptic().ec,i=requireParseAsn1(),o=require$$4;function a(p,h,b,m,v){var _=i(b);if(_.type==="ec"){if(m!=="ecdsa"&&m!=="ecdsa/rsa")throw new Error("wrong public key type");return c(p,h,_)}else if(_.type==="dsa"){if(m!=="dsa")throw new Error("wrong public key type");return u(p,h,_)}else if(m!=="rsa"&&m!=="ecdsa/rsa")throw new Error("wrong public key type");h=n.concat([v,h]);for(var $=_.modulus.byteLength(),k=[1],D=0;h.length+k.length+2<$;)k.push(255),D++;k.push(0);for(var O=-1;++O<h.length;)k.push(h[O]);k=n.from(k);var H=e.mont(_.modulus);p=new e(p).toRed(H),p=p.redPow(new e(_.publicExponent)),p=n.from(p.fromRed().toArray());var j=D<8?1:0;for($=Math.min(p.length,k.length),p.length!==k.length&&(j=1),O=-1;++O<$;)j|=p[O]^k[O];return j===0}function c(p,h,b){var m=o[b.data.algorithm.curve.join(".")];if(!m)throw new Error("unknown curve "+b.data.algorithm.curve.join("."));var v=new t(m),_=b.data.subjectPrivateKey.data;return v.verify(h,p,_)}function u(p,h,b){var m=b.data.p,v=b.data.q,_=b.data.g,$=b.data.pub_key,k=i.signature.decode(p,"der"),D=k.s,O=k.r;d(D,v),d(O,v);var H=e.mont(m),j=D.invm(v),W=_.toRed(H).redPow(new e(h).mul(j).mod(v)).fromRed().mul($.toRed(H).redPow(O.mul(j).mod(v)).fromRed()).mod(m).mod(v);return W.cmp(O)===0}function d(p,h){if(p.cmpn(0)<=0)throw new Error("invalid sig");if(p.cmp(h)>=h)throw new Error("invalid sig")}return verify_1=a,verify_1}var browser$3,hasRequiredBrowser$3;function requireBrowser$3(){if(hasRequiredBrowser$3)return browser$3;hasRequiredBrowser$3=1;var n=safeBufferExports.Buffer,e=requireBrowser$9(),t=requireReadableBrowser(),i=inherits_browserExports,o=requireSign(),a=requireVerify(),c=require$$6;Object.keys(c).forEach(function(b){c[b].id=n.from(c[b].id,"hex"),c[b.toLowerCase()]=c[b]});function u(b){t.Writable.call(this);var m=c[b];if(!m)throw new Error("Unknown message digest");this._hashType=m.hash,this._hash=e(m.hash),this._tag=m.id,this._signType=m.sign}i(u,t.Writable),u.prototype._write=function(m,v,_){this._hash.update(m),_()},u.prototype.update=function(m,v){return typeof m=="string"&&(m=n.from(m,v)),this._hash.update(m),this},u.prototype.sign=function(m,v){this.end();var _=this._hash.digest(),$=o(_,m,this._hashType,this._signType,this._tag);return v?$.toString(v):$};function d(b){t.Writable.call(this);var m=c[b];if(!m)throw new Error("Unknown message digest");this._hash=e(m.hash),this._tag=m.id,this._signType=m.sign}i(d,t.Writable),d.prototype._write=function(m,v,_){this._hash.update(m),_()},d.prototype.update=function(m,v){return typeof m=="string"&&(m=n.from(m,v)),this._hash.update(m),this},d.prototype.verify=function(m,v,_){typeof v=="string"&&(v=n.from(v,_)),this.end();var $=this._hash.digest();return a(v,$,m,this._signType,this._tag)};function p(b){return new u(b)}function h(b){return new d(b)}return browser$3={Sign:p,Verify:h,createSign:p,createVerify:h},browser$3}var browser$2,hasRequiredBrowser$2;function requireBrowser$2(){if(hasRequiredBrowser$2)return browser$2;hasRequiredBrowser$2=1;var n=requireElliptic(),e=bnExports;browser$2=function(c){return new i(c)};var t={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};t.p224=t.secp224r1,t.p256=t.secp256r1=t.prime256v1,t.p192=t.secp192r1=t.prime192v1,t.p384=t.secp384r1,t.p521=t.secp521r1;function i(a){this.curveType=t[a],this.curveType||(this.curveType={name:a}),this.curve=new n.ec(this.curveType.name),this.keys=void 0}i.prototype.generateKeys=function(a,c){return this.keys=this.curve.genKeyPair(),this.getPublicKey(a,c)},i.prototype.computeSecret=function(a,c,u){c=c||"utf8",buffer$2.Buffer.isBuffer(a)||(a=new buffer$2.Buffer(a,c));var d=this.curve.keyFromPublic(a).getPublic(),p=d.mul(this.keys.getPrivate()).getX();return o(p,u,this.curveType.byteLength)},i.prototype.getPublicKey=function(a,c){var u=this.keys.getPublic(c==="compressed",!0);return c==="hybrid"&&(u[u.length-1]%2?u[0]=7:u[0]=6),o(u,a)},i.prototype.getPrivateKey=function(a){return o(this.keys.getPrivate(),a)},i.prototype.setPublicKey=function(a,c){return c=c||"utf8",buffer$2.Buffer.isBuffer(a)||(a=new buffer$2.Buffer(a,c)),this.keys._importPublic(a),this},i.prototype.setPrivateKey=function(a,c){c=c||"utf8",buffer$2.Buffer.isBuffer(a)||(a=new buffer$2.Buffer(a,c));var u=new e(a);return u=u.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(u),this};function o(a,c,u){Array.isArray(a)||(a=a.toArray());var d=new buffer$2.Buffer(a);if(u&&d.length<u){var p=new buffer$2.Buffer(u-d.length);p.fill(0),d=buffer$2.Buffer.concat([p,d])}return c?d.toString(c):d}return browser$2}var browser$1={},mgf,hasRequiredMgf;function requireMgf(){if(hasRequiredMgf)return mgf;hasRequiredMgf=1;var n=requireBrowser$9(),e=safeBufferExports.Buffer;mgf=function(i,o){for(var a=e.alloc(0),c=0,u;a.length<o;)u=t(c++),a=e.concat([a,n("sha1").update(i).update(u).digest()]);return a.slice(0,o)};function t(i){var o=e.allocUnsafe(4);return o.writeUInt32BE(i,0),o}return mgf}var xor,hasRequiredXor;function requireXor(){return hasRequiredXor||(hasRequiredXor=1,xor=function(e,t){for(var i=e.length,o=-1;++o<i;)e[o]^=t[o];return e}),xor}var withPublic_1,hasRequiredWithPublic;function requireWithPublic(){if(hasRequiredWithPublic)return withPublic_1;hasRequiredWithPublic=1;var n=bnExports,e=safeBufferExports.Buffer;function t(i,o){return e.from(i.toRed(n.mont(o.modulus)).redPow(new n(o.publicExponent)).fromRed().toArray())}return withPublic_1=t,withPublic_1}var publicEncrypt,hasRequiredPublicEncrypt;function requirePublicEncrypt(){if(hasRequiredPublicEncrypt)return publicEncrypt;hasRequiredPublicEncrypt=1;var n=requireParseAsn1(),e=requireBrowser$b(),t=requireBrowser$9(),i=requireMgf(),o=requireXor(),a=bnExports,c=requireWithPublic(),u=requireBrowserifyRsa(),d=safeBufferExports.Buffer;publicEncrypt=function(v,_,$){var k;v.padding?k=v.padding:$?k=1:k=4;var D=n(v),O;if(k===4)O=p(D,_);else if(k===1)O=h(D,_,$);else if(k===3){if(O=new a(_),O.cmp(D.modulus)>=0)throw new Error("data too long for modulus")}else throw new Error("unknown padding");return $?u(O,D):c(O,D)};function p(m,v){var _=m.modulus.byteLength(),$=v.length,k=t("sha1").update(d.alloc(0)).digest(),D=k.length,O=2*D;if($>_-O-2)throw new Error("message too long");var H=d.alloc(_-$-O-2),j=_-D-1,W=e(D),ae=o(d.concat([k,H,d.alloc(1,1),v],j),i(W,j)),fe=o(W,i(ae,D));return new a(d.concat([d.alloc(1),fe,ae],_))}function h(m,v,_){var $=v.length,k=m.modulus.byteLength();if($>k-11)throw new Error("message too long");var D;return _?D=d.alloc(k-$-3,255):D=b(k-$-3),new a(d.concat([d.from([0,_?1:2]),D,d.alloc(1),v],k))}function b(m){for(var v=d.allocUnsafe(m),_=0,$=e(m*2),k=0,D;_<m;)k===$.length&&($=e(m*2),k=0),D=$[k++],D&&(v[_++]=D);return v}return publicEncrypt}var privateDecrypt,hasRequiredPrivateDecrypt;function requirePrivateDecrypt(){if(hasRequiredPrivateDecrypt)return privateDecrypt;hasRequiredPrivateDecrypt=1;var n=requireParseAsn1(),e=requireMgf(),t=requireXor(),i=bnExports,o=requireBrowserifyRsa(),a=requireBrowser$9(),c=requireWithPublic(),u=safeBufferExports.Buffer;privateDecrypt=function(m,v,_){var $;m.padding?$=m.padding:_?$=1:$=4;var k=n(m),D=k.modulus.byteLength();if(v.length>D||new i(v).cmp(k.modulus)>=0)throw new Error("decryption error");var O;_?O=c(new i(v),k):O=o(v,k);var H=u.alloc(D-O.length);if(O=u.concat([H,O],D),$===4)return d(k,O);if($===1)return p(k,O,_);if($===3)return O;throw new Error("unknown padding")};function d(b,m){var v=b.modulus.byteLength(),_=a("sha1").update(u.alloc(0)).digest(),$=_.length;if(m[0]!==0)throw new Error("decryption error");var k=m.slice(1,$+1),D=m.slice($+1),O=t(k,e(D,$)),H=t(D,e(O,v-$-1));if(h(_,H.slice(0,$)))throw new Error("decryption error");for(var j=$;H[j]===0;)j++;if(H[j++]!==1)throw new Error("decryption error");return H.slice(j)}function p(b,m,v){for(var _=m.slice(0,2),$=2,k=0;m[$++]!==0;)if($>=m.length){k++;break}var D=m.slice(2,$-1);if((_.toString("hex")!=="0002"&&!v||_.toString("hex")!=="0001"&&v)&&k++,D.length<8&&k++,k)throw new Error("decryption error");return m.slice($)}function h(b,m){b=u.from(b),m=u.from(m);var v=0,_=b.length;b.length!==m.length&&(v++,_=Math.min(b.length,m.length));for(var $=-1;++$<_;)v+=b[$]^m[$];return v}return privateDecrypt}var hasRequiredBrowser$1;function requireBrowser$1(){return hasRequiredBrowser$1||(hasRequiredBrowser$1=1,function(n){n.publicEncrypt=requirePublicEncrypt(),n.privateDecrypt=requirePrivateDecrypt(),n.privateEncrypt=function(t,i){return n.publicEncrypt(t,i,!0)},n.publicDecrypt=function(t,i){return n.privateDecrypt(t,i,!0)}}(browser$1)),browser$1}var browser={},hasRequiredBrowser;function requireBrowser(){if(hasRequiredBrowser)return browser;hasRequiredBrowser=1;function n(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var e=safeBufferExports,t=requireBrowser$b(),i=e.Buffer,o=e.kMaxLength,a=commonjsGlobal.crypto||commonjsGlobal.msCrypto,c=Math.pow(2,32)-1;function u(m,v){if(typeof m!="number"||m!==m)throw new TypeError("offset must be a number");if(m>c||m<0)throw new TypeError("offset must be a uint32");if(m>o||m>v)throw new RangeError("offset out of range")}function d(m,v,_){if(typeof m!="number"||m!==m)throw new TypeError("size must be a number");if(m>c||m<0)throw new TypeError("size must be a uint32");if(m+v>_||m>o)throw new RangeError("buffer too small")}a&&a.getRandomValues||!process$3.browser?(browser.randomFill=p,browser.randomFillSync=b):(browser.randomFill=n,browser.randomFillSync=n);function p(m,v,_,$){if(!i.isBuffer(m)&&!(m instanceof commonjsGlobal.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof v=="function")$=v,v=0,_=m.length;else if(typeof _=="function")$=_,_=m.length-v;else if(typeof $!="function")throw new TypeError('"cb" argument must be a function');return u(v,m.length),d(_,v,m.length),h(m,v,_,$)}function h(m,v,_,$){if(process$3.browser){var k=m.buffer,D=new Uint8Array(k,v,_);if(a.getRandomValues(D),$){process$3.nextTick(function(){$(null,m)});return}return m}if($){t(_,function(H,j){if(H)return $(H);j.copy(m,v),$(null,m)});return}var O=t(_);return O.copy(m,v),m}function b(m,v,_){if(typeof v>"u"&&(v=0),!i.isBuffer(m)&&!(m instanceof commonjsGlobal.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return u(v,m.length),_===void 0&&(_=m.length-v),d(_,v,m.length),h(m,v,_)}return browser}var hasRequiredCryptoBrowserify;function requireCryptoBrowserify(){if(hasRequiredCryptoBrowserify)return cryptoBrowserify;hasRequiredCryptoBrowserify=1,cryptoBrowserify.randomBytes=cryptoBrowserify.rng=cryptoBrowserify.pseudoRandomBytes=cryptoBrowserify.prng=requireBrowser$b(),cryptoBrowserify.createHash=cryptoBrowserify.Hash=requireBrowser$9(),cryptoBrowserify.createHmac=cryptoBrowserify.Hmac=requireBrowser$8();var n=requireAlgos(),e=Object.keys(n),t=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(e);cryptoBrowserify.getHashes=function(){return t};var i=requireBrowser$7();cryptoBrowserify.pbkdf2=i.pbkdf2,cryptoBrowserify.pbkdf2Sync=i.pbkdf2Sync;var o=requireBrowser$5();cryptoBrowserify.Cipher=o.Cipher,cryptoBrowserify.createCipher=o.createCipher,cryptoBrowserify.Cipheriv=o.Cipheriv,cryptoBrowserify.createCipheriv=o.createCipheriv,cryptoBrowserify.Decipher=o.Decipher,cryptoBrowserify.createDecipher=o.createDecipher,cryptoBrowserify.Decipheriv=o.Decipheriv,cryptoBrowserify.createDecipheriv=o.createDecipheriv,cryptoBrowserify.getCiphers=o.getCiphers,cryptoBrowserify.listCiphers=o.listCiphers;var a=requireBrowser$4();cryptoBrowserify.DiffieHellmanGroup=a.DiffieHellmanGroup,cryptoBrowserify.createDiffieHellmanGroup=a.createDiffieHellmanGroup,cryptoBrowserify.getDiffieHellman=a.getDiffieHellman,cryptoBrowserify.createDiffieHellman=a.createDiffieHellman,cryptoBrowserify.DiffieHellman=a.DiffieHellman;var c=requireBrowser$3();cryptoBrowserify.createSign=c.createSign,cryptoBrowserify.Sign=c.Sign,cryptoBrowserify.createVerify=c.createVerify,cryptoBrowserify.Verify=c.Verify,cryptoBrowserify.createECDH=requireBrowser$2();var u=requireBrowser$1();cryptoBrowserify.publicEncrypt=u.publicEncrypt,cryptoBrowserify.privateEncrypt=u.privateEncrypt,cryptoBrowserify.publicDecrypt=u.publicDecrypt,cryptoBrowserify.privateDecrypt=u.privateDecrypt;var d=requireBrowser();return cryptoBrowserify.randomFill=d.randomFill,cryptoBrowserify.randomFillSync=d.randomFillSync,cryptoBrowserify.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},cryptoBrowserify.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6},cryptoBrowserify}function concat$1(n,e){e==null&&(e=n.reduce((o,a)=>o+a.length,0));const t=allocUnsafe$2(e);let i=0;for(const o of n)t.set(o,i),i+=o.length;return asUint8Array$2(t)}debug.formatters.b=n=>n==null?"undefined":base58btc$3.baseEncode(n);debug.formatters.t=n=>n==null?"undefined":base32$6.baseEncode(n);debug.formatters.m=n=>n==null?"undefined":base64$8.baseEncode(n);debug.formatters.p=n=>n==null?"undefined":n.toString();debug.formatters.c=n=>n==null?"undefined":n.toString();debug.formatters.k=n=>n==null?"undefined":n.toString();debug.formatters.a=n=>n==null?"undefined":n.toString();function createDisabledLogger(n){const e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=n,e.destroy=()=>!0,e.extend=()=>e,e}function logger(n){let e=createDisabledLogger(`${n}:trace`);return debug.enabled(`${n}:trace`)&&debug.names.map(t=>t.toString()).find(t=>t.includes(":trace"))!=null&&(e=debug(`${n}:trace`)),Object.assign(debug(n),{error:debug(`${n}:error`),trace:e})}async function all(n){const e=[];for await(const t of n)e.push(t);return e}const sortAll$1=(n,e)=>async function*(){yield*(await all(n)).sort(e)}();async function drain$2(n){for await(const e of n);}async function*filter$2(n,e){for await(const t of n)await e(t)&&(yield t)}async function*take$2(n,e){let t=0;if(!(e<1)){for await(const i of n)if(yield i,t++,t===e)return}}class BaseDatastore{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,i){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:i,value:o}of e)await this.put(i,o,t),yield{key:i,value:o}}async*getMany(e,t={}){for await(const i of e)yield this.get(i,t)}async*deleteMany(e,t={}){for await(const i of e)await this.delete(i,t),yield i}batch(){let e=[],t=[];return{put(i,o){e.push({key:i,value:o})},delete(i){t.push(i)},commit:async i=>{await drain$2(this.putMany(e,i)),e=[],await drain$2(this.deleteMany(t,i)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let i=this._all(e,t);if(e.prefix!=null&&(i=filter$2(i,o=>o.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((o,a)=>filter$2(o,a),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((o,a)=>sortAll$1(o,a),i)),e.offset!=null){let o=0;i=filter$2(i,()=>o++>=e.offset)}return e.limit!=null&&(i=take$2(i,e.limit)),i}queryKeys(e,t){let i=this._allKeys(e,t);if(e.prefix!=null&&(i=filter$2(i,o=>o.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((o,a)=>filter$2(o,a),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((o,a)=>sortAll$1(o,a),i)),e.offset!=null){let o=0;i=filter$2(i,()=>o++>=e.offset)}return e.limit!=null&&(i=take$2(i,e.limit)),i}}class FixedFIFO{constructor(e){if(!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}}class FIFO{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new FixedFIFO(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new FixedFIFO(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}function pushable(n={}){return _pushable(t=>{const i=t.shift();if(i==null)return{done:!0};if(i.error!=null)throw i.error;return{done:i.done===!0,value:i.value}},n)}function _pushable(n,e){e=e??{};let t=e.onEnd,i=new FIFO,o,a,c;const u=async()=>i.isEmpty()?c?{done:!0}:await new Promise(($,k)=>{a=D=>{a=null,i.push(D);try{$(n(i))}catch(O){k(O)}return o}}):n(i),d=$=>a!=null?a($):(i.push($),o),p=$=>(i=new FIFO,a!=null?a({error:$}):(i.push({error:$}),o)),h=$=>{if(c)return o;if(e?.objectMode!==!0&&$?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return d({done:!1,value:$})},b=$=>c?o:(c=!0,$!=null?p($):d({done:!0})),m=()=>(i=new FIFO,b(),{done:!0}),v=$=>(b($),{done:!0});if(o={[Symbol.asyncIterator](){return this},next:u,return:m,throw:v,push:h,end:b,get readableLength(){return i.size}},t==null)return o;const _=o;return o={[Symbol.asyncIterator](){return this},next(){return _.next()},throw($){return _.throw($),t!=null&&(t($),t=void 0),{done:!0}},return(){return _.return(),t!=null&&(t(),t=void 0),{done:!0}},push:h,end($){return _.end($),t!=null&&(t($),t=void 0),o},get readableLength(){return _.readableLength}},o}logger("datastore:core:tiered");const SHARDING_FN="SHARDING",README_FN="_README";class MemoryDatastore extends BaseDatastore{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){if(!await this.has(e))throw notFoundError();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:new Key(e),value:t}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new Key(e))}}async function*map$2(n,e){for await(const t of n)yield e(t)}async function*merge$2(...n){const e=pushable({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(n.map(async t=>{for await(const i of t)e.push(i)})),e.end()}catch(t){e.end(t)}}),yield*e}const rawPipe=(...n)=>{let e;for(;n.length>0;)e=n.shift()(e);return e},isIterable=n=>n!=null&&(typeof n[Symbol.asyncIterator]=="function"||typeof n[Symbol.iterator]=="function"||typeof n.next=="function"),isDuplex=n=>n!=null&&typeof n.sink=="function"&&isIterable(n.source),duplexPipelineFn=n=>e=>{const t=n.sink(e);if(t.then!=null){const i=pushable({objectMode:!0});return t.then(()=>{i.end()},a=>{i.end(a)}),merge$2(i,async function*(){yield*n.source,i.end()}())}return n.source};function pipe(n,...e){if(isDuplex(n)){const i=n;n=()=>i.source}else if(isIterable(n)){const i=n;n=()=>i}const t=[n,...e];if(t.length>1&&isDuplex(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let i=1;i<t.length-1;i++)isDuplex(t[i])&&(t[i]=duplexPipelineFn(t[i]));return rawPipe(...t)}new Key(SHARDING_FN);new Key(README_FN);async function*batch(n,e=1){let t=[];e<1&&(e=1);for await(const i of n)for(t.push(i);t.length>=e;)yield t.slice(0,e),t=t.slice(e);for(;t.length>0;)yield t.slice(0,e),t=t.slice(e)}async function*parallelBatch(n,e=1){for await(const t of batch(n,e)){const i=t.map(async o=>await o().then(a=>({ok:!0,value:a}),a=>({ok:!1,err:a})));for(let o=0;o<i.length;o++){const a=await i[o];if(a.ok)yield a.value;else throw a.err}}}function compare(n,e){for(let t=0;t<n.byteLength;t++){if(n[t]<e[t])return-1;if(n[t]>e[t])return 1}return n.byteLength>e.byteLength?1:n.byteLength<e.byteLength?-1:0}var objectSafeSet=set;function set(n,e,t){var i,o;if(Array.isArray(e)&&(i=e.slice(0)),typeof e=="string"&&(i=e.split(".")),typeof e=="symbol"&&(i=[e]),!Array.isArray(i))throw new Error("props arg must be an array, a string or a symbol");if(o=i.pop(),!o)return!1;prototypeCheck(o);for(var a;a=i.shift();)if(prototypeCheck(a),typeof n[a]>"u"&&(n[a]={}),n=n[a],!n||typeof n!="object")return!1;return n[o]=t,!0}function prototypeCheck(n){if(n=="__proto__"||n=="constructor"||n=="prototype")throw new Error("setting of prototype values not supported")}async function first(n){for await(const e of n)return e}class TimeoutError extends Error{constructor(e){super(e),this.name="TimeoutError"}}class AbortError extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const getDOMException=n=>globalThis.DOMException===void 0?new AbortError(n):new DOMException(n),getAbortedReason=n=>{const e=n.reason===void 0?getDOMException("This operation was aborted."):n.reason;return e instanceof Error?e:getDOMException(e)};function pTimeout(n,e){const{milliseconds:t,fallback:i,message:o,customTimers:a={setTimeout,clearTimeout}}=e;let c;const u=new Promise((d,p)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t===Number.POSITIVE_INFINITY){d(n);return}if(e.signal){const{signal:b}=e;b.aborted&&p(getAbortedReason(b)),b.addEventListener("abort",()=>{p(getAbortedReason(b))})}const h=new TimeoutError;c=a.setTimeout.call(void 0,()=>{if(i){try{d(i())}catch(b){p(b)}return}typeof n.cancel=="function"&&n.cancel(),o===!1?d():o instanceof Error?p(o):(h.message=o??`Promise timed out after ${t} milliseconds`,p(h))},t),(async()=>{try{d(await n)}catch(b){p(b)}finally{a.clearTimeout.call(void 0,c)}})()});return u.clear=()=>{a.clearTimeout.call(void 0,c),c=void 0},u}const WORKER_REQUEST_READ_LOCK="lock:worker:request-read",WORKER_RELEASE_READ_LOCK="lock:worker:release-read",MASTER_GRANT_READ_LOCK="lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK="lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK="lock:worker:release-write",MASTER_GRANT_WRITE_LOCK="lock:master:grant-write",events={},observable=n=>{n.addEventListener("message",e=>{observable.dispatchEvent("message",n,e)}),n.port!=null&&n.port.addEventListener("message",e=>{observable.dispatchEvent("message",n,e)})};observable.addEventListener=(n,e)=>{events[n]==null&&(events[n]=[]),events[n].push(e)};observable.removeEventListener=(n,e)=>{events[n]!=null&&(events[n]=events[n].filter(t=>t===e))};observable.dispatchEvent=function(n,e,t){events[n]!=null&&events[n].forEach(i=>i(e,t))};const handleWorkerLockRequest=(n,e,t,i,o)=>(a,c)=>{if(c.data.type!==t)return;const u={type:c.data.type,name:c.data.name,identifier:c.data.identifier};n.dispatchEvent(new MessageEvent(e,{data:{name:u.name,handler:async()=>(a.postMessage({type:o,name:u.name,identifier:u.identifier}),await new Promise(d=>{const p=h=>{if(h==null||h.data==null)return;const b={type:h.data.type,name:h.data.name,identifier:h.data.identifier};b.type===i&&b.identifier===u.identifier&&(a.removeEventListener("message",p),d())};a.addEventListener("message",p)}))}}))},makeWorkerLockRequest=(n,e,t,i)=>async()=>{const o=nanoid();return globalThis.postMessage({type:e,identifier:o,name:n}),await new Promise(a=>{const c=u=>{if(u==null||u.data==null)return;const d={type:u.data.type,identifier:u.data.identifier};d.type===t&&d.identifier===o&&(globalThis.removeEventListener("message",c),a(()=>{globalThis.postMessage({type:i,identifier:o,name:n})}))};globalThis.addEventListener("message",c)})},defaultOptions$2={singleProcess:!1},impl=n=>{if(n=Object.assign({},defaultOptions$2,n),!!globalThis.document||n.singleProcess){const t=new EventTarget;return observable.addEventListener("message",handleWorkerLockRequest(t,"requestReadLock",WORKER_REQUEST_READ_LOCK,WORKER_RELEASE_READ_LOCK,MASTER_GRANT_READ_LOCK)),observable.addEventListener("message",handleWorkerLockRequest(t,"requestWriteLock",WORKER_REQUEST_WRITE_LOCK,WORKER_RELEASE_WRITE_LOCK,MASTER_GRANT_WRITE_LOCK)),t}return{isWorker:!0,readLock:t=>makeWorkerLockRequest(t,WORKER_REQUEST_READ_LOCK,MASTER_GRANT_READ_LOCK,WORKER_RELEASE_READ_LOCK),writeLock:t=>makeWorkerLockRequest(t,WORKER_REQUEST_WRITE_LOCK,MASTER_GRANT_WRITE_LOCK,WORKER_RELEASE_WRITE_LOCK)}},mutexes={};let implementation$g;async function createReleaseable(n,e){let t;const i=new Promise(o=>{t=o});return n.add(async()=>await pTimeout((async()=>await new Promise(o=>{t(()=>{o()})}))(),{milliseconds:e.timeout})),await i}const createMutex=(n,e)=>{if(implementation$g.isWorker===!0)return{readLock:implementation$g.readLock(n,e),writeLock:implementation$g.writeLock(n,e)};const t=new PQueue({concurrency:1});let i;return{async readLock(){if(i!=null)return await createReleaseable(i,e);i=new PQueue({concurrency:e.concurrency,autoStart:!1});const o=i,a=createReleaseable(i,e);return t.add(async()=>(o.start(),await o.onIdle().then(()=>{i===o&&(i=null)}))),await a},async writeLock(){return i=null,await createReleaseable(t,e)}}},defaultOptions$1={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function createMortice(n){const e=Object.assign({},defaultOptions$1,n);return implementation$g==null&&(implementation$g=impl(e),implementation$g.isWorker!==!0&&(implementation$g.addEventListener("requestReadLock",t=>{mutexes[t.data.name]!=null&&mutexes[t.data.name].readLock().then(async i=>await t.data.handler().finally(()=>i()))}),implementation$g.addEventListener("requestWriteLock",async t=>{mutexes[t.data.name]!=null&&mutexes[t.data.name].writeLock().then(async i=>await t.data.handler().finally(()=>i()))}))),mutexes[e.name]==null&&(mutexes[e.name]=createMutex(e.name,e)),mutexes[e.name]}var objectSafeGet=get$3;function get$3(n,e,t){if(!n)return t;var i,o;if(Array.isArray(e)&&(i=e.slice(0)),typeof e=="string"&&(i=e.split(".")),typeof e=="symbol"&&(i=[e]),!Array.isArray(i))throw new Error("props arg must be an array, a string or a symbol");for(;i.length;)if(o=i.shift(),!n||(n=n[o],n===void 0))return t;return n}async function length$1(n){let e=0;for await(const t of n)e++;return e}var fnv1a$1={exports:{}};(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),t.BASE=2166136261;function t(i,o=t.BASE){const a=i.length;for(let c=0;c<a;c++)o^=i.charCodeAt(c),o+=(o<<1)+(o<<4)+(o<<7)+(o<<8)+(o<<24);return o>>>0}e.default=t,n.exports=t})(fnv1a$1,fnv1a$1.exports);var fnv1aExports=fnv1a$1.exports;const fnv1a=getDefaultExportFromCjs(fnv1aExports);var bytes$2={exports:{}};/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */bytes$2.exports=bytes;bytes$2.exports.format=format$1;bytes$2.exports.parse=parse;var formatThousandsRegExp=/\B(?=(\d{3})+(?!\d))/g,formatDecimalsRegExp=/(?:\.0*|(\.[^0]+)0+)$/,map$1={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},parseRegExp=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function bytes(n,e){return typeof n=="string"?parse(n):typeof n=="number"?format$1(n,e):null}function format$1(n,e){if(!Number.isFinite(n))return null;var t=Math.abs(n),i=e&&e.thousandsSeparator||"",o=e&&e.unitSeparator||"",a=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,c=!!(e&&e.fixedDecimals),u=e&&e.unit||"";(!u||!map$1[u.toLowerCase()])&&(t>=map$1.pb?u="PB":t>=map$1.tb?u="TB":t>=map$1.gb?u="GB":t>=map$1.mb?u="MB":t>=map$1.kb?u="KB":u="B");var d=n/map$1[u.toLowerCase()],p=d.toFixed(a);return c||(p=p.replace(formatDecimalsRegExp,"$1")),i&&(p=p.split(".").map(function(h,b){return b===0?h.replace(formatThousandsRegExp,i):h}).join(".")),p+o+u}function parse(n){if(typeof n=="number"&&!isNaN(n))return n;if(typeof n!="string")return null;var e=parseRegExp.exec(n),t,i="b";return e?(t=parseFloat(e[1]),i=e[4].toLowerCase()):(t=parseInt(n,10),i="b"),isNaN(t)?null:Math.floor(map$1[i]*t)}var bytesExports=bytes$2.exports;const bytes$1=getDefaultExportFromCjs(bytesExports);function isPlainObject(n){if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)}function sortKeys(n,e={}){if(!isPlainObject(n)&&!Array.isArray(n))throw new TypeError("Expected a plain object or array");const{deep:t,compare:i}=e,o=[],a=[],c=d=>{const p=o.indexOf(d);if(p!==-1)return a[p];const h=[];return o.push(d),a.push(h),h.push(...d.map(b=>Array.isArray(b)?c(b):isPlainObject(b)?u(b):b)),h},u=d=>{const p=o.indexOf(d);if(p!==-1)return a[p];const h={},b=Object.keys(d).sort(i);o.push(d),a.push(h);for(const m of b){const v=d[m];let _;t&&Array.isArray(v)?_=c(v):_=t&&isPlainObject(v)?u(v):v,Object.defineProperty(h,m,{...Object.getOwnPropertyDescriptor(d,m),value:_})}return h};return Array.isArray(n)?t?c(n):n.slice():u(n)}class QuickLRU extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof e.maxAge=="number"&&e.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if(typeof this.onEviction=="function")for(const[t,i]of e)this.onEviction(t,i.value)}_deleteIfExpired(e,t){return typeof t.expiry=="number"&&t.expiry<=Date.now()?(typeof this.onEviction=="function"&&this.onEviction(e,t.value),this.delete(e)):!1}_getOrDeleteIfExpired(e,t){if(this._deleteIfExpired(e,t)===!1)return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const i=t.get(e);return this._getItemValue(e,i)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,i]=e;this.cache.has(t)||this._deleteIfExpired(t,i)===!1&&(yield e)}for(const e of this.cache){const[t,i]=e;this._deleteIfExpired(t,i)===!1&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(this._deleteIfExpired(e,t)===!1)return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:i=this.maxAge}={}){const o=typeof i=="number"&&i!==Number.POSITIVE_INFINITY?Date.now()+i:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:o}):this._set(e,{value:t,expiry:o})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):this.oldCache.has(e)?!this._deleteIfExpired(e,this.oldCache.get(e)):!1}peek(e){if(this.cache.has(e))return this._peek(e,this.cache);if(this.oldCache.has(e))return this._peek(e,this.oldCache)}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],i=t.length-e;i<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(i>0&&this._emitEvictions(t.slice(0,i)),this.oldCache=new Map(t.slice(i)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,i]=e;this._deleteIfExpired(t,i)===!1&&(yield[t,i.value])}for(const e of this.oldCache){const[t,i]=e;this.cache.has(t)||this._deleteIfExpired(t,i)===!1&&(yield[t,i.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const i=e[t],[o,a]=i;this._deleteIfExpired(o,a)===!1&&(yield[o,a.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const i=e[t],[o,a]=i;this.cache.has(o)||this._deleteIfExpired(o,a)===!1&&(yield[o,a.value])}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[i,o]of this.entriesAscending())e.call(t,o,i,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}async function*sort(n,e){yield*(await all(n)).sort(e)}var browserLevel={},abstractLevel$1={},abstractLevel={},levelSupports={};levelSupports.supports=function n(...e){const t=e.reduce((i,o)=>Object.assign(i,o),{});return Object.assign(t,{snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,getMany:t.getMany||!1,keyIterator:t.keyIterator||!1,valueIterator:t.valueIterator||!1,iteratorNextv:t.iteratorNextv||!1,iteratorAll:t.iteratorAll||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:Object.assign({},t.encodings),events:Object.assign({},t.events),additionalMethods:Object.assign({},t.additionalMethods)})};var levelTranscoder={},moduleError=class extends Error{constructor(e,t){super(e||""),typeof t=="object"&&t!==null&&(t.code&&(this.code=String(t.code)),t.expected&&(this.expected=!0),t.transient&&(this.transient=!0),t.cause&&(this.cause=t.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},encodings$1={};let lazy=null;var textEndec$1=function(){return lazy===null&&(lazy={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),lazy},formats$2={},encoding={};const ModuleError$8=moduleError,formats$1=new Set(["buffer","view","utf8"]);let Encoding$2=class{constructor(e){if(this.encode=e.encode||this.encode,this.decode=e.decode||this.decode,this.name=e.name||this.name,this.format=e.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!formats$1.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");e.createViewTranscoder&&(this.createViewTranscoder=e.createViewTranscoder),e.createBufferTranscoder&&(this.createBufferTranscoder=e.createBufferTranscoder),e.createUTF8Transcoder&&(this.createUTF8Transcoder=e.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};encoding.Encoding=Encoding$2;const{Buffer:Buffer$1}=buffer$2||{},{Encoding:Encoding$1}=encoding,textEndec=textEndec$1;let BufferFormat$2=class extends Encoding$1{constructor(e){super({...e,format:"buffer"})}createViewTranscoder(){return new ViewFormat$2({encode:this.encode,decode:e=>this.decode(Buffer$1.from(e.buffer,e.byteOffset,e.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}},ViewFormat$2=class extends Encoding$1{constructor(e){super({...e,format:"view"})}createBufferTranscoder(){return new BufferFormat$2({encode:e=>{const t=this.encode(e);return Buffer$1.from(t.buffer,t.byteOffset,t.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}},UTF8Format$2=class extends Encoding$1{constructor(e){super({...e,format:"utf8"})}createBufferTranscoder(){return new BufferFormat$2({encode:e=>Buffer$1.from(this.encode(e),"utf8"),decode:e=>this.decode(e.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:e,textDecoder:t}=textEndec();return new ViewFormat$2({encode:i=>e.encode(this.encode(i)),decode:i=>this.decode(t.decode(i)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};formats$2.BufferFormat=BufferFormat$2;formats$2.ViewFormat=ViewFormat$2;formats$2.UTF8Format=UTF8Format$2;const{Buffer}=buffer$2||{Buffer:{isBuffer:()=>!1}},{textEncoder:textEncoder$3,textDecoder:textDecoder$1}=textEndec$1(),{BufferFormat:BufferFormat$1,ViewFormat:ViewFormat$1,UTF8Format:UTF8Format$1}=formats$2,identity$3=n=>n;encodings$1.utf8=new UTF8Format$1({encode:function(n){return Buffer.isBuffer(n)?n.toString("utf8"):ArrayBuffer.isView(n)?textDecoder$1.decode(n):String(n)},decode:identity$3,name:"utf8",createViewTranscoder(){return new ViewFormat$1({encode:function(n){return ArrayBuffer.isView(n)?n:textEncoder$3.encode(n)},decode:function(n){return textDecoder$1.decode(n)},name:`${this.name}+view`})},createBufferTranscoder(){return new BufferFormat$1({encode:function(n){return Buffer.isBuffer(n)?n:ArrayBuffer.isView(n)?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(String(n),"utf8")},decode:function(n){return n.toString("utf8")},name:`${this.name}+buffer`})}});encodings$1.json=new UTF8Format$1({encode:JSON.stringify,decode:JSON.parse,name:"json"});encodings$1.buffer=new BufferFormat$1({encode:function(n){return Buffer.isBuffer(n)?n:ArrayBuffer.isView(n)?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(String(n),"utf8")},decode:identity$3,name:"buffer",createViewTranscoder(){return new ViewFormat$1({encode:function(n){return ArrayBuffer.isView(n)?n:Buffer.from(String(n),"utf8")},decode:function(n){return Buffer.from(n.buffer,n.byteOffset,n.byteLength)},name:`${this.name}+view`})}});encodings$1.view=new ViewFormat$1({encode:function(n){return ArrayBuffer.isView(n)?n:textEncoder$3.encode(n)},decode:identity$3,name:"view",createBufferTranscoder(){return new BufferFormat$1({encode:function(n){return Buffer.isBuffer(n)?n:ArrayBuffer.isView(n)?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(String(n),"utf8")},decode:identity$3,name:`${this.name}+buffer`})}});encodings$1.hex=new BufferFormat$1({encode:function(n){return Buffer.isBuffer(n)?n:Buffer.from(String(n),"hex")},decode:function(n){return n.toString("hex")},name:"hex"});encodings$1.base64=new BufferFormat$1({encode:function(n){return Buffer.isBuffer(n)?n:Buffer.from(String(n),"base64")},decode:function(n){return n.toString("base64")},name:"base64"});const ModuleError$7=moduleError,encodings=encodings$1,{Encoding}=encoding,{BufferFormat,ViewFormat,UTF8Format}=formats$2,kFormats=Symbol("formats"),kEncodings=Symbol("encodings"),validFormats=new Set(["buffer","view","utf8"]);let Transcoder$1=class{constructor(e){if(Array.isArray(e)){if(!e.every(t=>validFormats.has(t)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[kEncodings]=new Map,this[kFormats]=new Set(e);for(const t in encodings)try{this.encoding(t)}catch(i){if(i.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw i}}encodings(){return Array.from(new Set(this[kEncodings].values()))}encoding(e){let t=this[kEncodings].get(e);if(t===void 0){if(typeof e=="string"&&e!==""){if(t=lookup$1[e],!t)throw new ModuleError$7(`Encoding '${e}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof e!="object"||e===null)throw new TypeError("First argument 'encoding' must be a string or object");t=from$3(e)}const{name:i,format:o}=t;if(!this[kFormats].has(o))if(this[kFormats].has("view"))t=t.createViewTranscoder();else if(this[kFormats].has("buffer"))t=t.createBufferTranscoder();else if(this[kFormats].has("utf8"))t=t.createUTF8Transcoder();else throw new ModuleError$7(`Encoding '${i}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(const a of[e,i,t.name,t.commonName])this[kEncodings].set(a,t)}return t}};levelTranscoder.Transcoder=Transcoder$1;function from$3(n){if(n instanceof Encoding)return n;const e="type"in n&&typeof n.type=="string"?n.type:void 0,t=n.name||e||`anonymous-${anonymousCount++}`;switch(detectFormat(n)){case"view":return new ViewFormat({...n,name:t});case"utf8":return new UTF8Format({...n,name:t});case"buffer":return new BufferFormat({...n,name:t});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function detectFormat(n){return"format"in n&&n.format!==void 0?n.format:"buffer"in n&&typeof n.buffer=="boolean"?n.buffer?"buffer":"utf8":"code"in n&&Number.isInteger(n.code)?"view":"buffer"}const aliases={binary:encodings.buffer,"utf-8":encodings.utf8},lookup$1={...encodings,...aliases};let anonymousCount=0;var catering={},nextTickBrowser$1=typeof queueMicrotask=="function"?queueMicrotask:n=>Promise.resolve().then(n),nextTick=nextTickBrowser$1;catering.fromCallback=function(n,e){if(n===void 0){var t=new Promise(function(i,o){n=function(a,c){a?o(a):i(c)}});n[e!==void 0?e:"promise"]=t}else if(typeof n!="function")throw new TypeError("Callback must be a function");return n};catering.fromPromise=function(n,e){if(e===void 0)return n;n.then(function(t){nextTick(()=>e(null,t))}).catch(function(t){nextTick(()=>e(t))})};var abstractIterator={},common={};common.getCallback=function(n,e){return typeof n=="function"?n:e};common.getOptions=function(n,e){return typeof n=="object"&&n!==null?n:e!==void 0?e:{}};const{fromCallback:fromCallback$3}=catering,ModuleError$6=moduleError,{getOptions:getOptions$2,getCallback:getCallback$2}=common,kPromise$3=Symbol("promise"),kCallback$1=Symbol("callback"),kWorking=Symbol("working"),kHandleOne$1=Symbol("handleOne"),kHandleMany$1=Symbol("handleMany"),kAutoClose=Symbol("autoClose"),kFinishWork=Symbol("finishWork"),kReturnMany=Symbol("returnMany"),kClosing=Symbol("closing"),kHandleClose=Symbol("handleClose"),kClosed=Symbol("closed"),kCloseCallbacks$1=Symbol("closeCallbacks"),kKeyEncoding$1=Symbol("keyEncoding"),kValueEncoding$1=Symbol("valueEncoding"),kAbortOnClose=Symbol("abortOnClose"),kLegacy=Symbol("legacy"),kKeys=Symbol("keys"),kValues=Symbol("values"),kLimit=Symbol("limit"),kCount=Symbol("count"),emptyOptions$1=Object.freeze({}),noop$1=()=>{};let warnedEnd=!1;class CommonIterator{constructor(e,t,i){if(typeof e!="object"||e===null){const o=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${o}`)}if(typeof t!="object"||t===null)throw new TypeError("The second argument must be an options object");this[kClosed]=!1,this[kCloseCallbacks$1]=[],this[kWorking]=!1,this[kClosing]=!1,this[kAutoClose]=!1,this[kCallback$1]=null,this[kHandleOne$1]=this[kHandleOne$1].bind(this),this[kHandleMany$1]=this[kHandleMany$1].bind(this),this[kHandleClose]=this[kHandleClose].bind(this),this[kKeyEncoding$1]=t[kKeyEncoding$1],this[kValueEncoding$1]=t[kValueEncoding$1],this[kLegacy]=i,this[kLimit]=Number.isInteger(t.limit)&&t.limit>=0?t.limit:1/0,this[kCount]=0,this[kAbortOnClose]=!!t.abortOnClose,this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get count(){return this[kCount]}get limit(){return this[kLimit]}next(e){let t;if(e===void 0)t=new Promise((i,o)=>{e=(a,c,u)=>{a?o(a):this[kLegacy]?c===void 0&&u===void 0?i():i([c,u]):i(c)}});else if(typeof e!="function")throw new TypeError("Callback must be a function");return this[kClosing]?this.nextTick(e,new ModuleError$6("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(e,new ModuleError$6("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[kWorking]=!0,this[kCallback$1]=e,this[kCount]>=this[kLimit]?this.nextTick(this[kHandleOne$1],null):this._next(this[kHandleOne$1])),t}_next(e){this.nextTick(e)}nextv(e,t,i){return i=getCallback$2(t,i),i=fromCallback$3(i,kPromise$3),t=getOptions$2(t,emptyOptions$1),Number.isInteger(e)?(this[kClosing]?this.nextTick(i,new ModuleError$6("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(i,new ModuleError$6("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(e<1&&(e=1),this[kLimit]<1/0&&(e=Math.min(e,this[kLimit]-this[kCount])),this[kWorking]=!0,this[kCallback$1]=i,e<=0?this.nextTick(this[kHandleMany$1],null,[]):this._nextv(e,t,this[kHandleMany$1])),i[kPromise$3]):(this.nextTick(i,new TypeError("The first argument 'size' must be an integer")),i[kPromise$3])}_nextv(e,t,i){const o=[],a=(c,u,d)=>{if(c)return i(c);if(this[kLegacy]?u===void 0&&d===void 0:u===void 0)return i(null,o);o.push(this[kLegacy]?[u,d]:u),o.length===e?i(null,o):this._next(a)};this._next(a)}all(e,t){return t=getCallback$2(e,t),t=fromCallback$3(t,kPromise$3),e=getOptions$2(e,emptyOptions$1),this[kClosing]?this.nextTick(t,new ModuleError$6("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(t,new ModuleError$6("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[kWorking]=!0,this[kCallback$1]=t,this[kAutoClose]=!0,this[kCount]>=this[kLimit]?this.nextTick(this[kHandleMany$1],null,[]):this._all(e,this[kHandleMany$1])),t[kPromise$3]}_all(e,t){let i=this[kCount];const o=[],a=()=>{const u=this[kLimit]<1/0?Math.min(1e3,this[kLimit]-i):1e3;u<=0?this.nextTick(t,null,o):this._nextv(u,emptyOptions$1,c)},c=(u,d)=>{u?t(u):d.length===0?t(null,o):(o.push.apply(o,d),i+=d.length,a())};a()}[kFinishWork](){const e=this[kCallback$1];return this[kAbortOnClose]&&e===null?noop$1:(this[kWorking]=!1,this[kCallback$1]=null,this[kClosing]&&this._close(this[kHandleClose]),e)}[kReturnMany](e,t,i){this[kAutoClose]?this.close(e.bind(null,t,i)):e(t,i)}seek(e,t){if(t=getOptions$2(t,emptyOptions$1),!this[kClosing]){if(this[kWorking])throw new ModuleError$6("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const i=this.db.keyEncoding(t.keyEncoding||this[kKeyEncoding$1]),o=i.format;t.keyEncoding!==o&&(t={...t,keyEncoding:o});const a=this.db.prefixKey(i.encode(e),o);this._seek(a,t)}}}_seek(e,t){throw new ModuleError$6("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(e){return e=fromCallback$3(e,kPromise$3),this[kClosed]?this.nextTick(e):this[kClosing]?this[kCloseCallbacks$1].push(e):(this[kClosing]=!0,this[kCloseCallbacks$1].push(e),this[kWorking]?this[kAbortOnClose]&&this[kFinishWork]()(new ModuleError$6("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[kHandleClose])),e[kPromise$3]}_close(e){this.nextTick(e)}[kHandleClose](){this[kClosed]=!0,this.db.detachResource(this);const e=this[kCloseCallbacks$1];this[kCloseCallbacks$1]=[];for(const t of e)t()}async*[Symbol.asyncIterator](){try{let e;for(;(e=await this.next())!==void 0;)yield e}finally{this[kClosed]||await this.close()}}}let AbstractIterator$3=class extends CommonIterator{constructor(e,t){super(e,t,!0),this[kKeys]=t.keys!==!1,this[kValues]=t.values!==!1}[kHandleOne$1](e,t,i){const o=this[kFinishWork]();if(e)return o(e);try{t=this[kKeys]&&t!==void 0?this[kKeyEncoding$1].decode(t):void 0,i=this[kValues]&&i!==void 0?this[kValueEncoding$1].decode(i):void 0}catch(a){return o(new IteratorDecodeError("entry",a))}t===void 0&&i===void 0||this[kCount]++,o(null,t,i)}[kHandleMany$1](e,t){const i=this[kFinishWork]();if(e)return this[kReturnMany](i,e);try{for(const o of t){const a=o[0],c=o[1];o[0]=this[kKeys]&&a!==void 0?this[kKeyEncoding$1].decode(a):void 0,o[1]=this[kValues]&&c!==void 0?this[kValueEncoding$1].decode(c):void 0}}catch(o){return this[kReturnMany](i,new IteratorDecodeError("entries",o))}this[kCount]+=t.length,this[kReturnMany](i,null,t)}end(e){return!warnedEnd&&typeof console<"u"&&(warnedEnd=!0,console.warn(new ModuleError$6("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(e)}},AbstractKeyIterator$2=class extends CommonIterator{constructor(e,t){super(e,t,!1)}[kHandleOne$1](e,t){const i=this[kFinishWork]();if(e)return i(e);try{t=t!==void 0?this[kKeyEncoding$1].decode(t):void 0}catch(o){return i(new IteratorDecodeError("key",o))}t!==void 0&&this[kCount]++,i(null,t)}[kHandleMany$1](e,t){const i=this[kFinishWork]();if(e)return this[kReturnMany](i,e);try{for(let o=0;o<t.length;o++){const a=t[o];t[o]=a!==void 0?this[kKeyEncoding$1].decode(a):void 0}}catch(o){return this[kReturnMany](i,new IteratorDecodeError("keys",o))}this[kCount]+=t.length,this[kReturnMany](i,null,t)}},AbstractValueIterator$2=class extends CommonIterator{constructor(e,t){super(e,t,!1)}[kHandleOne$1](e,t){const i=this[kFinishWork]();if(e)return i(e);try{t=t!==void 0?this[kValueEncoding$1].decode(t):void 0}catch(o){return i(new IteratorDecodeError("value",o))}t!==void 0&&this[kCount]++,i(null,t)}[kHandleMany$1](e,t){const i=this[kFinishWork]();if(e)return this[kReturnMany](i,e);try{for(let o=0;o<t.length;o++){const a=t[o];t[o]=a!==void 0?this[kValueEncoding$1].decode(a):void 0}}catch(o){return this[kReturnMany](i,new IteratorDecodeError("values",o))}this[kCount]+=t.length,this[kReturnMany](i,null,t)}};class IteratorDecodeError extends ModuleError$6{constructor(e,t){super(`Iterator could not decode ${e}`,{code:"LEVEL_DECODE_ERROR",cause:t})}}for(const n of["_ended property","_nexting property","_end method"])Object.defineProperty(AbstractIterator$3.prototype,n.split(" ")[0],{get(){throw new ModuleError$6(`The ${n} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new ModuleError$6(`The ${n} has been removed`,{code:"LEVEL_LEGACY"})}});AbstractIterator$3.keyEncoding=kKeyEncoding$1;AbstractIterator$3.valueEncoding=kValueEncoding$1;abstractIterator.AbstractIterator=AbstractIterator$3;abstractIterator.AbstractKeyIterator=AbstractKeyIterator$2;abstractIterator.AbstractValueIterator=AbstractValueIterator$2;var defaultKvIterator={};const{AbstractKeyIterator:AbstractKeyIterator$1,AbstractValueIterator:AbstractValueIterator$1}=abstractIterator,kIterator=Symbol("iterator"),kCallback=Symbol("callback"),kHandleOne=Symbol("handleOne"),kHandleMany=Symbol("handleMany");let DefaultKeyIterator$1=class extends AbstractKeyIterator$1{constructor(e,t){super(e,t),this[kIterator]=e.iterator({...t,keys:!0,values:!1}),this[kHandleOne]=this[kHandleOne].bind(this),this[kHandleMany]=this[kHandleMany].bind(this)}},DefaultValueIterator$1=class extends AbstractValueIterator$1{constructor(e,t){super(e,t),this[kIterator]=e.iterator({...t,keys:!1,values:!0}),this[kHandleOne]=this[kHandleOne].bind(this),this[kHandleMany]=this[kHandleMany].bind(this)}};for(const n of[DefaultKeyIterator$1,DefaultValueIterator$1]){const e=n===DefaultKeyIterator$1,t=e?i=>i[0]:i=>i[1];n.prototype._next=function(i){this[kCallback]=i,this[kIterator].next(this[kHandleOne])},n.prototype[kHandleOne]=function(i,o,a){const c=this[kCallback];i?c(i):c(null,e?o:a)},n.prototype._nextv=function(i,o,a){this[kCallback]=a,this[kIterator].nextv(i,o,this[kHandleMany])},n.prototype._all=function(i,o){this[kCallback]=o,this[kIterator].all(i,this[kHandleMany])},n.prototype[kHandleMany]=function(i,o){const a=this[kCallback];i?a(i):a(null,o.map(t))},n.prototype._seek=function(i,o){this[kIterator].seek(i,o)},n.prototype._close=function(i){this[kIterator].close(i)}}defaultKvIterator.DefaultKeyIterator=DefaultKeyIterator$1;defaultKvIterator.DefaultValueIterator=DefaultValueIterator$1;var deferredIterator={};const{AbstractIterator:AbstractIterator$2,AbstractKeyIterator,AbstractValueIterator}=abstractIterator,ModuleError$5=moduleError,kNut=Symbol("nut"),kUndefer$1=Symbol("undefer"),kFactory=Symbol("factory");let DeferredIterator$1=class extends AbstractIterator$2{constructor(e,t){super(e,t),this[kNut]=null,this[kFactory]=()=>e.iterator(t),this.db.defer(()=>this[kUndefer$1]())}},DeferredKeyIterator$1=class extends AbstractKeyIterator{constructor(e,t){super(e,t),this[kNut]=null,this[kFactory]=()=>e.keys(t),this.db.defer(()=>this[kUndefer$1]())}},DeferredValueIterator$1=class extends AbstractValueIterator{constructor(e,t){super(e,t),this[kNut]=null,this[kFactory]=()=>e.values(t),this.db.defer(()=>this[kUndefer$1]())}};for(const n of[DeferredIterator$1,DeferredKeyIterator$1,DeferredValueIterator$1])n.prototype[kUndefer$1]=function(){this.db.status==="open"&&(this[kNut]=this[kFactory]())},n.prototype._next=function(e){this[kNut]!==null?this[kNut].next(e):this.db.status==="opening"?this.db.defer(()=>this._next(e)):this.nextTick(e,new ModuleError$5("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},n.prototype._nextv=function(e,t,i){this[kNut]!==null?this[kNut].nextv(e,t,i):this.db.status==="opening"?this.db.defer(()=>this._nextv(e,t,i)):this.nextTick(i,new ModuleError$5("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},n.prototype._all=function(e,t){this[kNut]!==null?this[kNut].all(t):this.db.status==="opening"?this.db.defer(()=>this._all(e,t)):this.nextTick(t,new ModuleError$5("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},n.prototype._seek=function(e,t){this[kNut]!==null?this[kNut]._seek(e,t):this.db.status==="opening"&&this.db.defer(()=>this._seek(e,t))},n.prototype._close=function(e){this[kNut]!==null?this[kNut].close(e):this.db.status==="opening"?this.db.defer(()=>this._close(e)):this.nextTick(e)};deferredIterator.DeferredIterator=DeferredIterator$1;deferredIterator.DeferredKeyIterator=DeferredKeyIterator$1;deferredIterator.DeferredValueIterator=DeferredValueIterator$1;var defaultChainedBatch={},abstractChainedBatch={};const{fromCallback:fromCallback$2}=catering,ModuleError$4=moduleError,{getCallback:getCallback$1,getOptions:getOptions$1}=common,kPromise$2=Symbol("promise"),kStatus$1=Symbol("status"),kOperations$1=Symbol("operations"),kFinishClose=Symbol("finishClose"),kCloseCallbacks=Symbol("closeCallbacks");let AbstractChainedBatch$1=class{constructor(e){if(typeof e!="object"||e===null){const t=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${t}`)}this[kOperations$1]=[],this[kCloseCallbacks]=[],this[kStatus$1]="open",this[kFinishClose]=this[kFinishClose].bind(this),this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get length(){return this[kOperations$1].length}put(e,t,i){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const o=this.db._checkKey(e)||this.db._checkValue(t);if(o)throw o;const a=i&&i.sublevel!=null?i.sublevel:this.db,c=i,u=a.keyEncoding(i&&i.keyEncoding),d=a.valueEncoding(i&&i.valueEncoding),p=u.format;i={...i,keyEncoding:p,valueEncoding:d.format},a!==this.db&&(i.sublevel=null);const h=a.prefixKey(u.encode(e),p),b=d.encode(t);return this._put(h,b,i),this[kOperations$1].push({...c,type:"put",key:e,value:t}),this}_put(e,t,i){}del(e,t){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const i=this.db._checkKey(e);if(i)throw i;const o=t&&t.sublevel!=null?t.sublevel:this.db,a=t,c=o.keyEncoding(t&&t.keyEncoding),u=c.format;return t={...t,keyEncoding:u},o!==this.db&&(t.sublevel=null),this._del(o.prefixKey(c.encode(e),u),t),this[kOperations$1].push({...a,type:"del",key:e}),this}_del(e,t){}clear(){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[kOperations$1]=[],this}_clear(){}write(e,t){return t=getCallback$1(e,t),t=fromCallback$2(t,kPromise$2),e=getOptions$1(e),this[kStatus$1]!=="open"?this.nextTick(t,new ModuleError$4("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):this.length===0?this.close(t):(this[kStatus$1]="writing",this._write(e,i=>{this[kStatus$1]="closing",this[kCloseCallbacks].push(()=>t(i)),i||this.db.emit("batch",this[kOperations$1]),this._close(this[kFinishClose])})),t[kPromise$2]}_write(e,t){}close(e){return e=fromCallback$2(e,kPromise$2),this[kStatus$1]==="closing"?this[kCloseCallbacks].push(e):this[kStatus$1]==="closed"?this.nextTick(e):(this[kCloseCallbacks].push(e),this[kStatus$1]!=="writing"&&(this[kStatus$1]="closing",this._close(this[kFinishClose]))),e[kPromise$2]}_close(e){this.nextTick(e)}[kFinishClose](){this[kStatus$1]="closed",this.db.detachResource(this);const e=this[kCloseCallbacks];this[kCloseCallbacks]=[];for(const t of e)t()}};abstractChainedBatch.AbstractChainedBatch=AbstractChainedBatch$1;const{AbstractChainedBatch}=abstractChainedBatch,ModuleError$3=moduleError,kEncoded=Symbol("encoded");let DefaultChainedBatch$1=class extends AbstractChainedBatch{constructor(e){super(e),this[kEncoded]=[]}_put(e,t,i){this[kEncoded].push({...i,type:"put",key:e,value:t})}_del(e,t){this[kEncoded].push({...t,type:"del",key:e})}_clear(){this[kEncoded]=[]}_write(e,t){this.db.status==="opening"?this.db.defer(()=>this._write(e,t)):this.db.status==="open"?this[kEncoded].length===0?this.nextTick(t):this.db._batch(this[kEncoded],e,t):this.nextTick(t,new ModuleError$3("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};defaultChainedBatch.DefaultChainedBatch=DefaultChainedBatch$1;const ModuleError$2=moduleError,hasOwnProperty=Object.prototype.hasOwnProperty,rangeOptions$1=new Set(["lt","lte","gt","gte"]);var rangeOptions_1=function(n,e){const t={};for(const i in n)if(hasOwnProperty.call(n,i)&&!(i==="keyEncoding"||i==="valueEncoding")){if(i==="start"||i==="end")throw new ModuleError$2(`The legacy range option '${i}' has been removed`,{code:"LEVEL_LEGACY"});if(i==="encoding")throw new ModuleError$2("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});rangeOptions$1.has(i)?t[i]=e.encode(n[i]):t[i]=n[i]}return t.reverse=!!t.reverse,t.limit=Number.isInteger(t.limit)&&t.limit>=0?t.limit:-1,t};/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let promise;var queueMicrotask_1=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:commonjsGlobal):n=>(promise||(promise=Promise.resolve())).then(n).catch(e=>setTimeout(()=>{throw e},0)),nextTickBrowser,hasRequiredNextTickBrowser;function requireNextTickBrowser(){if(hasRequiredNextTickBrowser)return nextTickBrowser;hasRequiredNextTickBrowser=1;const n=queueMicrotask_1;return nextTickBrowser=function(e,...t){t.length===0?n(e):n(()=>e(...t))},nextTickBrowser}var abstractSublevelIterator={},hasRequiredAbstractSublevelIterator;function requireAbstractSublevelIterator(){if(hasRequiredAbstractSublevelIterator)return abstractSublevelIterator;hasRequiredAbstractSublevelIterator=1;const{AbstractIterator:n,AbstractKeyIterator:e,AbstractValueIterator:t}=abstractIterator,i=Symbol("unfix"),o=Symbol("iterator"),a=Symbol("handleOne"),c=Symbol("handleMany"),u=Symbol("callback");class d extends n{constructor(m,v,_,$){super(m,v),this[o]=_,this[i]=$,this[a]=this[a].bind(this),this[c]=this[c].bind(this),this[u]=null}[a](m,v,_){const $=this[u];if(m)return $(m);v!==void 0&&(v=this[i](v)),$(m,v,_)}[c](m,v){const _=this[u];if(m)return _(m);for(const $ of v){const k=$[0];k!==void 0&&($[0]=this[i](k))}_(m,v)}}class p extends e{constructor(m,v,_,$){super(m,v),this[o]=_,this[i]=$,this[a]=this[a].bind(this),this[c]=this[c].bind(this),this[u]=null}[a](m,v){const _=this[u];if(m)return _(m);v!==void 0&&(v=this[i](v)),_(m,v)}[c](m,v){const _=this[u];if(m)return _(m);for(let $=0;$<v.length;$++){const k=v[$];k!==void 0&&(v[$]=this[i](k))}_(m,v)}}class h extends t{constructor(m,v,_){super(m,v),this[o]=_}}for(const b of[d,p])b.prototype._next=function(m){this[u]=m,this[o].next(this[a])},b.prototype._nextv=function(m,v,_){this[u]=_,this[o].nextv(m,v,this[c])},b.prototype._all=function(m,v){this[u]=v,this[o].all(m,this[c])};for(const b of[h])b.prototype._next=function(m){this[o].next(m)},b.prototype._nextv=function(m,v,_){this[o].nextv(m,v,_)},b.prototype._all=function(m,v){this[o].all(m,v)};for(const b of[d,p,h])b.prototype._seek=function(m,v){this[o].seek(m,v)},b.prototype._close=function(m){this[o].close(m)};return abstractSublevelIterator.AbstractSublevelIterator=d,abstractSublevelIterator.AbstractSublevelKeyIterator=p,abstractSublevelIterator.AbstractSublevelValueIterator=h,abstractSublevelIterator}var abstractSublevel,hasRequiredAbstractSublevel;function requireAbstractSublevel(){if(hasRequiredAbstractSublevel)return abstractSublevel;hasRequiredAbstractSublevel=1;const n=moduleError,{Buffer:e}=buffer$2||{},{AbstractSublevelIterator:t,AbstractSublevelKeyIterator:i,AbstractSublevelValueIterator:o}=requireAbstractSublevelIterator(),a=Symbol("prefix"),c=Symbol("upperBound"),u=Symbol("prefixRange"),d=Symbol("parent"),p=Symbol("unfix"),h=new TextEncoder,b={separator:"!"};abstractSublevel=function({AbstractLevel:D}){class O extends D{static defaults(j){if(typeof j=="string")throw new n("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(j&&j.open)throw new n("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return j==null?b:j.separator?j:{...j,separator:"!"}}constructor(j,W,ae){const{separator:fe,manifest:pe,...ve}=O.defaults(ae);W=k(W,fe);const Qe=fe.charCodeAt(0)+1,re=j[d]||j;if(!h.encode(W).every(w=>w>Qe&&w<127))throw new n(`Prefix must use bytes > ${Qe} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(m(re,pe),ve);const C=(j.prefix||"")+fe+W+fe,S=C.slice(0,-1)+String.fromCharCode(Qe);this[d]=re,this[a]=new _(C),this[c]=new _(S),this[p]=new $,this.nextTick=re.nextTick}prefixKey(j,W){if(W==="utf8")return this[a].utf8+j;if(j.byteLength===0)return this[a][W];if(W==="view"){const ae=this[a].view,fe=new Uint8Array(ae.byteLength+j.byteLength);return fe.set(ae,0),fe.set(j,ae.byteLength),fe}else{const ae=this[a].buffer;return e.concat([ae,j],ae.byteLength+j.byteLength)}}[u](j,W){j.gte!==void 0?j.gte=this.prefixKey(j.gte,W):j.gt!==void 0?j.gt=this.prefixKey(j.gt,W):j.gte=this[a][W],j.lte!==void 0?j.lte=this.prefixKey(j.lte,W):j.lt!==void 0?j.lt=this.prefixKey(j.lt,W):j.lte=this[c][W]}get prefix(){return this[a].utf8}get db(){return this[d]}_open(j,W){this[d].open({passive:!0},W)}_put(j,W,ae,fe){this[d].put(j,W,ae,fe)}_get(j,W,ae){this[d].get(j,W,ae)}_getMany(j,W,ae){this[d].getMany(j,W,ae)}_del(j,W,ae){this[d].del(j,W,ae)}_batch(j,W,ae){this[d].batch(j,W,ae)}_clear(j,W){this[u](j,j.keyEncoding),this[d].clear(j,W)}_iterator(j){this[u](j,j.keyEncoding);const W=this[d].iterator(j),ae=this[p].get(this[a].utf8.length,j.keyEncoding);return new t(this,j,W,ae)}_keys(j){this[u](j,j.keyEncoding);const W=this[d].keys(j),ae=this[p].get(this[a].utf8.length,j.keyEncoding);return new i(this,j,W,ae)}_values(j){this[u](j,j.keyEncoding);const W=this[d].values(j);return new o(this,j,W)}}return{AbstractSublevel:O}};const m=function(D,O){return{...D.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...O,encodings:{utf8:v(D,"utf8"),buffer:v(D,"buffer"),view:v(D,"view")}}},v=function(D,O){return D.supports.encodings[O]?D.keyEncoding(O).name===O:!1};class _{constructor(O){this.utf8=O,this.view=h.encode(O),this.buffer=e?e.from(this.view.buffer,0,this.view.byteLength):{}}}class ${constructor(){this.cache=new Map}get(O,H){let j=this.cache.get(H);return j===void 0&&(H==="view"?j=function(W,ae){return ae.subarray(W)}.bind(null,O):j=function(W,ae){return ae.slice(W)}.bind(null,O),this.cache.set(H,j)),j}}const k=function(D,O){let H=0,j=D.length;for(;H<j&&D[H]===O;)H++;for(;j>H&&D[j-1]===O;)j--;return D.slice(H,j)};return abstractSublevel}const{supports}=levelSupports,{Transcoder}=levelTranscoder,{EventEmitter:EventEmitter$1}=eventsExports,{fromCallback:fromCallback$1}=catering,ModuleError$1=moduleError,{AbstractIterator:AbstractIterator$1}=abstractIterator,{DefaultKeyIterator,DefaultValueIterator}=defaultKvIterator,{DeferredIterator,DeferredKeyIterator,DeferredValueIterator}=deferredIterator,{DefaultChainedBatch}=defaultChainedBatch,{getCallback,getOptions}=common,rangeOptions=rangeOptions_1,kPromise$1=Symbol("promise"),kLanded=Symbol("landed"),kResources=Symbol("resources"),kCloseResources=Symbol("closeResources"),kOperations=Symbol("operations"),kUndefer=Symbol("undefer"),kDeferOpen=Symbol("deferOpen"),kOptions$1=Symbol("options"),kStatus=Symbol("status"),kDefaultOptions=Symbol("defaultOptions"),kTranscoder=Symbol("transcoder"),kKeyEncoding=Symbol("keyEncoding"),kValueEncoding=Symbol("valueEncoding"),noop=()=>{};let AbstractLevel$1=class extends EventEmitter$1{constructor(e,t){if(super(),typeof e!="object"||e===null)throw new TypeError("The first argument 'manifest' must be an object");t=getOptions(t);const{keyEncoding:i,valueEncoding:o,passive:a,...c}=t;this[kResources]=new Set,this[kOperations]=[],this[kDeferOpen]=!0,this[kOptions$1]=c,this[kStatus]="opening",this.supports=supports(e,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:e.snapshots!==!1,permanence:e.permanence!==!1,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:e.encodings||{},events:Object.assign({},e.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[kTranscoder]=new Transcoder(formats(this)),this[kKeyEncoding]=this[kTranscoder].encoding(i||"utf8"),this[kValueEncoding]=this[kTranscoder].encoding(o||"utf8");for(const u of this[kTranscoder].encodings())this.supports.encodings[u.commonName]||(this.supports.encodings[u.commonName]=!0);this[kDefaultOptions]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[kKeyEncoding].commonName,valueEncoding:this[kValueEncoding].commonName}),key:Object.freeze({keyEncoding:this[kKeyEncoding].commonName})},this.nextTick(()=>{this[kDeferOpen]&&this.open({passive:!1},noop)})}get status(){return this[kStatus]}keyEncoding(e){return this[kTranscoder].encoding(e??this[kKeyEncoding])}valueEncoding(e){return this[kTranscoder].encoding(e??this[kValueEncoding])}open(e,t){t=getCallback(e,t),t=fromCallback$1(t,kPromise$1),e={...this[kOptions$1],...getOptions(e)},e.createIfMissing=e.createIfMissing!==!1,e.errorIfExists=!!e.errorIfExists;const i=o=>{this[kStatus]==="closing"||this[kStatus]==="opening"?this.once(kLanded,o?()=>i(o):i):this[kStatus]!=="open"?t(new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:o})):t()};return e.passive?this[kStatus]==="opening"?this.once(kLanded,i):this.nextTick(i):this[kStatus]==="closed"||this[kDeferOpen]?(this[kDeferOpen]=!1,this[kStatus]="opening",this.emit("opening"),this._open(e,o=>{if(o){this[kStatus]="closed",this[kCloseResources](()=>{this.emit(kLanded),i(o)}),this[kUndefer]();return}this[kStatus]="open",this[kUndefer](),this.emit(kLanded),this[kStatus]==="open"&&this.emit("open"),this[kStatus]==="open"&&this.emit("ready"),i()})):this[kStatus]==="open"?this.nextTick(i):this.once(kLanded,()=>this.open(e,t)),t[kPromise$1]}_open(e,t){this.nextTick(t)}close(e){e=fromCallback$1(e,kPromise$1);const t=i=>{this[kStatus]==="opening"||this[kStatus]==="closing"?this.once(kLanded,i?t(i):t):this[kStatus]!=="closed"?e(new ModuleError$1("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:i})):e()};if(this[kStatus]==="open"){this[kStatus]="closing",this.emit("closing");const i=o=>{this[kStatus]="open",this[kUndefer](),this.emit(kLanded),t(o)};this[kCloseResources](()=>{this._close(o=>{if(o)return i(o);this[kStatus]="closed",this[kUndefer](),this.emit(kLanded),this[kStatus]==="closed"&&this.emit("closed"),t()})})}else this[kStatus]==="closed"?this.nextTick(t):this.once(kLanded,()=>this.close(e));return e[kPromise$1]}[kCloseResources](e){if(this[kResources].size===0)return this.nextTick(e);let t=this[kResources].size,i=!0;const o=()=>{--t===0&&(i?this.nextTick(e):e())};for(const a of this[kResources])a.close(o);i=!1,this[kResources].clear()}_close(e){this.nextTick(e)}get(e,t,i){if(i=getCallback(t,i),i=fromCallback$1(i,kPromise$1),t=getOptions(t,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.get(e,t,i)),i[kPromise$1];if(maybeError(this,i))return i[kPromise$1];const o=this._checkKey(e);if(o)return this.nextTick(i,o),i[kPromise$1];const a=this.keyEncoding(t.keyEncoding),c=this.valueEncoding(t.valueEncoding),u=a.format,d=c.format;return(t.keyEncoding!==u||t.valueEncoding!==d)&&(t=Object.assign({},t,{keyEncoding:u,valueEncoding:d})),this._get(this.prefixKey(a.encode(e),u),t,(p,h)=>{if(p)return(p.code==="LEVEL_NOT_FOUND"||p.notFound||/NotFound/i.test(p))&&(p.code||(p.code="LEVEL_NOT_FOUND"),p.notFound||(p.notFound=!0),p.status||(p.status=404)),i(p);try{h=c.decode(h)}catch(b){return i(new ModuleError$1("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:b}))}i(null,h)}),i[kPromise$1]}_get(e,t,i){this.nextTick(i,new Error("NotFound"))}getMany(e,t,i){if(i=getCallback(t,i),i=fromCallback$1(i,kPromise$1),t=getOptions(t,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.getMany(e,t,i)),i[kPromise$1];if(maybeError(this,i))return i[kPromise$1];if(!Array.isArray(e))return this.nextTick(i,new TypeError("The first argument 'keys' must be an array")),i[kPromise$1];if(e.length===0)return this.nextTick(i,null,[]),i[kPromise$1];const o=this.keyEncoding(t.keyEncoding),a=this.valueEncoding(t.valueEncoding),c=o.format,u=a.format;(t.keyEncoding!==c||t.valueEncoding!==u)&&(t=Object.assign({},t,{keyEncoding:c,valueEncoding:u}));const d=new Array(e.length);for(let p=0;p<e.length;p++){const h=e[p],b=this._checkKey(h);if(b)return this.nextTick(i,b),i[kPromise$1];d[p]=this.prefixKey(o.encode(h),c)}return this._getMany(d,t,(p,h)=>{if(p)return i(p);try{for(let b=0;b<h.length;b++)h[b]!==void 0&&(h[b]=a.decode(h[b]))}catch(b){return i(new ModuleError$1(`Could not decode one or more of ${h.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:b}))}i(null,h)}),i[kPromise$1]}_getMany(e,t,i){this.nextTick(i,null,new Array(e.length).fill(void 0))}put(e,t,i,o){if(o=getCallback(i,o),o=fromCallback$1(o,kPromise$1),i=getOptions(i,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.put(e,t,i,o)),o[kPromise$1];if(maybeError(this,o))return o[kPromise$1];const a=this._checkKey(e)||this._checkValue(t);if(a)return this.nextTick(o,a),o[kPromise$1];const c=this.keyEncoding(i.keyEncoding),u=this.valueEncoding(i.valueEncoding),d=c.format,p=u.format;(i.keyEncoding!==d||i.valueEncoding!==p)&&(i=Object.assign({},i,{keyEncoding:d,valueEncoding:p}));const h=this.prefixKey(c.encode(e),d),b=u.encode(t);return this._put(h,b,i,m=>{if(m)return o(m);this.emit("put",e,t),o()}),o[kPromise$1]}_put(e,t,i,o){this.nextTick(o)}del(e,t,i){if(i=getCallback(t,i),i=fromCallback$1(i,kPromise$1),t=getOptions(t,this[kDefaultOptions].key),this[kStatus]==="opening")return this.defer(()=>this.del(e,t,i)),i[kPromise$1];if(maybeError(this,i))return i[kPromise$1];const o=this._checkKey(e);if(o)return this.nextTick(i,o),i[kPromise$1];const a=this.keyEncoding(t.keyEncoding),c=a.format;return t.keyEncoding!==c&&(t=Object.assign({},t,{keyEncoding:c})),this._del(this.prefixKey(a.encode(e),c),t,u=>{if(u)return i(u);this.emit("del",e),i()}),i[kPromise$1]}_del(e,t,i){this.nextTick(i)}batch(e,t,i){if(!arguments.length){if(this[kStatus]==="opening")return new DefaultChainedBatch(this);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(typeof e=="function"?i=e:i=getCallback(t,i),i=fromCallback$1(i,kPromise$1),t=getOptions(t,this[kDefaultOptions].empty),this[kStatus]==="opening")return this.defer(()=>this.batch(e,t,i)),i[kPromise$1];if(maybeError(this,i))return i[kPromise$1];if(!Array.isArray(e))return this.nextTick(i,new TypeError("The first argument 'operations' must be an array")),i[kPromise$1];if(e.length===0)return this.nextTick(i),i[kPromise$1];const o=new Array(e.length),{keyEncoding:a,valueEncoding:c,...u}=t;for(let d=0;d<e.length;d++){if(typeof e[d]!="object"||e[d]===null)return this.nextTick(i,new TypeError("A batch operation must be an object")),i[kPromise$1];const p=Object.assign({},e[d]);if(p.type!=="put"&&p.type!=="del")return this.nextTick(i,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),i[kPromise$1];const h=this._checkKey(p.key);if(h)return this.nextTick(i,h),i[kPromise$1];const b=p.sublevel!=null?p.sublevel:this,m=b.keyEncoding(p.keyEncoding||a),v=m.format;if(p.key=b.prefixKey(m.encode(p.key),v),p.keyEncoding=v,p.type==="put"){const _=this._checkValue(p.value);if(_)return this.nextTick(i,_),i[kPromise$1];const $=b.valueEncoding(p.valueEncoding||c);p.value=$.encode(p.value),p.valueEncoding=$.format}b!==this&&(p.sublevel=null),o[d]=p}return this._batch(o,u,d=>{if(d)return i(d);this.emit("batch",e),i()}),i[kPromise$1]}_batch(e,t,i){this.nextTick(i)}sublevel(e,t){return this._sublevel(e,AbstractSublevel.defaults(t))}_sublevel(e,t){return new AbstractSublevel(this,e,t)}prefixKey(e,t){return e}clear(e,t){if(t=getCallback(e,t),t=fromCallback$1(t,kPromise$1),e=getOptions(e,this[kDefaultOptions].empty),this[kStatus]==="opening")return this.defer(()=>this.clear(e,t)),t[kPromise$1];if(maybeError(this,t))return t[kPromise$1];const i=e,o=this.keyEncoding(e.keyEncoding);return e=rangeOptions(e,o),e.keyEncoding=o.format,e.limit===0?this.nextTick(t):this._clear(e,a=>{if(a)return t(a);this.emit("clear",i),t()}),t[kPromise$1]}_clear(e,t){this.nextTick(t)}iterator(e){const t=this.keyEncoding(e&&e.keyEncoding),i=this.valueEncoding(e&&e.valueEncoding);if(e=rangeOptions(e,t),e.keys=e.keys!==!1,e.values=e.values!==!1,e[AbstractIterator$1.keyEncoding]=t,e[AbstractIterator$1.valueEncoding]=i,e.keyEncoding=t.format,e.valueEncoding=i.format,this[kStatus]==="opening")return new DeferredIterator(this,e);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(e)}_iterator(e){return new AbstractIterator$1(this,e)}keys(e){const t=this.keyEncoding(e&&e.keyEncoding),i=this.valueEncoding(e&&e.valueEncoding);if(e=rangeOptions(e,t),e[AbstractIterator$1.keyEncoding]=t,e[AbstractIterator$1.valueEncoding]=i,e.keyEncoding=t.format,e.valueEncoding=i.format,this[kStatus]==="opening")return new DeferredKeyIterator(this,e);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(e)}_keys(e){return new DefaultKeyIterator(this,e)}values(e){const t=this.keyEncoding(e&&e.keyEncoding),i=this.valueEncoding(e&&e.valueEncoding);if(e=rangeOptions(e,t),e[AbstractIterator$1.keyEncoding]=t,e[AbstractIterator$1.valueEncoding]=i,e.keyEncoding=t.format,e.valueEncoding=i.format,this[kStatus]==="opening")return new DeferredValueIterator(this,e);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(e)}_values(e){return new DefaultValueIterator(this,e)}defer(e){if(typeof e!="function")throw new TypeError("The first argument must be a function");this[kOperations].push(e)}[kUndefer](){if(this[kOperations].length===0)return;const e=this[kOperations];this[kOperations]=[];for(const t of e)t()}attachResource(e){if(typeof e!="object"||e===null||typeof e.close!="function")throw new TypeError("The first argument must be a resource object");this[kResources].add(e)}detachResource(e){this[kResources].delete(e)}_chainedBatch(){return new DefaultChainedBatch(this)}_checkKey(e){if(e==null)return new ModuleError$1("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(e){if(e==null)return new ModuleError$1("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}};AbstractLevel$1.prototype.nextTick=requireNextTickBrowser();const{AbstractSublevel}=requireAbstractSublevel()({AbstractLevel:AbstractLevel$1});abstractLevel.AbstractLevel=AbstractLevel$1;abstractLevel.AbstractSublevel=AbstractSublevel;const maybeError=function(n,e){return n[kStatus]!=="open"?(n.nextTick(e,new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0):!1},formats=function(n){return Object.keys(n.supports.encodings).filter(e=>!!n.supports.encodings[e])};abstractLevel$1.AbstractLevel=abstractLevel.AbstractLevel;abstractLevel$1.AbstractSublevel=abstractLevel.AbstractSublevel;abstractLevel$1.AbstractIterator=abstractIterator.AbstractIterator;abstractLevel$1.AbstractKeyIterator=abstractIterator.AbstractKeyIterator;abstractLevel$1.AbstractValueIterator=abstractIterator.AbstractValueIterator;abstractLevel$1.AbstractChainedBatch=abstractChainedBatch.AbstractChainedBatch;/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var runParallelLimit_1=runParallelLimit;const queueMicrotask$1=queueMicrotask_1;function runParallelLimit(n,e,t){if(typeof e!="number")throw new Error("second argument must be a Number");let i,o,a,c,u,d=!0,p;Array.isArray(n)?(i=[],a=o=n.length):(c=Object.keys(n),i={},a=o=c.length);function h(m){function v(){t&&t(m,i),t=null}d?queueMicrotask$1(v):v()}function b(m,v,_){if(i[m]=_,v&&(u=!0),--a===0||v)h(v);else if(!u&&p<o){let $;c?($=c[p],p+=1,n[$](function(k,D){b($,k,D)})):($=p,p+=1,n[$](function(k,D){b($,k,D)}))}}p=e,a?c?c.some(function(m,v){return n[m](function(_,$){b(m,_,$)}),v===e-1}):n.some(function(m,v){return m(function(_,$){b(v,_,$)}),v===e-1}):h(null),d=!1}var iterator={},keyRange=function n(e){const t=e.gte!==void 0?e.gte:e.gt!==void 0?e.gt:void 0,i=e.lte!==void 0?e.lte:e.lt!==void 0?e.lt:void 0,o=e.gte===void 0,a=e.lte===void 0;return t!==void 0&&i!==void 0?IDBKeyRange.bound(t,i,o,a):t!==void 0?IDBKeyRange.lowerBound(t,o):i!==void 0?IDBKeyRange.upperBound(i,a):null};const textEncoder$2=new TextEncoder;var deserialize$2=function(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):textEncoder$2.encode(n)};const{AbstractIterator}=abstractLevel$1,createKeyRange$1=keyRange,deserialize$1=deserialize$2,kCache=Symbol("cache"),kFinished=Symbol("finished"),kOptions=Symbol("options"),kCurrentOptions=Symbol("currentOptions"),kPosition=Symbol("position"),kLocation$1=Symbol("location"),kFirst=Symbol("first"),emptyOptions={};let Iterator$1=class extends AbstractIterator{constructor(e,t,i){super(e,i),this[kCache]=[],this[kFinished]=this.limit===0,this[kOptions]=i,this[kCurrentOptions]={...i},this[kPosition]=void 0,this[kLocation$1]=t,this[kFirst]=!0}_nextv(e,t,i){if(this[kFirst]=!1,this[kFinished])return this.nextTick(i,null,[]);if(this[kCache].length>0)return e=Math.min(e,this[kCache].length),this.nextTick(i,null,this[kCache].splice(0,e));this[kPosition]!==void 0&&(this[kOptions].reverse?(this[kCurrentOptions].lt=this[kPosition],this[kCurrentOptions].lte=void 0):(this[kCurrentOptions].gt=this[kPosition],this[kCurrentOptions].gte=void 0));let o;try{o=createKeyRange$1(this[kCurrentOptions])}catch{return this[kFinished]=!0,this.nextTick(i,null,[])}const a=this.db.db.transaction([this[kLocation$1]],"readonly"),c=a.objectStore(this[kLocation$1]),u=[];if(this[kOptions].reverse){const d=!this[kOptions].values&&c.openKeyCursor?"openKeyCursor":"openCursor";c[d](o,"prev").onsuccess=p=>{const h=p.target.result;if(h){const{key:b,value:m}=h;this[kPosition]=b,u.push([this[kOptions].keys&&b!==void 0?deserialize$1(b):void 0,this[kOptions].values&&m!==void 0?deserialize$1(m):void 0]),u.length<e?h.continue():maybeCommit(a)}else this[kFinished]=!0}}else{let d,p;const h=()=>{if(d===void 0||p===void 0)return;const b=Math.max(d.length,p.length);b===0||e===1/0?this[kFinished]=!0:this[kPosition]=d[b-1],u.length=b;for(let m=0;m<b;m++){const v=d[m],_=p[m];u[m]=[this[kOptions].keys&&v!==void 0?deserialize$1(v):void 0,this[kOptions].values&&_!==void 0?deserialize$1(_):void 0]}maybeCommit(a)};this[kOptions].keys||e<1/0?c.getAllKeys(o,e<1/0?e:void 0).onsuccess=b=>{d=b.target.result,h()}:(d=[],this.nextTick(h)),this[kOptions].values?c.getAll(o,e<1/0?e:void 0).onsuccess=b=>{p=b.target.result,h()}:(p=[],this.nextTick(h))}a.onabort=()=>{i(a.error||new Error("aborted by user")),i=null},a.oncomplete=()=>{i(null,u),i=null}}_next(e){if(this[kCache].length>0){const[t,i]=this[kCache].shift();this.nextTick(e,null,t,i)}else if(this[kFinished])this.nextTick(e);else{let t=Math.min(100,this.limit-this.count);this[kFirst]&&(this[kFirst]=!1,t=1),this._nextv(t,emptyOptions,(i,o)=>{if(i)return e(i);this[kCache]=o,this._next(e)})}}_all(e,t){this[kFirst]=!1;const i=this[kCache].splice(0,this[kCache].length),o=this.limit-this.count-i.length;if(o<=0)return this.nextTick(t,null,i);this._nextv(o,emptyOptions,(a,c)=>{if(a)return t(a);i.length>0&&(c=i.concat(c)),t(null,c)})}_seek(e,t){this[kFirst]=!0,this[kCache]=[],this[kFinished]=!1,this[kPosition]=void 0,this[kCurrentOptions]={...this[kOptions]};let i;try{i=createKeyRange$1(this[kOptions])}catch{this[kFinished]=!0;return}i!==null&&!i.includes(e)?this[kFinished]=!0:this[kOptions].reverse?this[kCurrentOptions].lte=e:this[kCurrentOptions].gte=e}};iterator.Iterator=Iterator$1;function maybeCommit(n){typeof n.commit=="function"&&n.commit()}var clear$3=function n(e,t,i,o,a){if(o.limit===0)return e.nextTick(a);const c=e.db.transaction([t],"readwrite"),u=c.objectStore(t);let d=0;c.oncomplete=function(){a()},c.onabort=function(){a(c.error||new Error("aborted by user"))};const p=u.openKeyCursor?"openKeyCursor":"openCursor",h=o.reverse?"prev":"next";u[p](i,h).onsuccess=function(b){const m=b.target.result;m&&(u.delete(m.key).onsuccess=function(){(o.limit<=0||++d<o.limit)&&m.continue()})}};const{AbstractLevel}=abstractLevel$1,ModuleError=moduleError,parallel=runParallelLimit_1,{fromCallback}=catering,{Iterator}=iterator,deserialize=deserialize$2,clear$2=clear$3,createKeyRange=keyRange,DEFAULT_PREFIX="level-js-",kIDB=Symbol("idb"),kNamePrefix=Symbol("namePrefix"),kLocation=Symbol("location"),kVersion=Symbol("version"),kStore=Symbol("store"),kOnComplete=Symbol("onComplete"),kPromise=Symbol("promise");class BrowserLevel extends AbstractLevel{constructor(e,t,i){if(typeof t=="function"||typeof i=="function")throw new ModuleError("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:o,version:a,...c}=t||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},c),typeof e!="string")throw new Error("constructor requires a location string argument");this[kLocation]=e,this[kNamePrefix]=o??DEFAULT_PREFIX,this[kVersion]=parseInt(a||1,10),this[kIDB]=null}get location(){return this[kLocation]}get namePrefix(){return this[kNamePrefix]}get version(){return this[kVersion]}get db(){return this[kIDB]}get type(){return"browser-level"}_open(e,t){const i=indexedDB.open(this[kNamePrefix]+this[kLocation],this[kVersion]);i.onerror=function(){t(i.error||new Error("unknown error"))},i.onsuccess=()=>{this[kIDB]=i.result,t()},i.onupgradeneeded=o=>{const a=o.target.result;a.objectStoreNames.contains(this[kLocation])||a.createObjectStore(this[kLocation])}}[kStore](e){return this[kIDB].transaction([this[kLocation]],e).objectStore(this[kLocation])}[kOnComplete](e,t){const i=e.transaction;i.onabort=function(){t(i.error||new Error("aborted by user"))},i.oncomplete=function(){t(null,e.result)}}_get(e,t,i){const o=this[kStore]("readonly");let a;try{a=o.get(e)}catch(c){return this.nextTick(i,c)}this[kOnComplete](a,function(c,u){if(c)return i(c);if(u===void 0)return i(new ModuleError("Entry not found",{code:"LEVEL_NOT_FOUND"}));i(null,deserialize(u))})}_getMany(e,t,i){const o=this[kStore]("readonly"),a=e.map(c=>u=>{let d;try{d=o.get(c)}catch(p){return u(p)}d.onsuccess=()=>{const p=d.result;u(null,p===void 0?p:deserialize(p))},d.onerror=p=>{p.stopPropagation(),u(d.error)}});parallel(a,16,i)}_del(e,t,i){const o=this[kStore]("readwrite");let a;try{a=o.delete(e)}catch(c){return this.nextTick(i,c)}this[kOnComplete](a,i)}_put(e,t,i,o){const a=this[kStore]("readwrite");let c;try{c=a.put(t,e)}catch(u){return this.nextTick(o,u)}this[kOnComplete](c,o)}_iterator(e){return new Iterator(this,this[kLocation],e)}_batch(e,t,i){const o=this[kStore]("readwrite"),a=o.transaction;let c=0,u;a.onabort=function(){i(u||a.error||new Error("aborted by user"))},a.oncomplete=function(){i()};function d(){const p=e[c++],h=p.key;let b;try{b=p.type==="del"?o.delete(h):o.put(p.value,h)}catch(m){u=m,a.abort();return}c<e.length?b.onsuccess=d:typeof a.commit=="function"&&a.commit()}d()}_clear(e,t){let i,o;try{i=createKeyRange(e)}catch{return this.nextTick(t)}if(e.limit>=0)return clear$2(this,this[kLocation],i,e,t);try{const a=this[kStore]("readwrite");o=i?a.delete(i):a.clear()}catch(a){return this.nextTick(t,a)}this[kOnComplete](o,t)}_close(e){this[kIDB].close(),this.nextTick(e)}}BrowserLevel.destroy=function(n,e,t){typeof e=="function"&&(t=e,e=DEFAULT_PREFIX),t=fromCallback(t,kPromise);const i=indexedDB.deleteDatabase(e+n);return i.onsuccess=function(){t()},i.onerror=function(o){t(o)},t[kPromise]};browserLevel.BrowserLevel=BrowserLevel;var Level=browserLevel.BrowserLevel;class LevelDatastore extends BaseDatastore{constructor(e,t={}){super(),this.db=typeof e=="string"?new Level(e,{...t,keyEncoding:"utf8",valueEncoding:"view"}):e,this.opts={createIfMissing:!0,compression:!1,...t}}async open(){try{await this.db.open(this.opts)}catch(e){throw dbOpenFailedError(e)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(i){throw dbWriteFailedError(i)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(i){throw i.notFound?notFoundError(i):dbWriteFailedError(i)}return t}async has(e){try{await this.db.get(e.toString())}catch(t){if(t.notFound)return!1;throw t}return!0}async delete(e){try{await this.db.del(e.toString())}catch(t){throw dbDeleteFailedError(t)}}close(){return this.db&&this.db.close()}batch(){const e=[];return{put:(t,i)=>{e.push({type:"put",key:t.toString(),value:i})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce((a,c)=>filter$2(a,c),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((a,c)=>sort(a,c),t));const{offset:i,limit:o}=e;if(i){let a=0;t=filter$2(t,()=>a++>=i)}return o&&(t=take$2(t,o)),t}queryKeys(e){let t=map$2(this._query({values:!1,prefix:e.prefix}),({key:a})=>a);Array.isArray(e.filters)&&(t=e.filters.reduce((a,c)=>filter$2(a,c),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((a,c)=>sort(a,c),t));const{offset:i,limit:o}=e;if(i){let a=0;t=filter$2(t,()=>a++>=i)}return o&&(t=take$2(t,o)),t}_query(e){const t={keys:!0,keyEncoding:"buffer",values:e.values};if(e.prefix!=null){const o=e.prefix.toString();t.gte=o,t.lt=o+""}const i=this.db.iterator(t);if(i[Symbol.asyncIterator])return levelIteratorToIterator(i);if(i.next!=null&&i.end!=null)return oldLevelIteratorToIterator(i);throw new Error("Level returned incompatible iterator")}}async function*levelIteratorToIterator(n){for await(const[e,t]of n)yield{key:new Key(e,!1),value:t};await n.close()}function oldLevelIteratorToIterator(n){return{[Symbol.asyncIterator](){return{next:()=>new Promise((e,t)=>{n.next((i,o,a)=>{if(i)return t(i);if(o==null)return n.end(c=>{if(c)return t(c);e({done:!0,value:void 0})});e({done:!1,value:{key:new Key(o,!1),value:a}})})}),return:()=>new Promise((e,t)=>{n.end(i=>{if(i)return t(i);e({done:!0,value:void 0})})})}}}}function asUint8Array(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function allocUnsafe(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?asUint8Array(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function concat(n,e){e||(e=n.reduce((o,a)=>o+a.length,0));const t=allocUnsafe(e);let i=0;for(const o of n)t.set(o,i),i+=o.length;return asUint8Array(t)}function base$1(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var o=0;o<n.length;o++){var a=n.charAt(o),c=a.charCodeAt(0);if(t[c]!==255)throw new TypeError(a+" is ambiguous");t[c]=o}var u=n.length,d=n.charAt(0),p=Math.log(u)/Math.log(256),h=Math.log(256)/Math.log(u);function b(_){if(_ instanceof Uint8Array||(ArrayBuffer.isView(_)?_=new Uint8Array(_.buffer,_.byteOffset,_.byteLength):Array.isArray(_)&&(_=Uint8Array.from(_))),!(_ instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(_.length===0)return"";for(var $=0,k=0,D=0,O=_.length;D!==O&&_[D]===0;)D++,$++;for(var H=(O-D)*h+1>>>0,j=new Uint8Array(H);D!==O;){for(var W=_[D],ae=0,fe=H-1;(W!==0||ae<k)&&fe!==-1;fe--,ae++)W+=256*j[fe]>>>0,j[fe]=W%u>>>0,W=W/u>>>0;if(W!==0)throw new Error("Non-zero carry");k=ae,D++}for(var pe=H-k;pe!==H&&j[pe]===0;)pe++;for(var ve=d.repeat($);pe<H;++pe)ve+=n.charAt(j[pe]);return ve}function m(_){if(typeof _!="string")throw new TypeError("Expected String");if(_.length===0)return new Uint8Array;var $=0;if(_[$]!==" "){for(var k=0,D=0;_[$]===d;)k++,$++;for(var O=(_.length-$)*p+1>>>0,H=new Uint8Array(O);_[$];){var j=t[_.charCodeAt($)];if(j===255)return;for(var W=0,ae=O-1;(j!==0||W<D)&&ae!==-1;ae--,W++)j+=u*H[ae]>>>0,H[ae]=j%256>>>0,j=j/256>>>0;if(j!==0)throw new Error("Non-zero carry");D=W,$++}if(_[$]!==" "){for(var fe=O-D;fe!==O&&H[fe]===0;)fe++;for(var pe=new Uint8Array(k+(O-fe)),ve=k;fe!==O;)pe[ve++]=H[fe++];return pe}}}function v(_){var $=m(_);if($)return $;throw new Error(`Non-${e} character`)}return{encode:b,decodeUnsafe:m,decode:v}}var src$1=base$1,_brrp__multiformats_scope_baseX$1=src$1;const coerce$1=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},fromString$4=n=>new TextEncoder().encode(n),toString$4=n=>new TextDecoder().decode(n);let Encoder$1=class{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Decoder$1=class{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return or$1(this,e)}},ComposedDecoder$1=class{constructor(e){this.decoders=e}or(e){return or$1(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$1=(n,e)=>new ComposedDecoder$1({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});let Codec$1=class{constructor(e,t,i,o){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=o,this.encoder=new Encoder$1(e,t,i),this.decoder=new Decoder$1(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const from$2=({name:n,prefix:e,encode:t,decode:i})=>new Codec$1(n,e,t,i),baseX$1=({prefix:n,name:e,alphabet:t})=>{const{encode:i,decode:o}=_brrp__multiformats_scope_baseX$1(t,e);return from$2({prefix:n,name:e,encode:i,decode:a=>coerce$1(o(a))})},decode$b=(n,e,t,i)=>{const o={};for(let h=0;h<e.length;++h)o[e[h]]=h;let a=n.length;for(;n[a-1]==="=";)--a;const c=new Uint8Array(a*t/8|0);let u=0,d=0,p=0;for(let h=0;h<a;++h){const b=o[n[h]];if(b===void 0)throw new SyntaxError(`Non-${i} character`);d=d<<t|b,u+=t,u>=8&&(u-=8,c[p++]=255&d>>u)}if(u>=t||255&d<<8-u)throw new SyntaxError("Unexpected end of data");return c},encode$b=(n,e,t)=>{const i=e[e.length-1]==="=",o=(1<<t)-1;let a="",c=0,u=0;for(let d=0;d<n.length;++d)for(u=u<<8|n[d],c+=8;c>t;)c-=t,a+=e[o&u>>c];if(c&&(a+=e[o&u<<t-c]),i)for(;a.length*t&7;)a+="=";return a},rfc4648$1=({name:n,prefix:e,bitsPerChar:t,alphabet:i})=>from$2({prefix:e,name:n,encode(o){return encode$b(o,i,t)},decode(o){return decode$b(o,i,t,n)}}),identity$2=from$2({prefix:"\0",name:"identity",encode:n=>toString$4(n),decode:n=>fromString$4(n)}),identityBase$1=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$2},Symbol.toStringTag,{value:"Module"})),base2$2=rfc4648$1({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$3=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$2},Symbol.toStringTag,{value:"Module"})),base8$2=rfc4648$1({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$3=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$2},Symbol.toStringTag,{value:"Module"})),base10$2=baseX$1({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$3=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$2},Symbol.toStringTag,{value:"Module"})),base16$2=rfc4648$1({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$1=rfc4648$1({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$3=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$2,base16upper:base16upper$1},Symbol.toStringTag,{value:"Module"})),base32$2=rfc4648$1({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$1=rfc4648$1({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$1=rfc4648$1({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$1=rfc4648$1({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$1=rfc4648$1({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$1=rfc4648$1({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$1=rfc4648$1({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$1=rfc4648$1({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$1=rfc4648$1({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$3=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$2,base32hex:base32hex$1,base32hexpad:base32hexpad$1,base32hexpadupper:base32hexpadupper$1,base32hexupper:base32hexupper$1,base32pad:base32pad$1,base32padupper:base32padupper$1,base32upper:base32upper$1,base32z:base32z$1},Symbol.toStringTag,{value:"Module"})),base36$2=baseX$1({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$1=baseX$1({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$3=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$2,base36upper:base36upper$1},Symbol.toStringTag,{value:"Module"})),base58btc$1=baseX$1({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$1=baseX$1({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$1=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$1,base58flickr:base58flickr$1},Symbol.toStringTag,{value:"Module"})),base64$2=rfc4648$1({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$1=rfc4648$1({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$1=rfc4648$1({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$1=rfc4648$1({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$3=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$2,base64pad:base64pad$1,base64url:base64url$1,base64urlpad:base64urlpad$1},Symbol.toStringTag,{value:"Module"})),alphabet$1=Array.from(""),alphabetBytesToChars$1=alphabet$1.reduce((n,e,t)=>(n[t]=e,n),[]),alphabetCharsToBytes$1=alphabet$1.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function encode$a(n){return n.reduce((e,t)=>(e+=alphabetBytesToChars$1[t],e),"")}function decode$a(n){const e=[];for(const t of n){const i=alphabetCharsToBytes$1[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const base256emoji$2=from$2({prefix:"",name:"base256emoji",encode:encode$a,decode:decode$a}),base256emoji$3=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$2},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const bases$1={...identityBase$1,...base2$3,...base8$3,...base10$3,...base16$3,...base32$3,...base36$3,...base58$1,...base64$3,...base256emoji$3};function createCodec(n,e,t,i){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:i}}}const string=createCodec("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),ascii=createCodec("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=allocUnsafe(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),BASES={utf8:string,"utf-8":string,hex:bases$1.base16,latin1:ascii,ascii,binary:ascii,...bases$1};function fromString$3(n,e="utf8"){const t=BASES[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}function toString$3(n,e="utf8"){const t=BASES[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):t.encoder.encode(n).substring(1)}var localforage$1={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(n,e){(function(t){n.exports=t()})(function(){return function t(i,o,a){function c(p,h){if(!o[p]){if(!i[p]){var b=typeof commonjsRequire=="function"&&commonjsRequire;if(!h&&b)return b(p,!0);if(u)return u(p,!0);var m=new Error("Cannot find module '"+p+"'");throw m.code="MODULE_NOT_FOUND",m}var v=o[p]={exports:{}};i[p][0].call(v.exports,function(_){var $=i[p][1][_];return c($||_)},v,v.exports,t,i,o,a)}return o[p].exports}for(var u=typeof commonjsRequire=="function"&&commonjsRequire,d=0;d<a.length;d++)c(a[d]);return c}({1:[function(t,i,o){(function(a){var c=a.MutationObserver||a.WebKitMutationObserver,u;if(c){var d=0,p=new c(_),h=a.document.createTextNode("");p.observe(h,{characterData:!0}),u=function(){h.data=d=++d%2}}else if(!a.setImmediate&&typeof a.MessageChannel<"u"){var b=new a.MessageChannel;b.port1.onmessage=_,u=function(){b.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?u=function(){var k=a.document.createElement("script");k.onreadystatechange=function(){_(),k.onreadystatechange=null,k.parentNode.removeChild(k),k=null},a.document.documentElement.appendChild(k)}:u=function(){setTimeout(_,0)};var m,v=[];function _(){m=!0;for(var k,D,O=v.length;O;){for(D=v,v=[],k=-1;++k<O;)D[k]();O=v.length}m=!1}i.exports=$;function $(k){v.push(k)===1&&!m&&u()}}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,i,o){var a=t(1);function c(){}var u={},d=["REJECTED"],p=["FULFILLED"],h=["PENDING"];i.exports=b;function b(W){if(typeof W!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,W!==c&&$(this,W)}b.prototype.catch=function(W){return this.then(null,W)},b.prototype.then=function(W,ae){if(typeof W!="function"&&this.state===p||typeof ae!="function"&&this.state===d)return this;var fe=new this.constructor(c);if(this.state!==h){var pe=this.state===p?W:ae;v(fe,pe,this.outcome)}else this.queue.push(new m(fe,W,ae));return fe};function m(W,ae,fe){this.promise=W,typeof ae=="function"&&(this.onFulfilled=ae,this.callFulfilled=this.otherCallFulfilled),typeof fe=="function"&&(this.onRejected=fe,this.callRejected=this.otherCallRejected)}m.prototype.callFulfilled=function(W){u.resolve(this.promise,W)},m.prototype.otherCallFulfilled=function(W){v(this.promise,this.onFulfilled,W)},m.prototype.callRejected=function(W){u.reject(this.promise,W)},m.prototype.otherCallRejected=function(W){v(this.promise,this.onRejected,W)};function v(W,ae,fe){a(function(){var pe;try{pe=ae(fe)}catch(ve){return u.reject(W,ve)}pe===W?u.reject(W,new TypeError("Cannot resolve promise with itself")):u.resolve(W,pe)})}u.resolve=function(W,ae){var fe=k(_,ae);if(fe.status==="error")return u.reject(W,fe.value);var pe=fe.value;if(pe)$(W,pe);else{W.state=p,W.outcome=ae;for(var ve=-1,Qe=W.queue.length;++ve<Qe;)W.queue[ve].callFulfilled(ae)}return W},u.reject=function(W,ae){W.state=d,W.outcome=ae;for(var fe=-1,pe=W.queue.length;++fe<pe;)W.queue[fe].callRejected(ae);return W};function _(W){var ae=W&&W.then;if(W&&(typeof W=="object"||typeof W=="function")&&typeof ae=="function")return function(){ae.apply(W,arguments)}}function $(W,ae){var fe=!1;function pe(C){fe||(fe=!0,u.reject(W,C))}function ve(C){fe||(fe=!0,u.resolve(W,C))}function Qe(){ae(ve,pe)}var re=k(Qe);re.status==="error"&&pe(re.value)}function k(W,ae){var fe={};try{fe.value=W(ae),fe.status="success"}catch(pe){fe.status="error",fe.value=pe}return fe}b.resolve=D;function D(W){return W instanceof this?W:u.resolve(new this(c),W)}b.reject=O;function O(W){var ae=new this(c);return u.reject(ae,W)}b.all=H;function H(W){var ae=this;if(Object.prototype.toString.call(W)!=="[object Array]")return this.reject(new TypeError("must be an array"));var fe=W.length,pe=!1;if(!fe)return this.resolve([]);for(var ve=new Array(fe),Qe=0,re=-1,C=new this(c);++re<fe;)S(W[re],re);return C;function S(w,E){ae.resolve(w).then(I,function(N){pe||(pe=!0,u.reject(C,N))});function I(N){ve[E]=N,++Qe===fe&&!pe&&(pe=!0,u.resolve(C,ve))}}}b.race=j;function j(W){var ae=this;if(Object.prototype.toString.call(W)!=="[object Array]")return this.reject(new TypeError("must be an array"));var fe=W.length,pe=!1;if(!fe)return this.resolve([]);for(var ve=-1,Qe=new this(c);++ve<fe;)re(W[ve]);return Qe;function re(C){ae.resolve(C).then(function(S){pe||(pe=!0,u.resolve(Qe,S))},function(S){pe||(pe=!0,u.reject(Qe,S))})}}},{1:1}],3:[function(t,i,o){(function(a){typeof a.Promise!="function"&&(a.Promise=t(2))}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,i,o){var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q};function c(q,te){if(!(q instanceof te))throw new TypeError("Cannot call a class as a function")}function u(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var d=u();function p(){try{if(!d||!d.open)return!1;var q=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),te=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!q||te)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function h(q,te){q=q||[],te=te||{};try{return new Blob(q,te)}catch(le){if(le.name!=="TypeError")throw le;for(var J=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,ce=new J,ye=0;ye<q.length;ye+=1)ce.append(q[ye]);return ce.getBlob(te.type)}}typeof Promise>"u"&&t(3);var b=Promise;function m(q,te){te&&q.then(function(J){te(null,J)},function(J){te(J)})}function v(q,te,J){typeof te=="function"&&q.then(te),typeof J=="function"&&q.catch(J)}function _(q){return typeof q!="string"&&(console.warn(q+" used as a key, but it is not a string."),q=String(q)),q}function $(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var k="local-forage-detect-blob-support",D=void 0,O={},H=Object.prototype.toString,j="readonly",W="readwrite";function ae(q){for(var te=q.length,J=new ArrayBuffer(te),ce=new Uint8Array(J),ye=0;ye<te;ye++)ce[ye]=q.charCodeAt(ye);return J}function fe(q){return new b(function(te){var J=q.transaction(k,W),ce=h([""]);J.objectStore(k).put(ce,"key"),J.onabort=function(ye){ye.preventDefault(),ye.stopPropagation(),te(!1)},J.oncomplete=function(){var ye=navigator.userAgent.match(/Chrome\/(\d+)/),le=navigator.userAgent.match(/Edge\//);te(le||!ye||parseInt(ye[1],10)>=43)}}).catch(function(){return!1})}function pe(q){return typeof D=="boolean"?b.resolve(D):fe(q).then(function(te){return D=te,D})}function ve(q){var te=O[q.name],J={};J.promise=new b(function(ce,ye){J.resolve=ce,J.reject=ye}),te.deferredOperations.push(J),te.dbReady?te.dbReady=te.dbReady.then(function(){return J.promise}):te.dbReady=J.promise}function Qe(q){var te=O[q.name],J=te.deferredOperations.pop();if(J)return J.resolve(),J.promise}function re(q,te){var J=O[q.name],ce=J.deferredOperations.pop();if(ce)return ce.reject(te),ce.promise}function C(q,te){return new b(function(J,ce){if(O[q.name]=O[q.name]||A(),q.db)if(te)ve(q),q.db.close();else return J(q.db);var ye=[q.name];te&&ye.push(q.version);var le=d.open.apply(d,ye);te&&(le.onupgradeneeded=function(Se){var ee=le.result;try{ee.createObjectStore(q.storeName),Se.oldVersion<=1&&ee.createObjectStore(k)}catch(Oe){if(Oe.name==="ConstraintError")console.warn('The database "'+q.name+'" has been upgraded from version '+Se.oldVersion+" to version "+Se.newVersion+', but the storage "'+q.storeName+'" already exists.');else throw Oe}}),le.onerror=function(Se){Se.preventDefault(),ce(le.error)},le.onsuccess=function(){var Se=le.result;Se.onversionchange=function(ee){ee.target.close()},J(Se),Qe(q)}})}function S(q){return C(q,!1)}function w(q){return C(q,!0)}function E(q,te){if(!q.db)return!0;var J=!q.db.objectStoreNames.contains(q.storeName),ce=q.version<q.db.version,ye=q.version>q.db.version;if(ce&&(q.version!==te&&console.warn('The database "'+q.name+`" can't be downgraded from version `+q.db.version+" to version "+q.version+"."),q.version=q.db.version),ye||J){if(J){var le=q.db.version+1;le>q.version&&(q.version=le)}return!0}return!1}function I(q){return new b(function(te,J){var ce=new FileReader;ce.onerror=J,ce.onloadend=function(ye){var le=btoa(ye.target.result||"");te({__local_forage_encoded_blob:!0,data:le,type:q.type})},ce.readAsBinaryString(q)})}function N(q){var te=ae(atob(q.data));return h([te],{type:q.type})}function U(q){return q&&q.__local_forage_encoded_blob}function L(q){var te=this,J=te._initReady().then(function(){var ce=O[te._dbInfo.name];if(ce&&ce.dbReady)return ce.dbReady});return v(J,q,q),J}function P(q){ve(q);for(var te=O[q.name],J=te.forages,ce=0;ce<J.length;ce++){var ye=J[ce];ye._dbInfo.db&&(ye._dbInfo.db.close(),ye._dbInfo.db=null)}return q.db=null,S(q).then(function(le){return q.db=le,E(q)?w(q):le}).then(function(le){q.db=te.db=le;for(var Se=0;Se<J.length;Se++)J[Se]._dbInfo.db=le}).catch(function(le){throw re(q,le),le})}function B(q,te,J,ce){ce===void 0&&(ce=1);try{var ye=q.db.transaction(q.storeName,te);J(null,ye)}catch(le){if(ce>0&&(!q.db||le.name==="InvalidStateError"||le.name==="NotFoundError"))return b.resolve().then(function(){if(!q.db||le.name==="NotFoundError"&&!q.db.objectStoreNames.contains(q.storeName)&&q.version<=q.db.version)return q.db&&(q.version=q.db.version+1),w(q)}).then(function(){return P(q).then(function(){B(q,te,J,ce-1)})}).catch(J);J(le)}}function A(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function z(q){var te=this,J={db:null};if(q)for(var ce in q)J[ce]=q[ce];var ye=O[J.name];ye||(ye=A(),O[J.name]=ye),ye.forages.push(te),te._initReady||(te._initReady=te.ready,te.ready=L);var le=[];function Se(){return b.resolve()}for(var ee=0;ee<ye.forages.length;ee++){var Oe=ye.forages[ee];Oe!==te&&le.push(Oe._initReady().catch(Se))}var Fe=ye.forages.slice(0);return b.all(le).then(function(){return J.db=ye.db,S(J)}).then(function(Le){return J.db=Le,E(J,te._defaultConfig.version)?w(J):Le}).then(function(Le){J.db=ye.db=Le,te._dbInfo=J;for(var Ge=0;Ge<Fe.length;Ge++){var ct=Fe[Ge];ct!==te&&(ct._dbInfo.db=J.db,ct._dbInfo.version=J.version)}})}function de(q,te){var J=this;q=_(q);var ce=new b(function(ye,le){J.ready().then(function(){B(J._dbInfo,j,function(Se,ee){if(Se)return le(Se);try{var Oe=ee.objectStore(J._dbInfo.storeName),Fe=Oe.get(q);Fe.onsuccess=function(){var Le=Fe.result;Le===void 0&&(Le=null),U(Le)&&(Le=N(Le)),ye(Le)},Fe.onerror=function(){le(Fe.error)}}catch(Le){le(Le)}})}).catch(le)});return m(ce,te),ce}function we(q,te){var J=this,ce=new b(function(ye,le){J.ready().then(function(){B(J._dbInfo,j,function(Se,ee){if(Se)return le(Se);try{var Oe=ee.objectStore(J._dbInfo.storeName),Fe=Oe.openCursor(),Le=1;Fe.onsuccess=function(){var Ge=Fe.result;if(Ge){var ct=Ge.value;U(ct)&&(ct=N(ct));var bt=q(ct,Ge.key,Le++);bt!==void 0?ye(bt):Ge.continue()}else ye()},Fe.onerror=function(){le(Fe.error)}}catch(Ge){le(Ge)}})}).catch(le)});return m(ce,te),ce}function se(q,te,J){var ce=this;q=_(q);var ye=new b(function(le,Se){var ee;ce.ready().then(function(){return ee=ce._dbInfo,H.call(te)==="[object Blob]"?pe(ee.db).then(function(Oe){return Oe?te:I(te)}):te}).then(function(Oe){B(ce._dbInfo,W,function(Fe,Le){if(Fe)return Se(Fe);try{var Ge=Le.objectStore(ce._dbInfo.storeName);Oe===null&&(Oe=void 0);var ct=Ge.put(Oe,q);Le.oncomplete=function(){Oe===void 0&&(Oe=null),le(Oe)},Le.onabort=Le.onerror=function(){var bt=ct.error?ct.error:ct.transaction.error;Se(bt)}}catch(bt){Se(bt)}})}).catch(Se)});return m(ye,J),ye}function he(q,te){var J=this;q=_(q);var ce=new b(function(ye,le){J.ready().then(function(){B(J._dbInfo,W,function(Se,ee){if(Se)return le(Se);try{var Oe=ee.objectStore(J._dbInfo.storeName),Fe=Oe.delete(q);ee.oncomplete=function(){ye()},ee.onerror=function(){le(Fe.error)},ee.onabort=function(){var Le=Fe.error?Fe.error:Fe.transaction.error;le(Le)}}catch(Le){le(Le)}})}).catch(le)});return m(ce,te),ce}function $e(q){var te=this,J=new b(function(ce,ye){te.ready().then(function(){B(te._dbInfo,W,function(le,Se){if(le)return ye(le);try{var ee=Se.objectStore(te._dbInfo.storeName),Oe=ee.clear();Se.oncomplete=function(){ce()},Se.onabort=Se.onerror=function(){var Fe=Oe.error?Oe.error:Oe.transaction.error;ye(Fe)}}catch(Fe){ye(Fe)}})}).catch(ye)});return m(J,q),J}function Ae(q){var te=this,J=new b(function(ce,ye){te.ready().then(function(){B(te._dbInfo,j,function(le,Se){if(le)return ye(le);try{var ee=Se.objectStore(te._dbInfo.storeName),Oe=ee.count();Oe.onsuccess=function(){ce(Oe.result)},Oe.onerror=function(){ye(Oe.error)}}catch(Fe){ye(Fe)}})}).catch(ye)});return m(J,q),J}function ze(q,te){var J=this,ce=new b(function(ye,le){if(q<0){ye(null);return}J.ready().then(function(){B(J._dbInfo,j,function(Se,ee){if(Se)return le(Se);try{var Oe=ee.objectStore(J._dbInfo.storeName),Fe=!1,Le=Oe.openKeyCursor();Le.onsuccess=function(){var Ge=Le.result;if(!Ge){ye(null);return}q===0||Fe?ye(Ge.key):(Fe=!0,Ge.advance(q))},Le.onerror=function(){le(Le.error)}}catch(Ge){le(Ge)}})}).catch(le)});return m(ce,te),ce}function oe(q){var te=this,J=new b(function(ce,ye){te.ready().then(function(){B(te._dbInfo,j,function(le,Se){if(le)return ye(le);try{var ee=Se.objectStore(te._dbInfo.storeName),Oe=ee.openKeyCursor(),Fe=[];Oe.onsuccess=function(){var Le=Oe.result;if(!Le){ce(Fe);return}Fe.push(Le.key),Le.continue()},Oe.onerror=function(){ye(Oe.error)}}catch(Le){ye(Le)}})}).catch(ye)});return m(J,q),J}function ie(q,te){te=$.apply(this,arguments);var J=this.config();q=typeof q!="function"&&q||{},q.name||(q.name=q.name||J.name,q.storeName=q.storeName||J.storeName);var ce=this,ye;if(!q.name)ye=b.reject("Invalid arguments");else{var le=q.name===J.name&&ce._dbInfo.db,Se=le?b.resolve(ce._dbInfo.db):S(q).then(function(ee){var Oe=O[q.name],Fe=Oe.forages;Oe.db=ee;for(var Le=0;Le<Fe.length;Le++)Fe[Le]._dbInfo.db=ee;return ee});q.storeName?ye=Se.then(function(ee){if(ee.objectStoreNames.contains(q.storeName)){var Oe=ee.version+1;ve(q);var Fe=O[q.name],Le=Fe.forages;ee.close();for(var Ge=0;Ge<Le.length;Ge++){var ct=Le[Ge];ct._dbInfo.db=null,ct._dbInfo.version=Oe}var bt=new b(function(Pt,Mt){var Rt=d.open(q.name,Oe);Rt.onerror=function(Jt){var cr=Rt.result;cr.close(),Mt(Jt)},Rt.onupgradeneeded=function(){var Jt=Rt.result;Jt.deleteObjectStore(q.storeName)},Rt.onsuccess=function(){var Jt=Rt.result;Jt.close(),Pt(Jt)}});return bt.then(function(Pt){Fe.db=Pt;for(var Mt=0;Mt<Le.length;Mt++){var Rt=Le[Mt];Rt._dbInfo.db=Pt,Qe(Rt._dbInfo)}}).catch(function(Pt){throw(re(q,Pt)||b.resolve()).catch(function(){}),Pt})}}):ye=Se.then(function(ee){ve(q);var Oe=O[q.name],Fe=Oe.forages;ee.close();for(var Le=0;Le<Fe.length;Le++){var Ge=Fe[Le];Ge._dbInfo.db=null}var ct=new b(function(bt,Pt){var Mt=d.deleteDatabase(q.name);Mt.onerror=function(){var Rt=Mt.result;Rt&&Rt.close(),Pt(Mt.error)},Mt.onblocked=function(){console.warn('dropInstance blocked for database "'+q.name+'" until all open connections are closed')},Mt.onsuccess=function(){var Rt=Mt.result;Rt&&Rt.close(),bt(Rt)}});return ct.then(function(bt){Oe.db=bt;for(var Pt=0;Pt<Fe.length;Pt++){var Mt=Fe[Pt];Qe(Mt._dbInfo)}}).catch(function(bt){throw(re(q,bt)||b.resolve()).catch(function(){}),bt})})}return m(ye,te),ye}var Ie={_driver:"asyncStorage",_initStorage:z,_support:p(),iterate:we,getItem:de,setItem:se,removeItem:he,clear:$e,length:Ae,key:ze,keys:oe,dropInstance:ie};function qe(){return typeof openDatabase=="function"}var Ze="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lt="~~local_forage_type~",ht=/^~~local_forage_type~([^~]+)~/,gt="__lfsc__:",Me=gt.length,jt="arbf",ot="blob",Ot="si08",Ut="ui08",be="uic8",Pe="si16",Be="si32",Re="ur16",Ye="ui32",Tt="fl32",Je="fl64",dt=Me+jt.length,rt=Object.prototype.toString;function et(q){var te=q.length*.75,J=q.length,ce,ye=0,le,Se,ee,Oe;q[q.length-1]==="="&&(te--,q[q.length-2]==="="&&te--);var Fe=new ArrayBuffer(te),Le=new Uint8Array(Fe);for(ce=0;ce<J;ce+=4)le=Ze.indexOf(q[ce]),Se=Ze.indexOf(q[ce+1]),ee=Ze.indexOf(q[ce+2]),Oe=Ze.indexOf(q[ce+3]),Le[ye++]=le<<2|Se>>4,Le[ye++]=(Se&15)<<4|ee>>2,Le[ye++]=(ee&3)<<6|Oe&63;return Fe}function pt(q){var te=new Uint8Array(q),J="",ce;for(ce=0;ce<te.length;ce+=3)J+=Ze[te[ce]>>2],J+=Ze[(te[ce]&3)<<4|te[ce+1]>>4],J+=Ze[(te[ce+1]&15)<<2|te[ce+2]>>6],J+=Ze[te[ce+2]&63];return te.length%3===2?J=J.substring(0,J.length-1)+"=":te.length%3===1&&(J=J.substring(0,J.length-2)+"=="),J}function Kt(q,te){var J="";if(q&&(J=rt.call(q)),q&&(J==="[object ArrayBuffer]"||q.buffer&&rt.call(q.buffer)==="[object ArrayBuffer]")){var ce,ye=gt;q instanceof ArrayBuffer?(ce=q,ye+=jt):(ce=q.buffer,J==="[object Int8Array]"?ye+=Ot:J==="[object Uint8Array]"?ye+=Ut:J==="[object Uint8ClampedArray]"?ye+=be:J==="[object Int16Array]"?ye+=Pe:J==="[object Uint16Array]"?ye+=Re:J==="[object Int32Array]"?ye+=Be:J==="[object Uint32Array]"?ye+=Ye:J==="[object Float32Array]"?ye+=Tt:J==="[object Float64Array]"?ye+=Je:te(new Error("Failed to get type for BinaryArray"))),te(ye+pt(ce))}else if(J==="[object Blob]"){var le=new FileReader;le.onload=function(){var Se=lt+q.type+"~"+pt(this.result);te(gt+ot+Se)},le.readAsArrayBuffer(q)}else try{te(JSON.stringify(q))}catch(Se){console.error("Couldn't convert value into a JSON string: ",q),te(null,Se)}}function Ct(q){if(q.substring(0,Me)!==gt)return JSON.parse(q);var te=q.substring(dt),J=q.substring(Me,dt),ce;if(J===ot&&ht.test(te)){var ye=te.match(ht);ce=ye[1],te=te.substring(ye[0].length)}var le=et(te);switch(J){case jt:return le;case ot:return h([le],{type:ce});case Ot:return new Int8Array(le);case Ut:return new Uint8Array(le);case be:return new Uint8ClampedArray(le);case Pe:return new Int16Array(le);case Re:return new Uint16Array(le);case Be:return new Int32Array(le);case Ye:return new Uint32Array(le);case Tt:return new Float32Array(le);case Je:return new Float64Array(le);default:throw new Error("Unkown type: "+J)}}var er={serialize:Kt,deserialize:Ct,stringToBuffer:et,bufferToString:pt};function nr(q,te,J,ce){q.executeSql("CREATE TABLE IF NOT EXISTS "+te.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],J,ce)}function It(q){var te=this,J={db:null};if(q)for(var ce in q)J[ce]=typeof q[ce]!="string"?q[ce].toString():q[ce];var ye=new b(function(le,Se){try{J.db=openDatabase(J.name,String(J.version),J.description,J.size)}catch(ee){return Se(ee)}J.db.transaction(function(ee){nr(ee,J,function(){te._dbInfo=J,le()},function(Oe,Fe){Se(Fe)})},Se)});return J.serializer=er,ye}function Qt(q,te,J,ce,ye,le){q.executeSql(J,ce,ye,function(Se,ee){ee.code===ee.SYNTAX_ERR?Se.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[te.storeName],function(Oe,Fe){Fe.rows.length?le(Oe,ee):nr(Oe,te,function(){Oe.executeSql(J,ce,ye,le)},le)},le):le(Se,ee)},le)}function fr(q,te){var J=this;q=_(q);var ce=new b(function(ye,le){J.ready().then(function(){var Se=J._dbInfo;Se.db.transaction(function(ee){Qt(ee,Se,"SELECT * FROM "+Se.storeName+" WHERE key = ? LIMIT 1",[q],function(Oe,Fe){var Le=Fe.rows.length?Fe.rows.item(0).value:null;Le&&(Le=Se.serializer.deserialize(Le)),ye(Le)},function(Oe,Fe){le(Fe)})})}).catch(le)});return m(ce,te),ce}function qt(q,te){var J=this,ce=new b(function(ye,le){J.ready().then(function(){var Se=J._dbInfo;Se.db.transaction(function(ee){Qt(ee,Se,"SELECT * FROM "+Se.storeName,[],function(Oe,Fe){for(var Le=Fe.rows,Ge=Le.length,ct=0;ct<Ge;ct++){var bt=Le.item(ct),Pt=bt.value;if(Pt&&(Pt=Se.serializer.deserialize(Pt)),Pt=q(Pt,bt.key,ct+1),Pt!==void 0){ye(Pt);return}}ye()},function(Oe,Fe){le(Fe)})})}).catch(le)});return m(ce,te),ce}function lr(q,te,J,ce){var ye=this;q=_(q);var le=new b(function(Se,ee){ye.ready().then(function(){te===void 0&&(te=null);var Oe=te,Fe=ye._dbInfo;Fe.serializer.serialize(te,function(Le,Ge){Ge?ee(Ge):Fe.db.transaction(function(ct){Qt(ct,Fe,"INSERT OR REPLACE INTO "+Fe.storeName+" (key, value) VALUES (?, ?)",[q,Le],function(){Se(Oe)},function(bt,Pt){ee(Pt)})},function(ct){if(ct.code===ct.QUOTA_ERR){if(ce>0){Se(lr.apply(ye,[q,Oe,J,ce-1]));return}ee(ct)}})})}).catch(ee)});return m(le,J),le}function Xt(q,te,J){return lr.apply(this,[q,te,J,1])}function Dt(q,te){var J=this;q=_(q);var ce=new b(function(ye,le){J.ready().then(function(){var Se=J._dbInfo;Se.db.transaction(function(ee){Qt(ee,Se,"DELETE FROM "+Se.storeName+" WHERE key = ?",[q],function(){ye()},function(Oe,Fe){le(Fe)})})}).catch(le)});return m(ce,te),ce}function ir(q){var te=this,J=new b(function(ce,ye){te.ready().then(function(){var le=te._dbInfo;le.db.transaction(function(Se){Qt(Se,le,"DELETE FROM "+le.storeName,[],function(){ce()},function(ee,Oe){ye(Oe)})})}).catch(ye)});return m(J,q),J}function ar(q){var te=this,J=new b(function(ce,ye){te.ready().then(function(){var le=te._dbInfo;le.db.transaction(function(Se){Qt(Se,le,"SELECT COUNT(key) as c FROM "+le.storeName,[],function(ee,Oe){var Fe=Oe.rows.item(0).c;ce(Fe)},function(ee,Oe){ye(Oe)})})}).catch(ye)});return m(J,q),J}function Lt(q,te){var J=this,ce=new b(function(ye,le){J.ready().then(function(){var Se=J._dbInfo;Se.db.transaction(function(ee){Qt(ee,Se,"SELECT key FROM "+Se.storeName+" WHERE id = ? LIMIT 1",[q+1],function(Oe,Fe){var Le=Fe.rows.length?Fe.rows.item(0).key:null;ye(Le)},function(Oe,Fe){le(Fe)})})}).catch(le)});return m(ce,te),ce}function dr(q){var te=this,J=new b(function(ce,ye){te.ready().then(function(){var le=te._dbInfo;le.db.transaction(function(Se){Qt(Se,le,"SELECT key FROM "+le.storeName,[],function(ee,Oe){for(var Fe=[],Le=0;Le<Oe.rows.length;Le++)Fe.push(Oe.rows.item(Le).key);ce(Fe)},function(ee,Oe){ye(Oe)})})}).catch(ye)});return m(J,q),J}function yr(q){return new b(function(te,J){q.transaction(function(ce){ce.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(ye,le){for(var Se=[],ee=0;ee<le.rows.length;ee++)Se.push(le.rows.item(ee).name);te({db:q,storeNames:Se})},function(ye,le){J(le)})},function(ce){J(ce)})})}function _t(q,te){te=$.apply(this,arguments);var J=this.config();q=typeof q!="function"&&q||{},q.name||(q.name=q.name||J.name,q.storeName=q.storeName||J.storeName);var ce=this,ye;return q.name?ye=new b(function(le){var Se;q.name===J.name?Se=ce._dbInfo.db:Se=openDatabase(q.name,"","",0),q.storeName?le({db:Se,storeNames:[q.storeName]}):le(yr(Se))}).then(function(le){return new b(function(Se,ee){le.db.transaction(function(Oe){function Fe(bt){return new b(function(Pt,Mt){Oe.executeSql("DROP TABLE IF EXISTS "+bt,[],function(){Pt()},function(Rt,Jt){Mt(Jt)})})}for(var Le=[],Ge=0,ct=le.storeNames.length;Ge<ct;Ge++)Le.push(Fe(le.storeNames[Ge]));b.all(Le).then(function(){Se()}).catch(function(bt){ee(bt)})},function(Oe){ee(Oe)})})}):ye=b.reject("Invalid arguments"),m(ye,te),ye}var hr={_driver:"webSQLStorage",_initStorage:It,_support:qe(),iterate:qt,getItem:fr,setItem:Xt,removeItem:Dt,clear:ir,length:ar,key:Lt,keys:dr,dropInstance:_t};function F(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Y(q,te){var J=q.name+"/";return q.storeName!==te.storeName&&(J+=q.storeName+"/"),J}function Q(){var q="_localforage_support_test";try{return localStorage.setItem(q,!0),localStorage.removeItem(q),!1}catch{return!0}}function M(){return!Q()||localStorage.length>0}function X(q){var te=this,J={};if(q)for(var ce in q)J[ce]=q[ce];return J.keyPrefix=Y(q,te._defaultConfig),M()?(te._dbInfo=J,J.serializer=er,b.resolve()):b.reject()}function ge(q){var te=this,J=te.ready().then(function(){for(var ce=te._dbInfo.keyPrefix,ye=localStorage.length-1;ye>=0;ye--){var le=localStorage.key(ye);le.indexOf(ce)===0&&localStorage.removeItem(le)}});return m(J,q),J}function _e(q,te){var J=this;q=_(q);var ce=J.ready().then(function(){var ye=J._dbInfo,le=localStorage.getItem(ye.keyPrefix+q);return le&&(le=ye.serializer.deserialize(le)),le});return m(ce,te),ce}function Ce(q,te){var J=this,ce=J.ready().then(function(){for(var ye=J._dbInfo,le=ye.keyPrefix,Se=le.length,ee=localStorage.length,Oe=1,Fe=0;Fe<ee;Fe++){var Le=localStorage.key(Fe);if(Le.indexOf(le)===0){var Ge=localStorage.getItem(Le);if(Ge&&(Ge=ye.serializer.deserialize(Ge)),Ge=q(Ge,Le.substring(Se),Oe++),Ge!==void 0)return Ge}}});return m(ce,te),ce}function je(q,te){var J=this,ce=J.ready().then(function(){var ye=J._dbInfo,le;try{le=localStorage.key(q)}catch{le=null}return le&&(le=le.substring(ye.keyPrefix.length)),le});return m(ce,te),ce}function Xe(q){var te=this,J=te.ready().then(function(){for(var ce=te._dbInfo,ye=localStorage.length,le=[],Se=0;Se<ye;Se++){var ee=localStorage.key(Se);ee.indexOf(ce.keyPrefix)===0&&le.push(ee.substring(ce.keyPrefix.length))}return le});return m(J,q),J}function Ve(q){var te=this,J=te.keys().then(function(ce){return ce.length});return m(J,q),J}function zt(q,te){var J=this;q=_(q);var ce=J.ready().then(function(){var ye=J._dbInfo;localStorage.removeItem(ye.keyPrefix+q)});return m(ce,te),ce}function at(q,te,J){var ce=this;q=_(q);var ye=ce.ready().then(function(){te===void 0&&(te=null);var le=te;return new b(function(Se,ee){var Oe=ce._dbInfo;Oe.serializer.serialize(te,function(Fe,Le){if(Le)ee(Le);else try{localStorage.setItem(Oe.keyPrefix+q,Fe),Se(le)}catch(Ge){(Ge.name==="QuotaExceededError"||Ge.name==="NS_ERROR_DOM_QUOTA_REACHED")&&ee(Ge),ee(Ge)}})})});return m(ye,J),ye}function xt(q,te){if(te=$.apply(this,arguments),q=typeof q!="function"&&q||{},!q.name){var J=this.config();q.name=q.name||J.name,q.storeName=q.storeName||J.storeName}var ce=this,ye;return q.name?ye=new b(function(le){q.storeName?le(Y(q,ce._defaultConfig)):le(q.name+"/")}).then(function(le){for(var Se=localStorage.length-1;Se>=0;Se--){var ee=localStorage.key(Se);ee.indexOf(le)===0&&localStorage.removeItem(ee)}}):ye=b.reject("Invalid arguments"),m(ye,te),ye}var St={_driver:"localStorageWrapper",_initStorage:X,_support:F(),iterate:Ce,getItem:_e,setItem:at,removeItem:zt,clear:ge,length:Ve,key:je,keys:Xe,dropInstance:xt},kt=function(te,J){return te===J||typeof te=="number"&&typeof J=="number"&&isNaN(te)&&isNaN(J)},At=function(te,J){for(var ce=te.length,ye=0;ye<ce;){if(kt(te[ye],J))return!0;ye++}return!1},$t=Array.isArray||function(q){return Object.prototype.toString.call(q)==="[object Array]"},vt={},Et={},it={INDEXEDDB:Ie,WEBSQL:hr,LOCALSTORAGE:St},yt=[it.INDEXEDDB._driver,it.WEBSQL._driver,it.LOCALSTORAGE._driver],tt=["dropInstance"],st=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(tt),ft={description:"",driver:yt.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function nt(q,te){q[te]=function(){var J=arguments;return q.ready().then(function(){return q[te].apply(q,J)})}}function ke(){for(var q=1;q<arguments.length;q++){var te=arguments[q];if(te)for(var J in te)te.hasOwnProperty(J)&&($t(te[J])?arguments[0][J]=te[J].slice():arguments[0][J]=te[J])}return arguments[0]}var De=function(){function q(te){c(this,q);for(var J in it)if(it.hasOwnProperty(J)){var ce=it[J],ye=ce._driver;this[J]=ye,vt[ye]||this.defineDriver(ce)}this._defaultConfig=ke({},ft),this._config=ke({},this._defaultConfig,te),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return q.prototype.config=function(J){if((typeof J>"u"?"undefined":a(J))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var ce in J){if(ce==="storeName"&&(J[ce]=J[ce].replace(/\W/g,"_")),ce==="version"&&typeof J[ce]!="number")return new Error("Database version must be a number.");this._config[ce]=J[ce]}return"driver"in J&&J.driver?this.setDriver(this._config.driver):!0}else return typeof J=="string"?this._config[J]:this._config},q.prototype.defineDriver=function(J,ce,ye){var le=new b(function(Se,ee){try{var Oe=J._driver,Fe=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!J._driver){ee(Fe);return}for(var Le=st.concat("_initStorage"),Ge=0,ct=Le.length;Ge<ct;Ge++){var bt=Le[Ge],Pt=!At(tt,bt);if((Pt||J[bt])&&typeof J[bt]!="function"){ee(Fe);return}}var Mt=function(){for(var cr=function(bi){return function(){var no=new Error("Method "+bi+" is not implemented by the current driver"),mi=b.reject(no);return m(mi,arguments[arguments.length-1]),mi}},_r=0,Ar=tt.length;_r<Ar;_r++){var $r=tt[_r];J[$r]||(J[$r]=cr($r))}};Mt();var Rt=function(cr){vt[Oe]&&console.info("Redefining LocalForage driver: "+Oe),vt[Oe]=J,Et[Oe]=cr,Se()};"_support"in J?J._support&&typeof J._support=="function"?J._support().then(Rt,ee):Rt(!!J._support):Rt(!0)}catch(Jt){ee(Jt)}});return v(le,ce,ye),le},q.prototype.driver=function(){return this._driver||null},q.prototype.getDriver=function(J,ce,ye){var le=vt[J]?b.resolve(vt[J]):b.reject(new Error("Driver not found."));return v(le,ce,ye),le},q.prototype.getSerializer=function(J){var ce=b.resolve(er);return v(ce,J),ce},q.prototype.ready=function(J){var ce=this,ye=ce._driverSet.then(function(){return ce._ready===null&&(ce._ready=ce._initDriver()),ce._ready});return v(ye,J,J),ye},q.prototype.setDriver=function(J,ce,ye){var le=this;$t(J)||(J=[J]);var Se=this._getSupportedDrivers(J);function ee(){le._config.driver=le.driver()}function Oe(Ge){return le._extend(Ge),ee(),le._ready=le._initStorage(le._config),le._ready}function Fe(Ge){return function(){var ct=0;function bt(){for(;ct<Ge.length;){var Pt=Ge[ct];return ct++,le._dbInfo=null,le._ready=null,le.getDriver(Pt).then(Oe).catch(bt)}ee();var Mt=new Error("No available storage method found.");return le._driverSet=b.reject(Mt),le._driverSet}return bt()}}var Le=this._driverSet!==null?this._driverSet.catch(function(){return b.resolve()}):b.resolve();return this._driverSet=Le.then(function(){var Ge=Se[0];return le._dbInfo=null,le._ready=null,le.getDriver(Ge).then(function(ct){le._driver=ct._driver,ee(),le._wrapLibraryMethodsWithReady(),le._initDriver=Fe(Se)})}).catch(function(){ee();var Ge=new Error("No available storage method found.");return le._driverSet=b.reject(Ge),le._driverSet}),v(this._driverSet,ce,ye),this._driverSet},q.prototype.supports=function(J){return!!Et[J]},q.prototype._extend=function(J){ke(this,J)},q.prototype._getSupportedDrivers=function(J){for(var ce=[],ye=0,le=J.length;ye<le;ye++){var Se=J[ye];this.supports(Se)&&ce.push(Se)}return ce},q.prototype._wrapLibraryMethodsWithReady=function(){for(var J=0,ce=st.length;J<ce;J++)nt(this,st[J])},q.prototype.createInstance=function(J){return new q(J)},q}(),He=new De;i.exports=He},{3:3}]},{},[4])(4)})})(localforage$1);var localforageExports=localforage$1.exports;const localforage=getDefaultExportFromCjs(localforageExports);var RootBranch;(function(n){n.Public="public",n.Pretty="p",n.Private="private",n.PrivateLog="privateLog",n.Shared="shared",n.SharedCounter="sharedCounter",n.Version="version"})(RootBranch||(RootBranch={}));var Kind;(function(n){n.Directory="directory",n.File="file"})(Kind||(Kind={}));function directory(...n){if(n.some(e=>e.includes("/")))throw new Error("Forward slashes `/` are not allowed");return{directory:n}}function file(...n){if(n.some(e=>e.includes("/")))throw new Error("Forward slashes `/` are not allowed");return{file:n}}function root$1(){return{directory:[]}}function appData(n,e){const t=directory(RootBranch.Private,"Apps",n.creator,n.name);return e?combine(t,e):t}function fromPosix(n){const e=n.replace(/^\/+/,"").split("/");return n.endsWith("/")?{directory:e.slice(0,-1)}:n===""?root$1():{file:e}}function toPosix(n,{absolute:e}={absolute:!1}){const t=e?"/":"",i=unwrap$2(n).join("/");return isDirectory(n)?t+i+(i.length?"/":""):t+i}function combine(n,e){return map(t=>unwrap$2(n).concat(t),e)}function isDirectory(n){return!!n.directory}function isFile$1(n){return!!n.file}function isPartition(n,e){return unwrap$2(e)[0]===n}function isOnRootBranch(n,e){return unwrap$2(e)[0]===n}function isRootDirectory(n){return n.directory.length===0}function isSamePartition(n,e){return unwrap$2(n)[0]===unwrap$2(e)[0]}function isSameKind(n,e){return isDirectory(n)&&isDirectory(e)?!0:!!(isFile$1(n)&&isFile$1(e))}function kind(n){return isDirectory(n)?Kind.Directory:Kind.File}function map(n,e){return isDirectory(e)?{directory:n(e.directory)}:isFile$1(e)?{file:n(e.file)}:e}function parent(n){return isDirectory(n)&&isRootDirectory(n)?null:directory(...unwrap$2(n).slice(0,-1))}function removePartition(n){return map(e=>isDirectory(n)||e.length>1?e.slice(1):e,n)}function terminus(n){const e=unwrap$2(n);return e.length<1?null:e[e.length-1]}function unwrap$2(n){if(isDirectory(n))return n.directory;if(isFile$1(n))return n.file;throw new Error("Path is neither a directory or a file")}function withPartition(n,e){return combine(directory(n),e)}function log$8(n){return`[ ${n.join(", ")} ]`}async function bareNameFilter({crypto:n,accountDID:e,path:t}){return`wnfs:${e}:bareNameFilter:${await pathHash(n,t)}`}async function readKey({crypto:n,accountDID:e,path:t}){return`wnfs:${e}:readKey:${await pathHash(n,t)}`}async function pathHash(n,e){return toString$3(await n.hash.sha256(fromString$3("/"+unwrap$2(e).join("/"),"utf8")),"base64pad")}const ROOT_FILESYSTEM_PERMISSIONS={fs:{private:[root$1()],public:[root$1()]}};function appId(n){return`${n.creator}/${n.name}`}function permissionPaths(n){let e=[];return n.app&&e.push(appData(n.app)),n.fs?.private&&(e=e.concat(n.fs?.private.map(t=>withPartition("private",t)))),n.fs?.public&&(e=e.concat(n.fs?.public.map(t=>withPartition("public",t)))),e}const equal=(n,e)=>{const t=new Uint8Array(n),i=new Uint8Array(e);if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o]!==i[o])return!1;return!0};function decode$9(n){return toString$3(fromString$3(n,"base64pad"))}function encode$9(n){return toString$3(fromString$3(n),"base64pad")}function urlDecode(n){return decode$9(makeUrlUnsafe(n))}function urlEncode(n){return makeUrlSafe(encode$9(n))}function makeUrlSafe(n){return n.replace(/\//g,"_").replace(/\+/g,"-").replace(/=+$/,"")}function makeUrlUnsafe(n){return n.replace(/_/g,"/").replace(/-/g,"+")}const toUint8Array=async n=>new Promise((e,t)=>{const i=()=>t(new Error("Failed to read file")),o=new FileReader;o.addEventListener("load",a=>{const c=a?.target?.result||null;if(c==null){i();return}if(typeof c=="string"){e(fromString$3(c));return}e(new Uint8Array(c))}),o.addEventListener("error",()=>o.abort()),o.addEventListener("abort",i),o.readAsArrayBuffer(n)});var encode_1=encode$8,MSB=128,REST=127,MSBALL=~REST,INT=Math.pow(2,31);function encode$8(n,e,t){e=e||[],t=t||0;for(var i=t;n>=INT;)e[t++]=n&255|MSB,n/=128;for(;n&MSBALL;)e[t++]=n&255|MSB,n>>>=7;return e[t]=n|0,encode$8.bytes=t-i+1,e}var decode$8=read,MSB$1=128,REST$1=127;function read(n,i){var t=0,i=i||0,o=0,a=i,c,u=n.length;do{if(a>=u)throw read.bytes=0,new RangeError("Could not decode varint");c=n[a++],t+=o<28?(c&REST$1)<<o:(c&REST$1)*Math.pow(2,o),o+=7}while(c>=MSB$1);return read.bytes=a-i,t}var N1=Math.pow(2,7),N2=Math.pow(2,14),N3=Math.pow(2,21),N4=Math.pow(2,28),N5=Math.pow(2,35),N6=Math.pow(2,42),N7=Math.pow(2,49),N8=Math.pow(2,56),N9=Math.pow(2,63),length=function(n){return n<N1?1:n<N2?2:n<N3?3:n<N4?4:n<N5?5:n<N6?6:n<N7?7:n<N8?8:n<N9?9:10},varint={encode:encode_1,decode:decode$8,encodingLength:length},_brrp_varint=varint;const decode$7=(n,e=0)=>[_brrp_varint.decode(n,e),_brrp_varint.decode.bytes],encodeTo=(n,e,t=0)=>(_brrp_varint.encode(n,e,t),e),encodingLength=n=>_brrp_varint.encodingLength(n),equals$2=(n,e)=>{if(n===e)return!0;if(n.byteLength!==e.byteLength)return!1;for(let t=0;t<n.byteLength;t++)if(n[t]!==e[t])return!1;return!0},coerce=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},fromString$2=n=>new TextEncoder().encode(n),toString$2=n=>new TextDecoder().decode(n),create$5=(n,e)=>{const t=e.byteLength,i=encodingLength(n),o=i+encodingLength(t),a=new Uint8Array(o+t);return encodeTo(n,a,0),encodeTo(t,a,i),a.set(e,o),new Digest(n,t,e,a)},decode$6=n=>{const e=coerce(n),[t,i]=decode$7(e),[o,a]=decode$7(e.subarray(i)),c=e.subarray(i+a);if(c.byteLength!==o)throw new Error("Incorrect length");return new Digest(t,o,c,e)},equals$1=(n,e)=>{if(n===e)return!0;{const t=e;return n.code===t.code&&n.size===t.size&&t.bytes instanceof Uint8Array&&equals$2(n.bytes,t.bytes)}};class Digest{constructor(e,t,i,o){this.code=e,this.size=t,this.digest=i,this.bytes=o}}function base(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var o=0;o<n.length;o++){var a=n.charAt(o),c=a.charCodeAt(0);if(t[c]!==255)throw new TypeError(a+" is ambiguous");t[c]=o}var u=n.length,d=n.charAt(0),p=Math.log(u)/Math.log(256),h=Math.log(256)/Math.log(u);function b(_){if(_ instanceof Uint8Array||(ArrayBuffer.isView(_)?_=new Uint8Array(_.buffer,_.byteOffset,_.byteLength):Array.isArray(_)&&(_=Uint8Array.from(_))),!(_ instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(_.length===0)return"";for(var $=0,k=0,D=0,O=_.length;D!==O&&_[D]===0;)D++,$++;for(var H=(O-D)*h+1>>>0,j=new Uint8Array(H);D!==O;){for(var W=_[D],ae=0,fe=H-1;(W!==0||ae<k)&&fe!==-1;fe--,ae++)W+=256*j[fe]>>>0,j[fe]=W%u>>>0,W=W/u>>>0;if(W!==0)throw new Error("Non-zero carry");k=ae,D++}for(var pe=H-k;pe!==H&&j[pe]===0;)pe++;for(var ve=d.repeat($);pe<H;++pe)ve+=n.charAt(j[pe]);return ve}function m(_){if(typeof _!="string")throw new TypeError("Expected String");if(_.length===0)return new Uint8Array;var $=0;if(_[$]!==" "){for(var k=0,D=0;_[$]===d;)k++,$++;for(var O=(_.length-$)*p+1>>>0,H=new Uint8Array(O);_[$];){var j=t[_.charCodeAt($)];if(j===255)return;for(var W=0,ae=O-1;(j!==0||W<D)&&ae!==-1;ae--,W++)j+=u*H[ae]>>>0,H[ae]=j%256>>>0,j=j/256>>>0;if(j!==0)throw new Error("Non-zero carry");D=W,$++}if(_[$]!==" "){for(var fe=O-D;fe!==O&&H[fe]===0;)fe++;for(var pe=new Uint8Array(k+(O-fe)),ve=k;fe!==O;)pe[ve++]=H[fe++];return pe}}}function v(_){var $=m(_);if($)return $;throw new Error(`Non-${e} character`)}return{encode:b,decodeUnsafe:m,decode:v}}var src=base,_brrp__multiformats_scope_baseX=src;class Encoder{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Decoder{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return or(this,e)}}class ComposedDecoder{constructor(e){this.decoders=e}or(e){return or(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const or=(n,e)=>new ComposedDecoder({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class Codec{constructor(e,t,i,o){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=o,this.encoder=new Encoder(e,t,i),this.decoder=new Decoder(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const from$1=({name:n,prefix:e,encode:t,decode:i})=>new Codec(n,e,t,i),baseX=({prefix:n,name:e,alphabet:t})=>{const{encode:i,decode:o}=_brrp__multiformats_scope_baseX(t,e);return from$1({prefix:n,name:e,encode:i,decode:a=>coerce(o(a))})},decode$5=(n,e,t,i)=>{const o={};for(let h=0;h<e.length;++h)o[e[h]]=h;let a=n.length;for(;n[a-1]==="=";)--a;const c=new Uint8Array(a*t/8|0);let u=0,d=0,p=0;for(let h=0;h<a;++h){const b=o[n[h]];if(b===void 0)throw new SyntaxError(`Non-${i} character`);d=d<<t|b,u+=t,u>=8&&(u-=8,c[p++]=255&d>>u)}if(u>=t||255&d<<8-u)throw new SyntaxError("Unexpected end of data");return c},encode$7=(n,e,t)=>{const i=e[e.length-1]==="=",o=(1<<t)-1;let a="",c=0,u=0;for(let d=0;d<n.length;++d)for(u=u<<8|n[d],c+=8;c>t;)c-=t,a+=e[o&u>>c];if(c&&(a+=e[o&u<<t-c]),i)for(;a.length*t&7;)a+="=";return a},rfc4648=({name:n,prefix:e,bitsPerChar:t,alphabet:i})=>from$1({prefix:e,name:n,encode(o){return encode$7(o,i,t)},decode(o){return decode$5(o,i,t,n)}}),base58btc=baseX({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr=baseX({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58=Object.freeze(Object.defineProperty({__proto__:null,base58btc,base58flickr},Symbol.toStringTag,{value:"Module"})),base32=rfc4648({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper=rfc4648({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad=rfc4648({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper=rfc4648({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex=rfc4648({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper=rfc4648({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad=rfc4648({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper=rfc4648({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z=rfc4648({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$1=Object.freeze(Object.defineProperty({__proto__:null,base32,base32hex,base32hexpad,base32hexpadupper,base32hexupper,base32pad,base32padupper,base32upper,base32z},Symbol.toStringTag,{value:"Module"})),format=(n,e)=>{const{bytes:t,version:i}=n;switch(i){case 0:return toStringV0(t,baseCache(n),e||base58btc.encoder);default:return toStringV1(t,baseCache(n),e||base32.encoder)}},cache=new WeakMap,baseCache=n=>{const e=cache.get(n);if(e==null){const t=new Map;return cache.set(n,t),t}return e};class CID{constructor(e,t,i,o){this.code=t,this.version=e,this.multihash=i,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return CID.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,i=create$5(e,t);return CID.createV1(this.code,i)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return CID.equals(this,e)}static equals(e,t){const i=t;return i&&e.code===i.code&&e.version===i.version&&equals$1(e.multihash,i.multihash)}toString(e){return format(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;const t=e;if(t instanceof CID)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){const{version:i,code:o,multihash:a,bytes:c}=t;return new CID(i,o,a,c||encodeCID$1(i,o,a.bytes))}else if(t[cidSymbol]===!0){const{version:i,multihash:o,code:a}=t,c=decode$6(o);return CID.create(i,a,c)}else return null}static create(e,t,i){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(i.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new CID(e,t,i,i.bytes)}case 1:{const o=encodeCID$1(e,t,i.bytes);return new CID(e,t,i,o)}default:throw new Error("Invalid version")}}static createV0(e){return CID.create(0,DAG_PB_CODE,e)}static createV1(e,t){return CID.create(1,e,t)}static decode(e){const[t,i]=CID.decodeFirst(e);if(i.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=CID.inspectBytes(e),i=t.size-t.multihashSize,o=coerce(e.subarray(i,i+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");const a=o.subarray(t.multihashSize-t.digestSize),c=new Digest(t.multihashCode,t.digestSize,a,o);return[t.version===0?CID.createV0(c):CID.createV1(t.codec,c),e.subarray(t.size)]}static inspectBytes(e){let t=0;const i=()=>{const[b,m]=decode$7(e.subarray(t));return t+=m,b};let o=i(),a=DAG_PB_CODE;if(o===18?(o=0,t=0):a=i(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);const c=t,u=i(),d=i(),p=t+d,h=p-c;return{version:o,codec:a,multihashCode:u,digestSize:d,multihashSize:h,size:p}}static parse(e,t){const[i,o]=parseCIDtoBytes(e,t),a=CID.decode(o);return baseCache(a).set(i,e),a}}const parseCIDtoBytes=(n,e)=>{switch(n[0]){case"Q":{const t=e||base58btc;return[base58btc.prefix,t.decode(`${base58btc.prefix}${n}`)]}case base58btc.prefix:{const t=e||base58btc;return[base58btc.prefix,t.decode(n)]}case base32.prefix:{const t=e||base32;return[base32.prefix,t.decode(n)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[n[0],e.decode(n)]}}},toStringV0=(n,e,t)=>{const{prefix:i}=t;if(i!==base58btc.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const o=e.get(i);if(o==null){const a=t.encode(n).slice(1);return e.set(i,a),a}else return o},toStringV1=(n,e,t)=>{const{prefix:i}=t,o=e.get(i);if(o==null){const a=t.encode(n);return e.set(i,a),a}else return o},DAG_PB_CODE=112,SHA_256_CODE=18,encodeCID$1=(n,e,t)=>{const i=encodingLength(n),o=i+encodingLength(e),a=new Uint8Array(o+t.byteLength);return encodeTo(n,a,0),encodeTo(e,a,i),a.set(t,o),a},cidSymbol=Symbol.for("@ipld/js-cid/CID");function hasProp(n,e){return typeof n=="object"&&n!=null&&e in n}const isDefined=n=>n!==void 0,notNull=n=>n!==null,isValue=n=>isDefined(n)&&notNull(n),isBool=n=>typeof n=="boolean";function isCryptoKey(n){return hasProp(n,"algorithm")&&hasProp(n,"extractable")&&hasProp(n,"type")}const isNum=n=>typeof n=="number",isString=n=>typeof n=="string",isObject$1=n=>n!==null&&typeof n=="object",isBlob=n=>typeof Blob>"u"?!1:n instanceof Blob||isObject$1(n)&&n?.constructor?.name==="Blob",EMPTY_CID="Qmc5m94Gu7z62RC8waSKkZUrCCBJPyHbkpmGzEePxy2oXJ";function decodeCID(n){const e=CID.asCID(n);if(e)return e;if(typeof n=="string")return CID.parse(n);if(typeof n=="object"&&"version"in n&&"code"in n&&"multihash"in n)return CID.create(n.version,n.code,n.multihash);if(typeof n=="object"&&hasProp(n,"version")&&hasProp(n,"code")&&isNum(n.code)&&hasProp(n,"hash")&&isObject$1(n.hash)&&Object.values(n.hash).every(isNum)){const t=decode$6(new Uint8Array(Object.values(n.hash)));return CID.create(n.version,n.code,t)}if(typeof n=="object"&&hasProp(n,"/")&&typeof n["/"]=="string")return CID.parse(n["/"]);throw new Error(`Could not decode CID: ${JSON.stringify(n)}`)}function encodeCID(n){return typeof n=="string"?n:n.toString()}const removeKeyFromObj=(n,e)=>{const{[e]:t,...i}=n;return i},mapObj=(n,e)=>{const t={};return Object.entries(n).forEach(([i,o])=>{t[i]=e(o,i)}),t},VERSION="0.37.2",WASM_WNFS_VERSION="0.1.7",isBrowser=typeof self<"u"&&typeof self.location=="object",assertBrowser=n=>{if(!isBrowser)throw new Error(`Must be in browser to use method. Provide a node-compatible implementation for ${n}`)},BASE58_DID_PREFIX="did:key:z",hasPrefix=(n,e)=>equal(e,n.slice(0,e.byteLength));function publicKeyToDid(n,e,t){const i=n.did.keyTypes[t]?.magicBytes;if(i===null)throw new Error(`Key type '${t}' not supported, available types: ${Object.keys(n.did.keyTypes).join(", ")}`);const o=concat([i,e]);return BASE58_DID_PREFIX+toString$3(o,"base58btc")}function didToPublicKey(n,e){if(!e.startsWith(BASE58_DID_PREFIX))throw new Error("Please use a base58-encoded DID formatted `did:key:z...`");const t=e.substr(BASE58_DID_PREFIX.length),i=fromString$3(t,"base58btc"),o=Object.entries(n.did.keyTypes).find(([a,c])=>hasPrefix(i,c.magicBytes));if(!o)throw new Error("Unsupported key algorithm.");return{publicKey:i.slice(o[1].magicBytes.length),type:o[0]}}async function build({addSignature:n=!0,audience:e,dependencies:t,facts:i=[],issuer:o,lifetimeInSeconds:a=120,expiration:c,potency:u="APPEND",proof:d,resource:p}){const h=Math.floor(Date.now()/1e3),b=d?typeof d=="string"?decode$4(d):d:null,m={alg:await t.crypto.keystore.getUcanAlgorithm(),typ:"JWT",uav:"1.0.0"};let v=c||h+a,_=h-120;if(b){const D=b.payload;v=Math.min(D.exp,v),_=Math.max(D.nbf,_)}const $={aud:e,exp:v,fct:i,iss:o,nbf:_,prf:d?typeof d=="string"?d:encode$6(d):null,ptc:u,rsc:p||(b?b.payload.rsc:"*")},k=n?await sign$1(t.crypto,m,$):null;return{header:m,payload:$,signature:k}}function decode$4(n){const e=n.split("."),t=JSON.parse(urlDecode(e[0])),i=JSON.parse(urlDecode(e[1]));return{header:t,payload:i,signature:e[2]||null}}function encode$6(n){const e=encodeHeader(n.header),t=encodePayload(n.payload);return e+"."+t+"."+n.signature}function encodeHeader(n){return urlEncode(JSON.stringify(n))}function encodePayload(n){return urlEncode(JSON.stringify({...n}))}function isExpired(n){return n.payload.exp<=Math.floor(Date.now()/1e3)}function isSelfSigned(n){return n.payload.iss===n.payload.aud}async function isValid(n,e){try{const t=encodeHeader(e.header),i=encodePayload(e.payload),{publicKey:o,type:a}=didToPublicKey(n,e.payload.iss),u=await n.did.keyTypes[a].verify({publicKey:o,message:fromString$3(`${t}.${i}`,"utf8"),signature:fromString$3(e.signature||"","base64url")});if(!u)return u;if(!e.payload.prf)return!0;const d=decode$4(e.payload.prf),p=d.payload.aud===e.payload.iss;return p&&await isValid(n,d)}catch{return!1}}function rootIssuer(n,e=0){const t=typeof n=="string"?extractPayload(n,e):n.payload;return t.prf?rootIssuer(t.prf,e+1):t.iss}async function sign$1(n,e,t){const i=encodeHeader(e),o=encodePayload(t);return toString$3(await n.keystore.sign(fromString$3(`${i}.${o}`,"utf8")),"base64url")}function extractPayload(n,e){try{return JSON.parse(urlDecode(n.split(".")[1]))}catch{throw new Error(`Invalid UCAN (${e} level${e===1?"":"s"} deep): \`${n}\``)}}class Repository{constructor({storage:e,storageName:t}){this.memoryCache=[],this.dictionary={},this.storage=e,this.storageName=t}static async create(e){const t=new this.prototype.constructor(e);return t.memoryCache=await t.getAll(),t.dictionary=t.toDictionary(t.memoryCache),t}async add(e){const t=Array.isArray(e)?e:[e];this.memoryCache=[...this.memoryCache,...t],this.dictionary=this.toDictionary(this.memoryCache),await this.storage.setItem(this.storageName,this.memoryCache.map(this.toJSON).join("|||"))}clear(){return this.memoryCache=[],this.dictionary={},this.storage.removeItem(this.storageName)}find(e){return this.memoryCache.find(e)||null}getByIndex(e){return this.memoryCache[e]}async getAll(){const e=await this.storage.getItem(this.storageName);return isString(e)?e.split("|||").map(this.fromJSON):[]}indexOf(e){return this.memoryCache.indexOf(e)}length(){return this.memoryCache.length}fromJSON(e){return JSON.parse(e)}toJSON(e){return JSON.stringify(e)}getByKey(e){return this.dictionary[e]}toDictionary(e){return e.reduce((t,i,o)=>({...t,[o.toString()]:i}),{})}}function create$4({storage:n}){return Repo$2.create({storage:n,storageName:n.KEYS.UCANS})}let Repo$2=class extends Repository{constructor(e){super(e)}fromJSON(e){return decode$4(e)}toJSON(e){return encode$6(e)}toDictionary(e){return e.reduce((t,i)=>({...t,[resourceLabel(i.payload.rsc)]:i}),{})}async lookupFilesystemUcan(e){const t=this.getByKey("*");if(t)return t;const i=e==="*",o=i?!1:isDirectory(e),a=i?["*"]:unwrap$2(e),c=filesystemPrefix();return a.reduce((u,d,p)=>{if(u)return u;const h=p===0,b=a.slice(0,a.length-p),m=toPosix(h&&!o?file(...b):directory(...b));return this.getByKey(`${c}${m}`)||null},null)}async lookupAppUcan(e){return this.getByKey("*")||this.getByKey("app:*")||this.getByKey(`app:${e}`)}};const WNFS_PREFIX="wnfs";function filesystemPrefix(n){return WNFS_PREFIX+":"}function resourceLabel(n){if(typeof n!="object")return n;const e=Array.from(Object.entries(n))[0];return e[0]+":"+(e[0]===WNFS_PREFIX?e[1].replace(/^\/+/,""):e[1])}const SESSION_TYPE="capabilities";async function collect$1({capabilities:n,crypto:e,reference:t,storage:i}){if(n.ucans.length===0)throw new Error("Expected at least one UCAN");await collectPermissions({reference:t,ucans:n.ucans});const o=await t.didRoot.lookup(n.username);await n.fileSystemSecrets.reduce(async(a,c)=>{await a,await collectSecret({accountDID:o,crypto:e,storage:i,bareNameFilter:c.bareNameFilter,readKey:c.readKey,path:c.path})},Promise.resolve())}async function collectSecret({accountDID:n,bareNameFilter:e,crypto:t,path:i,readKey:o,storage:a}){const c=await readKey({accountDID:n,crypto:t,path:i}),u=await bareNameFilter({accountDID:n,crypto:t,path:i});await t.keystore.importSymmKey(o,c),await a.setItem(u,e)}async function collectPermissions({reference:n,ucans:e}){await n.repositories.ucans.add(e)}function validatePermissions(n,{app:e,fs:t,raw:i}){let o;const a=filesystemPrefix(),c=n.getByKey("*");if(c&&!isExpired(c)&&!isSelfSigned(c))return c;if(e){const u=a+toPosix(appData(e)),d=n.getByKey(u);if(!d||isExpired(d))return null;o=d}return t?.private&&!t.private.every(d=>{const p=`${a}private/`+toPosix(d),h=n.getByKey(p);return o=h,h&&!isExpired(h)})||t?.public&&!t.public.every(d=>{const p=`${a}public/`+toPosix(d),h=n.getByKey(p);return o=h,h&&!isExpired(h)})||i&&!i.every(d=>{const p=resourceLabel(d.rsc),h=n.getByKey(p);return o=h,h&&!isExpired(h)})?null:o||null}async function validateSecrets(n,e,t){return permissionPaths(t).reduce((i,o)=>i.then(async a=>{if(a===!1||isPartition(RootBranch.Public,o))return a;const c=await readKey({accountDID:e,crypto:n,path:o});return n.keystore.keyExists(c)}),Promise.resolve(!0))}async function exchange(n){const e=await n.keystore.publicExchangeKey(),t=await n.keystore.getAlgorithm();return publicKeyToDid(n,e,t)}async function write(n){const e=await n.keystore.publicWriteKey(),t=await n.keystore.getAlgorithm();return publicKeyToDid(n,e,t)}class EventEmitter{constructor(){this.events=new Map,this.on=this.addListener,this.off=this.removeListener}addListener(e,t){const i=this.events.get(e);i===void 0?this.events.set(e,new Set([t])):i.add(t)}removeListener(e,t){const i=this.events.get(e);i!==void 0&&(i.delete(t),i.size===0&&this.events.delete(e))}emit(e,t){this.events.get(e)?.forEach(i=>{i.apply(this,[t])})}}function createEmitter(){return new EventEmitter}function listenTo(n){return{addListener:n.addListener.bind(n),removeListener:n.removeListener.bind(n),on:n.on.bind(n),off:n.off.bind(n)}}function merge$1(n,e){const t=createEmitter(),i=n.emit,o=e.emit;return n.emit=(a,c)=>{i.call(n,a,c),t.emit(a,c)},e.emit=(a,c)=>{o.call(e,a,c),t.emit(a,c)},t}async function create$3(n){let e={extensionId:null,connected:!1},t;return{connect:async i=>{e=await connect(i,n),t||(t=listen(e,n))},disconnect:async i=>{e=await disconnect(i,n),stopListening(n,t)}}}async function connect(n,e){const t=await getState(e);return globalThis.postMessage({id:n,type:"connect",timestamp:Date.now(),state:t}),{extensionId:n,connected:!0}}async function disconnect(n,e){const t=await getState(e);return globalThis.postMessage({id:n,type:"disconnect",timestamp:Date.now(),state:t}),{extensionId:n,connected:!1}}function listen(n,e){async function t(c){const{root:u,path:d}=c,p=await getState(e);globalThis.postMessage({id:n.extensionId,type:"fileSystem",timestamp:Date.now(),state:p,detail:{type:"local-change",root:u.toString(),path:d}})}async function i(c){const{root:u}=c,d=await getState(e);globalThis.postMessage({id:n.extensionId,type:"fileSystem",timestamp:Date.now(),state:d,detail:{type:"publish",root:u.toString()}})}async function o(c){const{session:u}=c;e={...e,session:u};const d=await getState(e);globalThis.postMessage({id:n.extensionId,type:"session",timestamp:Date.now(),state:d,detail:{type:"create",username:u.username}})}async function a(c){const{username:u}=c;e={...e,session:null};const d=await getState(e);globalThis.postMessage({id:n.extensionId,type:"session",timestamp:Date.now(),state:d,detail:{type:"destroy",username:u}})}return e.eventEmitters.fileSystem.on("fileSystem:local-change",t),e.eventEmitters.fileSystem.on("fileSystem:publish",i),e.eventEmitters.session.on("session:create",o),e.eventEmitters.session.on("session:destroy",a),{handleLocalChange:t,handlePublish:i,handleSessionCreate:o,handleSessionDestroy:a}}function stopListening(n,e){e&&(n.eventEmitters.fileSystem.removeListener("fileSystem:local-change",e.handleLocalChange),n.eventEmitters.fileSystem.removeListener("fileSystem:publish",e.handlePublish),n.eventEmitters.session.removeListener("session:create",e.handleSessionCreate),n.eventEmitters.session.removeListener("session:destroy",e.handleSessionDestroy))}async function getState(n){const{capabilities:e,dependencies:t,namespace:i,session:o}=n,a=await write(t.crypto);let c=null,u=null,d=null;return o&&o.username&&(u=o.username,c=await t.reference.didRoot.lookup(u),d=await t.reference.dataRoot.lookup(u)),{app:{namespace:i,...e?{capabilities:e}:{}},fileSystem:{dataRootCID:d?.toString()??null},user:{username:u,accountDID:c,agentDID:a},odd:{version:VERSION}}}const CID_CBOR_TAG=42;function cidEncoder(n){if(n.asCID!==n&&n["/"]!==n.bytes)return null;const e=CID$1.asCID(n);if(!e)return null;const t=new Uint8Array(e.bytes.byteLength+1);return t.set(e.bytes,1),[new Token(Type.tag,CID_CBOR_TAG),new Token(Type.bytes,t)]}function undefinedEncoder(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder(n){if(Number.isNaN(n))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(n===1/0||n===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const encodeOptions={float64:!0,typeEncoders:{Object:cidEncoder,undefined:undefinedEncoder,number:numberEncoder}};function cidDecoder(n){if(n[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return CID$1.decode(n.subarray(1))}const decodeOptions={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};decodeOptions.tags[CID_CBOR_TAG]=cidDecoder;const name$3="dag-cbor",code$3=113,encode$5=n=>encode$g(n,encodeOptions),decode$3=n=>decode$g(n,decodeOptions),dagCBOR=Object.freeze(Object.defineProperty({__proto__:null,code:code$3,decode:decode$3,encode:encode$5,name:name$3},Symbol.toStringTag,{value:"Module"})),textDecoder=new TextDecoder;function decodeVarint(n,e){let t=0;for(let i=0;;i+=7){if(i>=64)throw new Error("protobuf: varint overflow");if(e>=n.length)throw new Error("protobuf: unexpected end of data");const o=n[e++];if(t+=i<28?(o&127)<<i:(o&127)*2**i,o<128)break}return[t,e]}function decodeBytes(n,e){let t;[t,e]=decodeVarint(n,e);const i=e+t;if(t<0||i<0)throw new Error("protobuf: invalid length");if(i>n.length)throw new Error("protobuf: unexpected end of data");return[n.subarray(e,i),i]}function decodeKey(n,e){let t;return[t,e]=decodeVarint(n,e),[t&7,t>>3,e]}function decodeLink(n){const e={},t=n.length;let i=0;for(;i<t;){let o,a;if([o,a,i]=decodeKey(n,i),a===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,i]=decodeBytes(n,i)}else if(a===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let c;[c,i]=decodeBytes(n,i),e.Name=textDecoder.decode(c)}else if(a===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(o!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Tsize`);[e.Tsize,i]=decodeVarint(n,i)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${a}`)}if(i>t)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function decodeNode(n){const e=n.length;let t=0,i,o=!1,a;for(;t<e;){let u,d;if([u,d,t]=decodeKey(n,t),u!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${u}`);if(d===1){if(a)throw new Error("protobuf: (PBNode) duplicate Data section");[a,t]=decodeBytes(n,t),i&&(o=!0)}else if(d===2){if(o)throw new Error("protobuf: (PBNode) duplicate Links section");i||(i=[]);let p;[p,t]=decodeBytes(n,t),i.push(decodeLink(p))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${d}`)}if(t>e)throw new Error("protobuf: (PBNode) unexpected end of data");const c={};return a&&(c.Data=a),c.Links=i||[],c}const textEncoder$1=new TextEncoder,maxInt32=2**32,maxUInt32=2**31;function encodeLink(n,e){let t=e.length;if(typeof n.Tsize=="number"){if(n.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(n.Tsize))throw new Error("Tsize too large for encoding");t=encodeVarint(e,t,n.Tsize)-1,e[t]=24}if(typeof n.Name=="string"){const i=textEncoder$1.encode(n.Name);t-=i.length,e.set(i,t),t=encodeVarint(e,t,i.length)-1,e[t]=18}return n.Hash&&(t-=n.Hash.length,e.set(n.Hash,t),t=encodeVarint(e,t,n.Hash.length)-1,e[t]=10),e.length-t}function encodeNode(n){const e=sizeNode(n),t=new Uint8Array(e);let i=e;if(n.Data&&(i-=n.Data.length,t.set(n.Data,i),i=encodeVarint(t,i,n.Data.length)-1,t[i]=10),n.Links)for(let o=n.Links.length-1;o>=0;o--){const a=encodeLink(n.Links[o],t.subarray(0,i));i-=a,i=encodeVarint(t,i,a)-1,t[i]=18}return t}function sizeLink(n){let e=0;if(n.Hash){const t=n.Hash.length;e+=1+t+sov(t)}if(typeof n.Name=="string"){const t=textEncoder$1.encode(n.Name).length;e+=1+t+sov(t)}return typeof n.Tsize=="number"&&(e+=1+sov(n.Tsize)),e}function sizeNode(n){let e=0;if(n.Data){const t=n.Data.length;e+=1+t+sov(t)}if(n.Links)for(const t of n.Links){const i=sizeLink(t);e+=1+i+sov(i)}return e}function encodeVarint(n,e,t){e-=sov(t);const i=e;for(;t>=maxUInt32;)n[e++]=t&127|128,t/=128;for(;t>=128;)n[e++]=t&127|128,t>>>=7;return n[e]=t,i}function sov(n){return n%2===0&&n++,Math.floor((len64(n)+6)/7)}function len64(n){let e=0;return n>=maxInt32&&(n=Math.floor(n/maxInt32),e=32),n>=65536&&(n>>>=16,e+=16),n>=256&&(n>>>=8,e+=8),e+len8tab[n]}const len8tab=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],pbNodeProperties=["Data","Links"],pbLinkProperties=["Hash","Name","Tsize"],textEncoder=new TextEncoder;function linkComparator(n,e){if(n===e)return 0;const t=n.Name?textEncoder.encode(n.Name):[],i=e.Name?textEncoder.encode(e.Name):[];let o=t.length,a=i.length;for(let c=0,u=Math.min(o,a);c<u;++c)if(t[c]!==i[c]){o=t[c],a=i[c];break}return o<a?-1:a<o?1:0}function hasOnlyProperties(n,e){return!Object.keys(n).some(t=>!e.includes(t))}function asLink(n){if(typeof n.asCID=="object"){const t=CID$1.asCID(n);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if(typeof n!="object"||Array.isArray(n))throw new TypeError("Invalid DAG-PB form");const e={};if(n.Hash){let t=CID$1.asCID(n.Hash);try{t||(typeof n.Hash=="string"?t=CID$1.parse(n.Hash):n.Hash instanceof Uint8Array&&(t=CID$1.decode(n.Hash)))}catch(i){throw new TypeError(`Invalid DAG-PB form: ${i.message}`)}t&&(e.Hash=t)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return typeof n.Name=="string"&&(e.Name=n.Name),typeof n.Tsize=="number"&&(e.Tsize=n.Tsize),e}function prepare(n){if((n instanceof Uint8Array||typeof n=="string")&&(n={Data:n}),typeof n!="object"||Array.isArray(n))throw new TypeError("Invalid DAG-PB form");const e={};if(n.Data!==void 0)if(typeof n.Data=="string")e.Data=textEncoder.encode(n.Data);else if(n.Data instanceof Uint8Array)e.Data=n.Data;else throw new TypeError("Invalid DAG-PB form");if(n.Links!==void 0)if(Array.isArray(n.Links))e.Links=n.Links.map(asLink),e.Links.sort(linkComparator);else throw new TypeError("Invalid DAG-PB form");else e.Links=[];return e}function validate(n){if(!n||typeof n!="object"||Array.isArray(n))throw new TypeError("Invalid DAG-PB form");if(!hasOnlyProperties(n,pbNodeProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(n.Data!==void 0&&!(n.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(n.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let e=0;e<n.Links.length;e++){const t=n.Links[e];if(!t||typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!hasOnlyProperties(t,pbLinkProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!t.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(t.Hash.asCID!==t.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(t.Name!==void 0&&typeof t.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(t.Tsize!==void 0&&(typeof t.Tsize!="number"||t.Tsize%1!==0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e>0&&linkComparator(t,n.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function createNode(n,e=[]){return prepare({Data:n,Links:e})}function createLink(n,e,t){return asLink({Hash:t,Name:n,Tsize:e})}const name$2="dag-pb",code$2=112;function encode$4(n){validate(n);const e={};return n.Links&&(e.Links=n.Links.map(t=>{const i={};return t.Hash&&(i.Hash=t.Hash.bytes),t.Name!==void 0&&(i.Name=t.Name),t.Tsize!==void 0&&(i.Tsize=t.Tsize),i})),n.Data&&(e.Data=n.Data),encodeNode(e)}function decode$2(n){const e=decodeNode(n),t={};return e.Data&&(t.Data=e.Data),e.Links&&(t.Links=e.Links.map(i=>{const o={};try{o.Hash=CID$1.decode(i.Hash)}catch{}if(!o.Hash)throw new Error("Invalid Hash field found in link, expected CID");return i.Name!==void 0&&(o.Name=i.Name),i.Tsize!==void 0&&(o.Tsize=i.Tsize),o})),t}const dagPB=Object.freeze(Object.defineProperty({__proto__:null,code:code$2,createLink,createNode,decode:decode$2,encode:encode$4,name:name$2,prepare,validate},Symbol.toStringTag,{value:"Module"})),name$1="raw",code$1=85,encode$3=n=>coerce(n),decode$1=n=>coerce(n),raw=Object.freeze(Object.defineProperty({__proto__:null,code:code$1,decode:decode$1,encode:encode$3,name:name$1},Symbol.toStringTag,{value:"Module"})),BY_NAME={[name$2]:dagPB,[name$3]:dagCBOR,[name$1]:raw},BY_CODE={[code$2]:dagPB,[code$3]:dagCBOR,[code$1]:raw};function getByCode(n){const e=BY_CODE[n];if(!e)throw new Error(`No codec was registered for the code: ${numberHex(n)}. Is it part of the multicodec table (https://github.com/multiformats/multicodec/blob/master/table.csv)?`);return e}function getByName$1(n){const e=BY_NAME[n];if(!e)throw new Error(`No codec was registered for the name: ${n}`);return e}function getByIdentifier(n){return typeof n=="string"?getByName$1(n):getByCode(n)}function expect(n,e){const t=getByIdentifier(n);if(e.code!==t.code){const i=getByCode(e.code);throw new Error(`Expected a ${t.name} CID, found a ${i.name} CID instead.`)}}function isIdentifier(n){return typeof n=="string"?!!BY_NAME[n]:!!BY_CODE[n]}function numberHex(n){const e=new Uint8Array(4);return new DataView(e.buffer).setUint32(0,n),`0x${toString$3(e,"hex").replace(/^(00)*/,"")}`}const PB_IPLD_DATA=new Uint8Array([8,1]);async function getPB(n,e){return expect(code$2,e),decode$2(await n.getBlock(e))}function putPB(n,e){const t=createNode(PB_IPLD_DATA,e);return n.putBlock(encode$4(t),code$2)}const isFile=n=>isObject$1(n)&&n.content!==void 0,isTree=n=>isObject$1(n)&&n.ls!==void 0,isBaseLink=n=>isObject$1(n)&&isString(n.name)&&isNum(n.size)&&isBool(n.isFile),isSimpleLink=n=>isObject$1(n)&&isString(n.name)&&isNum(n.size)&&isCID(n.cid),isSoftLink=n=>isObject$1(n)&&isString(n.name)&&isString(n.ipns),isSoftLinkDictionary=n=>{if(isObject$1(n)){const e=Object.values(n);return e.length>0&&e.every(isSoftLink)}return!1},isSoftLinkList=n=>Array.isArray(n)&&n.every(isSoftLink),isHardLink=n=>isBaseLink(n)&&isCID(n.cid),isLinks=n=>isObject$1(n)&&Object.values(n).every(e=>isHardLink(e)||isSoftLink(e)),isUnixMeta=n=>isObject$1(n)&&isNum(n.mtime)&&isNum(n.ctime)&&isNum(n.mode)&&isString(n._type),isMetadata=n=>isObject$1(n)&&isUnixMeta(n.unixMeta)&&isBool(n.isFile)&&isSemVer(n.version),isSkeleton=n=>isObject$1(n)&&Object.values(n).every(isSkeletonInfo),isSkeletonInfo=n=>isObject$1(n)&&isCID(n.cid)&&isCID(n.userland)&&isCID(n.metadata)&&isSkeleton(n.subSkeleton)||isSoftLink(n),isTreeHeader=n=>isObject$1(n)&&isSkeleton(n.skeleton)&&isMetadata(n.metadata)&&n.metadata.isFile===!1,isTreeInfo=n=>isTreeHeader(n)&&isCID(n.userland),isFileHeader=n=>isObject$1(n)&&isMetadata(n.metadata)&&n.metadata.isFile===!0,isFileInfo=n=>isFileHeader(n)&&isCID(n.userland),isCID=n=>!!CID.asCID(n)||isString(n)||n&&"code"in n&&"version"in n&&("multihash"in n||"hash"in n),isSemVer=n=>{if(!isObject$1(n))return!1;const{major:e,minor:t,patch:i}=n;return isNum(e)&&isNum(t)&&isNum(i)},arrToMap=n=>n.reduce((e,t)=>(e[t.name]=t,e),{}),fromDAGLink=n=>{const e=n.Name||"",t=n.Hash,i=n.Tsize||0;return{name:e,cid:t,size:i}},make=(n,e,t,i)=>({name:n,cid:encodeCID(e),size:i,isFile:t}),toDAGLink=n=>{const{name:e,cid:t,size:i}=n;return createLink(e,i,decodeCID(t))};var CryptoSystem;(function(n){n.ECC="ecc",n.RSA="rsa"})(CryptoSystem||(CryptoSystem={}));var EccCurve;(function(n){n.P_256="P-256",n.P_384="P-384",n.P_521="P-521"})(EccCurve||(EccCurve={}));var RsaSize;(function(n){n[n.B1024=1024]="B1024",n[n.B2048=2048]="B2048",n[n.B4096=4096]="B4096"})(RsaSize||(RsaSize={}));var SymmAlg;(function(n){n.AES_CTR="AES-CTR",n.AES_CBC="AES-CBC",n.AES_GCM="AES-GCM"})(SymmAlg||(SymmAlg={}));var SymmKeyLength;(function(n){n[n.B128=128]="B128",n[n.B192=192]="B192",n[n.B256=256]="B256"})(SymmKeyLength||(SymmKeyLength={}));var HashAlg;(function(n){n.SHA_1="SHA-1",n.SHA_256="SHA-256",n.SHA_384="SHA-384",n.SHA_512="SHA-512"})(HashAlg||(HashAlg={}));var CharSize;(function(n){n[n.B8=8]="B8",n[n.B16=16]="B16"})(CharSize||(CharSize={}));var KeyUse;(function(n){n.Exchange="exchange",n.Write="write"})(KeyUse||(KeyUse={}));const DEFAULT_AES_ALG=SymmAlg.AES_CTR,getFile=async(n,e)=>n.getUnixFile(e),getEncryptedFile=async(n,e,t,i)=>{const o=await getFile(n,t);let a;try{a=decode$3(o)}catch{return o}if(!hasProp(a,"alg")||!hasProp(a,"cip")||!isSymmAlg(a.alg)||!ArrayBuffer.isView(a.cip))throw new Error('Unexpected private block. Expected "alg" and "cip" field.');const c=a.alg,u=new Uint8Array(a.cip.buffer),d=await e.aes.decrypt(u,i,c),p=decode$3(d);return p instanceof Uint8Array?p:fromString$3(typeof p=="string"?p:JSON.stringify(p),"utf8")},putFile$1=async(n,e)=>n.putChunked(e),putEncryptedFile=async(n,e,t,i)=>{const o=isBlob(t)?await toUint8Array(t):t,a=encode$5(o),c=SymmAlg.AES_GCM,u=await e.aes.encrypt(a,i,c),d=encode$5({alg:c,cip:u});return putFile$1(n,d)},getSimpleLinks=async(n,e)=>{const t=await getPB(n,e);return arrToMap(t.Links.map(fromDAGLink))},getFileSystemLinks=async(n,e)=>{const t=await getPB(n,e),i=await Promise.all(t.Links.map(async o=>{const a=await getPB(n,o.Hash),c=arrToMap(a.Links.map(fromDAGLink));if(!!c.softLink){const p=await n.getUnixFile(decodeCID(c.softLink.cid)),h=new TextDecoder().decode(p);return JSON.parse(h)}const d=await decode$3(await getFile(n,decodeCID(c.metadata.cid)));return{...fromDAGLink(o),isFile:hasProp(d,"isFile")?d.isFile:!1}}));return arrToMap(i)},putLinks=async(n,e)=>{const t=Object.values(e).reduce(async(o,a)=>{const c=await o;if(isSoftLink(a)){const u=await n.putChunked(fromString$3(JSON.stringify(a),"utf8")),d=await putPB(n,[createLink("softLink",u.size,u.cid)]),p=await n.size(d);return[...c,createLink(a.name,p,d)]}else return hasProp(a,"Hash")&&a.Hash?[...c,a]:isSimpleLink(a)?[...c,toDAGLink(a)]:c},Promise.resolve([])),i=await putPB(n,await t);return{cid:i,isFile:!1,size:await n.size(i)}};function isSymmAlg(n){return isString(n)&&Object.values(SymmAlg).includes(n)}const putTree=async(n,e,t,i,o)=>{const a=await putLinks(n,e),c=make("userland",a.cid,!0,a.size),[u,d]=await Promise.all([putAndMakeLink(n,"metadata",i),putAndMakeLink(n,"skeleton",t)]),p=o!=null?make("previous",o,!1,await n.size(o)):void 0,h={metadata:u,skeleton:d,userland:c,previous:p},{cid:b,size:m}=await putLinks(n,h);return{cid:b,userland:decodeCID(c.cid),metadata:decodeCID(u.cid),size:m,isFile:!1,skeleton:t}},putFile=async(n,e,t,i)=>{const o=await putFile$1(n,e),a=make("userland",o.cid,!0,o.size),c=await putAndMakeLink(n,"metadata",t),u=i!=null?make("previous",i,!1,await n.size(i)):void 0,d={metadata:c,userland:a,previous:u},{cid:p,size:h}=await putLinks(n,d);return{cid:p,userland:decodeCID(a.cid),metadata:decodeCID(c.cid),size:h,isFile:!0,skeleton:{}}},get$2=async(n,e)=>{const t=await getSimpleLinks(n,e),i=await getAndCheckValue(n,t,"metadata",isMetadata),o=i.isFile?void 0:await getAndCheckValue(n,t,"skeleton",isSkeleton),a=t.userland?.cid||null;if(!isCID(a))throw new Error("Could not find userland");const c=t.previous?.cid||void 0;return{userland:a,metadata:i,previous:c,skeleton:o}},getValue=async(n,e,t)=>{const i=CID.asCID(e);if(isCID(e)){if(!i)return null;const o=await getSimpleLinks(n,i);return getValueFromLinks(n,o,t)}return getValueFromLinks(n,e,t)},getValueFromLinks=async(n,e,t)=>{const i=e[t]?.cid;if(!i)return null;const o=await getFile(n,decodeCID(i)),a=decode$3(o);let c;return a instanceof Uint8Array?c=JSON.parse(toString$3(a,"utf8")):c=a,c},getAndCheckValue=async(n,e,t,i,o=!1)=>{const a=await getValue(n,e,t);return checkValue(a,t,i,o)},checkValue=(n,e,t,i=!1)=>{if(!isValue(n)){if(i)return n;throw new Error(`Could not find header value: ${e}`)}if(t(n))return n;throw new Error(`Improperly formatted header value: ${e}`)};async function putAndMakeLink(n,e,t){const{cid:i,size:o}=await putFile$1(n,encode$5(t));return make(e,i,!0,o)}const isDecryptedNode=n=>isPrivateTreeInfo(n)||isPrivateFileInfo(n)||isSoftLink(n),isPrivateFileInfo=n=>isObject$1(n)&&isMetadata(n.metadata)&&n.metadata.isFile&&isString(n.key)&&notNull(n.content),isPrivateTreeInfo=n=>isObject$1(n)&&isMetadata(n.metadata)&&n.metadata.isFile===!1&&isNum(n.revision)&&isPrivateLinks(n.links)&&isPrivateSkeleton(n.skeleton),isPrivateLink=n=>isBaseLink(n)&&isString(n.key)&&isString(n.pointer),isPrivateLinks=n=>isObject$1(n)&&Object.values(n).every(e=>isPrivateLink(e)||isSoftLink(e)),isPrivateSkeleton=n=>isObject$1(n)&&Object.values(n).every(e=>isPrivateSkeletonInfo(e)||isSoftLink(e)),isPrivateSkeletonInfo=n=>isObject$1(n)&&notNull(n.cid)&&isString(n.key)&&isPrivateSkeleton(n.subSkeleton),fromBytes=n=>Array.prototype.map.call(n,e=>("00"+e.toString(16)).slice(-2)).join(""),toBytes=n=>{const e=new Uint8Array(n.length/2);for(let t=0;t<e.length;t++)e[t]=parseInt(n.slice(t*2,t*2+2),16);return e};var api={},bloomFilter={},baseFilter={},utils$3={},cuint={},uint32={exports:{}};(function(n){(function(e){t(Math.pow(36,5)),t(Math.pow(16,7)),t(Math.pow(10,9)),t(Math.pow(2,30)),t(36),t(16),t(10),t(2);function t(c,u){if(!(this instanceof t))return new t(c,u);if(this._low=0,this._high=0,this.remainder=null,typeof u>"u")return o.call(this,c);if(typeof c=="string")return a.call(this,c,u);i.call(this,c,u)}function i(c,u){return this._low=c|0,this._high=u|0,this}t.prototype.fromBits=i;function o(c){return this._low=c&65535,this._high=c>>>16,this}t.prototype.fromNumber=o;function a(c,u){var d=parseInt(c,u||10);return this._low=d&65535,this._high=d>>>16,this}t.prototype.fromString=a,t.prototype.toNumber=function(){return this._high*65536+this._low},t.prototype.toString=function(c){return this.toNumber().toString(c||10)},t.prototype.add=function(c){var u=this._low+c._low,d=u>>>16;return d+=this._high+c._high,this._low=u&65535,this._high=d&65535,this},t.prototype.subtract=function(c){return this.add(c.clone().negate())},t.prototype.multiply=function(c){var u=this._high,d=this._low,p=c._high,h=c._low,b,m;return m=d*h,b=m>>>16,b+=u*h,b&=65535,b+=d*p,this._low=m&65535,this._high=b&65535,this},t.prototype.div=function(c){if(c._low==0&&c._high==0)throw Error("division by zero");if(c._high==0&&c._low==1)return this.remainder=new t(0),this;if(c.gt(this))return this.remainder=this.clone(),this._low=0,this._high=0,this;if(this.eq(c))return this.remainder=new t(0),this._low=1,this._high=0,this;for(var u=c.clone(),d=-1;!this.lt(u);)u.shiftLeft(1,!0),d++;for(this.remainder=this.clone(),this._low=0,this._high=0;d>=0;d--)u.shiftRight(1),this.remainder.lt(u)||(this.remainder.subtract(u),d>=16?this._high|=1<<d-16:this._low|=1<<d);return this},t.prototype.negate=function(){var c=(~this._low&65535)+1;return this._low=c&65535,this._high=~this._high+(c>>>16)&65535,this},t.prototype.equals=t.prototype.eq=function(c){return this._low==c._low&&this._high==c._high},t.prototype.greaterThan=t.prototype.gt=function(c){return this._high>c._high?!0:this._high<c._high?!1:this._low>c._low},t.prototype.lessThan=t.prototype.lt=function(c){return this._high<c._high?!0:this._high>c._high?!1:this._low<c._low},t.prototype.or=function(c){return this._low|=c._low,this._high|=c._high,this},t.prototype.and=function(c){return this._low&=c._low,this._high&=c._high,this},t.prototype.not=function(){return this._low=~this._low&65535,this._high=~this._high&65535,this},t.prototype.xor=function(c){return this._low^=c._low,this._high^=c._high,this},t.prototype.shiftRight=t.prototype.shiftr=function(c){return c>16?(this._low=this._high>>c-16,this._high=0):c==16?(this._low=this._high,this._high=0):(this._low=this._low>>c|this._high<<16-c&65535,this._high>>=c),this},t.prototype.shiftLeft=t.prototype.shiftl=function(c,u){return c>16?(this._high=this._low<<c-16,this._low=0,u||(this._high&=65535)):c==16?(this._high=this._low,this._low=0):(this._high=this._high<<c|this._low>>16-c,this._low=this._low<<c&65535,u||(this._high&=65535)),this},t.prototype.rotateLeft=t.prototype.rotl=function(c){var u=this._high<<16|this._low;return u=u<<c|u>>>32-c,this._low=u&65535,this._high=u>>>16,this},t.prototype.rotateRight=t.prototype.rotr=function(c){var u=this._high<<16|this._low;return u=u>>>c|u<<32-c,this._low=u&65535,this._high=u>>>16,this},t.prototype.clone=function(){return new t(this._low,this._high)},n.exports?n.exports=t:e.UINT32=t})(commonjsGlobal)})(uint32);var uint32Exports=uint32.exports,uint64={exports:{}};(function(n){(function(e){var t={16:o(Math.pow(16,5)),10:o(Math.pow(10,5)),2:o(Math.pow(2,5))},i={16:o(16),10:o(10),2:o(2)};function o(d,p,h,b){if(!(this instanceof o))return new o(d,p,h,b);if(this.remainder=null,typeof d=="string")return u.call(this,d,p);if(typeof p>"u")return c.call(this,d);a.apply(this,arguments)}function a(d,p,h,b){return typeof h>"u"?(this._a00=d&65535,this._a16=d>>>16,this._a32=p&65535,this._a48=p>>>16,this):(this._a00=d|0,this._a16=p|0,this._a32=h|0,this._a48=b|0,this)}o.prototype.fromBits=a;function c(d){return this._a00=d&65535,this._a16=d>>>16,this._a32=0,this._a48=0,this}o.prototype.fromNumber=c;function u(d,p){p=p||10,this._a00=0,this._a16=0,this._a32=0,this._a48=0;for(var h=t[p]||new o(Math.pow(p,5)),b=0,m=d.length;b<m;b+=5){var v=Math.min(5,m-b),_=parseInt(d.slice(b,b+v),p);this.multiply(v<5?new o(Math.pow(p,v)):h).add(new o(_))}return this}o.prototype.fromString=u,o.prototype.toNumber=function(){return this._a16*65536+this._a00},o.prototype.toString=function(d){d=d||10;var p=i[d]||new o(d);if(!this.gt(p))return this.toNumber().toString(d);for(var h=this.clone(),b=new Array(64),m=63;m>=0&&(h.div(p),b[m]=h.remainder.toNumber().toString(d),!!h.gt(p));m--);return b[m-1]=h.toNumber().toString(d),b.join("")},o.prototype.add=function(d){var p=this._a00+d._a00,h=p>>>16;h+=this._a16+d._a16;var b=h>>>16;b+=this._a32+d._a32;var m=b>>>16;return m+=this._a48+d._a48,this._a00=p&65535,this._a16=h&65535,this._a32=b&65535,this._a48=m&65535,this},o.prototype.subtract=function(d){return this.add(d.clone().negate())},o.prototype.multiply=function(d){var p=this._a00,h=this._a16,b=this._a32,m=this._a48,v=d._a00,_=d._a16,$=d._a32,k=d._a48,D=p*v,O=D>>>16;O+=p*_;var H=O>>>16;O&=65535,O+=h*v,H+=O>>>16,H+=p*$;var j=H>>>16;return H&=65535,H+=h*_,j+=H>>>16,H&=65535,H+=b*v,j+=H>>>16,j+=p*k,j&=65535,j+=h*$,j&=65535,j+=b*_,j&=65535,j+=m*v,this._a00=D&65535,this._a16=O&65535,this._a32=H&65535,this._a48=j&65535,this},o.prototype.div=function(d){if(d._a16==0&&d._a32==0&&d._a48==0){if(d._a00==0)throw Error("division by zero");if(d._a00==1)return this.remainder=new o(0),this}if(d.gt(this))return this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0,this;if(this.eq(d))return this.remainder=new o(0),this._a00=1,this._a16=0,this._a32=0,this._a48=0,this;for(var p=d.clone(),h=-1;!this.lt(p);)p.shiftLeft(1,!0),h++;for(this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0;h>=0;h--)p.shiftRight(1),this.remainder.lt(p)||(this.remainder.subtract(p),h>=48?this._a48|=1<<h-48:h>=32?this._a32|=1<<h-32:h>=16?this._a16|=1<<h-16:this._a00|=1<<h);return this},o.prototype.negate=function(){var d=(~this._a00&65535)+1;return this._a00=d&65535,d=(~this._a16&65535)+(d>>>16),this._a16=d&65535,d=(~this._a32&65535)+(d>>>16),this._a32=d&65535,this._a48=~this._a48+(d>>>16)&65535,this},o.prototype.equals=o.prototype.eq=function(d){return this._a48==d._a48&&this._a00==d._a00&&this._a32==d._a32&&this._a16==d._a16},o.prototype.greaterThan=o.prototype.gt=function(d){return this._a48>d._a48?!0:this._a48<d._a48?!1:this._a32>d._a32?!0:this._a32<d._a32?!1:this._a16>d._a16?!0:this._a16<d._a16?!1:this._a00>d._a00},o.prototype.lessThan=o.prototype.lt=function(d){return this._a48<d._a48?!0:this._a48>d._a48?!1:this._a32<d._a32?!0:this._a32>d._a32?!1:this._a16<d._a16?!0:this._a16>d._a16?!1:this._a00<d._a00},o.prototype.or=function(d){return this._a00|=d._a00,this._a16|=d._a16,this._a32|=d._a32,this._a48|=d._a48,this},o.prototype.and=function(d){return this._a00&=d._a00,this._a16&=d._a16,this._a32&=d._a32,this._a48&=d._a48,this},o.prototype.xor=function(d){return this._a00^=d._a00,this._a16^=d._a16,this._a32^=d._a32,this._a48^=d._a48,this},o.prototype.not=function(){return this._a00=~this._a00&65535,this._a16=~this._a16&65535,this._a32=~this._a32&65535,this._a48=~this._a48&65535,this},o.prototype.shiftRight=o.prototype.shiftr=function(d){return d%=64,d>=48?(this._a00=this._a48>>d-48,this._a16=0,this._a32=0,this._a48=0):d>=32?(d-=32,this._a00=(this._a32>>d|this._a48<<16-d)&65535,this._a16=this._a48>>d&65535,this._a32=0,this._a48=0):d>=16?(d-=16,this._a00=(this._a16>>d|this._a32<<16-d)&65535,this._a16=(this._a32>>d|this._a48<<16-d)&65535,this._a32=this._a48>>d&65535,this._a48=0):(this._a00=(this._a00>>d|this._a16<<16-d)&65535,this._a16=(this._a16>>d|this._a32<<16-d)&65535,this._a32=(this._a32>>d|this._a48<<16-d)&65535,this._a48=this._a48>>d&65535),this},o.prototype.shiftLeft=o.prototype.shiftl=function(d,p){return d%=64,d>=48?(this._a48=this._a00<<d-48,this._a32=0,this._a16=0,this._a00=0):d>=32?(d-=32,this._a48=this._a16<<d|this._a00>>16-d,this._a32=this._a00<<d&65535,this._a16=0,this._a00=0):d>=16?(d-=16,this._a48=this._a32<<d|this._a16>>16-d,this._a32=(this._a16<<d|this._a00>>16-d)&65535,this._a16=this._a00<<d&65535,this._a00=0):(this._a48=this._a48<<d|this._a32>>16-d,this._a32=(this._a32<<d|this._a16>>16-d)&65535,this._a16=(this._a16<<d|this._a00>>16-d)&65535,this._a00=this._a00<<d&65535),p||(this._a48&=65535),this},o.prototype.rotateLeft=o.prototype.rotl=function(d){if(d%=64,d==0)return this;if(d>=32){var p=this._a00;if(this._a00=this._a32,this._a32=p,p=this._a48,this._a48=this._a16,this._a16=p,d==32)return this;d-=32}var h=this._a48<<16|this._a32,b=this._a16<<16|this._a00,m=h<<d|b>>>32-d,v=b<<d|h>>>32-d;return this._a00=v&65535,this._a16=v>>>16,this._a32=m&65535,this._a48=m>>>16,this},o.prototype.rotateRight=o.prototype.rotr=function(d){if(d%=64,d==0)return this;if(d>=32){var p=this._a00;if(this._a00=this._a32,this._a32=p,p=this._a48,this._a48=this._a16,this._a16=p,d==32)return this;d-=32}var h=this._a48<<16|this._a32,b=this._a16<<16|this._a00,m=h>>>d|b<<32-d,v=b>>>d|h<<32-d;return this._a00=v&65535,this._a16=v>>>16,this._a32=m&65535,this._a48=m>>>16,this},o.prototype.clone=function(){return new o(this._a00,this._a16,this._a32,this._a48)},n.exports?n.exports=o:e.UINT64=o})(commonjsGlobal)})(uint64);var uint64Exports=uint64.exports;cuint.UINT32=uint32Exports;cuint.UINT64=uint64Exports;var UINT32=cuint.UINT32;UINT32.prototype.xxh_update=function(n,e){var t=PRIME32_2._low,i=PRIME32_2._high,o,a;a=n*t,o=a>>>16,o+=e*t,o&=65535,o+=n*i;var c=this._low+(a&65535),u=c>>>16;u+=this._high+(o&65535);var d=u<<16|c&65535;d=d<<13|d>>>19,c=d&65535,u=d>>>16,t=PRIME32_1._low,i=PRIME32_1._high,a=c*t,o=a>>>16,o+=u*t,o&=65535,o+=c*i,this._low=a&65535,this._high=o&65535};var PRIME32_1=UINT32("2654435761"),PRIME32_2=UINT32("2246822519"),PRIME32_3=UINT32("3266489917"),PRIME32_4=UINT32("668265263"),PRIME32_5=UINT32("374761393");function toUTF8Array$1(n){for(var e=[],t=0,i=n.length;t<i;t++){var o=n.charCodeAt(t);o<128?e.push(o):o<2048?e.push(192|o>>6,128|o&63):o<55296||o>=57344?e.push(224|o>>12,128|o>>6&63,128|o&63):(t++,o=65536+((o&1023)<<10|n.charCodeAt(t)&1023),e.push(240|o>>18,128|o>>12&63,128|o>>6&63,128|o&63))}return new Uint8Array(e)}function XXH(){if(arguments.length==2)return new XXH(arguments[1]).update(arguments[0]).digest();if(!(this instanceof XXH))return new XXH(arguments[0]);init$3.call(this,arguments[0])}function init$3(n){return this.seed=n instanceof UINT32?n.clone():UINT32(n),this.v1=this.seed.clone().add(PRIME32_1).add(PRIME32_2),this.v2=this.seed.clone().add(PRIME32_2),this.v3=this.seed.clone(),this.v4=this.seed.clone().subtract(PRIME32_1),this.total_len=0,this.memsize=0,this.memory=null,this}XXH.prototype.init=init$3;XXH.prototype.update=function(n){var e=typeof n=="string",t;e&&(n=toUTF8Array$1(n),e=!1,t=!0),typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer&&(t=!0,n=new Uint8Array(n));var i=0,o=n.length,a=i+o;if(o==0)return this;if(this.total_len+=o,this.memsize==0&&(e?this.memory="":t?this.memory=new Uint8Array(16):this.memory=new buffer$2.Buffer(16)),this.memsize+o<16)return e?this.memory+=n:t?this.memory.set(n.subarray(0,o),this.memsize):n.copy(this.memory,this.memsize,0,o),this.memsize+=o,this;if(this.memsize>0){e?this.memory+=n.slice(0,16-this.memsize):t?this.memory.set(n.subarray(0,16-this.memsize),this.memsize):n.copy(this.memory,this.memsize,0,16-this.memsize);var c=0;e?(this.v1.xxh_update(this.memory.charCodeAt(c+1)<<8|this.memory.charCodeAt(c),this.memory.charCodeAt(c+3)<<8|this.memory.charCodeAt(c+2)),c+=4,this.v2.xxh_update(this.memory.charCodeAt(c+1)<<8|this.memory.charCodeAt(c),this.memory.charCodeAt(c+3)<<8|this.memory.charCodeAt(c+2)),c+=4,this.v3.xxh_update(this.memory.charCodeAt(c+1)<<8|this.memory.charCodeAt(c),this.memory.charCodeAt(c+3)<<8|this.memory.charCodeAt(c+2)),c+=4,this.v4.xxh_update(this.memory.charCodeAt(c+1)<<8|this.memory.charCodeAt(c),this.memory.charCodeAt(c+3)<<8|this.memory.charCodeAt(c+2))):(this.v1.xxh_update(this.memory[c+1]<<8|this.memory[c],this.memory[c+3]<<8|this.memory[c+2]),c+=4,this.v2.xxh_update(this.memory[c+1]<<8|this.memory[c],this.memory[c+3]<<8|this.memory[c+2]),c+=4,this.v3.xxh_update(this.memory[c+1]<<8|this.memory[c],this.memory[c+3]<<8|this.memory[c+2]),c+=4,this.v4.xxh_update(this.memory[c+1]<<8|this.memory[c],this.memory[c+3]<<8|this.memory[c+2])),i+=16-this.memsize,this.memsize=0,e&&(this.memory="")}if(i<=a-16){var u=a-16;do e?(this.v1.xxh_update(n.charCodeAt(i+1)<<8|n.charCodeAt(i),n.charCodeAt(i+3)<<8|n.charCodeAt(i+2)),i+=4,this.v2.xxh_update(n.charCodeAt(i+1)<<8|n.charCodeAt(i),n.charCodeAt(i+3)<<8|n.charCodeAt(i+2)),i+=4,this.v3.xxh_update(n.charCodeAt(i+1)<<8|n.charCodeAt(i),n.charCodeAt(i+3)<<8|n.charCodeAt(i+2)),i+=4,this.v4.xxh_update(n.charCodeAt(i+1)<<8|n.charCodeAt(i),n.charCodeAt(i+3)<<8|n.charCodeAt(i+2))):(this.v1.xxh_update(n[i+1]<<8|n[i],n[i+3]<<8|n[i+2]),i+=4,this.v2.xxh_update(n[i+1]<<8|n[i],n[i+3]<<8|n[i+2]),i+=4,this.v3.xxh_update(n[i+1]<<8|n[i],n[i+3]<<8|n[i+2]),i+=4,this.v4.xxh_update(n[i+1]<<8|n[i],n[i+3]<<8|n[i+2])),i+=4;while(i<=u)}return i<a&&(e?this.memory+=n.slice(i):t?this.memory.set(n.subarray(i,a),this.memsize):n.copy(this.memory,this.memsize,i,a),this.memsize=a-i),this};XXH.prototype.digest=function(){var n=this.memory,e=typeof n=="string",t=0,i=this.memsize,o,a,c=new UINT32;for(this.total_len>=16?o=this.v1.rotl(1).add(this.v2.rotl(7).add(this.v3.rotl(12).add(this.v4.rotl(18)))):o=this.seed.clone().add(PRIME32_5),o.add(c.fromNumber(this.total_len));t<=i-4;)e?c.fromBits(n.charCodeAt(t+1)<<8|n.charCodeAt(t),n.charCodeAt(t+3)<<8|n.charCodeAt(t+2)):c.fromBits(n[t+1]<<8|n[t],n[t+3]<<8|n[t+2]),o.add(c.multiply(PRIME32_3)).rotl(17).multiply(PRIME32_4),t+=4;for(;t<i;)c.fromBits(e?n.charCodeAt(t++):n[t++],0),o.add(c.multiply(PRIME32_5)).rotl(11).multiply(PRIME32_1);return a=o.clone().shiftRight(15),o.xor(a).multiply(PRIME32_2),a=o.clone().shiftRight(13),o.xor(a).multiply(PRIME32_3),a=o.clone().shiftRight(16),o.xor(a),this.init(this.seed),o};var xxhash=XXH,UINT64=cuint.UINT64,PRIME64_1=UINT64("11400714785074694791"),PRIME64_2=UINT64("14029467366897019727"),PRIME64_3=UINT64("1609587929392839161"),PRIME64_4=UINT64("9650029242287828579"),PRIME64_5=UINT64("2870177450012600261");function toUTF8Array(n){for(var e=[],t=0,i=n.length;t<i;t++){var o=n.charCodeAt(t);o<128?e.push(o):o<2048?e.push(192|o>>6,128|o&63):o<55296||o>=57344?e.push(224|o>>12,128|o>>6&63,128|o&63):(t++,o=65536+((o&1023)<<10|n.charCodeAt(t)&1023),e.push(240|o>>18,128|o>>12&63,128|o>>6&63,128|o&63))}return new Uint8Array(e)}function XXH64(){if(arguments.length==2)return new XXH64(arguments[1]).update(arguments[0]).digest();if(!(this instanceof XXH64))return new XXH64(arguments[0]);init$2.call(this,arguments[0])}function init$2(n){return this.seed=n instanceof UINT64?n.clone():UINT64(n),this.v1=this.seed.clone().add(PRIME64_1).add(PRIME64_2),this.v2=this.seed.clone().add(PRIME64_2),this.v3=this.seed.clone(),this.v4=this.seed.clone().subtract(PRIME64_1),this.total_len=0,this.memsize=0,this.memory=null,this}XXH64.prototype.init=init$2;XXH64.prototype.update=function(n){var e=typeof n=="string",t;e&&(n=toUTF8Array(n),e=!1,t=!0),typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer&&(t=!0,n=new Uint8Array(n));var i=0,o=n.length,a=i+o;if(o==0)return this;if(this.total_len+=o,this.memsize==0&&(e?this.memory="":t?this.memory=new Uint8Array(32):this.memory=new buffer$2.Buffer(32)),this.memsize+o<32)return e?this.memory+=n:t?this.memory.set(n.subarray(0,o),this.memsize):n.copy(this.memory,this.memsize,0,o),this.memsize+=o,this;if(this.memsize>0){e?this.memory+=n.slice(0,32-this.memsize):t?this.memory.set(n.subarray(0,32-this.memsize),this.memsize):n.copy(this.memory,this.memsize,0,32-this.memsize);var c=0;if(e){var u;u=UINT64(this.memory.charCodeAt(c+1)<<8|this.memory.charCodeAt(c),this.memory.charCodeAt(c+3)<<8|this.memory.charCodeAt(c+2),this.memory.charCodeAt(c+5)<<8|this.memory.charCodeAt(c+4),this.memory.charCodeAt(c+7)<<8|this.memory.charCodeAt(c+6)),this.v1.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1),c+=8,u=UINT64(this.memory.charCodeAt(c+1)<<8|this.memory.charCodeAt(c),this.memory.charCodeAt(c+3)<<8|this.memory.charCodeAt(c+2),this.memory.charCodeAt(c+5)<<8|this.memory.charCodeAt(c+4),this.memory.charCodeAt(c+7)<<8|this.memory.charCodeAt(c+6)),this.v2.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1),c+=8,u=UINT64(this.memory.charCodeAt(c+1)<<8|this.memory.charCodeAt(c),this.memory.charCodeAt(c+3)<<8|this.memory.charCodeAt(c+2),this.memory.charCodeAt(c+5)<<8|this.memory.charCodeAt(c+4),this.memory.charCodeAt(c+7)<<8|this.memory.charCodeAt(c+6)),this.v3.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1),c+=8,u=UINT64(this.memory.charCodeAt(c+1)<<8|this.memory.charCodeAt(c),this.memory.charCodeAt(c+3)<<8|this.memory.charCodeAt(c+2),this.memory.charCodeAt(c+5)<<8|this.memory.charCodeAt(c+4),this.memory.charCodeAt(c+7)<<8|this.memory.charCodeAt(c+6)),this.v4.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1)}else{var u;u=UINT64(this.memory[c+1]<<8|this.memory[c],this.memory[c+3]<<8|this.memory[c+2],this.memory[c+5]<<8|this.memory[c+4],this.memory[c+7]<<8|this.memory[c+6]),this.v1.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1),c+=8,u=UINT64(this.memory[c+1]<<8|this.memory[c],this.memory[c+3]<<8|this.memory[c+2],this.memory[c+5]<<8|this.memory[c+4],this.memory[c+7]<<8|this.memory[c+6]),this.v2.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1),c+=8,u=UINT64(this.memory[c+1]<<8|this.memory[c],this.memory[c+3]<<8|this.memory[c+2],this.memory[c+5]<<8|this.memory[c+4],this.memory[c+7]<<8|this.memory[c+6]),this.v3.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1),c+=8,u=UINT64(this.memory[c+1]<<8|this.memory[c],this.memory[c+3]<<8|this.memory[c+2],this.memory[c+5]<<8|this.memory[c+4],this.memory[c+7]<<8|this.memory[c+6]),this.v4.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1)}i+=32-this.memsize,this.memsize=0,e&&(this.memory="")}if(i<=a-32){var d=a-32;do{if(e){var u;u=UINT64(n.charCodeAt(i+1)<<8|n.charCodeAt(i),n.charCodeAt(i+3)<<8|n.charCodeAt(i+2),n.charCodeAt(i+5)<<8|n.charCodeAt(i+4),n.charCodeAt(i+7)<<8|n.charCodeAt(i+6)),this.v1.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1),i+=8,u=UINT64(n.charCodeAt(i+1)<<8|n.charCodeAt(i),n.charCodeAt(i+3)<<8|n.charCodeAt(i+2),n.charCodeAt(i+5)<<8|n.charCodeAt(i+4),n.charCodeAt(i+7)<<8|n.charCodeAt(i+6)),this.v2.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1),i+=8,u=UINT64(n.charCodeAt(i+1)<<8|n.charCodeAt(i),n.charCodeAt(i+3)<<8|n.charCodeAt(i+2),n.charCodeAt(i+5)<<8|n.charCodeAt(i+4),n.charCodeAt(i+7)<<8|n.charCodeAt(i+6)),this.v3.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1),i+=8,u=UINT64(n.charCodeAt(i+1)<<8|n.charCodeAt(i),n.charCodeAt(i+3)<<8|n.charCodeAt(i+2),n.charCodeAt(i+5)<<8|n.charCodeAt(i+4),n.charCodeAt(i+7)<<8|n.charCodeAt(i+6)),this.v4.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1)}else{var u;u=UINT64(n[i+1]<<8|n[i],n[i+3]<<8|n[i+2],n[i+5]<<8|n[i+4],n[i+7]<<8|n[i+6]),this.v1.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1),i+=8,u=UINT64(n[i+1]<<8|n[i],n[i+3]<<8|n[i+2],n[i+5]<<8|n[i+4],n[i+7]<<8|n[i+6]),this.v2.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1),i+=8,u=UINT64(n[i+1]<<8|n[i],n[i+3]<<8|n[i+2],n[i+5]<<8|n[i+4],n[i+7]<<8|n[i+6]),this.v3.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1),i+=8,u=UINT64(n[i+1]<<8|n[i],n[i+3]<<8|n[i+2],n[i+5]<<8|n[i+4],n[i+7]<<8|n[i+6]),this.v4.add(u.multiply(PRIME64_2)).rotl(31).multiply(PRIME64_1)}i+=8}while(i<=d)}return i<a&&(e?this.memory+=n.slice(i):t?this.memory.set(n.subarray(i,a),this.memsize):n.copy(this.memory,this.memsize,i,a),this.memsize=a-i),this};XXH64.prototype.digest=function(){var n=this.memory,e=typeof n=="string",t=0,i=this.memsize,o,a,c=new UINT64;for(this.total_len>=32?(o=this.v1.clone().rotl(1),o.add(this.v2.clone().rotl(7)),o.add(this.v3.clone().rotl(12)),o.add(this.v4.clone().rotl(18)),o.xor(this.v1.multiply(PRIME64_2).rotl(31).multiply(PRIME64_1)),o.multiply(PRIME64_1).add(PRIME64_4),o.xor(this.v2.multiply(PRIME64_2).rotl(31).multiply(PRIME64_1)),o.multiply(PRIME64_1).add(PRIME64_4),o.xor(this.v3.multiply(PRIME64_2).rotl(31).multiply(PRIME64_1)),o.multiply(PRIME64_1).add(PRIME64_4),o.xor(this.v4.multiply(PRIME64_2).rotl(31).multiply(PRIME64_1)),o.multiply(PRIME64_1).add(PRIME64_4)):o=this.seed.clone().add(PRIME64_5),o.add(c.fromNumber(this.total_len));t<=i-8;)e?c.fromBits(n.charCodeAt(t+1)<<8|n.charCodeAt(t),n.charCodeAt(t+3)<<8|n.charCodeAt(t+2),n.charCodeAt(t+5)<<8|n.charCodeAt(t+4),n.charCodeAt(t+7)<<8|n.charCodeAt(t+6)):c.fromBits(n[t+1]<<8|n[t],n[t+3]<<8|n[t+2],n[t+5]<<8|n[t+4],n[t+7]<<8|n[t+6]),c.multiply(PRIME64_2).rotl(31).multiply(PRIME64_1),o.xor(c).rotl(27).multiply(PRIME64_1).add(PRIME64_4),t+=8;for(t+4<=i&&(e?c.fromBits(n.charCodeAt(t+1)<<8|n.charCodeAt(t),n.charCodeAt(t+3)<<8|n.charCodeAt(t+2),0,0):c.fromBits(n[t+1]<<8|n[t],n[t+3]<<8|n[t+2],0,0),o.xor(c.multiply(PRIME64_1)).rotl(23).multiply(PRIME64_2).add(PRIME64_3),t+=4);t<i;)c.fromBits(e?n.charCodeAt(t++):n[t++],0,0,0),o.xor(c.multiply(PRIME64_5)).rotl(11).multiply(PRIME64_1);return a=o.clone().shiftRight(33),o.xor(a).multiply(PRIME64_2),a=o.clone().shiftRight(29),o.xor(a).multiply(PRIME64_3),a=o.clone().shiftRight(32),o.xor(a),this.init(this.seed),o};var xxhash64=XXH64,lib={h32:xxhash,h64:xxhash64},__values$1=commonjsGlobal&&commonjsGlobal.__values||function(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},__importDefault$c=commonjsGlobal&&commonjsGlobal.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(utils$3,"__esModule",{value:!0});var xxhashjs_1=__importDefault$c(lib),buffer_1$2=buffer$2;function allocateArray(n,e){for(var t=new Array(n),i=typeof e=="function"?e:function(){return e},o=0;o<n;o++)t[o]=i();return t}utils$3.allocateArray=allocateArray;function hashTwice(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=getDefaultSeed());var i=xxhashjs_1.default.h64(n,t+1),o=xxhashjs_1.default.h64(n,t+2);if(e)return{first:i.toNumber(),second:o.toNumber()};var a=i.toString(16);a.length<16&&(a="0".repeat(16-a.length)+a);var c=o.toString(16);return c.length<16&&(c="0".repeat(16-c.length)+c),{first:Number(a),second:Number(c)}}utils$3.hashTwice=hashTwice;function hashTwiceAsString(n,e){e===void 0&&(e=getDefaultSeed());var t=xxhashjs_1.default.h64(n,e+1),i=xxhashjs_1.default.h64(n,e+2),o=t.toString(16);o.length<16&&(o="0".repeat(16-o.length)+o);var a=i.toString(16);return a.length<16&&(a="0".repeat(16-a.length)+a),{first:o,second:a}}utils$3.hashTwiceAsString=hashTwiceAsString;function allInOneHashTwice(n,e){e===void 0&&(e=getDefaultSeed());var t=xxhashjs_1.default.h64(n,e+1),i=xxhashjs_1.default.h64(n,e+2),o=t.toString(16);o.length<16&&(o="0".repeat(16-o.length)+o);var a=i.toString(16);return a.length<16&&(a="0".repeat(16-a.length)+a),{int:{first:t.toNumber(),second:i.toNumber()},string:{first:o,second:a}}}utils$3.allInOneHashTwice=allInOneHashTwice;function doubleHashing(n,e,t,i){return Math.abs((e+n*t)%i)}utils$3.doubleHashing=doubleHashing;function getDistinctIndices(n,e,t,i){i===void 0&&(i=getDefaultSeed());function o(a,c,u,d,p){if(p===void 0&&(p=[]),p.length===d)return p;var h=hashTwice(c,!0,i+u%a),b=doubleHashing(a,h.first,h.second,u);return p.includes(b)||p.push(b),o(a+1,c,u,d,p)}return o(1,n,e,t)}utils$3.getDistinctIndices=getDistinctIndices;function getIndices(n,e,t,i){i===void 0&&(i=getDefaultSeed());for(var o=[],a=1;a<=t;a++){var c=hashTwice(n,!0,i+e%a);o.push(doubleHashing(a,c.first,c.second,e))}if(o.length!==t)throw new Error("report this, please, shouldnt be of different size");return o}utils$3.getIndices=getIndices;function randomInt(n,e,t){t===void 0&&(t=Math.random),n=Math.ceil(n),e=Math.floor(e);var i=t();return Math.floor(i*(e-n+1))+n}utils$3.randomInt=randomInt;function xorBuffer(n,e){for(var t=Math.max(n.length,e.length),i=buffer_1$2.Buffer.allocUnsafe(t).fill(0),o=0;o<t;++o)o<n.length&&o<e.length?i[t-o-1]=n[n.length-o-1]^e[e.length-o-1]:o<n.length&&o>=e.length?i[t-o-1]^=n[n.length-o-1]:o<e.length&&o>=n.length&&(i[t-o-1]^=e[e.length-o-1]);for(var a=0,c=i.values(),u=c.next();!u.done&&u.value===0;)a++,u=c.next();var d=i.slice(a);return d}utils$3.xorBuffer=xorBuffer;function isEmptyBuffer(n){var e,t;if(n===null||!n)return!0;try{for(var i=__values$1(n),o=i.next();!o.done;o=i.next()){var a=o.value;if(a!==0)return!1}}catch(c){e={error:c}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return!0}utils$3.isEmptyBuffer=isEmptyBuffer;function hashAsInt(n,e,t){switch(e===void 0&&(e=getDefaultSeed()),t){case 32:return xxhashjs_1.default.h32(n,e).toNumber();case 64:return xxhashjs_1.default.h64(n,e).toNumber();default:return xxhashjs_1.default.h64(n,e).toNumber()}}utils$3.hashAsInt=hashAsInt;function hashAsString(n,e,t,i){e===void 0&&(e=getDefaultSeed()),t===void 0&&(t=16),i===void 0&&(i=64);var o;switch(i){case 32:o=xxhashjs_1.default.h32(n,e);break;case 64:o=xxhashjs_1.default.h64(n,e);break;default:o=xxhashjs_1.default.h64(n,e);break}var a="";return t===16?(a=o.toString(t),a.length<i/4&&(a="0".repeat(i/4-a.length)+a)):t===2&&(a=hex2bin(o.toString(16)),a.length<i&&(a="0".repeat(i-a.length)+a)),a}utils$3.hashAsString=hashAsString;function hashIntAndString(n,e,t,i){e===void 0&&(e=getDefaultSeed()),t===void 0&&(t=16),i===void 0&&(i=64);var o;switch(i){case 32:o=xxhashjs_1.default.h32(n,e);break;case 64:o=xxhashjs_1.default.h64(n,e);break;default:o=xxhashjs_1.default.h64(n,e);break}var a="";return t===16?(a=o.toString(t),a.length<i/4&&(a="0".repeat(i/4-a.length)+a)):t===2&&(a=hex2bin(o.toString(16)),a.length<i&&(a="0".repeat(i-a.length)+a)),{int:o.toNumber(),string:a}}utils$3.hashIntAndString=hashIntAndString;function getDefaultSeed(){return 78187493520}utils$3.getDefaultSeed=getDefaultSeed;function power2(n){return Math.ceil(Math.pow(2,Math.floor(Math.log(n)/Math.log(2))))}utils$3.power2=power2;function hex2bin(n){return parseInt(n,16).toString(2)}utils$3.hex2bin=hex2bin;function uint8ToBits(n){return[128,64,32,16,8,4,2,1].map(function(e){return(e&n)>0?1:0})}utils$3.uint8ToBits=uint8ToBits;function bitsToUint8(n){return n.reduce(function(e,t,i){if(t===0)return e;if(t===1)return e+Math.pow(2,7-i);throw new Error("Not binary")},0)}utils$3.bitsToUint8=bitsToUint8;var alea$1={exports:{}};alea$1.exports;(function(n){(function(e,t,i){function o(d){var p=this,h=u();p.next=function(){var b=2091639*p.s0+p.c*23283064365386963e-26;return p.s0=p.s1,p.s1=p.s2,p.s2=b-(p.c=b|0)},p.c=1,p.s0=h(" "),p.s1=h(" "),p.s2=h(" "),p.s0-=h(d),p.s0<0&&(p.s0+=1),p.s1-=h(d),p.s1<0&&(p.s1+=1),p.s2-=h(d),p.s2<0&&(p.s2+=1),h=null}function a(d,p){return p.c=d.c,p.s0=d.s0,p.s1=d.s1,p.s2=d.s2,p}function c(d,p){var h=new o(d),b=p&&p.state,m=h.next;return m.int32=function(){return h.next()*4294967296|0},m.double=function(){return m()+(m()*2097152|0)*11102230246251565e-32},m.quick=m,b&&(typeof b=="object"&&a(b,h),m.state=function(){return a(h,{})}),m}function u(){var d=4022871197,p=function(h){h=String(h);for(var b=0;b<h.length;b++){d+=h.charCodeAt(b);var m=.02519603282416938*d;d=m>>>0,m-=d,m*=d,d=m>>>0,m-=d,d+=m*4294967296}return(d>>>0)*23283064365386963e-26};return p}t&&t.exports?t.exports=c:i&&i.amd?i(function(){return c}):this.alea=c})(commonjsGlobal,n,!1)})(alea$1);var aleaExports=alea$1.exports,xor128$1={exports:{}};xor128$1.exports;(function(n){(function(e,t,i){function o(u){var d=this,p="";d.x=0,d.y=0,d.z=0,d.w=0,d.next=function(){var b=d.x^d.x<<11;return d.x=d.y,d.y=d.z,d.z=d.w,d.w^=d.w>>>19^b^b>>>8},u===(u|0)?d.x=u:p+=u;for(var h=0;h<p.length+64;h++)d.x^=p.charCodeAt(h)|0,d.next()}function a(u,d){return d.x=u.x,d.y=u.y,d.z=u.z,d.w=u.w,d}function c(u,d){var p=new o(u),h=d&&d.state,b=function(){return(p.next()>>>0)/4294967296};return b.double=function(){do var m=p.next()>>>11,v=(p.next()>>>0)/4294967296,_=(m+v)/(1<<21);while(_===0);return _},b.int32=p.next,b.quick=b,h&&(typeof h=="object"&&a(h,p),b.state=function(){return a(p,{})}),b}t&&t.exports?t.exports=c:i&&i.amd?i(function(){return c}):this.xor128=c})(commonjsGlobal,n,!1)})(xor128$1);var xor128Exports=xor128$1.exports,xorwow$1={exports:{}};xorwow$1.exports;(function(n){(function(e,t,i){function o(u){var d=this,p="";d.next=function(){var b=d.x^d.x>>>2;return d.x=d.y,d.y=d.z,d.z=d.w,d.w=d.v,(d.d=d.d+362437|0)+(d.v=d.v^d.v<<4^(b^b<<1))|0},d.x=0,d.y=0,d.z=0,d.w=0,d.v=0,u===(u|0)?d.x=u:p+=u;for(var h=0;h<p.length+64;h++)d.x^=p.charCodeAt(h)|0,h==p.length&&(d.d=d.x<<10^d.x>>>4),d.next()}function a(u,d){return d.x=u.x,d.y=u.y,d.z=u.z,d.w=u.w,d.v=u.v,d.d=u.d,d}function c(u,d){var p=new o(u),h=d&&d.state,b=function(){return(p.next()>>>0)/4294967296};return b.double=function(){do var m=p.next()>>>11,v=(p.next()>>>0)/4294967296,_=(m+v)/(1<<21);while(_===0);return _},b.int32=p.next,b.quick=b,h&&(typeof h=="object"&&a(h,p),b.state=function(){return a(p,{})}),b}t&&t.exports?t.exports=c:i&&i.amd?i(function(){return c}):this.xorwow=c})(commonjsGlobal,n,!1)})(xorwow$1);var xorwowExports=xorwow$1.exports,xorshift7$1={exports:{}};xorshift7$1.exports;(function(n){(function(e,t,i){function o(u){var d=this;d.next=function(){var h=d.x,b=d.i,m,v;return m=h[b],m^=m>>>7,v=m^m<<24,m=h[b+1&7],v^=m^m>>>10,m=h[b+3&7],v^=m^m>>>3,m=h[b+4&7],v^=m^m<<7,m=h[b+7&7],m=m^m<<13,v^=m^m<<9,h[b]=v,d.i=b+1&7,v};function p(h,b){var m,v=[];if(b===(b|0))v[0]=b;else for(b=""+b,m=0;m<b.length;++m)v[m&7]=v[m&7]<<15^b.charCodeAt(m)+v[m+1&7]<<13;for(;v.length<8;)v.push(0);for(m=0;m<8&&v[m]===0;++m);for(m==8?v[7]=-1:v[m],h.x=v,h.i=0,m=256;m>0;--m)h.next()}p(d,u)}function a(u,d){return d.x=u.x.slice(),d.i=u.i,d}function c(u,d){u==null&&(u=+new Date);var p=new o(u),h=d&&d.state,b=function(){return(p.next()>>>0)/4294967296};return b.double=function(){do var m=p.next()>>>11,v=(p.next()>>>0)/4294967296,_=(m+v)/(1<<21);while(_===0);return _},b.int32=p.next,b.quick=b,h&&(h.x&&a(h,p),b.state=function(){return a(p,{})}),b}t&&t.exports?t.exports=c:i&&i.amd?i(function(){return c}):this.xorshift7=c})(commonjsGlobal,n,!1)})(xorshift7$1);var xorshift7Exports=xorshift7$1.exports,xor4096$1={exports:{}};xor4096$1.exports;(function(n){(function(e,t,i){function o(u){var d=this;d.next=function(){var h=d.w,b=d.X,m=d.i,v,_;return d.w=h=h+1640531527|0,_=b[m+34&127],v=b[m=m+1&127],_^=_<<13,v^=v<<17,_^=_>>>15,v^=v>>>12,_=b[m]=_^v,d.i=m,_+(h^h>>>16)|0};function p(h,b){var m,v,_,$,k,D=[],O=128;for(b===(b|0)?(v=b,b=null):(b=b+"\0",v=0,O=Math.max(O,b.length)),_=0,$=-32;$<O;++$)b&&(v^=b.charCodeAt(($+32)%b.length)),$===0&&(k=v),v^=v<<10,v^=v>>>15,v^=v<<4,v^=v>>>13,$>=0&&(k=k+1640531527|0,m=D[$&127]^=v+k,_=m==0?_+1:0);for(_>=128&&(D[(b&&b.length||0)&127]=-1),_=127,$=4*128;$>0;--$)v=D[_+34&127],m=D[_=_+1&127],v^=v<<13,m^=m<<17,v^=v>>>15,m^=m>>>12,D[_]=v^m;h.w=k,h.X=D,h.i=_}p(d,u)}function a(u,d){return d.i=u.i,d.w=u.w,d.X=u.X.slice(),d}function c(u,d){u==null&&(u=+new Date);var p=new o(u),h=d&&d.state,b=function(){return(p.next()>>>0)/4294967296};return b.double=function(){do var m=p.next()>>>11,v=(p.next()>>>0)/4294967296,_=(m+v)/(1<<21);while(_===0);return _},b.int32=p.next,b.quick=b,h&&(h.X&&a(h,p),b.state=function(){return a(p,{})}),b}t&&t.exports?t.exports=c:i&&i.amd?i(function(){return c}):this.xor4096=c})(commonjsGlobal,n,!1)})(xor4096$1);var xor4096Exports=xor4096$1.exports,tychei$1={exports:{}};tychei$1.exports;(function(n){(function(e,t,i){function o(u){var d=this,p="";d.next=function(){var b=d.b,m=d.c,v=d.d,_=d.a;return b=b<<25^b>>>7^m,m=m-v|0,v=v<<24^v>>>8^_,_=_-b|0,d.b=b=b<<20^b>>>12^m,d.c=m=m-v|0,d.d=v<<16^m>>>16^_,d.a=_-b|0},d.a=0,d.b=0,d.c=-1640531527,d.d=1367130551,u===Math.floor(u)?(d.a=u/4294967296|0,d.b=u|0):p+=u;for(var h=0;h<p.length+20;h++)d.b^=p.charCodeAt(h)|0,d.next()}function a(u,d){return d.a=u.a,d.b=u.b,d.c=u.c,d.d=u.d,d}function c(u,d){var p=new o(u),h=d&&d.state,b=function(){return(p.next()>>>0)/4294967296};return b.double=function(){do var m=p.next()>>>11,v=(p.next()>>>0)/4294967296,_=(m+v)/(1<<21);while(_===0);return _},b.int32=p.next,b.quick=b,h&&(typeof h=="object"&&a(h,p),b.state=function(){return a(p,{})}),b}t&&t.exports?t.exports=c:i&&i.amd?i(function(){return c}):this.tychei=c})(commonjsGlobal,n,!1)})(tychei$1);var tycheiExports=tychei$1.exports,seedrandom$1={exports:{}};(function(n){(function(e,t,i){var o=256,a=6,c=52,u="random",d=i.pow(o,a),p=i.pow(2,c),h=p*2,b=o-1,m;function v(j,W,ae){var fe=[];W=W==!0?{entropy:!0}:W||{};var pe=D(k(W.entropy?[j,H(t)]:j??O(),3),fe),ve=new _(fe),Qe=function(){for(var re=ve.g(a),C=d,S=0;re<p;)re=(re+S)*o,C*=o,S=ve.g(1);for(;re>=h;)re/=2,C/=2,S>>>=1;return(re+S)/C};return Qe.int32=function(){return ve.g(4)|0},Qe.quick=function(){return ve.g(4)/4294967296},Qe.double=Qe,D(H(ve.S),t),(W.pass||ae||function(re,C,S,w){return w&&(w.S&&$(w,ve),re.state=function(){return $(ve,{})}),S?(i[u]=re,C):re})(Qe,pe,"global"in W?W.global:this==i,W.state)}function _(j){var W,ae=j.length,fe=this,pe=0,ve=fe.i=fe.j=0,Qe=fe.S=[];for(ae||(j=[ae++]);pe<o;)Qe[pe]=pe++;for(pe=0;pe<o;pe++)Qe[pe]=Qe[ve=b&ve+j[pe%ae]+(W=Qe[pe])],Qe[ve]=W;(fe.g=function(re){for(var C,S=0,w=fe.i,E=fe.j,I=fe.S;re--;)C=I[w=b&w+1],S=S*o+I[b&(I[w]=I[E=b&E+C])+(I[E]=C)];return fe.i=w,fe.j=E,S})(o)}function $(j,W){return W.i=j.i,W.j=j.j,W.S=j.S.slice(),W}function k(j,W){var ae=[],fe=typeof j,pe;if(W&&fe=="object")for(pe in j)try{ae.push(k(j[pe],W-1))}catch{}return ae.length?ae:fe=="string"?j:j+"\0"}function D(j,W){for(var ae=j+"",fe,pe=0;pe<ae.length;)W[b&pe]=b&(fe^=W[b&pe]*19)+ae.charCodeAt(pe++);return H(W)}function O(){try{var j;return m&&(j=m.randomBytes)?j=j(o):(j=new Uint8Array(o),(e.crypto||e.msCrypto).getRandomValues(j)),H(j)}catch{var W=e.navigator,ae=W&&W.plugins;return[+new Date,e,ae,e.screen,H(t)]}}function H(j){return String.fromCharCode.apply(0,j)}if(D(i.random(),t),n.exports){n.exports=v;try{m=requireCryptoBrowserify()}catch{}}else i["seed"+u]=v})(typeof self<"u"?self:commonjsGlobal,[],Math)})(seedrandom$1);var seedrandomExports=seedrandom$1.exports,alea=aleaExports,xor128=xor128Exports,xorwow=xorwowExports,xorshift7=xorshift7Exports,xor4096=xor4096Exports,tychei=tycheiExports,sr=seedrandomExports;sr.alea=alea;sr.xor128=xor128;sr.xorwow=xorwow;sr.xorshift7=xorshift7;sr.xor4096=xor4096;sr.tychei=tychei;var seedrandom=sr,__importStar$1=commonjsGlobal&&commonjsGlobal.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e},__importDefault$b=commonjsGlobal&&commonjsGlobal.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(baseFilter,"__esModule",{value:!0});var utils$2=__importStar$1(utils$3),seedrandom_1=__importDefault$b(seedrandom),BaseFilter=function(){function n(){this._seed=utils$2.getDefaultSeed(),this._rng=seedrandom_1.default(""+this._seed)}return Object.defineProperty(n.prototype,"seed",{get:function(){return this._seed},set:function(e){this._seed=e,this._rng=seedrandom_1.default(""+this._seed)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"random",{get:function(){return this._rng},enumerable:!0,configurable:!0}),n.prototype.saveAsJSON=function(){throw new Error("not-implemented")},n.fromJSON=function(e){throw new Error("not-implemented")},n}();baseFilter.default=BaseFilter;var exportable={},Reflect$1;(function(n){(function(e){var t=typeof commonjsGlobal=="object"?commonjsGlobal:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),i=o(n);typeof t.Reflect>"u"?t.Reflect=n:i=o(t.Reflect,i),e(i);function o(a,c){return function(u,d){typeof a[u]!="function"&&Object.defineProperty(a,u,{configurable:!0,writable:!0,value:d}),c&&c(u,d)}}})(function(e){var t=Object.prototype.hasOwnProperty,i=typeof Symbol=="function",o=i&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",a=i&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",u={__proto__:[]}instanceof Array,d=!c&&!u,p={create:c?function(){return Ut(Object.create(null))}:u?function(){return Ut({__proto__:null})}:function(){return Ut({})},has:d?function(be,Pe){return t.call(be,Pe)}:function(be,Pe){return Pe in be},get:d?function(be,Pe){return t.call(be,Pe)?be[Pe]:void 0}:function(be,Pe){return be[Pe]}},h=Object.getPrototypeOf(Function),b=typeof process$3=="object"&&process$3.env&&process$3.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",m=!b&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:jt(),v=!b&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:ot(),_=!b&&typeof WeakMap=="function"?WeakMap:Ot(),$=new _;function k(be,Pe,Be,Re){if(B(Be)){if(!ze(be))throw new TypeError;if(!ie(Pe))throw new TypeError;return Qe(be,Pe)}else{if(!ze(be))throw new TypeError;if(!de(Pe))throw new TypeError;if(!de(Re)&&!B(Re)&&!A(Re))throw new TypeError;return A(Re)&&(Re=void 0),Be=Ae(Be),re(be,Pe,Be,Re)}}e("decorate",k);function D(be,Pe){function Be(Re,Ye){if(!de(Re))throw new TypeError;if(!B(Ye)&&!Ie(Ye))throw new TypeError;N(be,Pe,Re,Ye)}return Be}e("metadata",D);function O(be,Pe,Be,Re){if(!de(Be))throw new TypeError;return B(Re)||(Re=Ae(Re)),N(be,Pe,Be,Re)}e("defineMetadata",O);function H(be,Pe,Be){if(!de(Pe))throw new TypeError;return B(Be)||(Be=Ae(Be)),S(be,Pe,Be)}e("hasMetadata",H);function j(be,Pe,Be){if(!de(Pe))throw new TypeError;return B(Be)||(Be=Ae(Be)),w(be,Pe,Be)}e("hasOwnMetadata",j);function W(be,Pe,Be){if(!de(Pe))throw new TypeError;return B(Be)||(Be=Ae(Be)),E(be,Pe,Be)}e("getMetadata",W);function ae(be,Pe,Be){if(!de(Pe))throw new TypeError;return B(Be)||(Be=Ae(Be)),I(be,Pe,Be)}e("getOwnMetadata",ae);function fe(be,Pe){if(!de(be))throw new TypeError;return B(Pe)||(Pe=Ae(Pe)),U(be,Pe)}e("getMetadataKeys",fe);function pe(be,Pe){if(!de(be))throw new TypeError;return B(Pe)||(Pe=Ae(Pe)),L(be,Pe)}e("getOwnMetadataKeys",pe);function ve(be,Pe,Be){if(!de(Pe))throw new TypeError;B(Be)||(Be=Ae(Be));var Re=C(Pe,Be,!1);if(B(Re)||!Re.delete(be))return!1;if(Re.size>0)return!0;var Ye=$.get(Pe);return Ye.delete(Be),Ye.size>0||$.delete(Pe),!0}e("deleteMetadata",ve);function Qe(be,Pe){for(var Be=be.length-1;Be>=0;--Be){var Re=be[Be],Ye=Re(Pe);if(!B(Ye)&&!A(Ye)){if(!ie(Ye))throw new TypeError;Pe=Ye}}return Pe}function re(be,Pe,Be,Re){for(var Ye=be.length-1;Ye>=0;--Ye){var Tt=be[Ye],Je=Tt(Pe,Be,Re);if(!B(Je)&&!A(Je)){if(!de(Je))throw new TypeError;Re=Je}}return Re}function C(be,Pe,Be){var Re=$.get(be);if(B(Re)){if(!Be)return;Re=new m,$.set(be,Re)}var Ye=Re.get(Pe);if(B(Ye)){if(!Be)return;Ye=new m,Re.set(Pe,Ye)}return Ye}function S(be,Pe,Be){var Re=w(be,Pe,Be);if(Re)return!0;var Ye=Me(Pe);return A(Ye)?!1:S(be,Ye,Be)}function w(be,Pe,Be){var Re=C(Pe,Be,!1);return B(Re)?!1:he(Re.has(be))}function E(be,Pe,Be){var Re=w(be,Pe,Be);if(Re)return I(be,Pe,Be);var Ye=Me(Pe);if(!A(Ye))return E(be,Ye,Be)}function I(be,Pe,Be){var Re=C(Pe,Be,!1);if(!B(Re))return Re.get(be)}function N(be,Pe,Be,Re){var Ye=C(Be,Re,!0);Ye.set(be,Pe)}function U(be,Pe){var Be=L(be,Pe),Re=Me(be);if(Re===null)return Be;var Ye=U(Re,Pe);if(Ye.length<=0)return Be;if(Be.length<=0)return Ye;for(var Tt=new v,Je=[],dt=0,rt=Be;dt<rt.length;dt++){var et=rt[dt],pt=Tt.has(et);pt||(Tt.add(et),Je.push(et))}for(var Kt=0,Ct=Ye;Kt<Ct.length;Kt++){var et=Ct[Kt],pt=Tt.has(et);pt||(Tt.add(et),Je.push(et))}return Je}function L(be,Pe){var Be=[],Re=C(be,Pe,!1);if(B(Re))return Be;for(var Ye=Re.keys(),Tt=Ze(Ye),Je=0;;){var dt=ht(Tt);if(!dt)return Be.length=Je,Be;var rt=lt(dt);try{Be[Je]=rt}catch(et){try{gt(Tt)}finally{throw et}}Je++}}function P(be){if(be===null)return 1;switch(typeof be){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return be===null?1:6;default:return 6}}function B(be){return be===void 0}function A(be){return be===null}function z(be){return typeof be=="symbol"}function de(be){return typeof be=="object"?be!==null:typeof be=="function"}function we(be,Pe){switch(P(be)){case 0:return be;case 1:return be;case 2:return be;case 3:return be;case 4:return be;case 5:return be}var Be=Pe===3?"string":Pe===5?"number":"default",Re=qe(be,o);if(Re!==void 0){var Ye=Re.call(be,Be);if(de(Ye))throw new TypeError;return Ye}return se(be,Be==="default"?"number":Be)}function se(be,Pe){if(Pe==="string"){var Be=be.toString;if(oe(Be)){var Re=Be.call(be);if(!de(Re))return Re}var Ye=be.valueOf;if(oe(Ye)){var Re=Ye.call(be);if(!de(Re))return Re}}else{var Ye=be.valueOf;if(oe(Ye)){var Re=Ye.call(be);if(!de(Re))return Re}var Tt=be.toString;if(oe(Tt)){var Re=Tt.call(be);if(!de(Re))return Re}}throw new TypeError}function he(be){return!!be}function $e(be){return""+be}function Ae(be){var Pe=we(be,3);return z(Pe)?Pe:$e(Pe)}function ze(be){return Array.isArray?Array.isArray(be):be instanceof Object?be instanceof Array:Object.prototype.toString.call(be)==="[object Array]"}function oe(be){return typeof be=="function"}function ie(be){return typeof be=="function"}function Ie(be){switch(P(be)){case 3:return!0;case 4:return!0;default:return!1}}function qe(be,Pe){var Be=be[Pe];if(Be!=null){if(!oe(Be))throw new TypeError;return Be}}function Ze(be){var Pe=qe(be,a);if(!oe(Pe))throw new TypeError;var Be=Pe.call(be);if(!de(Be))throw new TypeError;return Be}function lt(be){return be.value}function ht(be){var Pe=be.next();return Pe.done?!1:Pe}function gt(be){var Pe=be.return;Pe&&Pe.call(be)}function Me(be){var Pe=Object.getPrototypeOf(be);if(typeof be!="function"||be===h||Pe!==h)return Pe;var Be=be.prototype,Re=Be&&Object.getPrototypeOf(Be);if(Re==null||Re===Object.prototype)return Pe;var Ye=Re.constructor;return typeof Ye!="function"||Ye===be?Pe:Ye}function jt(){var be={},Pe=[],Be=function(){function Je(dt,rt,et){this._index=0,this._keys=dt,this._values=rt,this._selector=et}return Je.prototype["@@iterator"]=function(){return this},Je.prototype[a]=function(){return this},Je.prototype.next=function(){var dt=this._index;if(dt>=0&&dt<this._keys.length){var rt=this._selector(this._keys[dt],this._values[dt]);return dt+1>=this._keys.length?(this._index=-1,this._keys=Pe,this._values=Pe):this._index++,{value:rt,done:!1}}return{value:void 0,done:!0}},Je.prototype.throw=function(dt){throw this._index>=0&&(this._index=-1,this._keys=Pe,this._values=Pe),dt},Je.prototype.return=function(dt){return this._index>=0&&(this._index=-1,this._keys=Pe,this._values=Pe),{value:dt,done:!0}},Je}();return function(){function Je(){this._keys=[],this._values=[],this._cacheKey=be,this._cacheIndex=-2}return Object.defineProperty(Je.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Je.prototype.has=function(dt){return this._find(dt,!1)>=0},Je.prototype.get=function(dt){var rt=this._find(dt,!1);return rt>=0?this._values[rt]:void 0},Je.prototype.set=function(dt,rt){var et=this._find(dt,!0);return this._values[et]=rt,this},Je.prototype.delete=function(dt){var rt=this._find(dt,!1);if(rt>=0){for(var et=this._keys.length,pt=rt+1;pt<et;pt++)this._keys[pt-1]=this._keys[pt],this._values[pt-1]=this._values[pt];return this._keys.length--,this._values.length--,dt===this._cacheKey&&(this._cacheKey=be,this._cacheIndex=-2),!0}return!1},Je.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=be,this._cacheIndex=-2},Je.prototype.keys=function(){return new Be(this._keys,this._values,Re)},Je.prototype.values=function(){return new Be(this._keys,this._values,Ye)},Je.prototype.entries=function(){return new Be(this._keys,this._values,Tt)},Je.prototype["@@iterator"]=function(){return this.entries()},Je.prototype[a]=function(){return this.entries()},Je.prototype._find=function(dt,rt){return this._cacheKey!==dt&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=dt)),this._cacheIndex<0&&rt&&(this._cacheIndex=this._keys.length,this._keys.push(dt),this._values.push(void 0)),this._cacheIndex},Je}();function Re(Je,dt){return Je}function Ye(Je,dt){return dt}function Tt(Je,dt){return[Je,dt]}}function ot(){return function(){function be(){this._map=new m}return Object.defineProperty(be.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),be.prototype.has=function(Pe){return this._map.has(Pe)},be.prototype.add=function(Pe){return this._map.set(Pe,Pe),this},be.prototype.delete=function(Pe){return this._map.delete(Pe)},be.prototype.clear=function(){this._map.clear()},be.prototype.keys=function(){return this._map.keys()},be.prototype.values=function(){return this._map.values()},be.prototype.entries=function(){return this._map.entries()},be.prototype["@@iterator"]=function(){return this.keys()},be.prototype[a]=function(){return this.keys()},be}()}function Ot(){var be=16,Pe=p.create(),Be=Re();return function(){function rt(){this._key=Re()}return rt.prototype.has=function(et){var pt=Ye(et,!1);return pt!==void 0?p.has(pt,this._key):!1},rt.prototype.get=function(et){var pt=Ye(et,!1);return pt!==void 0?p.get(pt,this._key):void 0},rt.prototype.set=function(et,pt){var Kt=Ye(et,!0);return Kt[this._key]=pt,this},rt.prototype.delete=function(et){var pt=Ye(et,!1);return pt!==void 0?delete pt[this._key]:!1},rt.prototype.clear=function(){this._key=Re()},rt}();function Re(){var rt;do rt="@@WeakMap@@"+dt();while(p.has(Pe,rt));return Pe[rt]=!0,rt}function Ye(rt,et){if(!t.call(rt,Be)){if(!et)return;Object.defineProperty(rt,Be,{value:p.create()})}return rt[Be]}function Tt(rt,et){for(var pt=0;pt<et;++pt)rt[pt]=Math.random()*255|0;return rt}function Je(rt){return typeof Uint8Array=="function"?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(rt)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(rt)):Tt(new Uint8Array(rt),rt):Tt(new Array(rt),rt)}function dt(){var rt=Je(be);rt[6]=rt[6]&79|64,rt[8]=rt[8]&191|128;for(var et="",pt=0;pt<be;++pt){var Kt=rt[pt];(pt===4||pt===6||pt===8)&&(et+="-"),Kt<16&&(et+="0"),et+=Kt.toString(16).toLowerCase()}return et}}function Ut(be){return be.__=void 0,delete be.__,be}})})(Reflect$1||(Reflect$1={}));var __read$1=commonjsGlobal&&commonjsGlobal.__read||function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),o,a=[],c;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(u){c={error:u}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(c)throw c.error}}return a},__spread$1=commonjsGlobal&&commonjsGlobal.__spread||function(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(__read$1(arguments[e]));return n};Object.defineProperty(exportable,"__esModule",{value:!0});function cloneField(n){return n==null?n:Array.isArray(n)?n.map(cloneField):typeof n=="object"?"saveAsJSON"in n?n.saveAsJSON():Object.assign({},n):n}exportable.cloneField=cloneField;function cloneObject(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(i){var o={type:n};return e.forEach(function(a){o[a]=cloneField(i[a])}),o}}exportable.cloneObject=cloneObject;function Exportable(n){return function(e){return e.prototype.saveAsJSON=function(){return n.export(this)},e.fromJSON=function(t){return n.import(t)},e}}exportable.Exportable=Exportable;var METADATA_CLASSNAME=Symbol("bloom-filters:exportable:class-name"),METADATA_FIELDS=Symbol("bloom-filters:exportable:fields"),METADATA_PARAMETERS=Symbol("bloom-filters:exportable:constructor-parameters");function Field(n,e){return n===void 0&&(n=cloneField),e===void 0&&(e=function(t){return t}),function(t,i){var o=[];Reflect.hasMetadata(METADATA_FIELDS,t)&&(o=Reflect.getMetadata(METADATA_FIELDS,t)),o.push({name:i,exporter:n,importer:e}),Reflect.defineMetadata(METADATA_FIELDS,o,t)}}exportable.Field=Field;function Parameter(n){return function(e,t,i){var o=new Map;Reflect.hasMetadata(METADATA_PARAMETERS,e)&&(o=Reflect.getMetadata(METADATA_PARAMETERS,e)),o.set(n,i),Reflect.defineMetadata(METADATA_PARAMETERS,o,e)}}exportable.Parameter=Parameter;function AutoExportable(n,e){return e===void 0&&(e=[]),function(t){if(Reflect.defineMetadata(METADATA_CLASSNAME,n,t.prototype),!Reflect.hasMetadata(METADATA_FIELDS,t.prototype)||e.length===0)throw new SyntaxError("No exported fields declared when @AutoExportable is called");Reflect.hasMetadata(METADATA_PARAMETERS,t)||Reflect.defineMetadata(METADATA_PARAMETERS,new Map,t),t.prototype.saveAsJSON=function(){var i=this,o={type:Reflect.getMetadata(METADATA_CLASSNAME,t.prototype)},a=Reflect.getMetadata(METADATA_FIELDS,t.prototype);return a.forEach(function(c){o[c.name]=c.exporter(i[c.name])}),e.forEach(function(c){o[c]=cloneField(i[c])}),o},t.fromJSON=function(i){var o=Reflect.getMetadata(METADATA_CLASSNAME,t.prototype),a=Reflect.getMetadata(METADATA_PARAMETERS,t),c=Reflect.getMetadata(METADATA_FIELDS,t.prototype);if(i.type!==o)throw new Error("Cannot create an object "+o+' from a JSON export with type "'+i.type+'"');var u=[],d=[];e.map(function(h){return{name:h,importer:function(b){return b}}}).concat(c).forEach(function(h){if(!(h.name in i))throw new Error('Invalid import: required field "'+h+'" not found in JSON export "'+i+'"');a.has(h.name)?u[a.get(h.name)]=h.importer(i[h.name]):d.push({name:h.name,value:h.importer(i[h.name])})});var p=new(t.bind.apply(t,__spread$1([void 0],u)));return d.forEach(function(h){p[h.name]=h.value}),p}}}exportable.AutoExportable=AutoExportable;var formulas={};Object.defineProperty(formulas,"__esModule",{value:!0});function optimalFilterSize(n,e){return Math.ceil(-(n*Math.log(e)/Math.pow(Math.log(2),2)))}formulas.optimalFilterSize=optimalFilterSize;function optimalHashes(n,e){return Math.ceil(n/e*Math.log(2))}formulas.optimalHashes=optimalHashes;var __extends$9=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var a in o)o.hasOwnProperty(a)&&(i[a]=o[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate$a=commonjsGlobal&&commonjsGlobal.__decorate||function(n,e,t,i){var o=arguments.length,a=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(o<3?c(a):o>3?c(e,t,a):c(e,t))||a);return o>3&&a&&Object.defineProperty(e,t,a),a},__metadata$a=commonjsGlobal&&commonjsGlobal.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},__param$8=commonjsGlobal&&commonjsGlobal.__param||function(n,e){return function(t,i){e(t,i,n)}},__importDefault$a=commonjsGlobal&&commonjsGlobal.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(bloomFilter,"__esModule",{value:!0});var base_filter_1$9=__importDefault$a(baseFilter),exportable_1$a=exportable,formulas_1$2=formulas,utils_1$8=utils$3,BloomFilter$1=function(n){__extends$9(e,n);function e(i,o){var a=n.call(this)||this;if(o<1)throw new Error("A BloomFilter cannot uses less than one hash function, while you tried to use "+o+".");return a._size=i,a._nbHashes=o,a._filter=utils_1$8.allocateArray(a._size,0),a._length=0,a}t=e,e.create=function(i,o){var a=formulas_1$2.optimalFilterSize(i,o),c=formulas_1$2.optimalHashes(a,i);return new t(a,c)},e.from=function(i,o){var a=Array.from(i),c=t.create(a.length,o);return a.forEach(function(u){return c.add(u)}),c},e.fromBytes=function(i,o){for(var a=[],c=0;c<i.length;c++){var u=utils_1$8.uint8ToBits(i[c]);a=a.concat(u)}var d=new t(a.length,o);return d._filter=a,d},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),e.prototype.add=function(i){for(var o=utils_1$8.getDistinctIndices(i,this._size,this._nbHashes,this.seed),a=0;a<o.length;a++)this._filter[o[a]]=1;this._length++},e.prototype.has=function(i){for(var o=utils_1$8.getDistinctIndices(i,this._size,this._nbHashes,this.seed),a=0;a<o.length;a++)if(!this._filter[o[a]])return!1;return!0},e.prototype.rate=function(){return Math.pow(1-Math.exp(-this._nbHashes*this._length/this._size),this._nbHashes)},e.prototype.equals=function(i){return this._size!==i._size||this._nbHashes!==i._nbHashes?!1:this._filter.every(function(o,a){return i._filter[a]===o})},e.prototype.toBytes=function(){for(var i=new Uint8Array(Math.ceil(this._size/8)),o=0;o<i.length;o++){var a=this._filter.slice(o*8,o*8+8);i[o]=utils_1$8.bitsToUint8(a)}return i};var t;return __decorate$a([exportable_1$a.Field(),__metadata$a("design:type",Number)],e.prototype,"_size",void 0),__decorate$a([exportable_1$a.Field(),__metadata$a("design:type",Number)],e.prototype,"_nbHashes",void 0),__decorate$a([exportable_1$a.Field(),__metadata$a("design:type",Array)],e.prototype,"_filter",void 0),__decorate$a([exportable_1$a.Field(),__metadata$a("design:type",Number)],e.prototype,"_length",void 0),e=t=__decorate$a([exportable_1$a.AutoExportable("BloomFilter",["_seed"]),__param$8(0,exportable_1$a.Parameter("_size")),__param$8(1,exportable_1$a.Parameter("_nbHashes")),__metadata$a("design:paramtypes",[Number,Number])],e),e}(base_filter_1$9.default);bloomFilter.default=BloomFilter$1;var countingBloomFilter={},__extends$8=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var a in o)o.hasOwnProperty(a)&&(i[a]=o[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate$9=commonjsGlobal&&commonjsGlobal.__decorate||function(n,e,t,i){var o=arguments.length,a=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(o<3?c(a):o>3?c(e,t,a):c(e,t))||a);return o>3&&a&&Object.defineProperty(e,t,a),a},__metadata$9=commonjsGlobal&&commonjsGlobal.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},__param$7=commonjsGlobal&&commonjsGlobal.__param||function(n,e){return function(t,i){e(t,i,n)}},__importDefault$9=commonjsGlobal&&commonjsGlobal.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(countingBloomFilter,"__esModule",{value:!0});var base_filter_1$8=__importDefault$9(baseFilter),exportable_1$9=exportable,formulas_1$1=formulas,utils_1$7=utils$3,CountingBloomFilter=function(n){__extends$8(e,n);function e(i,o){var a=n.call(this)||this;if(o<1)throw new Error("A CountingBloomFilter must used at least one hash function, but you tried to use "+o+" functions. Consider increasing it.");return a._size=i,a._nbHashes=o,a._filter=utils_1$7.allocateArray(a._size,function(){return[0,0]}),a._length=0,a}t=e,e.create=function(i,o){var a=formulas_1$1.optimalFilterSize(i,o);return new t(a,formulas_1$1.optimalHashes(a,i))},e.from=function(i,o){var a=Array.from(i),c=t.create(a.length,o);return a.forEach(function(u){return c.add(u)}),c},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),e.prototype.add=function(i){for(var o=utils_1$7.getDistinctIndices(i,this._size,this._nbHashes,this.seed),a=0;a<o.length;a++)this._filter[o[a]][1]+=1,this._filter[o[a]][1]>0&&(this._filter[o[a]][0]=1);this._length++},e.prototype.remove=function(i){for(var o=utils_1$7.getDistinctIndices(i,this._size,this._nbHashes,this.seed),a=!0,c=0;c<o.length;c++)this._filter[o[c]][1]-=1,this._filter[o[c]][1]<=0&&(this._filter[o[c]][0]=0);return this._length--,a},e.prototype.has=function(i){for(var o=utils_1$7.getDistinctIndices(i,this._size,this._nbHashes,this.seed),a=0;a<o.length;a++)if(!this._filter[o[a]][0])return!1;return!0},e.prototype.rate=function(){return Math.pow(1-Math.exp(-this._nbHashes*this._length/this._size),this._nbHashes)},e.prototype.equals=function(i){return this._size!==i._size||this._nbHashes!==i._nbHashes||this._length!==i._length?!1:this._filter.every(function(o,a){return i._filter[a][0]===o[0]&&i._filter[a][1]===o[1]})};var t;return __decorate$9([exportable_1$9.Field(),__metadata$9("design:type",Number)],e.prototype,"_size",void 0),__decorate$9([exportable_1$9.Field(),__metadata$9("design:type",Number)],e.prototype,"_nbHashes",void 0),__decorate$9([exportable_1$9.Field(),__metadata$9("design:type",Array)],e.prototype,"_filter",void 0),__decorate$9([exportable_1$9.Field(),__metadata$9("design:type",Number)],e.prototype,"_length",void 0),e=t=__decorate$9([exportable_1$9.AutoExportable("CountingBloomFilter",["_seed"]),__param$7(0,exportable_1$9.Parameter("_size")),__param$7(1,exportable_1$9.Parameter("_nbHashes")),__metadata$9("design:paramtypes",[Number,Number])],e),e}(base_filter_1$8.default);countingBloomFilter.default=CountingBloomFilter;var partitionedBloomFilter={},__extends$7=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var a in o)o.hasOwnProperty(a)&&(i[a]=o[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate$8=commonjsGlobal&&commonjsGlobal.__decorate||function(n,e,t,i){var o=arguments.length,a=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(o<3?c(a):o>3?c(e,t,a):c(e,t))||a);return o>3&&a&&Object.defineProperty(e,t,a),a},__metadata$8=commonjsGlobal&&commonjsGlobal.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},__param$6=commonjsGlobal&&commonjsGlobal.__param||function(n,e){return function(t,i){e(t,i,n)}},__importDefault$8=commonjsGlobal&&commonjsGlobal.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(partitionedBloomFilter,"__esModule",{value:!0});var base_filter_1$7=__importDefault$8(baseFilter),exportable_1$8=exportable,utils_1$6=utils$3;function computeOptimalNumberOfhashes(n,e){return Math.ceil(Math.log(n)/Math.log(e))}function computeOptimalNumberOfCells(n,e,t){return Math.ceil(n*-Math.log(e)/(Math.log(t)*Math.log(1-t)))}function computeNumberOfItems(n,e,t){return Math.ceil(n*(Math.log(e)*Math.log(1-e))/-(t*Math.log(e)))}var PartitionedBloomFilter=function(n){__extends$7(e,n);function e(i,o,a,c){var u=n.call(this)||this;return u._size=i,u._nbHashes=o,u._loadFactor=a,u._m=Math.ceil(u._size/u._nbHashes),u._filter=utils_1$6.allocateArray(u._nbHashes,function(){return utils_1$6.allocateArray(u._m,0)}),u._capacity=c!==void 0?c:computeNumberOfItems(u._size,a,o),u._length=0,u}t=e,e.create=function(i,o,a){a===void 0&&(a=.5);var c=computeOptimalNumberOfCells(i,o,a),u=computeOptimalNumberOfhashes(o,a);return new t(c,u,a,i)},e.from=function(i,o,a){a===void 0&&(a=.5);var c=Array.from(i),u=t.create(c.length,o,a);return c.forEach(function(d){return u.add(d)}),u},Object.defineProperty(e.prototype,"capacity",{get:function(){return this._capacity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loadFactor",{get:function(){return this._loadFactor},enumerable:!0,configurable:!0}),e.prototype.add=function(i){for(var o=utils_1$6.getIndices(i,this._m,this._nbHashes,this.seed),a=0;a<this._nbHashes;a++)this._filter[a][o[a]]=1;this._length++},e.prototype.has=function(i){for(var o=utils_1$6.getIndices(i,this._m,this._nbHashes,this.seed),a=0;a<this._nbHashes;a++)if(!this._filter[a][o[a]])return!1;return!0},e.prototype.rate=function(){var i=this._currentload();return Math.pow(i,this._nbHashes)},e.prototype.equals=function(i){return this._size!==i._size||this._nbHashes!==i._nbHashes||this._length!==i._length||this._loadFactor!==i._loadFactor?!1:this._filter.every(function(o,a){return i._filter[a].every(function(c,u){return o[u]===c})})},e.prototype._currentload=function(){var i=this._filter.map(function(a){return a.reduce(function(c,u){return c+u},0)}),o=i.reduce(function(a,c){return a+c},0);return o/this._size};var t;return __decorate$8([exportable_1$8.Field(),__metadata$8("design:type",Number)],e.prototype,"_size",void 0),__decorate$8([exportable_1$8.Field(),__metadata$8("design:type",Number)],e.prototype,"_nbHashes",void 0),__decorate$8([exportable_1$8.Field(),__metadata$8("design:type",Number)],e.prototype,"_loadFactor",void 0),__decorate$8([exportable_1$8.Field(),__metadata$8("design:type",Number)],e.prototype,"_m",void 0),__decorate$8([exportable_1$8.Field(),__metadata$8("design:type",Array)],e.prototype,"_filter",void 0),__decorate$8([exportable_1$8.Field(),__metadata$8("design:type",Number)],e.prototype,"_capacity",void 0),__decorate$8([exportable_1$8.Field(),__metadata$8("design:type",Number)],e.prototype,"_length",void 0),e=t=__decorate$8([exportable_1$8.AutoExportable("PartitionedBloomFilter",["_seed"]),__param$6(0,exportable_1$8.Parameter("_size")),__param$6(1,exportable_1$8.Parameter("_nbHashes")),__param$6(2,exportable_1$8.Parameter("_loadFactor")),__param$6(3,exportable_1$8.Parameter("_capacity")),__metadata$8("design:paramtypes",[Number,Number,Number,Number])],e),e}(base_filter_1$7.default);partitionedBloomFilter.default=PartitionedBloomFilter;var countMinSketch={},__extends$6=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var a in o)o.hasOwnProperty(a)&&(i[a]=o[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate$7=commonjsGlobal&&commonjsGlobal.__decorate||function(n,e,t,i){var o=arguments.length,a=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(o<3?c(a):o>3?c(e,t,a):c(e,t))||a);return o>3&&a&&Object.defineProperty(e,t,a),a},__metadata$7=commonjsGlobal&&commonjsGlobal.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},__param$5=commonjsGlobal&&commonjsGlobal.__param||function(n,e){return function(t,i){e(t,i,n)}},__values=commonjsGlobal&&commonjsGlobal.__values||function(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},__importDefault$7=commonjsGlobal&&commonjsGlobal.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(countMinSketch,"__esModule",{value:!0});var base_filter_1$6=__importDefault$7(baseFilter),exportable_1$7=exportable,utils_1$5=utils$3,CountMinSketch=function(n){__extends$6(e,n);function e(i,o){var a=n.call(this)||this;return a._columns=i,a._rows=o,a._matrix=utils_1$5.allocateArray(a._rows,function(){return utils_1$5.allocateArray(a._columns,0)}),a._allSums=0,a}t=e,e.create=function(i,o){o===void 0&&(o=.999);var a=Math.ceil(Math.E/i),c=Math.ceil(Math.log(1/o));return new t(a,c)},e.from=function(i,o,a){var c,u;a===void 0&&(a=.999);var d=t.create(o,a);try{for(var p=__values(i),h=p.next();!h.done;h=p.next()){var b=h.value;d.update(b)}}catch(m){c={error:m}}finally{try{h&&!h.done&&(u=p.return)&&u.call(p)}finally{if(c)throw c.error}}return d},Object.defineProperty(e.prototype,"columns",{get:function(){return this._columns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sum",{get:function(){return this._allSums},enumerable:!0,configurable:!0}),e.prototype.update=function(i,o){o===void 0&&(o=1),this._allSums+=o;for(var a=utils_1$5.getDistinctIndices(i,this._columns,this._rows,this.seed),c=0;c<this._rows;c++)this._matrix[c][a[c]]+=o},e.prototype.count=function(i){for(var o=1/0,a=utils_1$5.getDistinctIndices(i,this._columns,this._rows,this.seed),c=0;c<this._rows;c++){var u=this._matrix[c][a[c]];o=Math.min(u,o)}return o},e.prototype.equals=function(i){if(this._columns!==i._columns||this._rows!==i._rows)return!1;for(var o=0;o<this._rows;o++)for(var a=0;a<this._columns;a++)if(this._matrix[o][a]!==i._matrix[o][a])return!1;return!0},e.prototype.merge=function(i){if(this._columns!==i._columns)throw new Error("Cannot merge two sketches with different number of columns");if(this._rows!==i._rows)throw new Error("Cannot merge two sketches with different number of rows");for(var o=0;o<this._rows;o++)for(var a=0;a<this._columns;a++)this._matrix[o][a]+=i._matrix[o][a]},e.prototype.clone=function(){var i=new t(this._columns,this._rows);return i.merge(this),i.seed=this.seed,i};var t;return __decorate$7([exportable_1$7.Field(),__metadata$7("design:type",Number)],e.prototype,"_columns",void 0),__decorate$7([exportable_1$7.Field(),__metadata$7("design:type",Number)],e.prototype,"_rows",void 0),__decorate$7([exportable_1$7.Field(),__metadata$7("design:type",Array)],e.prototype,"_matrix",void 0),__decorate$7([exportable_1$7.Field(),__metadata$7("design:type",Number)],e.prototype,"_allSums",void 0),e=t=__decorate$7([exportable_1$7.AutoExportable("CountMinSketch",["_seed"]),__param$5(0,exportable_1$7.Parameter("_columns")),__param$5(1,exportable_1$7.Parameter("_rows")),__metadata$7("design:paramtypes",[Number,Number])],e),e}(base_filter_1$6.default);countMinSketch.default=CountMinSketch;var hyperloglog={},__extends$5=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var a in o)o.hasOwnProperty(a)&&(i[a]=o[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate$6=commonjsGlobal&&commonjsGlobal.__decorate||function(n,e,t,i){var o=arguments.length,a=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(o<3?c(a):o>3?c(e,t,a):c(e,t))||a);return o>3&&a&&Object.defineProperty(e,t,a),a},__metadata$6=commonjsGlobal&&commonjsGlobal.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},__param$4=commonjsGlobal&&commonjsGlobal.__param||function(n,e){return function(t,i){e(t,i,n)}},__importDefault$6=commonjsGlobal&&commonjsGlobal.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(hyperloglog,"__esModule",{value:!0});var base_filter_1$5=__importDefault$6(baseFilter),exportable_1$6=exportable,utils_1$4=utils$3,TWO_POW_32=Math.pow(2,32);function computeAlpha(n){switch(n){case 16:return .673;case 32:return .697;case 64:return .709;default:return .7213/(1+1.079/n)}}var HyperLogLog=function(n){__extends$5(e,n);function e(i){var o=n.call(this)||this;return o._nbRegisters=i,o._nbBytesPerHash=Math.round(Math.log2(i)),o._correctionBias=computeAlpha(i),o._registers=utils_1$4.allocateArray(o._nbRegisters,0),o}t=e,Object.defineProperty(e.prototype,"nbRegisters",{get:function(){return this._nbRegisters},enumerable:!0,configurable:!0}),e.prototype.update=function(i){for(var o=utils_1$4.hashAsInt(i,this.seed).toString(2),a=1+parseInt(o.slice(0,this._nbBytesPerHash-1),2),c=o.slice(this._nbBytesPerHash),u=0;c[u]!=="1"&&u<c.length-1;)u++;this._registers[a]=Math.max(this._registers[a],u)},e.prototype.count=function(i){i===void 0&&(i=!1);var o=this._registers.reduce(function(c,u){return c+Math.pow(2,-u)},0),a=this._correctionBias*Math.pow(this._nbRegisters,2)/o;return a>TWO_POW_32/30&&(a=-TWO_POW_32*Math.log(1-a/TWO_POW_32)),i&&(a=Math.round(a)),a},e.prototype.accuracy=function(){return 1.04/Math.sqrt(this._nbRegisters)},e.prototype.merge=function(i){if(this.nbRegisters!==i.nbRegisters)throw new Error("Two HyperLogLog must have the same number of registers to be merged. Tried to merge two HyperLogLog with m = "+this.nbRegisters+" and m = "+i.nbRegisters);for(var o=new t(this.nbRegisters),a=0;a<this.nbRegisters-1;a++)o._registers[a]=Math.max(this._registers[a],i._registers[a]);return o},e.prototype.equals=function(i){if(this.nbRegisters!==i.nbRegisters)return!1;for(var o=0;o<this.nbRegisters-1;o++)if(this._registers[o]!==i._registers[o])return!1;return!0};var t;return __decorate$6([exportable_1$6.Field(),__metadata$6("design:type",Number)],e.prototype,"_nbRegisters",void 0),__decorate$6([exportable_1$6.Field(),__metadata$6("design:type",Number)],e.prototype,"_nbBytesPerHash",void 0),__decorate$6([exportable_1$6.Field(),__metadata$6("design:type",Number)],e.prototype,"_correctionBias",void 0),__decorate$6([exportable_1$6.Field(),__metadata$6("design:type",Array)],e.prototype,"_registers",void 0),e=t=__decorate$6([exportable_1$6.AutoExportable("HyperLogLog",["_seed"]),__param$4(0,exportable_1$6.Parameter("_nbRegisters")),__metadata$6("design:paramtypes",[Number])],e),e}(base_filter_1$5.default);hyperloglog.default=HyperLogLog;var topk={},lodash={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */lodash.exports;(function(n,e){(function(){var t,i="4.17.21",o=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",u="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",p=500,h="__lodash_placeholder__",b=1,m=2,v=4,_=1,$=2,k=1,D=2,O=4,H=8,j=16,W=32,ae=64,fe=128,pe=256,ve=512,Qe=30,re="...",C=800,S=16,w=1,E=2,I=3,N=1/0,U=9007199254740991,L=17976931348623157e292,P=0/0,B=4294967295,A=B-1,z=B>>>1,de=[["ary",fe],["bind",k],["bindKey",D],["curry",H],["curryRight",j],["flip",ve],["partial",W],["partialRight",ae],["rearg",pe]],we="[object Arguments]",se="[object Array]",he="[object AsyncFunction]",$e="[object Boolean]",Ae="[object Date]",ze="[object DOMException]",oe="[object Error]",ie="[object Function]",Ie="[object GeneratorFunction]",qe="[object Map]",Ze="[object Number]",lt="[object Null]",ht="[object Object]",gt="[object Promise]",Me="[object Proxy]",jt="[object RegExp]",ot="[object Set]",Ot="[object String]",Ut="[object Symbol]",be="[object Undefined]",Pe="[object WeakMap]",Be="[object WeakSet]",Re="[object ArrayBuffer]",Ye="[object DataView]",Tt="[object Float32Array]",Je="[object Float64Array]",dt="[object Int8Array]",rt="[object Int16Array]",et="[object Int32Array]",pt="[object Uint8Array]",Kt="[object Uint8ClampedArray]",Ct="[object Uint16Array]",er="[object Uint32Array]",nr=/\b__p \+= '';/g,It=/\b(__p \+=) '' \+/g,Qt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,fr=/&(?:amp|lt|gt|quot|#39);/g,qt=/[&<>"']/g,lr=RegExp(fr.source),Xt=RegExp(qt.source),Dt=/<%-([\s\S]+?)%>/g,ir=/<%([\s\S]+?)%>/g,ar=/<%=([\s\S]+?)%>/g,Lt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,dr=/^\w*$/,yr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,_t=/[\\^$.*+?()[\]{}|]/g,hr=RegExp(_t.source),F=/^\s+/,Y=/\s/,Q=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,M=/\{\n\/\* \[wrapped with (.+)\] \*/,X=/,? & /,ge=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,_e=/[()=,{}\[\]\/\s]/,Ce=/\\(\\)?/g,je=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Xe=/\w*$/,Ve=/^[-+]0x[0-9a-f]+$/i,zt=/^0b[01]+$/i,at=/^\[object .+?Constructor\]$/,xt=/^0o[0-7]+$/i,St=/^(?:0|[1-9]\d*)$/,kt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,At=/($^)/,$t=/['\n\r\u2028\u2029\\]/g,vt="\\ud800-\\udfff",Et="\\u0300-\\u036f",it="\\ufe20-\\ufe2f",yt="\\u20d0-\\u20ff",tt=Et+it+yt,st="\\u2700-\\u27bf",ft="a-z\\xdf-\\xf6\\xf8-\\xff",nt="\\xac\\xb1\\xd7\\xf7",ke="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",De="\\u2000-\\u206f",He=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",q="A-Z\\xc0-\\xd6\\xd8-\\xde",te="\\ufe0e\\ufe0f",J=nt+ke+De+He,ce="[']",ye="["+vt+"]",le="["+J+"]",Se="["+tt+"]",ee="\\d+",Oe="["+st+"]",Fe="["+ft+"]",Le="[^"+vt+J+ee+st+ft+q+"]",Ge="\\ud83c[\\udffb-\\udfff]",ct="(?:"+Se+"|"+Ge+")",bt="[^"+vt+"]",Pt="(?:\\ud83c[\\udde6-\\uddff]){2}",Mt="[\\ud800-\\udbff][\\udc00-\\udfff]",Rt="["+q+"]",Jt="\\u200d",cr="(?:"+Fe+"|"+Le+")",_r="(?:"+Rt+"|"+Le+")",Ar="(?:"+ce+"(?:d|ll|m|re|s|t|ve))?",$r="(?:"+ce+"(?:D|LL|M|RE|S|T|VE))?",kr=ct+"?",bi="["+te+"]?",no="(?:"+Jt+"(?:"+[bt,Pt,Mt].join("|")+")"+bi+kr+")*",mi="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ef="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",da=bi+kr+no,Sf="(?:"+[Oe,Pt,Mt].join("|")+")"+da,Af="(?:"+[bt+Se+"?",Se,Pt,Mt,ye].join("|")+")",Cf=RegExp(ce,"g"),Pf=RegExp(Se,"g"),io=RegExp(Ge+"(?="+Ge+")|"+Af+da,"g"),kf=RegExp([Rt+"?"+Fe+"+"+Ar+"(?="+[le,Rt,"$"].join("|")+")",_r+"+"+$r+"(?="+[le,Rt+cr,"$"].join("|")+")",Rt+"?"+cr+"+"+Ar,Rt+"+"+$r,Ef,mi,ee,Sf].join("|"),"g"),Mf=RegExp("["+Jt+vt+tt+te+"]"),Df=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Tf=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],If=-1,wr={};wr[Tt]=wr[Je]=wr[dt]=wr[rt]=wr[et]=wr[pt]=wr[Kt]=wr[Ct]=wr[er]=!0,wr[we]=wr[se]=wr[Re]=wr[$e]=wr[Ye]=wr[Ae]=wr[oe]=wr[ie]=wr[qe]=wr[Ze]=wr[ht]=wr[jt]=wr[ot]=wr[Ot]=wr[Pe]=!1;var vr={};vr[we]=vr[se]=vr[Re]=vr[Ye]=vr[$e]=vr[Ae]=vr[Tt]=vr[Je]=vr[dt]=vr[rt]=vr[et]=vr[qe]=vr[Ze]=vr[ht]=vr[jt]=vr[ot]=vr[Ot]=vr[Ut]=vr[pt]=vr[Kt]=vr[Ct]=vr[er]=!0,vr[oe]=vr[ie]=vr[Pe]=!1;var Rf={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Bf={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Of={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Ff={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Nf=parseFloat,Lf=parseInt,ha=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,jf=typeof self=="object"&&self&&self.Object===Object&&self,Ir=ha||jf||Function("return this")(),oo=e&&!e.nodeType&&e,Tn=oo&&!0&&n&&!n.nodeType&&n,pa=Tn&&Tn.exports===oo,ao=pa&&ha.process,Jr=function(){try{var xe=Tn&&Tn.require&&Tn.require("util").types;return xe||ao&&ao.binding&&ao.binding("util")}catch{}}(),ya=Jr&&Jr.isArrayBuffer,ba=Jr&&Jr.isDate,ma=Jr&&Jr.isMap,ga=Jr&&Jr.isRegExp,va=Jr&&Jr.isSet,wa=Jr&&Jr.isTypedArray;function Hr(xe,Ne,Te){switch(Te.length){case 0:return xe.call(Ne);case 1:return xe.call(Ne,Te[0]);case 2:return xe.call(Ne,Te[0],Te[1]);case 3:return xe.call(Ne,Te[0],Te[1],Te[2])}return xe.apply(Ne,Te)}function qf(xe,Ne,Te,mt){for(var Ht=-1,ur=xe==null?0:xe.length;++Ht<ur;){var Mr=xe[Ht];Ne(mt,Mr,Te(Mr),xe)}return mt}function Xr(xe,Ne){for(var Te=-1,mt=xe==null?0:xe.length;++Te<mt&&Ne(xe[Te],Te,xe)!==!1;);return xe}function Uf(xe,Ne){for(var Te=xe==null?0:xe.length;Te--&&Ne(xe[Te],Te,xe)!==!1;);return xe}function xa(xe,Ne){for(var Te=-1,mt=xe==null?0:xe.length;++Te<mt;)if(!Ne(xe[Te],Te,xe))return!1;return!0}function $n(xe,Ne){for(var Te=-1,mt=xe==null?0:xe.length,Ht=0,ur=[];++Te<mt;){var Mr=xe[Te];Ne(Mr,Te,xe)&&(ur[Ht++]=Mr)}return ur}function gi(xe,Ne){var Te=xe==null?0:xe.length;return!!Te&&qn(xe,Ne,0)>-1}function so(xe,Ne,Te){for(var mt=-1,Ht=xe==null?0:xe.length;++mt<Ht;)if(Te(Ne,xe[mt]))return!0;return!1}function xr(xe,Ne){for(var Te=-1,mt=xe==null?0:xe.length,Ht=Array(mt);++Te<mt;)Ht[Te]=Ne(xe[Te],Te,xe);return Ht}function En(xe,Ne){for(var Te=-1,mt=Ne.length,Ht=xe.length;++Te<mt;)xe[Ht+Te]=Ne[Te];return xe}function fo(xe,Ne,Te,mt){var Ht=-1,ur=xe==null?0:xe.length;for(mt&&ur&&(Te=xe[++Ht]);++Ht<ur;)Te=Ne(Te,xe[Ht],Ht,xe);return Te}function Kf(xe,Ne,Te,mt){var Ht=xe==null?0:xe.length;for(mt&&Ht&&(Te=xe[--Ht]);Ht--;)Te=Ne(Te,xe[Ht],Ht,xe);return Te}function co(xe,Ne){for(var Te=-1,mt=xe==null?0:xe.length;++Te<mt;)if(Ne(xe[Te],Te,xe))return!0;return!1}var zf=uo("length");function Hf(xe){return xe.split("")}function Gf(xe){return xe.match(ge)||[]}function $a(xe,Ne,Te){var mt;return Te(xe,function(Ht,ur,Mr){if(Ne(Ht,ur,Mr))return mt=ur,!1}),mt}function vi(xe,Ne,Te,mt){for(var Ht=xe.length,ur=Te+(mt?1:-1);mt?ur--:++ur<Ht;)if(Ne(xe[ur],ur,xe))return ur;return-1}function qn(xe,Ne,Te){return Ne===Ne?oc(xe,Ne,Te):vi(xe,Ea,Te)}function Wf(xe,Ne,Te,mt){for(var Ht=Te-1,ur=xe.length;++Ht<ur;)if(mt(xe[Ht],Ne))return Ht;return-1}function Ea(xe){return xe!==xe}function Sa(xe,Ne){var Te=xe==null?0:xe.length;return Te?ho(xe,Ne)/Te:P}function uo(xe){return function(Ne){return Ne==null?t:Ne[xe]}}function lo(xe){return function(Ne){return xe==null?t:xe[Ne]}}function Aa(xe,Ne,Te,mt,Ht){return Ht(xe,function(ur,Mr,gr){Te=mt?(mt=!1,ur):Ne(Te,ur,Mr,gr)}),Te}function Vf(xe,Ne){var Te=xe.length;for(xe.sort(Ne);Te--;)xe[Te]=xe[Te].value;return xe}function ho(xe,Ne){for(var Te,mt=-1,Ht=xe.length;++mt<Ht;){var ur=Ne(xe[mt]);ur!==t&&(Te=Te===t?ur:Te+ur)}return Te}function po(xe,Ne){for(var Te=-1,mt=Array(xe);++Te<xe;)mt[Te]=Ne(Te);return mt}function Yf(xe,Ne){return xr(Ne,function(Te){return[Te,xe[Te]]})}function Ca(xe){return xe&&xe.slice(0,Da(xe)+1).replace(F,"")}function Gr(xe){return function(Ne){return xe(Ne)}}function yo(xe,Ne){return xr(Ne,function(Te){return xe[Te]})}function ei(xe,Ne){return xe.has(Ne)}function Pa(xe,Ne){for(var Te=-1,mt=xe.length;++Te<mt&&qn(Ne,xe[Te],0)>-1;);return Te}function ka(xe,Ne){for(var Te=xe.length;Te--&&qn(Ne,xe[Te],0)>-1;);return Te}function Qf(xe,Ne){for(var Te=xe.length,mt=0;Te--;)xe[Te]===Ne&&++mt;return mt}var Jf=lo(Rf),Xf=lo(Bf);function Zf(xe){return"\\"+Ff[xe]}function tc(xe,Ne){return xe==null?t:xe[Ne]}function Un(xe){return Mf.test(xe)}function rc(xe){return Df.test(xe)}function nc(xe){for(var Ne,Te=[];!(Ne=xe.next()).done;)Te.push(Ne.value);return Te}function bo(xe){var Ne=-1,Te=Array(xe.size);return xe.forEach(function(mt,Ht){Te[++Ne]=[Ht,mt]}),Te}function Ma(xe,Ne){return function(Te){return xe(Ne(Te))}}function Sn(xe,Ne){for(var Te=-1,mt=xe.length,Ht=0,ur=[];++Te<mt;){var Mr=xe[Te];(Mr===Ne||Mr===h)&&(xe[Te]=h,ur[Ht++]=Te)}return ur}function _i(xe){var Ne=-1,Te=Array(xe.size);return xe.forEach(function(mt){Te[++Ne]=mt}),Te}function ic(xe){var Ne=-1,Te=Array(xe.size);return xe.forEach(function(mt){Te[++Ne]=[mt,mt]}),Te}function oc(xe,Ne,Te){for(var mt=Te-1,Ht=xe.length;++mt<Ht;)if(xe[mt]===Ne)return mt;return-1}function ac(xe,Ne,Te){for(var mt=Te+1;mt--;)if(xe[mt]===Ne)return mt;return mt}function Kn(xe){return Un(xe)?fc(xe):zf(xe)}function an(xe){return Un(xe)?cc(xe):Hf(xe)}function Da(xe){for(var Ne=xe.length;Ne--&&Y.test(xe.charAt(Ne)););return Ne}var sc=lo(Of);function fc(xe){for(var Ne=io.lastIndex=0;io.test(xe);)++Ne;return Ne}function cc(xe){return xe.match(io)||[]}function uc(xe){return xe.match(kf)||[]}var lc=function xe(Ne){Ne=Ne==null?Ir:zn.defaults(Ir.Object(),Ne,zn.pick(Ir,Tf));var Te=Ne.Array,mt=Ne.Date,Ht=Ne.Error,ur=Ne.Function,Mr=Ne.Math,gr=Ne.Object,mo=Ne.RegExp,dc=Ne.String,Zr=Ne.TypeError,wi=Te.prototype,hc=ur.prototype,Hn=gr.prototype,xi=Ne["__core-js_shared__"],$i=hc.toString,br=Hn.hasOwnProperty,pc=0,Ta=function(){var l=/[^.]+$/.exec(xi&&xi.keys&&xi.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""}(),Ei=Hn.toString,yc=$i.call(gr),bc=Ir._,mc=mo("^"+$i.call(br).replace(_t,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Si=pa?Ne.Buffer:t,An=Ne.Symbol,Ai=Ne.Uint8Array,Ia=Si?Si.allocUnsafe:t,Ci=Ma(gr.getPrototypeOf,gr),Ra=gr.create,Ba=Hn.propertyIsEnumerable,Pi=wi.splice,Oa=An?An.isConcatSpreadable:t,ti=An?An.iterator:t,In=An?An.toStringTag:t,ki=function(){try{var l=Nn(gr,"defineProperty");return l({},"",{}),l}catch{}}(),vc=Ne.clearTimeout!==Ir.clearTimeout&&Ne.clearTimeout,_c=mt&&mt.now!==Ir.Date.now&&mt.now,wc=Ne.setTimeout!==Ir.setTimeout&&Ne.setTimeout,Mi=Mr.ceil,Di=Mr.floor,go=gr.getOwnPropertySymbols,xc=Si?Si.isBuffer:t,Fa=Ne.isFinite,$c=wi.join,Ec=Ma(gr.keys,gr),Dr=Mr.max,Br=Mr.min,Sc=mt.now,Ac=Ne.parseInt,Na=Mr.random,Cc=wi.reverse,vo=Nn(Ne,"DataView"),ri=Nn(Ne,"Map"),_o=Nn(Ne,"Promise"),Gn=Nn(Ne,"Set"),ni=Nn(Ne,"WeakMap"),ii=Nn(gr,"create"),Ti=ni&&new ni,Wn={},Pc=Ln(vo),kc=Ln(ri),Mc=Ln(_o),Dc=Ln(Gn),Tc=Ln(ni),Ii=An?An.prototype:t,oi=Ii?Ii.valueOf:t,La=Ii?Ii.toString:t;function Z(l){if(Sr(l)&&!Gt(l)&&!(l instanceof tr)){if(l instanceof en)return l;if(br.call(l,"__wrapped__"))return Us(l)}return new en(l)}var Vn=function(){function l(){}return function(y){if(!Er(y))return{};if(Ra)return Ra(y);l.prototype=y;var x=new l;return l.prototype=t,x}}();function Ri(){}function en(l,y){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!y,this.__index__=0,this.__values__=t}Z.templateSettings={escape:Dt,evaluate:ir,interpolate:ar,variable:"",imports:{_:Z}},Z.prototype=Ri.prototype,Z.prototype.constructor=Z,en.prototype=Vn(Ri.prototype),en.prototype.constructor=en;function tr(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=B,this.__views__=[]}function Ic(){var l=new tr(this.__wrapped__);return l.__actions__=qr(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=qr(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=qr(this.__views__),l}function Rc(){if(this.__filtered__){var l=new tr(this);l.__dir__=-1,l.__filtered__=!0}else l=this.clone(),l.__dir__*=-1;return l}function Bc(){var l=this.__wrapped__.value(),y=this.__dir__,x=Gt(l),T=y<0,G=x?l.length:0,ne=Wu(0,G,this.__views__),ue=ne.start,me=ne.end,Ee=me-ue,Ue=T?me:ue-1,Ke=this.__iteratees__,We=Ke.length,ut=0,wt=Br(Ee,this.__takeCount__);if(!x||!T&&G==Ee&&wt==Ee)return us(l,this.__actions__);var Ft=[];e:for(;Ee--&&ut<wt;){Ue+=y;for(var Vt=-1,Nt=l[Ue];++Vt<We;){var Zt=Ke[Vt],rr=Zt.iteratee,Yr=Zt.type,jr=rr(Nt);if(Yr==E)Nt=jr;else if(!jr){if(Yr==w)continue e;break e}}Ft[ut++]=Nt}return Ft}tr.prototype=Vn(Ri.prototype),tr.prototype.constructor=tr;function Rn(l){var y=-1,x=l==null?0:l.length;for(this.clear();++y<x;){var T=l[y];this.set(T[0],T[1])}}function Oc(){this.__data__=ii?ii(null):{},this.size=0}function Fc(l){var y=this.has(l)&&delete this.__data__[l];return this.size-=y?1:0,y}function Nc(l){var y=this.__data__;if(ii){var x=y[l];return x===d?t:x}return br.call(y,l)?y[l]:t}function Lc(l){var y=this.__data__;return ii?y[l]!==t:br.call(y,l)}function jc(l,y){var x=this.__data__;return this.size+=this.has(l)?0:1,x[l]=ii&&y===t?d:y,this}Rn.prototype.clear=Oc,Rn.prototype.delete=Fc,Rn.prototype.get=Nc,Rn.prototype.has=Lc,Rn.prototype.set=jc;function hn(l){var y=-1,x=l==null?0:l.length;for(this.clear();++y<x;){var T=l[y];this.set(T[0],T[1])}}function qc(){this.__data__=[],this.size=0}function Uc(l){var y=this.__data__,x=Bi(y,l);if(x<0)return!1;var T=y.length-1;return x==T?y.pop():Pi.call(y,x,1),--this.size,!0}function Kc(l){var y=this.__data__,x=Bi(y,l);return x<0?t:y[x][1]}function zc(l){return Bi(this.__data__,l)>-1}function Hc(l,y){var x=this.__data__,T=Bi(x,l);return T<0?(++this.size,x.push([l,y])):x[T][1]=y,this}hn.prototype.clear=qc,hn.prototype.delete=Uc,hn.prototype.get=Kc,hn.prototype.has=zc,hn.prototype.set=Hc;function pn(l){var y=-1,x=l==null?0:l.length;for(this.clear();++y<x;){var T=l[y];this.set(T[0],T[1])}}function Gc(){this.size=0,this.__data__={hash:new Rn,map:new(ri||hn),string:new Rn}}function Wc(l){var y=Wi(this,l).delete(l);return this.size-=y?1:0,y}function Vc(l){return Wi(this,l).get(l)}function Yc(l){return Wi(this,l).has(l)}function Qc(l,y){var x=Wi(this,l),T=x.size;return x.set(l,y),this.size+=x.size==T?0:1,this}pn.prototype.clear=Gc,pn.prototype.delete=Wc,pn.prototype.get=Vc,pn.prototype.has=Yc,pn.prototype.set=Qc;function Bn(l){var y=-1,x=l==null?0:l.length;for(this.__data__=new pn;++y<x;)this.add(l[y])}function Jc(l){return this.__data__.set(l,d),this}function Xc(l){return this.__data__.has(l)}Bn.prototype.add=Bn.prototype.push=Jc,Bn.prototype.has=Xc;function sn(l){var y=this.__data__=new hn(l);this.size=y.size}function Zc(){this.__data__=new hn,this.size=0}function eu(l){var y=this.__data__,x=y.delete(l);return this.size=y.size,x}function tu(l){return this.__data__.get(l)}function ru(l){return this.__data__.has(l)}function nu(l,y){var x=this.__data__;if(x instanceof hn){var T=x.__data__;if(!ri||T.length<o-1)return T.push([l,y]),this.size=++x.size,this;x=this.__data__=new pn(T)}return x.set(l,y),this.size=x.size,this}sn.prototype.clear=Zc,sn.prototype.delete=eu,sn.prototype.get=tu,sn.prototype.has=ru,sn.prototype.set=nu;function ja(l,y){var x=Gt(l),T=!x&&jn(l),G=!x&&!T&&Dn(l),ne=!x&&!T&&!G&&Xn(l),ue=x||T||G||ne,me=ue?po(l.length,dc):[],Ee=me.length;for(var Ue in l)(y||br.call(l,Ue))&&!(ue&&(Ue=="length"||G&&(Ue=="offset"||Ue=="parent")||ne&&(Ue=="buffer"||Ue=="byteLength"||Ue=="byteOffset")||vn(Ue,Ee)))&&me.push(Ue);return me}function qa(l){var y=l.length;return y?l[Do(0,y-1)]:t}function iu(l,y){return Vi(qr(l),On(y,0,l.length))}function ou(l){return Vi(qr(l))}function wo(l,y,x){(x!==t&&!fn(l[y],x)||x===t&&!(y in l))&&yn(l,y,x)}function ai(l,y,x){var T=l[y];(!(br.call(l,y)&&fn(T,x))||x===t&&!(y in l))&&yn(l,y,x)}function Bi(l,y){for(var x=l.length;x--;)if(fn(l[x][0],y))return x;return-1}function au(l,y,x,T){return Cn(l,function(G,ne,ue){y(T,G,x(G),ue)}),T}function Ua(l,y){return l&&ln(y,Tr(y),l)}function su(l,y){return l&&ln(y,Kr(y),l)}function yn(l,y,x){y=="__proto__"&&ki?ki(l,y,{configurable:!0,enumerable:!0,value:x,writable:!0}):l[y]=x}function xo(l,y){for(var x=-1,T=y.length,G=Te(T),ne=l==null;++x<T;)G[x]=ne?t:ra(l,y[x]);return G}function On(l,y,x){return l===l&&(x!==t&&(l=l<=x?l:x),y!==t&&(l=l>=y?l:y)),l}function tn(l,y,x,T,G,ne){var ue,me=y&b,Ee=y&m,Ue=y&v;if(x&&(ue=G?x(l,T,G,ne):x(l)),ue!==t)return ue;if(!Er(l))return l;var Ke=Gt(l);if(Ke){if(ue=Yu(l),!me)return qr(l,ue)}else{var We=Or(l),ut=We==ie||We==Ie;if(Dn(l))return hs(l,me);if(We==ht||We==we||ut&&!G){if(ue=Ee||ut?{}:Is(l),!me)return Ee?Nu(l,su(ue,l)):Fu(l,Ua(ue,l))}else{if(!vr[We])return G?l:{};ue=Qu(l,We,me)}}ne||(ne=new sn);var wt=ne.get(l);if(wt)return wt;ne.set(l,ue),cf(l)?l.forEach(function(Nt){ue.add(tn(Nt,y,x,Nt,l,ne))}):sf(l)&&l.forEach(function(Nt,Zt){ue.set(Zt,tn(Nt,y,x,Zt,l,ne))});var Ft=Ue?Ee?Uo:qo:Ee?Kr:Tr,Vt=Ke?t:Ft(l);return Xr(Vt||l,function(Nt,Zt){Vt&&(Zt=Nt,Nt=l[Zt]),ai(ue,Zt,tn(Nt,y,x,Zt,l,ne))}),ue}function fu(l){var y=Tr(l);return function(x){return Ka(x,l,y)}}function Ka(l,y,x){var T=x.length;if(l==null)return!T;for(l=gr(l);T--;){var G=x[T],ne=y[G],ue=l[G];if(ue===t&&!(G in l)||!ne(ue))return!1}return!0}function za(l,y,x){if(typeof l!="function")throw new Zr(c);return hi(function(){l.apply(t,x)},y)}function si(l,y,x,T){var G=-1,ne=gi,ue=!0,me=l.length,Ee=[],Ue=y.length;if(!me)return Ee;x&&(y=xr(y,Gr(x))),T?(ne=so,ue=!1):y.length>=o&&(ne=ei,ue=!1,y=new Bn(y));e:for(;++G<me;){var Ke=l[G],We=x==null?Ke:x(Ke);if(Ke=T||Ke!==0?Ke:0,ue&&We===We){for(var ut=Ue;ut--;)if(y[ut]===We)continue e;Ee.push(Ke)}else ne(y,We,T)||Ee.push(Ke)}return Ee}var Cn=vs(un),Ha=vs(Eo,!0);function cu(l,y){var x=!0;return Cn(l,function(T,G,ne){return x=!!y(T,G,ne),x}),x}function Oi(l,y,x){for(var T=-1,G=l.length;++T<G;){var ne=l[T],ue=y(ne);if(ue!=null&&(me===t?ue===ue&&!Vr(ue):x(ue,me)))var me=ue,Ee=ne}return Ee}function uu(l,y,x,T){var G=l.length;for(x=Wt(x),x<0&&(x=-x>G?0:G+x),T=T===t||T>G?G:Wt(T),T<0&&(T+=G),T=x>T?0:lf(T);x<T;)l[x++]=y;return l}function Ga(l,y){var x=[];return Cn(l,function(T,G,ne){y(T,G,ne)&&x.push(T)}),x}function Rr(l,y,x,T,G){var ne=-1,ue=l.length;for(x||(x=Xu),G||(G=[]);++ne<ue;){var me=l[ne];y>0&&x(me)?y>1?Rr(me,y-1,x,T,G):En(G,me):T||(G[G.length]=me)}return G}var $o=_s(),Wa=_s(!0);function un(l,y){return l&&$o(l,y,Tr)}function Eo(l,y){return l&&Wa(l,y,Tr)}function Fi(l,y){return $n(y,function(x){return _n(l[x])})}function Fn(l,y){y=kn(y,l);for(var x=0,T=y.length;l!=null&&x<T;)l=l[dn(y[x++])];return x&&x==T?l:t}function Va(l,y,x){var T=y(l);return Gt(l)?T:En(T,x(l))}function Nr(l){return l==null?l===t?be:lt:In&&In in gr(l)?Gu(l):ol(l)}function So(l,y){return l>y}function lu(l,y){return l!=null&&br.call(l,y)}function du(l,y){return l!=null&&y in gr(l)}function hu(l,y,x){return l>=Br(y,x)&&l<Dr(y,x)}function Ao(l,y,x){for(var T=x?so:gi,G=l[0].length,ne=l.length,ue=ne,me=Te(ne),Ee=1/0,Ue=[];ue--;){var Ke=l[ue];ue&&y&&(Ke=xr(Ke,Gr(y))),Ee=Br(Ke.length,Ee),me[ue]=!x&&(y||G>=120&&Ke.length>=120)?new Bn(ue&&Ke):t}Ke=l[0];var We=-1,ut=me[0];e:for(;++We<G&&Ue.length<Ee;){var wt=Ke[We],Ft=y?y(wt):wt;if(wt=x||wt!==0?wt:0,!(ut?ei(ut,Ft):T(Ue,Ft,x))){for(ue=ne;--ue;){var Vt=me[ue];if(!(Vt?ei(Vt,Ft):T(l[ue],Ft,x)))continue e}ut&&ut.push(Ft),Ue.push(wt)}}return Ue}function pu(l,y,x,T){return un(l,function(G,ne,ue){y(T,x(G),ne,ue)}),T}function fi(l,y,x){y=kn(y,l),l=Fs(l,y);var T=l==null?l:l[dn(nn(y))];return T==null?t:Hr(T,l,x)}function Ya(l){return Sr(l)&&Nr(l)==we}function yu(l){return Sr(l)&&Nr(l)==Re}function bu(l){return Sr(l)&&Nr(l)==Ae}function ci(l,y,x,T,G){return l===y?!0:l==null||y==null||!Sr(l)&&!Sr(y)?l!==l&&y!==y:mu(l,y,x,T,ci,G)}function mu(l,y,x,T,G,ne){var ue=Gt(l),me=Gt(y),Ee=ue?se:Or(l),Ue=me?se:Or(y);Ee=Ee==we?ht:Ee,Ue=Ue==we?ht:Ue;var Ke=Ee==ht,We=Ue==ht,ut=Ee==Ue;if(ut&&Dn(l)){if(!Dn(y))return!1;ue=!0,Ke=!1}if(ut&&!Ke)return ne||(ne=new sn),ue||Xn(l)?Ms(l,y,x,T,G,ne):zu(l,y,Ee,x,T,G,ne);if(!(x&_)){var wt=Ke&&br.call(l,"__wrapped__"),Ft=We&&br.call(y,"__wrapped__");if(wt||Ft){var Vt=wt?l.value():l,Nt=Ft?y.value():y;return ne||(ne=new sn),G(Vt,Nt,x,T,ne)}}return ut?(ne||(ne=new sn),Hu(l,y,x,T,G,ne)):!1}function gu(l){return Sr(l)&&Or(l)==qe}function Co(l,y,x,T){var G=x.length,ne=G,ue=!T;if(l==null)return!ne;for(l=gr(l);G--;){var me=x[G];if(ue&&me[2]?me[1]!==l[me[0]]:!(me[0]in l))return!1}for(;++G<ne;){me=x[G];var Ee=me[0],Ue=l[Ee],Ke=me[1];if(ue&&me[2]){if(Ue===t&&!(Ee in l))return!1}else{var We=new sn;if(T)var ut=T(Ue,Ke,Ee,l,y,We);if(!(ut===t?ci(Ke,Ue,_|$,T,We):ut))return!1}}return!0}function Qa(l){if(!Er(l)||el(l))return!1;var y=_n(l)?mc:at;return y.test(Ln(l))}function vu(l){return Sr(l)&&Nr(l)==jt}function _u(l){return Sr(l)&&Or(l)==ot}function wu(l){return Sr(l)&&eo(l.length)&&!!wr[Nr(l)]}function Ja(l){return typeof l=="function"?l:l==null?zr:typeof l=="object"?Gt(l)?es(l[0],l[1]):Za(l):xf(l)}function Po(l){if(!di(l))return Ec(l);var y=[];for(var x in gr(l))br.call(l,x)&&x!="constructor"&&y.push(x);return y}function xu(l){if(!Er(l))return il(l);var y=di(l),x=[];for(var T in l)T=="constructor"&&(y||!br.call(l,T))||x.push(T);return x}function ko(l,y){return l<y}function Xa(l,y){var x=-1,T=Ur(l)?Te(l.length):[];return Cn(l,function(G,ne,ue){T[++x]=y(G,ne,ue)}),T}function Za(l){var y=zo(l);return y.length==1&&y[0][2]?Bs(y[0][0],y[0][1]):function(x){return x===l||Co(x,l,y)}}function es(l,y){return Go(l)&&Rs(y)?Bs(dn(l),y):function(x){var T=ra(x,l);return T===t&&T===y?na(x,l):ci(y,T,_|$)}}function Ni(l,y,x,T,G){l!==y&&$o(y,function(ne,ue){if(G||(G=new sn),Er(ne))$u(l,y,ue,x,Ni,T,G);else{var me=T?T(Vo(l,ue),ne,ue+"",l,y,G):t;me===t&&(me=ne),wo(l,ue,me)}},Kr)}function $u(l,y,x,T,G,ne,ue){var me=Vo(l,x),Ee=Vo(y,x),Ue=ue.get(Ee);if(Ue){wo(l,x,Ue);return}var Ke=ne?ne(me,Ee,x+"",l,y,ue):t,We=Ke===t;if(We){var ut=Gt(Ee),wt=!ut&&Dn(Ee),Ft=!ut&&!wt&&Xn(Ee);Ke=Ee,ut||wt||Ft?Gt(me)?Ke=me:Cr(me)?Ke=qr(me):wt?(We=!1,Ke=hs(Ee,!0)):Ft?(We=!1,Ke=ps(Ee,!0)):Ke=[]:pi(Ee)||jn(Ee)?(Ke=me,jn(me)?Ke=df(me):(!Er(me)||_n(me))&&(Ke=Is(Ee))):We=!1}We&&(ue.set(Ee,Ke),G(Ke,Ee,T,ne,ue),ue.delete(Ee)),wo(l,x,Ke)}function ts(l,y){var x=l.length;if(x)return y+=y<0?x:0,vn(y,x)?l[y]:t}function rs(l,y,x){y.length?y=xr(y,function(ne){return Gt(ne)?function(ue){return Fn(ue,ne.length===1?ne[0]:ne)}:ne}):y=[zr];var T=-1;y=xr(y,Gr(Bt()));var G=Xa(l,function(ne,ue,me){var Ee=xr(y,function(Ue){return Ue(ne)});return{criteria:Ee,index:++T,value:ne}});return Vf(G,function(ne,ue){return Ou(ne,ue,x)})}function Eu(l,y){return ns(l,y,function(x,T){return na(l,T)})}function ns(l,y,x){for(var T=-1,G=y.length,ne={};++T<G;){var ue=y[T],me=Fn(l,ue);x(me,ue)&&ui(ne,kn(ue,l),me)}return ne}function Su(l){return function(y){return Fn(y,l)}}function Mo(l,y,x,T){var G=T?Wf:qn,ne=-1,ue=y.length,me=l;for(l===y&&(y=qr(y)),x&&(me=xr(l,Gr(x)));++ne<ue;)for(var Ee=0,Ue=y[ne],Ke=x?x(Ue):Ue;(Ee=G(me,Ke,Ee,T))>-1;)me!==l&&Pi.call(me,Ee,1),Pi.call(l,Ee,1);return l}function os(l,y){for(var x=l?y.length:0,T=x-1;x--;){var G=y[x];if(x==T||G!==ne){var ne=G;vn(G)?Pi.call(l,G,1):Ro(l,G)}}return l}function Do(l,y){return l+Di(Na()*(y-l+1))}function Au(l,y,x,T){for(var G=-1,ne=Dr(Mi((y-l)/(x||1)),0),ue=Te(ne);ne--;)ue[T?ne:++G]=l,l+=x;return ue}function To(l,y){var x="";if(!l||y<1||y>U)return x;do y%2&&(x+=l),y=Di(y/2),y&&(l+=l);while(y);return x}function Yt(l,y){return Yo(Os(l,y,zr),l+"")}function Cu(l){return qa(Zn(l))}function Pu(l,y){var x=Zn(l);return Vi(x,On(y,0,x.length))}function ui(l,y,x,T){if(!Er(l))return l;y=kn(y,l);for(var G=-1,ne=y.length,ue=ne-1,me=l;me!=null&&++G<ne;){var Ee=dn(y[G]),Ue=x;if(Ee==="__proto__"||Ee==="constructor"||Ee==="prototype")return l;if(G!=ue){var Ke=me[Ee];Ue=T?T(Ke,Ee,me):t,Ue===t&&(Ue=Er(Ke)?Ke:vn(y[G+1])?[]:{})}ai(me,Ee,Ue),me=me[Ee]}return l}var as=Ti?function(l,y){return Ti.set(l,y),l}:zr,ku=ki?function(l,y){return ki(l,"toString",{configurable:!0,enumerable:!1,value:oa(y),writable:!0})}:zr;function Mu(l){return Vi(Zn(l))}function rn(l,y,x){var T=-1,G=l.length;y<0&&(y=-y>G?0:G+y),x=x>G?G:x,x<0&&(x+=G),G=y>x?0:x-y>>>0,y>>>=0;for(var ne=Te(G);++T<G;)ne[T]=l[T+y];return ne}function Du(l,y){var x;return Cn(l,function(T,G,ne){return x=y(T,G,ne),!x}),!!x}function Li(l,y,x){var T=0,G=l==null?T:l.length;if(typeof y=="number"&&y===y&&G<=z){for(;T<G;){var ne=T+G>>>1,ue=l[ne];ue!==null&&!Vr(ue)&&(x?ue<=y:ue<y)?T=ne+1:G=ne}return G}return Io(l,y,zr,x)}function Io(l,y,x,T){var G=0,ne=l==null?0:l.length;if(ne===0)return 0;y=x(y);for(var ue=y!==y,me=y===null,Ee=Vr(y),Ue=y===t;G<ne;){var Ke=Di((G+ne)/2),We=x(l[Ke]),ut=We!==t,wt=We===null,Ft=We===We,Vt=Vr(We);if(ue)var Nt=T||Ft;else Ue?Nt=Ft&&(T||ut):me?Nt=Ft&&ut&&(T||!wt):Ee?Nt=Ft&&ut&&!wt&&(T||!Vt):wt||Vt?Nt=!1:Nt=T?We<=y:We<y;Nt?G=Ke+1:ne=Ke}return Br(ne,A)}function ss(l,y){for(var x=-1,T=l.length,G=0,ne=[];++x<T;){var ue=l[x],me=y?y(ue):ue;if(!x||!fn(me,Ee)){var Ee=me;ne[G++]=ue===0?0:ue}}return ne}function fs(l){return typeof l=="number"?l:Vr(l)?P:+l}function Wr(l){if(typeof l=="string")return l;if(Gt(l))return xr(l,Wr)+"";if(Vr(l))return La?La.call(l):"";var y=l+"";return y=="0"&&1/l==-N?"-0":y}function Pn(l,y,x){var T=-1,G=gi,ne=l.length,ue=!0,me=[],Ee=me;if(x)ue=!1,G=so;else if(ne>=o){var Ue=y?null:Uu(l);if(Ue)return _i(Ue);ue=!1,G=ei,Ee=new Bn}else Ee=y?[]:me;e:for(;++T<ne;){var Ke=l[T],We=y?y(Ke):Ke;if(Ke=x||Ke!==0?Ke:0,ue&&We===We){for(var ut=Ee.length;ut--;)if(Ee[ut]===We)continue e;y&&Ee.push(We),me.push(Ke)}else G(Ee,We,x)||(Ee!==me&&Ee.push(We),me.push(Ke))}return me}function Ro(l,y){return y=kn(y,l),l=Fs(l,y),l==null||delete l[dn(nn(y))]}function cs(l,y,x,T){return ui(l,y,x(Fn(l,y)),T)}function ji(l,y,x,T){for(var G=l.length,ne=T?G:-1;(T?ne--:++ne<G)&&y(l[ne],ne,l););return x?rn(l,T?0:ne,T?ne+1:G):rn(l,T?ne+1:0,T?G:ne)}function us(l,y){var x=l;return x instanceof tr&&(x=x.value()),fo(y,function(T,G){return G.func.apply(G.thisArg,En([T],G.args))},x)}function Bo(l,y,x){var T=l.length;if(T<2)return T?Pn(l[0]):[];for(var G=-1,ne=Te(T);++G<T;)for(var ue=l[G],me=-1;++me<T;)me!=G&&(ne[G]=si(ne[G]||ue,l[me],y,x));return Pn(Rr(ne,1),y,x)}function ls(l,y,x){for(var T=-1,G=l.length,ne=y.length,ue={};++T<G;){var me=T<ne?y[T]:t;x(ue,l[T],me)}return ue}function Oo(l){return Cr(l)?l:[]}function Fo(l){return typeof l=="function"?l:zr}function kn(l,y){return Gt(l)?l:Go(l,y)?[l]:qs(pr(l))}var Tu=Yt;function Mn(l,y,x){var T=l.length;return x=x===t?T:x,!y&&x>=T?l:rn(l,y,x)}var ds=vc||function(l){return Ir.clearTimeout(l)};function hs(l,y){if(y)return l.slice();var x=l.length,T=Ia?Ia(x):new l.constructor(x);return l.copy(T),T}function No(l){var y=new l.constructor(l.byteLength);return new Ai(y).set(new Ai(l)),y}function Iu(l,y){var x=y?No(l.buffer):l.buffer;return new l.constructor(x,l.byteOffset,l.byteLength)}function Ru(l){var y=new l.constructor(l.source,Xe.exec(l));return y.lastIndex=l.lastIndex,y}function Bu(l){return oi?gr(oi.call(l)):{}}function ps(l,y){var x=y?No(l.buffer):l.buffer;return new l.constructor(x,l.byteOffset,l.length)}function ys(l,y){if(l!==y){var x=l!==t,T=l===null,G=l===l,ne=Vr(l),ue=y!==t,me=y===null,Ee=y===y,Ue=Vr(y);if(!me&&!Ue&&!ne&&l>y||ne&&ue&&Ee&&!me&&!Ue||T&&ue&&Ee||!x&&Ee||!G)return 1;if(!T&&!ne&&!Ue&&l<y||Ue&&x&&G&&!T&&!ne||me&&x&&G||!ue&&G||!Ee)return-1}return 0}function Ou(l,y,x){for(var T=-1,G=l.criteria,ne=y.criteria,ue=G.length,me=x.length;++T<ue;){var Ee=ys(G[T],ne[T]);if(Ee){if(T>=me)return Ee;var Ue=x[T];return Ee*(Ue=="desc"?-1:1)}}return l.index-y.index}function bs(l,y,x,T){for(var G=-1,ne=l.length,ue=x.length,me=-1,Ee=y.length,Ue=Dr(ne-ue,0),Ke=Te(Ee+Ue),We=!T;++me<Ee;)Ke[me]=y[me];for(;++G<ue;)(We||G<ne)&&(Ke[x[G]]=l[G]);for(;Ue--;)Ke[me++]=l[G++];return Ke}function gs(l,y,x,T){for(var G=-1,ne=l.length,ue=-1,me=x.length,Ee=-1,Ue=y.length,Ke=Dr(ne-me,0),We=Te(Ke+Ue),ut=!T;++G<Ke;)We[G]=l[G];for(var wt=G;++Ee<Ue;)We[wt+Ee]=y[Ee];for(;++ue<me;)(ut||G<ne)&&(We[wt+x[ue]]=l[G++]);return We}function qr(l,y){var x=-1,T=l.length;for(y||(y=Te(T));++x<T;)y[x]=l[x];return y}function ln(l,y,x,T){var G=!x;x||(x={});for(var ne=-1,ue=y.length;++ne<ue;){var me=y[ne],Ee=T?T(x[me],l[me],me,x,l):t;Ee===t&&(Ee=l[me]),G?yn(x,me,Ee):ai(x,me,Ee)}return x}function Fu(l,y){return ln(l,Ho(l),y)}function Nu(l,y){return ln(l,Ds(l),y)}function qi(l,y){return function(x,T){var G=Gt(x)?qf:au,ne=y?y():{};return G(x,l,Bt(T,2),ne)}}function Yn(l){return Yt(function(y,x){var T=-1,G=x.length,ne=G>1?x[G-1]:t,ue=G>2?x[2]:t;for(ne=l.length>3&&typeof ne=="function"?(G--,ne):t,ue&&Lr(x[0],x[1],ue)&&(ne=G<3?t:ne,G=1),y=gr(y);++T<G;){var me=x[T];me&&l(y,me,T,ne)}return y})}function vs(l,y){return function(x,T){if(x==null)return x;if(!Ur(x))return l(x,T);for(var G=x.length,ne=y?G:-1,ue=gr(x);(y?ne--:++ne<G)&&T(ue[ne],ne,ue)!==!1;);return x}}function _s(l){return function(y,x,T){for(var G=-1,ne=gr(y),ue=T(y),me=ue.length;me--;){var Ee=ue[l?me:++G];if(x(ne[Ee],Ee,ne)===!1)break}return y}}function Lu(l,y,x){var T=y&k,G=li(l);function ne(){var ue=this&&this!==Ir&&this instanceof ne?G:l;return ue.apply(T?x:this,arguments)}return ne}function ws(l){return function(y){y=pr(y);var x=Un(y)?an(y):t,T=x?x[0]:y.charAt(0),G=x?Mn(x,1).join(""):y.slice(1);return T[l]()+G}}function Qn(l){return function(y){return fo(_f(vf(y).replace(Cf,"")),l,"")}}function li(l){return function(){var y=arguments;switch(y.length){case 0:return new l;case 1:return new l(y[0]);case 2:return new l(y[0],y[1]);case 3:return new l(y[0],y[1],y[2]);case 4:return new l(y[0],y[1],y[2],y[3]);case 5:return new l(y[0],y[1],y[2],y[3],y[4]);case 6:return new l(y[0],y[1],y[2],y[3],y[4],y[5]);case 7:return new l(y[0],y[1],y[2],y[3],y[4],y[5],y[6])}var x=Vn(l.prototype),T=l.apply(x,y);return Er(T)?T:x}}function ju(l,y,x){var T=li(l);function G(){for(var ne=arguments.length,ue=Te(ne),me=ne,Ee=Jn(G);me--;)ue[me]=arguments[me];var Ue=ne<3&&ue[0]!==Ee&&ue[ne-1]!==Ee?[]:Sn(ue,Ee);if(ne-=Ue.length,ne<x)return As(l,y,Ui,G.placeholder,t,ue,Ue,t,t,x-ne);var Ke=this&&this!==Ir&&this instanceof G?T:l;return Hr(Ke,this,ue)}return G}function xs(l){return function(y,x,T){var G=gr(y);if(!Ur(y)){var ne=Bt(x,3);y=Tr(y),x=function(me){return ne(G[me],me,G)}}var ue=l(y,x,T);return ue>-1?G[ne?y[ue]:ue]:t}}function $s(l){return gn(function(y){var x=y.length,T=x,G=en.prototype.thru;for(l&&y.reverse();T--;){var ne=y[T];if(typeof ne!="function")throw new Zr(c);if(G&&!ue&&Gi(ne)=="wrapper")var ue=new en([],!0)}for(T=ue?T:x;++T<x;){ne=y[T];var me=Gi(ne),Ee=me=="wrapper"?Ko(ne):t;Ee&&Wo(Ee[0])&&Ee[1]==(fe|H|W|pe)&&!Ee[4].length&&Ee[9]==1?ue=ue[Gi(Ee[0])].apply(ue,Ee[3]):ue=ne.length==1&&Wo(ne)?ue[me]():ue.thru(ne)}return function(){var Ue=arguments,Ke=Ue[0];if(ue&&Ue.length==1&&Gt(Ke))return ue.plant(Ke).value();for(var We=0,ut=x?y[We].apply(this,Ue):Ke;++We<x;)ut=y[We].call(this,ut);return ut}})}function Ui(l,y,x,T,G,ne,ue,me,Ee,Ue){var Ke=y&fe,We=y&k,ut=y&D,wt=y&(H|j),Ft=y&ve,Vt=ut?t:li(l);function Nt(){for(var Zt=arguments.length,rr=Te(Zt),Yr=Zt;Yr--;)rr[Yr]=arguments[Yr];if(wt)var jr=Jn(Nt),Qr=Qf(rr,jr);if(T&&(rr=bs(rr,T,G,wt)),ne&&(rr=gs(rr,ne,ue,wt)),Zt-=Qr,wt&&Zt<Ue){var Pr=Sn(rr,jr);return As(l,y,Ui,Nt.placeholder,x,rr,Pr,me,Ee,Ue-Zt)}var cn=We?x:this,xn=ut?cn[l]:l;return Zt=rr.length,me?rr=al(rr,me):Ft&&Zt>1&&rr.reverse(),Ke&&Ee<Zt&&(rr.length=Ee),this&&this!==Ir&&this instanceof Nt&&(xn=Vt||li(xn)),xn.apply(cn,rr)}return Nt}function Es(l,y){return function(x,T){return pu(x,l,y(T),{})}}function Ki(l,y){return function(x,T){var G;if(x===t&&T===t)return y;if(x!==t&&(G=x),T!==t){if(G===t)return T;typeof x=="string"||typeof T=="string"?(x=Wr(x),T=Wr(T)):(x=fs(x),T=fs(T)),G=l(x,T)}return G}}function Lo(l){return gn(function(y){return y=xr(y,Gr(Bt())),Yt(function(x){var T=this;return l(y,function(G){return Hr(G,T,x)})})})}function zi(l,y){y=y===t?" ":Wr(y);var x=y.length;if(x<2)return x?To(y,l):y;var T=To(y,Mi(l/Kn(y)));return Un(y)?Mn(an(T),0,l).join(""):T.slice(0,l)}function qu(l,y,x,T){var G=y&k,ne=li(l);function ue(){for(var me=-1,Ee=arguments.length,Ue=-1,Ke=T.length,We=Te(Ke+Ee),ut=this&&this!==Ir&&this instanceof ue?ne:l;++Ue<Ke;)We[Ue]=T[Ue];for(;Ee--;)We[Ue++]=arguments[++me];return Hr(ut,G?x:this,We)}return ue}function Ss(l){return function(y,x,T){return T&&typeof T!="number"&&Lr(y,x,T)&&(x=T=t),y=wn(y),x===t?(x=y,y=0):x=wn(x),T=T===t?y<x?1:-1:wn(T),Au(y,x,T,l)}}function Hi(l){return function(y,x){return typeof y=="string"&&typeof x=="string"||(y=on(y),x=on(x)),l(y,x)}}function As(l,y,x,T,G,ne,ue,me,Ee,Ue){var Ke=y&H,We=Ke?ue:t,ut=Ke?t:ue,wt=Ke?ne:t,Ft=Ke?t:ne;y|=Ke?W:ae,y&=~(Ke?ae:W),y&O||(y&=~(k|D));var Vt=[l,y,G,wt,We,Ft,ut,me,Ee,Ue],Nt=x.apply(t,Vt);return Wo(l)&&Ns(Nt,Vt),Nt.placeholder=T,Ls(Nt,l,y)}function jo(l){var y=Mr[l];return function(x,T){if(x=on(x),T=T==null?0:Br(Wt(T),292),T&&Fa(x)){var G=(pr(x)+"e").split("e"),ne=y(G[0]+"e"+(+G[1]+T));return G=(pr(ne)+"e").split("e"),+(G[0]+"e"+(+G[1]-T))}return y(x)}}var Uu=Gn&&1/_i(new Gn([,-0]))[1]==N?function(l){return new Gn(l)}:fa;function Cs(l){return function(y){var x=Or(y);return x==qe?bo(y):x==ot?ic(y):Yf(y,l(y))}}function mn(l,y,x,T,G,ne,ue,me){var Ee=y&D;if(!Ee&&typeof l!="function")throw new Zr(c);var Ue=T?T.length:0;if(Ue||(y&=~(W|ae),T=G=t),ue=ue===t?ue:Dr(Wt(ue),0),me=me===t?me:Wt(me),Ue-=G?G.length:0,y&ae){var Ke=T,We=G;T=G=t}var ut=Ee?t:Ko(l),wt=[l,y,x,T,G,Ke,We,ne,ue,me];if(ut&&nl(wt,ut),l=wt[0],y=wt[1],x=wt[2],T=wt[3],G=wt[4],me=wt[9]=wt[9]===t?Ee?0:l.length:Dr(wt[9]-Ue,0),!me&&y&(H|j)&&(y&=~(H|j)),!y||y==k)var Ft=Lu(l,y,x);else y==H||y==j?Ft=ju(l,y,me):(y==W||y==(k|W))&&!G.length?Ft=qu(l,y,x,T):Ft=Ui.apply(t,wt);var Vt=ut?as:Ns;return Ls(Vt(Ft,wt),l,y)}function Ps(l,y,x,T){return l===t||fn(l,Hn[x])&&!br.call(T,x)?y:l}function ks(l,y,x,T,G,ne){return Er(l)&&Er(y)&&(ne.set(y,l),Ni(l,y,t,ks,ne),ne.delete(y)),l}function Ku(l){return pi(l)?t:l}function Ms(l,y,x,T,G,ne){var ue=x&_,me=l.length,Ee=y.length;if(me!=Ee&&!(ue&&Ee>me))return!1;var Ue=ne.get(l),Ke=ne.get(y);if(Ue&&Ke)return Ue==y&&Ke==l;var We=-1,ut=!0,wt=x&$?new Bn:t;for(ne.set(l,y),ne.set(y,l);++We<me;){var Ft=l[We],Vt=y[We];if(T)var Nt=ue?T(Vt,Ft,We,y,l,ne):T(Ft,Vt,We,l,y,ne);if(Nt!==t){if(Nt)continue;ut=!1;break}if(wt){if(!co(y,function(Zt,rr){if(!ei(wt,rr)&&(Ft===Zt||G(Ft,Zt,x,T,ne)))return wt.push(rr)})){ut=!1;break}}else if(!(Ft===Vt||G(Ft,Vt,x,T,ne))){ut=!1;break}}return ne.delete(l),ne.delete(y),ut}function zu(l,y,x,T,G,ne,ue){switch(x){case Ye:if(l.byteLength!=y.byteLength||l.byteOffset!=y.byteOffset)return!1;l=l.buffer,y=y.buffer;case Re:return!(l.byteLength!=y.byteLength||!ne(new Ai(l),new Ai(y)));case $e:case Ae:case Ze:return fn(+l,+y);case oe:return l.name==y.name&&l.message==y.message;case jt:case Ot:return l==y+"";case qe:var me=bo;case ot:var Ee=T&_;if(me||(me=_i),l.size!=y.size&&!Ee)return!1;var Ue=ue.get(l);if(Ue)return Ue==y;T|=$,ue.set(l,y);var Ke=Ms(me(l),me(y),T,G,ne,ue);return ue.delete(l),Ke;case Ut:if(oi)return oi.call(l)==oi.call(y)}return!1}function Hu(l,y,x,T,G,ne){var ue=x&_,me=qo(l),Ee=me.length,Ue=qo(y),Ke=Ue.length;if(Ee!=Ke&&!ue)return!1;for(var We=Ee;We--;){var ut=me[We];if(!(ue?ut in y:br.call(y,ut)))return!1}var wt=ne.get(l),Ft=ne.get(y);if(wt&&Ft)return wt==y&&Ft==l;var Vt=!0;ne.set(l,y),ne.set(y,l);for(var Nt=ue;++We<Ee;){ut=me[We];var Zt=l[ut],rr=y[ut];if(T)var Yr=ue?T(rr,Zt,ut,y,l,ne):T(Zt,rr,ut,l,y,ne);if(!(Yr===t?Zt===rr||G(Zt,rr,x,T,ne):Yr)){Vt=!1;break}Nt||(Nt=ut=="constructor")}if(Vt&&!Nt){var jr=l.constructor,Qr=y.constructor;jr!=Qr&&"constructor"in l&&"constructor"in y&&!(typeof jr=="function"&&jr instanceof jr&&typeof Qr=="function"&&Qr instanceof Qr)&&(Vt=!1)}return ne.delete(l),ne.delete(y),Vt}function gn(l){return Yo(Os(l,t,Hs),l+"")}function qo(l){return Va(l,Tr,Ho)}function Uo(l){return Va(l,Kr,Ds)}var Ko=Ti?function(l){return Ti.get(l)}:fa;function Gi(l){for(var y=l.name+"",x=Wn[y],T=br.call(Wn,y)?x.length:0;T--;){var G=x[T],ne=G.func;if(ne==null||ne==l)return G.name}return y}function Jn(l){var y=br.call(Z,"placeholder")?Z:l;return y.placeholder}function Bt(){var l=Z.iteratee||aa;return l=l===aa?Ja:l,arguments.length?l(arguments[0],arguments[1]):l}function Wi(l,y){var x=l.__data__;return Zu(y)?x[typeof y=="string"?"string":"hash"]:x.map}function zo(l){for(var y=Tr(l),x=y.length;x--;){var T=y[x],G=l[T];y[x]=[T,G,Rs(G)]}return y}function Nn(l,y){var x=tc(l,y);return Qa(x)?x:t}function Gu(l){var y=br.call(l,In),x=l[In];try{l[In]=t;var T=!0}catch{}var G=Ei.call(l);return T&&(y?l[In]=x:delete l[In]),G}var Ho=go?function(l){return l==null?[]:(l=gr(l),$n(go(l),function(y){return Ba.call(l,y)}))}:ca,Ds=go?function(l){for(var y=[];l;)En(y,Ho(l)),l=Ci(l);return y}:ca,Or=Nr;(vo&&Or(new vo(new ArrayBuffer(1)))!=Ye||ri&&Or(new ri)!=qe||_o&&Or(_o.resolve())!=gt||Gn&&Or(new Gn)!=ot||ni&&Or(new ni)!=Pe)&&(Or=function(l){var y=Nr(l),x=y==ht?l.constructor:t,T=x?Ln(x):"";if(T)switch(T){case Pc:return Ye;case kc:return qe;case Mc:return gt;case Dc:return ot;case Tc:return Pe}return y});function Wu(l,y,x){for(var T=-1,G=x.length;++T<G;){var ne=x[T],ue=ne.size;switch(ne.type){case"drop":l+=ue;break;case"dropRight":y-=ue;break;case"take":y=Br(y,l+ue);break;case"takeRight":l=Dr(l,y-ue);break}}return{start:l,end:y}}function Vu(l){var y=l.match(M);return y?y[1].split(X):[]}function Ts(l,y,x){y=kn(y,l);for(var T=-1,G=y.length,ne=!1;++T<G;){var ue=dn(y[T]);if(!(ne=l!=null&&x(l,ue)))break;l=l[ue]}return ne||++T!=G?ne:(G=l==null?0:l.length,!!G&&eo(G)&&vn(ue,G)&&(Gt(l)||jn(l)))}function Yu(l){var y=l.length,x=new l.constructor(y);return y&&typeof l[0]=="string"&&br.call(l,"index")&&(x.index=l.index,x.input=l.input),x}function Is(l){return typeof l.constructor=="function"&&!di(l)?Vn(Ci(l)):{}}function Qu(l,y,x){var T=l.constructor;switch(y){case Re:return No(l);case $e:case Ae:return new T(+l);case Ye:return Iu(l,x);case Tt:case Je:case dt:case rt:case et:case pt:case Kt:case Ct:case er:return ps(l,x);case qe:return new T;case Ze:case Ot:return new T(l);case jt:return Ru(l);case ot:return new T;case Ut:return Bu(l)}}function Ju(l,y){var x=y.length;if(!x)return l;var T=x-1;return y[T]=(x>1?"& ":"")+y[T],y=y.join(x>2?", ":" "),l.replace(Q,`{
/* [wrapped with `+y+`] */
`)}function Xu(l){return Gt(l)||jn(l)||!!(Oa&&l&&l[Oa])}function vn(l,y){var x=typeof l;return y=y??U,!!y&&(x=="number"||x!="symbol"&&St.test(l))&&l>-1&&l%1==0&&l<y}function Lr(l,y,x){if(!Er(x))return!1;var T=typeof y;return(T=="number"?Ur(x)&&vn(y,x.length):T=="string"&&y in x)?fn(x[y],l):!1}function Go(l,y){if(Gt(l))return!1;var x=typeof l;return x=="number"||x=="symbol"||x=="boolean"||l==null||Vr(l)?!0:dr.test(l)||!Lt.test(l)||y!=null&&l in gr(y)}function Zu(l){var y=typeof l;return y=="string"||y=="number"||y=="symbol"||y=="boolean"?l!=="__proto__":l===null}function Wo(l){var y=Gi(l),x=Z[y];if(typeof x!="function"||!(y in tr.prototype))return!1;if(l===x)return!0;var T=Ko(x);return!!T&&l===T[0]}function el(l){return!!Ta&&Ta in l}var tl=xi?_n:ua;function di(l){var y=l&&l.constructor,x=typeof y=="function"&&y.prototype||Hn;return l===x}function Rs(l){return l===l&&!Er(l)}function Bs(l,y){return function(x){return x==null?!1:x[l]===y&&(y!==t||l in gr(x))}}function rl(l){var y=Xi(l,function(T){return x.size===p&&x.clear(),T}),x=y.cache;return y}function nl(l,y){var x=l[1],T=y[1],G=x|T,ne=G<(k|D|fe),ue=T==fe&&x==H||T==fe&&x==pe&&l[7].length<=y[8]||T==(fe|pe)&&y[7].length<=y[8]&&x==H;if(!(ne||ue))return l;T&k&&(l[2]=y[2],G|=x&k?0:O);var me=y[3];if(me){var Ee=l[3];l[3]=Ee?bs(Ee,me,y[4]):me,l[4]=Ee?Sn(l[3],h):y[4]}return me=y[5],me&&(Ee=l[5],l[5]=Ee?gs(Ee,me,y[6]):me,l[6]=Ee?Sn(l[5],h):y[6]),me=y[7],me&&(l[7]=me),T&fe&&(l[8]=l[8]==null?y[8]:Br(l[8],y[8])),l[9]==null&&(l[9]=y[9]),l[0]=y[0],l[1]=G,l}function il(l){var y=[];if(l!=null)for(var x in gr(l))y.push(x);return y}function ol(l){return Ei.call(l)}function Os(l,y,x){return y=Dr(y===t?l.length-1:y,0),function(){for(var T=arguments,G=-1,ne=Dr(T.length-y,0),ue=Te(ne);++G<ne;)ue[G]=T[y+G];G=-1;for(var me=Te(y+1);++G<y;)me[G]=T[G];return me[y]=x(ue),Hr(l,this,me)}}function Fs(l,y){return y.length<2?l:Fn(l,rn(y,0,-1))}function al(l,y){for(var x=l.length,T=Br(y.length,x),G=qr(l);T--;){var ne=y[T];l[T]=vn(ne,x)?G[ne]:t}return l}function Vo(l,y){if(!(y==="constructor"&&typeof l[y]=="function")&&y!="__proto__")return l[y]}var Ns=js(as),hi=wc||function(l,y){return Ir.setTimeout(l,y)},Yo=js(ku);function Ls(l,y,x){var T=y+"";return Yo(l,Ju(T,sl(Vu(T),x)))}function js(l){var y=0,x=0;return function(){var T=Sc(),G=S-(T-x);if(x=T,G>0){if(++y>=C)return arguments[0]}else y=0;return l.apply(t,arguments)}}function Vi(l,y){var x=-1,T=l.length,G=T-1;for(y=y===t?T:y;++x<y;){var ne=Do(x,G),ue=l[ne];l[ne]=l[x],l[x]=ue}return l.length=y,l}var qs=rl(function(l){var y=[];return l.charCodeAt(0)===46&&y.push(""),l.replace(yr,function(x,T,G,ne){y.push(G?ne.replace(Ce,"$1"):T||x)}),y});function dn(l){if(typeof l=="string"||Vr(l))return l;var y=l+"";return y=="0"&&1/l==-N?"-0":y}function Ln(l){if(l!=null){try{return $i.call(l)}catch{}try{return l+""}catch{}}return""}function sl(l,y){return Xr(de,function(x){var T="_."+x[0];y&x[1]&&!gi(l,T)&&l.push(T)}),l.sort()}function Us(l){if(l instanceof tr)return l.clone();var y=new en(l.__wrapped__,l.__chain__);return y.__actions__=qr(l.__actions__),y.__index__=l.__index__,y.__values__=l.__values__,y}function fl(l,y,x){(x?Lr(l,y,x):y===t)?y=1:y=Dr(Wt(y),0);var T=l==null?0:l.length;if(!T||y<1)return[];for(var G=0,ne=0,ue=Te(Mi(T/y));G<T;)ue[ne++]=rn(l,G,G+=y);return ue}function cl(l){for(var y=-1,x=l==null?0:l.length,T=0,G=[];++y<x;){var ne=l[y];ne&&(G[T++]=ne)}return G}function ul(){var l=arguments.length;if(!l)return[];for(var y=Te(l-1),x=arguments[0],T=l;T--;)y[T-1]=arguments[T];return En(Gt(x)?qr(x):[x],Rr(y,1))}var ll=Yt(function(l,y){return Cr(l)?si(l,Rr(y,1,Cr,!0)):[]}),dl=Yt(function(l,y){var x=nn(y);return Cr(x)&&(x=t),Cr(l)?si(l,Rr(y,1,Cr,!0),Bt(x,2)):[]}),hl=Yt(function(l,y){var x=nn(y);return Cr(x)&&(x=t),Cr(l)?si(l,Rr(y,1,Cr,!0),t,x):[]});function pl(l,y,x){var T=l==null?0:l.length;return T?(y=x||y===t?1:Wt(y),rn(l,y<0?0:y,T)):[]}function yl(l,y,x){var T=l==null?0:l.length;return T?(y=x||y===t?1:Wt(y),y=T-y,rn(l,0,y<0?0:y)):[]}function bl(l,y){return l&&l.length?ji(l,Bt(y,3),!0,!0):[]}function ml(l,y){return l&&l.length?ji(l,Bt(y,3),!0):[]}function gl(l,y,x,T){var G=l==null?0:l.length;return G?(x&&typeof x!="number"&&Lr(l,y,x)&&(x=0,T=G),uu(l,y,x,T)):[]}function Ks(l,y,x){var T=l==null?0:l.length;if(!T)return-1;var G=x==null?0:Wt(x);return G<0&&(G=Dr(T+G,0)),vi(l,Bt(y,3),G)}function zs(l,y,x){var T=l==null?0:l.length;if(!T)return-1;var G=T-1;return x!==t&&(G=Wt(x),G=x<0?Dr(T+G,0):Br(G,T-1)),vi(l,Bt(y,3),G,!0)}function Hs(l){var y=l==null?0:l.length;return y?Rr(l,1):[]}function vl(l){var y=l==null?0:l.length;return y?Rr(l,N):[]}function _l(l,y){var x=l==null?0:l.length;return x?(y=y===t?1:Wt(y),Rr(l,y)):[]}function wl(l){for(var y=-1,x=l==null?0:l.length,T={};++y<x;){var G=l[y];T[G[0]]=G[1]}return T}function Gs(l){return l&&l.length?l[0]:t}function xl(l,y,x){var T=l==null?0:l.length;if(!T)return-1;var G=x==null?0:Wt(x);return G<0&&(G=Dr(T+G,0)),qn(l,y,G)}function $l(l){var y=l==null?0:l.length;return y?rn(l,0,-1):[]}var El=Yt(function(l){var y=xr(l,Oo);return y.length&&y[0]===l[0]?Ao(y):[]}),Sl=Yt(function(l){var y=nn(l),x=xr(l,Oo);return y===nn(x)?y=t:x.pop(),x.length&&x[0]===l[0]?Ao(x,Bt(y,2)):[]}),Al=Yt(function(l){var y=nn(l),x=xr(l,Oo);return y=typeof y=="function"?y:t,y&&x.pop(),x.length&&x[0]===l[0]?Ao(x,t,y):[]});function Cl(l,y){return l==null?"":$c.call(l,y)}function nn(l){var y=l==null?0:l.length;return y?l[y-1]:t}function Pl(l,y,x){var T=l==null?0:l.length;if(!T)return-1;var G=T;return x!==t&&(G=Wt(x),G=G<0?Dr(T+G,0):Br(G,T-1)),y===y?ac(l,y,G):vi(l,Ea,G,!0)}function kl(l,y){return l&&l.length?ts(l,Wt(y)):t}var Ml=Yt(Ws);function Ws(l,y){return l&&l.length&&y&&y.length?Mo(l,y):l}function Dl(l,y,x){return l&&l.length&&y&&y.length?Mo(l,y,Bt(x,2)):l}function Tl(l,y,x){return l&&l.length&&y&&y.length?Mo(l,y,t,x):l}var Il=gn(function(l,y){var x=l==null?0:l.length,T=xo(l,y);return os(l,xr(y,function(G){return vn(G,x)?+G:G}).sort(ys)),T});function Rl(l,y){var x=[];if(!(l&&l.length))return x;var T=-1,G=[],ne=l.length;for(y=Bt(y,3);++T<ne;){var ue=l[T];y(ue,T,l)&&(x.push(ue),G.push(T))}return os(l,G),x}function Qo(l){return l==null?l:Cc.call(l)}function Ol(l,y,x){var T=l==null?0:l.length;return T?(x&&typeof x!="number"&&Lr(l,y,x)?(y=0,x=T):(y=y==null?0:Wt(y),x=x===t?T:Wt(x)),rn(l,y,x)):[]}function Fl(l,y){return Li(l,y)}function Nl(l,y,x){return Io(l,y,Bt(x,2))}function Ll(l,y){var x=l==null?0:l.length;if(x){var T=Li(l,y);if(T<x&&fn(l[T],y))return T}return-1}function jl(l,y){return Li(l,y,!0)}function ql(l,y,x){return Io(l,y,Bt(x,2),!0)}function Ul(l,y){var x=l==null?0:l.length;if(x){var T=Li(l,y,!0)-1;if(fn(l[T],y))return T}return-1}function Kl(l){return l&&l.length?ss(l):[]}function zl(l,y){return l&&l.length?ss(l,Bt(y,2)):[]}function Hl(l){var y=l==null?0:l.length;return y?rn(l,1,y):[]}function Gl(l,y,x){return l&&l.length?(y=x||y===t?1:Wt(y),rn(l,0,y<0?0:y)):[]}function Wl(l,y,x){var T=l==null?0:l.length;return T?(y=x||y===t?1:Wt(y),y=T-y,rn(l,y<0?0:y,T)):[]}function Vl(l,y){return l&&l.length?ji(l,Bt(y,3),!1,!0):[]}function Yl(l,y){return l&&l.length?ji(l,Bt(y,3)):[]}var Ql=Yt(function(l){return Pn(Rr(l,1,Cr,!0))}),Jl=Yt(function(l){var y=nn(l);return Cr(y)&&(y=t),Pn(Rr(l,1,Cr,!0),Bt(y,2))}),Xl=Yt(function(l){var y=nn(l);return y=typeof y=="function"?y:t,Pn(Rr(l,1,Cr,!0),t,y)});function Zl(l){return l&&l.length?Pn(l):[]}function ed(l,y){return l&&l.length?Pn(l,Bt(y,2)):[]}function td(l,y){return y=typeof y=="function"?y:t,l&&l.length?Pn(l,t,y):[]}function Jo(l){if(!(l&&l.length))return[];var y=0;return l=$n(l,function(x){if(Cr(x))return y=Dr(x.length,y),!0}),po(y,function(x){return xr(l,uo(x))})}function Vs(l,y){if(!(l&&l.length))return[];var x=Jo(l);return y==null?x:xr(x,function(T){return Hr(y,t,T)})}var rd=Yt(function(l,y){return Cr(l)?si(l,y):[]}),nd=Yt(function(l){return Bo($n(l,Cr))}),id=Yt(function(l){var y=nn(l);return Cr(y)&&(y=t),Bo($n(l,Cr),Bt(y,2))}),od=Yt(function(l){var y=nn(l);return y=typeof y=="function"?y:t,Bo($n(l,Cr),t,y)}),ad=Yt(Jo);function sd(l,y){return ls(l||[],y||[],ai)}function fd(l,y){return ls(l||[],y||[],ui)}var cd=Yt(function(l){var y=l.length,x=y>1?l[y-1]:t;return x=typeof x=="function"?(l.pop(),x):t,Vs(l,x)});function Ys(l){var y=Z(l);return y.__chain__=!0,y}function ud(l,y){return y(l),l}function Yi(l,y){return y(l)}var ld=gn(function(l){var y=l.length,x=y?l[0]:0,T=this.__wrapped__,G=function(ne){return xo(ne,l)};return y>1||this.__actions__.length||!(T instanceof tr)||!vn(x)?this.thru(G):(T=T.slice(x,+x+(y?1:0)),T.__actions__.push({func:Yi,args:[G],thisArg:t}),new en(T,this.__chain__).thru(function(ne){return y&&!ne.length&&ne.push(t),ne}))});function dd(){return Ys(this)}function hd(){return new en(this.value(),this.__chain__)}function pd(){this.__values__===t&&(this.__values__=uf(this.value()));var l=this.__index__>=this.__values__.length,y=l?t:this.__values__[this.__index__++];return{done:l,value:y}}function yd(){return this}function bd(l){for(var y,x=this;x instanceof Ri;){var T=Us(x);T.__index__=0,T.__values__=t,y?G.__wrapped__=T:y=T;var G=T;x=x.__wrapped__}return G.__wrapped__=l,y}function md(){var l=this.__wrapped__;if(l instanceof tr){var y=l;return this.__actions__.length&&(y=new tr(this)),y=y.reverse(),y.__actions__.push({func:Yi,args:[Qo],thisArg:t}),new en(y,this.__chain__)}return this.thru(Qo)}function gd(){return us(this.__wrapped__,this.__actions__)}var vd=qi(function(l,y,x){br.call(l,x)?++l[x]:yn(l,x,1)});function _d(l,y,x){var T=Gt(l)?xa:cu;return x&&Lr(l,y,x)&&(y=t),T(l,Bt(y,3))}function wd(l,y){var x=Gt(l)?$n:Ga;return x(l,Bt(y,3))}var xd=xs(Ks),$d=xs(zs);function Ed(l,y){return Rr(Qi(l,y),1)}function Sd(l,y){return Rr(Qi(l,y),N)}function Ad(l,y,x){return x=x===t?1:Wt(x),Rr(Qi(l,y),x)}function Qs(l,y){var x=Gt(l)?Xr:Cn;return x(l,Bt(y,3))}function Js(l,y){var x=Gt(l)?Uf:Ha;return x(l,Bt(y,3))}var Cd=qi(function(l,y,x){br.call(l,x)?l[x].push(y):yn(l,x,[y])});function Pd(l,y,x,T){l=Ur(l)?l:Zn(l),x=x&&!T?Wt(x):0;var G=l.length;return x<0&&(x=Dr(G+x,0)),to(l)?x<=G&&l.indexOf(y,x)>-1:!!G&&qn(l,y,x)>-1}var kd=Yt(function(l,y,x){var T=-1,G=typeof y=="function",ne=Ur(l)?Te(l.length):[];return Cn(l,function(ue){ne[++T]=G?Hr(y,ue,x):fi(ue,y,x)}),ne}),Md=qi(function(l,y,x){yn(l,x,y)});function Qi(l,y){var x=Gt(l)?xr:Xa;return x(l,Bt(y,3))}function Dd(l,y,x,T){return l==null?[]:(Gt(y)||(y=y==null?[]:[y]),x=T?t:x,Gt(x)||(x=x==null?[]:[x]),rs(l,y,x))}var Td=qi(function(l,y,x){l[x?0:1].push(y)},function(){return[[],[]]});function Id(l,y,x){var T=Gt(l)?fo:Aa,G=arguments.length<3;return T(l,Bt(y,4),x,G,Cn)}function Rd(l,y,x){var T=Gt(l)?Kf:Aa,G=arguments.length<3;return T(l,Bt(y,4),x,G,Ha)}function Bd(l,y){var x=Gt(l)?$n:Ga;return x(l,Zi(Bt(y,3)))}function Od(l){var y=Gt(l)?qa:Cu;return y(l)}function Fd(l,y,x){(x?Lr(l,y,x):y===t)?y=1:y=Wt(y);var T=Gt(l)?iu:Pu;return T(l,y)}function Nd(l){var y=Gt(l)?ou:Mu;return y(l)}function Ld(l){if(l==null)return 0;if(Ur(l))return to(l)?Kn(l):l.length;var y=Or(l);return y==qe||y==ot?l.size:Po(l).length}function jd(l,y,x){var T=Gt(l)?co:Du;return x&&Lr(l,y,x)&&(y=t),T(l,Bt(y,3))}var qd=Yt(function(l,y){if(l==null)return[];var x=y.length;return x>1&&Lr(l,y[0],y[1])?y=[]:x>2&&Lr(y[0],y[1],y[2])&&(y=[y[0]]),rs(l,Rr(y,1),[])}),Ji=_c||function(){return Ir.Date.now()};function Ud(l,y){if(typeof y!="function")throw new Zr(c);return l=Wt(l),function(){if(--l<1)return y.apply(this,arguments)}}function Xs(l,y,x){return y=x?t:y,y=l&&y==null?l.length:y,mn(l,fe,t,t,t,t,y)}function Zs(l,y){var x;if(typeof y!="function")throw new Zr(c);return l=Wt(l),function(){return--l>0&&(x=y.apply(this,arguments)),l<=1&&(y=t),x}}var Xo=Yt(function(l,y,x){var T=k;if(x.length){var G=Sn(x,Jn(Xo));T|=W}return mn(l,T,y,x,G)}),ef=Yt(function(l,y,x){var T=k|D;if(x.length){var G=Sn(x,Jn(ef));T|=W}return mn(y,T,l,x,G)});function tf(l,y,x){y=x?t:y;var T=mn(l,H,t,t,t,t,t,y);return T.placeholder=tf.placeholder,T}function rf(l,y,x){y=x?t:y;var T=mn(l,j,t,t,t,t,t,y);return T.placeholder=rf.placeholder,T}function nf(l,y,x){var T,G,ne,ue,me,Ee,Ue=0,Ke=!1,We=!1,ut=!0;if(typeof l!="function")throw new Zr(c);y=on(y)||0,Er(x)&&(Ke=!!x.leading,We="maxWait"in x,ne=We?Dr(on(x.maxWait)||0,y):ne,ut="trailing"in x?!!x.trailing:ut);function wt(Pr){var cn=T,xn=G;return T=G=t,Ue=Pr,ue=l.apply(xn,cn),ue}function Ft(Pr){return Ue=Pr,me=hi(Zt,y),Ke?wt(Pr):ue}function Vt(Pr){var cn=Pr-Ee,xn=Pr-Ue,$f=y-cn;return We?Br($f,ne-xn):$f}function Nt(Pr){var cn=Pr-Ee,xn=Pr-Ue;return Ee===t||cn>=y||cn<0||We&&xn>=ne}function Zt(){var Pr=Ji();if(Nt(Pr))return rr(Pr);me=hi(Zt,Vt(Pr))}function rr(Pr){return me=t,ut&&T?wt(Pr):(T=G=t,ue)}function Yr(){me!==t&&ds(me),Ue=0,T=Ee=G=me=t}function jr(){return me===t?ue:rr(Ji())}function Qr(){var Pr=Ji(),cn=Nt(Pr);if(T=arguments,G=this,Ee=Pr,cn){if(me===t)return Ft(Ee);if(We)return ds(me),me=hi(Zt,y),wt(Ee)}return me===t&&(me=hi(Zt,y)),ue}return Qr.cancel=Yr,Qr.flush=jr,Qr}var Kd=Yt(function(l,y){return za(l,1,y)}),zd=Yt(function(l,y,x){return za(l,on(y)||0,x)});function Hd(l){return mn(l,ve)}function Xi(l,y){if(typeof l!="function"||y!=null&&typeof y!="function")throw new Zr(c);var x=function(){var T=arguments,G=y?y.apply(this,T):T[0],ne=x.cache;if(ne.has(G))return ne.get(G);var ue=l.apply(this,T);return x.cache=ne.set(G,ue)||ne,ue};return x.cache=new(Xi.Cache||pn),x}Xi.Cache=pn;function Zi(l){if(typeof l!="function")throw new Zr(c);return function(){var y=arguments;switch(y.length){case 0:return!l.call(this);case 1:return!l.call(this,y[0]);case 2:return!l.call(this,y[0],y[1]);case 3:return!l.call(this,y[0],y[1],y[2])}return!l.apply(this,y)}}function Gd(l){return Zs(2,l)}var Wd=Tu(function(l,y){y=y.length==1&&Gt(y[0])?xr(y[0],Gr(Bt())):xr(Rr(y,1),Gr(Bt()));var x=y.length;return Yt(function(T){for(var G=-1,ne=Br(T.length,x);++G<ne;)T[G]=y[G].call(this,T[G]);return Hr(l,this,T)})}),Zo=Yt(function(l,y){var x=Sn(y,Jn(Zo));return mn(l,W,t,y,x)}),of=Yt(function(l,y){var x=Sn(y,Jn(of));return mn(l,ae,t,y,x)}),Vd=gn(function(l,y){return mn(l,pe,t,t,t,y)});function Yd(l,y){if(typeof l!="function")throw new Zr(c);return y=y===t?y:Wt(y),Yt(l,y)}function Qd(l,y){if(typeof l!="function")throw new Zr(c);return y=y==null?0:Dr(Wt(y),0),Yt(function(x){var T=x[y],G=Mn(x,0,y);return T&&En(G,T),Hr(l,this,G)})}function Jd(l,y,x){var T=!0,G=!0;if(typeof l!="function")throw new Zr(c);return Er(x)&&(T="leading"in x?!!x.leading:T,G="trailing"in x?!!x.trailing:G),nf(l,y,{leading:T,maxWait:y,trailing:G})}function Xd(l){return Xs(l,1)}function Zd(l,y){return Zo(Fo(y),l)}function eh(){if(!arguments.length)return[];var l=arguments[0];return Gt(l)?l:[l]}function th(l){return tn(l,v)}function nh(l,y){return y=typeof y=="function"?y:t,tn(l,v,y)}function ih(l){return tn(l,b|v)}function oh(l,y){return y=typeof y=="function"?y:t,tn(l,b|v,y)}function ah(l,y){return y==null||Ka(l,y,Tr(y))}function fn(l,y){return l===y||l!==l&&y!==y}var fh=Hi(So),ch=Hi(function(l,y){return l>=y}),jn=Ya(function(){return arguments}())?Ya:function(l){return Sr(l)&&br.call(l,"callee")&&!Ba.call(l,"callee")},Gt=Te.isArray,uh=ya?Gr(ya):yu;function Ur(l){return l!=null&&eo(l.length)&&!_n(l)}function Cr(l){return Sr(l)&&Ur(l)}function lh(l){return l===!0||l===!1||Sr(l)&&Nr(l)==$e}var Dn=xc||ua,hh=ba?Gr(ba):bu;function ph(l){return Sr(l)&&l.nodeType===1&&!pi(l)}function yh(l){if(l==null)return!0;if(Ur(l)&&(Gt(l)||typeof l=="string"||typeof l.splice=="function"||Dn(l)||Xn(l)||jn(l)))return!l.length;var y=Or(l);if(y==qe||y==ot)return!l.size;if(di(l))return!Po(l).length;for(var x in l)if(br.call(l,x))return!1;return!0}function bh(l,y){return ci(l,y)}function mh(l,y,x){x=typeof x=="function"?x:t;var T=x?x(l,y):t;return T===t?ci(l,y,t,x):!!T}function ea(l){if(!Sr(l))return!1;var y=Nr(l);return y==oe||y==ze||typeof l.message=="string"&&typeof l.name=="string"&&!pi(l)}function gh(l){return typeof l=="number"&&Fa(l)}function _n(l){if(!Er(l))return!1;var y=Nr(l);return y==ie||y==Ie||y==he||y==Me}function af(l){return typeof l=="number"&&l==Wt(l)}function eo(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=U}function Er(l){var y=typeof l;return l!=null&&(y=="object"||y=="function")}function Sr(l){return l!=null&&typeof l=="object"}var sf=ma?Gr(ma):gu;function vh(l,y){return l===y||Co(l,y,zo(y))}function _h(l,y,x){return x=typeof x=="function"?x:t,Co(l,y,zo(y),x)}function wh(l){return ff(l)&&l!=+l}function xh(l){if(tl(l))throw new Ht(a);return Qa(l)}function $h(l){return l===null}function Eh(l){return l==null}function ff(l){return typeof l=="number"||Sr(l)&&Nr(l)==Ze}function pi(l){if(!Sr(l)||Nr(l)!=ht)return!1;var y=Ci(l);if(y===null)return!0;var x=br.call(y,"constructor")&&y.constructor;return typeof x=="function"&&x instanceof x&&$i.call(x)==yc}var ta=ga?Gr(ga):vu;function Sh(l){return af(l)&&l>=-U&&l<=U}var cf=va?Gr(va):_u;function to(l){return typeof l=="string"||!Gt(l)&&Sr(l)&&Nr(l)==Ot}function Vr(l){return typeof l=="symbol"||Sr(l)&&Nr(l)==Ut}var Xn=wa?Gr(wa):wu;function Ah(l){return l===t}function Ch(l){return Sr(l)&&Or(l)==Pe}function Ph(l){return Sr(l)&&Nr(l)==Be}var kh=Hi(ko),Mh=Hi(function(l,y){return l<=y});function uf(l){if(!l)return[];if(Ur(l))return to(l)?an(l):qr(l);if(ti&&l[ti])return nc(l[ti]());var y=Or(l),x=y==qe?bo:y==ot?_i:Zn;return x(l)}function wn(l){if(!l)return l===0?l:0;if(l=on(l),l===N||l===-N){var y=l<0?-1:1;return y*L}return l===l?l:0}function Wt(l){var y=wn(l),x=y%1;return y===y?x?y-x:y:0}function lf(l){return l?On(Wt(l),0,B):0}function on(l){if(typeof l=="number")return l;if(Vr(l))return P;if(Er(l)){var y=typeof l.valueOf=="function"?l.valueOf():l;l=Er(y)?y+"":y}if(typeof l!="string")return l===0?l:+l;l=Ca(l);var x=zt.test(l);return x||xt.test(l)?Lf(l.slice(2),x?2:8):Ve.test(l)?P:+l}function df(l){return ln(l,Kr(l))}function Dh(l){return l?On(Wt(l),-U,U):l===0?l:0}function pr(l){return l==null?"":Wr(l)}var Th=Yn(function(l,y){if(di(y)||Ur(y)){ln(y,Tr(y),l);return}for(var x in y)br.call(y,x)&&ai(l,x,y[x])}),hf=Yn(function(l,y){ln(y,Kr(y),l)}),ro=Yn(function(l,y,x,T){ln(y,Kr(y),l,T)}),Ih=Yn(function(l,y,x,T){ln(y,Tr(y),l,T)}),Rh=gn(xo);function Bh(l,y){var x=Vn(l);return y==null?x:Ua(x,y)}var Oh=Yt(function(l,y){l=gr(l);var x=-1,T=y.length,G=T>2?y[2]:t;for(G&&Lr(y[0],y[1],G)&&(T=1);++x<T;)for(var ne=y[x],ue=Kr(ne),me=-1,Ee=ue.length;++me<Ee;){var Ue=ue[me],Ke=l[Ue];(Ke===t||fn(Ke,Hn[Ue])&&!br.call(l,Ue))&&(l[Ue]=ne[Ue])}return l}),Fh=Yt(function(l){return l.push(t,ks),Hr(pf,t,l)});function Nh(l,y){return $a(l,Bt(y,3),un)}function Lh(l,y){return $a(l,Bt(y,3),Eo)}function jh(l,y){return l==null?l:$o(l,Bt(y,3),Kr)}function qh(l,y){return l==null?l:Wa(l,Bt(y,3),Kr)}function Uh(l,y){return l&&un(l,Bt(y,3))}function zh(l,y){return l&&Eo(l,Bt(y,3))}function Hh(l){return l==null?[]:Fi(l,Tr(l))}function Gh(l){return l==null?[]:Fi(l,Kr(l))}function ra(l,y,x){var T=l==null?t:Fn(l,y);return T===t?x:T}function Wh(l,y){return l!=null&&Ts(l,y,lu)}function na(l,y){return l!=null&&Ts(l,y,du)}var Vh=Es(function(l,y,x){y!=null&&typeof y.toString!="function"&&(y=Ei.call(y)),l[y]=x},oa(zr)),Yh=Es(function(l,y,x){y!=null&&typeof y.toString!="function"&&(y=Ei.call(y)),br.call(l,y)?l[y].push(x):l[y]=[x]},Bt),Qh=Yt(fi);function Tr(l){return Ur(l)?ja(l):Po(l)}function Kr(l){return Ur(l)?ja(l,!0):xu(l)}function Jh(l,y){var x={};return y=Bt(y,3),un(l,function(T,G,ne){yn(x,y(T,G,ne),T)}),x}function Xh(l,y){var x={};return y=Bt(y,3),un(l,function(T,G,ne){yn(x,G,y(T,G,ne))}),x}var Zh=Yn(function(l,y,x){Ni(l,y,x)}),pf=Yn(function(l,y,x,T){Ni(l,y,x,T)}),e0=gn(function(l,y){var x={};if(l==null)return x;var T=!1;y=xr(y,function(ne){return ne=kn(ne,l),T||(T=ne.length>1),ne}),ln(l,Uo(l),x),T&&(x=tn(x,b|m|v,Ku));for(var G=y.length;G--;)Ro(x,y[G]);return x});function t0(l,y){return yf(l,Zi(Bt(y)))}var r0=gn(function(l,y){return l==null?{}:Eu(l,y)});function yf(l,y){if(l==null)return{};var x=xr(Uo(l),function(T){return[T]});return y=Bt(y),ns(l,x,function(T,G){return y(T,G[0])})}function n0(l,y,x){y=kn(y,l);var T=-1,G=y.length;for(G||(G=1,l=t);++T<G;){var ne=l==null?t:l[dn(y[T])];ne===t&&(T=G,ne=x),l=_n(ne)?ne.call(l):ne}return l}function i0(l,y,x){return l==null?l:ui(l,y,x)}function o0(l,y,x,T){return T=typeof T=="function"?T:t,l==null?l:ui(l,y,x,T)}var bf=Cs(Tr),mf=Cs(Kr);function a0(l,y,x){var T=Gt(l),G=T||Dn(l)||Xn(l);if(y=Bt(y,4),x==null){var ne=l&&l.constructor;G?x=T?new ne:[]:Er(l)?x=_n(ne)?Vn(Ci(l)):{}:x={}}return(G?Xr:un)(l,function(ue,me,Ee){return y(x,ue,me,Ee)}),x}function s0(l,y){return l==null?!0:Ro(l,y)}function f0(l,y,x){return l==null?l:cs(l,y,Fo(x))}function c0(l,y,x,T){return T=typeof T=="function"?T:t,l==null?l:cs(l,y,Fo(x),T)}function Zn(l){return l==null?[]:yo(l,Tr(l))}function u0(l){return l==null?[]:yo(l,Kr(l))}function l0(l,y,x){return x===t&&(x=y,y=t),x!==t&&(x=on(x),x=x===x?x:0),y!==t&&(y=on(y),y=y===y?y:0),On(on(l),y,x)}function d0(l,y,x){return y=wn(y),x===t?(x=y,y=0):x=wn(x),l=on(l),hu(l,y,x)}function h0(l,y,x){if(x&&typeof x!="boolean"&&Lr(l,y,x)&&(y=x=t),x===t&&(typeof y=="boolean"?(x=y,y=t):typeof l=="boolean"&&(x=l,l=t)),l===t&&y===t?(l=0,y=1):(l=wn(l),y===t?(y=l,l=0):y=wn(y)),l>y){var T=l;l=y,y=T}if(x||l%1||y%1){var G=Na();return Br(l+G*(y-l+Nf("1e-"+((G+"").length-1))),y)}return Do(l,y)}var p0=Qn(function(l,y,x){return y=y.toLowerCase(),l+(x?gf(y):y)});function gf(l){return ia(pr(l).toLowerCase())}function vf(l){return l=pr(l),l&&l.replace(kt,Jf).replace(Pf,"")}function y0(l,y,x){l=pr(l),y=Wr(y);var T=l.length;x=x===t?T:On(Wt(x),0,T);var G=x;return x-=y.length,x>=0&&l.slice(x,G)==y}function b0(l){return l=pr(l),l&&Xt.test(l)?l.replace(qt,Xf):l}function m0(l){return l=pr(l),l&&hr.test(l)?l.replace(_t,"\\$&"):l}var g0=Qn(function(l,y,x){return l+(x?"-":"")+y.toLowerCase()}),_0=Qn(function(l,y,x){return l+(x?" ":"")+y.toLowerCase()}),w0=ws("toLowerCase");function x0(l,y,x){l=pr(l),y=Wt(y);var T=y?Kn(l):0;if(!y||T>=y)return l;var G=(y-T)/2;return zi(Di(G),x)+l+zi(Mi(G),x)}function $0(l,y,x){l=pr(l),y=Wt(y);var T=y?Kn(l):0;return y&&T<y?l+zi(y-T,x):l}function E0(l,y,x){l=pr(l),y=Wt(y);var T=y?Kn(l):0;return y&&T<y?zi(y-T,x)+l:l}function S0(l,y,x){return x||y==null?y=0:y&&(y=+y),Ac(pr(l).replace(F,""),y||0)}function A0(l,y,x){return(x?Lr(l,y,x):y===t)?y=1:y=Wt(y),To(pr(l),y)}function C0(){var l=arguments,y=pr(l[0]);return l.length<3?y:y.replace(l[1],l[2])}var P0=Qn(function(l,y,x){return l+(x?"_":"")+y.toLowerCase()});function k0(l,y,x){return x&&typeof x!="number"&&Lr(l,y,x)&&(y=x=t),x=x===t?B:x>>>0,x?(l=pr(l),l&&(typeof y=="string"||y!=null&&!ta(y))&&(y=Wr(y),!y&&Un(l))?Mn(an(l),0,x):l.split(y,x)):[]}var M0=Qn(function(l,y,x){return l+(x?" ":"")+ia(y)});function D0(l,y,x){return l=pr(l),x=x==null?0:On(Wt(x),0,l.length),y=Wr(y),l.slice(x,x+y.length)==y}function T0(l,y,x){var T=Z.templateSettings;x&&Lr(l,y,x)&&(y=t),l=pr(l),y=ro({},y,T,Ps);var G=ro({},y.imports,T.imports,Ps),ne=Tr(G),ue=yo(G,ne),me,Ee,Ue=0,Ke=y.interpolate||At,We="__p += '",ut=mo((y.escape||At).source+"|"+Ke.source+"|"+(Ke===ar?je:At).source+"|"+(y.evaluate||At).source+"|$","g"),wt="//# sourceURL="+(br.call(y,"sourceURL")?(y.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++If+"]")+`
`;l.replace(ut,function(Nt,Zt,rr,Yr,jr,Qr){return rr||(rr=Yr),We+=l.slice(Ue,Qr).replace($t,Zf),Zt&&(me=!0,We+=`' +
__e(`+Zt+`) +
'`),jr&&(Ee=!0,We+=`';
`+jr+`;
__p += '`),rr&&(We+=`' +
((__t = (`+rr+`)) == null ? '' : __t) +
'`),Ue=Qr+Nt.length,Nt}),We+=`';
`;var Ft=br.call(y,"variable")&&y.variable;if(!Ft)We=`with (obj) {
`+We+`
}
`;else if(_e.test(Ft))throw new Ht(u);We=(Ee?We.replace(nr,""):We).replace(It,"$1").replace(Qt,"$1;"),We="function("+(Ft||"obj")+`) {
`+(Ft?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(me?", __e = _.escape":"")+(Ee?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+We+`return __p
}`;var Vt=wf(function(){return ur(ne,wt+"return "+We).apply(t,ue)});if(Vt.source=We,ea(Vt))throw Vt;return Vt}function I0(l){return pr(l).toLowerCase()}function R0(l){return pr(l).toUpperCase()}function B0(l,y,x){if(l=pr(l),l&&(x||y===t))return Ca(l);if(!l||!(y=Wr(y)))return l;var T=an(l),G=an(y),ne=Pa(T,G),ue=ka(T,G)+1;return Mn(T,ne,ue).join("")}function O0(l,y,x){if(l=pr(l),l&&(x||y===t))return l.slice(0,Da(l)+1);if(!l||!(y=Wr(y)))return l;var T=an(l),G=ka(T,an(y))+1;return Mn(T,0,G).join("")}function F0(l,y,x){if(l=pr(l),l&&(x||y===t))return l.replace(F,"");if(!l||!(y=Wr(y)))return l;var T=an(l),G=Pa(T,an(y));return Mn(T,G).join("")}function N0(l,y){var x=Qe,T=re;if(Er(y)){var G="separator"in y?y.separator:G;x="length"in y?Wt(y.length):x,T="omission"in y?Wr(y.omission):T}l=pr(l);var ne=l.length;if(Un(l)){var ue=an(l);ne=ue.length}if(x>=ne)return l;var me=x-Kn(T);if(me<1)return T;var Ee=ue?Mn(ue,0,me).join(""):l.slice(0,me);if(G===t)return Ee+T;if(ue&&(me+=Ee.length-me),ta(G)){if(l.slice(me).search(G)){var Ue,Ke=Ee;for(G.global||(G=mo(G.source,pr(Xe.exec(G))+"g")),G.lastIndex=0;Ue=G.exec(Ke);)var We=Ue.index;Ee=Ee.slice(0,We===t?me:We)}}else if(l.indexOf(Wr(G),me)!=me){var ut=Ee.lastIndexOf(G);ut>-1&&(Ee=Ee.slice(0,ut))}return Ee+T}function L0(l){return l=pr(l),l&&lr.test(l)?l.replace(fr,sc):l}var j0=Qn(function(l,y,x){return l+(x?" ":"")+y.toUpperCase()}),ia=ws("toUpperCase");function _f(l,y,x){return l=pr(l),y=x?t:y,y===t?rc(l)?uc(l):Gf(l):l.match(y)||[]}var wf=Yt(function(l,y){try{return Hr(l,t,y)}catch(x){return ea(x)?x:new Ht(x)}}),q0=gn(function(l,y){return Xr(y,function(x){x=dn(x),yn(l,x,Xo(l[x],l))}),l});function U0(l){var y=l==null?0:l.length,x=Bt();return l=y?xr(l,function(T){if(typeof T[1]!="function")throw new Zr(c);return[x(T[0]),T[1]]}):[],Yt(function(T){for(var G=-1;++G<y;){var ne=l[G];if(Hr(ne[0],this,T))return Hr(ne[1],this,T)}})}function K0(l){return fu(tn(l,b))}function oa(l){return function(){return l}}function z0(l,y){return l==null||l!==l?y:l}var H0=$s(),G0=$s(!0);function zr(l){return l}function aa(l){return Ja(typeof l=="function"?l:tn(l,b))}function W0(l){return Za(tn(l,b))}function V0(l,y){return es(l,tn(y,b))}var Y0=Yt(function(l,y){return function(x){return fi(x,l,y)}}),Q0=Yt(function(l,y){return function(x){return fi(l,x,y)}});function sa(l,y,x){var T=Tr(y),G=Fi(y,T);x==null&&!(Er(y)&&(G.length||!T.length))&&(x=y,y=l,l=this,G=Fi(y,Tr(y)));var ne=!(Er(x)&&"chain"in x)||!!x.chain,ue=_n(l);return Xr(G,function(me){var Ee=y[me];l[me]=Ee,ue&&(l.prototype[me]=function(){var Ue=this.__chain__;if(ne||Ue){var Ke=l(this.__wrapped__),We=Ke.__actions__=qr(this.__actions__);return We.push({func:Ee,args:arguments,thisArg:l}),Ke.__chain__=Ue,Ke}return Ee.apply(l,En([this.value()],arguments))})}),l}function J0(){return Ir._===this&&(Ir._=bc),this}function fa(){}function X0(l){return l=Wt(l),Yt(function(y){return ts(y,l)})}var Z0=Lo(xr),ep=Lo(xa),tp=Lo(co);function xf(l){return Go(l)?uo(dn(l)):Su(l)}function rp(l){return function(y){return l==null?t:Fn(l,y)}}var np=Ss(),ip=Ss(!0);function ca(){return[]}function ua(){return!1}function op(){return{}}function ap(){return""}function sp(){return!0}function fp(l,y){if(l=Wt(l),l<1||l>U)return[];var x=B,T=Br(l,B);y=Bt(y),l-=B;for(var G=po(T,y);++x<l;)y(x);return G}function cp(l){return Gt(l)?xr(l,dn):Vr(l)?[l]:qr(qs(pr(l)))}function up(l){var y=++pc;return pr(l)+y}var lp=Ki(function(l,y){return l+y},0),dp=jo("ceil"),hp=Ki(function(l,y){return l/y},1),pp=jo("floor");function yp(l){return l&&l.length?Oi(l,zr,So):t}function bp(l,y){return l&&l.length?Oi(l,Bt(y,2),So):t}function mp(l){return Sa(l,zr)}function gp(l,y){return Sa(l,Bt(y,2))}function vp(l){return l&&l.length?Oi(l,zr,ko):t}function _p(l,y){return l&&l.length?Oi(l,Bt(y,2),ko):t}var wp=Ki(function(l,y){return l*y},1),xp=jo("round"),$p=Ki(function(l,y){return l-y},0);function Ep(l){return l&&l.length?ho(l,zr):0}function Sp(l,y){return l&&l.length?ho(l,Bt(y,2)):0}return Z.after=Ud,Z.ary=Xs,Z.assign=Th,Z.assignIn=hf,Z.assignInWith=ro,Z.assignWith=Ih,Z.at=Rh,Z.before=Zs,Z.bind=Xo,Z.bindAll=q0,Z.bindKey=ef,Z.castArray=eh,Z.chain=Ys,Z.chunk=fl,Z.compact=cl,Z.concat=ul,Z.cond=U0,Z.conforms=K0,Z.constant=oa,Z.countBy=vd,Z.create=Bh,Z.curry=tf,Z.curryRight=rf,Z.debounce=nf,Z.defaults=Oh,Z.defaultsDeep=Fh,Z.defer=Kd,Z.delay=zd,Z.difference=ll,Z.differenceBy=dl,Z.differenceWith=hl,Z.drop=pl,Z.dropRight=yl,Z.dropRightWhile=bl,Z.dropWhile=ml,Z.fill=gl,Z.filter=wd,Z.flatMap=Ed,Z.flatMapDeep=Sd,Z.flatMapDepth=Ad,Z.flatten=Hs,Z.flattenDeep=vl,Z.flattenDepth=_l,Z.flip=Hd,Z.flow=H0,Z.flowRight=G0,Z.fromPairs=wl,Z.functions=Hh,Z.functionsIn=Gh,Z.groupBy=Cd,Z.initial=$l,Z.intersection=El,Z.intersectionBy=Sl,Z.intersectionWith=Al,Z.invert=Vh,Z.invertBy=Yh,Z.invokeMap=kd,Z.iteratee=aa,Z.keyBy=Md,Z.keys=Tr,Z.keysIn=Kr,Z.map=Qi,Z.mapKeys=Jh,Z.mapValues=Xh,Z.matches=W0,Z.matchesProperty=V0,Z.memoize=Xi,Z.merge=Zh,Z.mergeWith=pf,Z.method=Y0,Z.methodOf=Q0,Z.mixin=sa,Z.negate=Zi,Z.nthArg=X0,Z.omit=e0,Z.omitBy=t0,Z.once=Gd,Z.orderBy=Dd,Z.over=Z0,Z.overArgs=Wd,Z.overEvery=ep,Z.overSome=tp,Z.partial=Zo,Z.partialRight=of,Z.partition=Td,Z.pick=r0,Z.pickBy=yf,Z.property=xf,Z.propertyOf=rp,Z.pull=Ml,Z.pullAll=Ws,Z.pullAllBy=Dl,Z.pullAllWith=Tl,Z.pullAt=Il,Z.range=np,Z.rangeRight=ip,Z.rearg=Vd,Z.reject=Bd,Z.remove=Rl,Z.rest=Yd,Z.reverse=Qo,Z.sampleSize=Fd,Z.set=i0,Z.setWith=o0,Z.shuffle=Nd,Z.slice=Ol,Z.sortBy=qd,Z.sortedUniq=Kl,Z.sortedUniqBy=zl,Z.split=k0,Z.spread=Qd,Z.tail=Hl,Z.take=Gl,Z.takeRight=Wl,Z.takeRightWhile=Vl,Z.takeWhile=Yl,Z.tap=ud,Z.throttle=Jd,Z.thru=Yi,Z.toArray=uf,Z.toPairs=bf,Z.toPairsIn=mf,Z.toPath=cp,Z.toPlainObject=df,Z.transform=a0,Z.unary=Xd,Z.union=Ql,Z.unionBy=Jl,Z.unionWith=Xl,Z.uniq=Zl,Z.uniqBy=ed,Z.uniqWith=td,Z.unset=s0,Z.unzip=Jo,Z.unzipWith=Vs,Z.update=f0,Z.updateWith=c0,Z.values=Zn,Z.valuesIn=u0,Z.without=rd,Z.words=_f,Z.wrap=Zd,Z.xor=nd,Z.xorBy=id,Z.xorWith=od,Z.zip=ad,Z.zipObject=sd,Z.zipObjectDeep=fd,Z.zipWith=cd,Z.entries=bf,Z.entriesIn=mf,Z.extend=hf,Z.extendWith=ro,sa(Z,Z),Z.add=lp,Z.attempt=wf,Z.camelCase=p0,Z.capitalize=gf,Z.ceil=dp,Z.clamp=l0,Z.clone=th,Z.cloneDeep=ih,Z.cloneDeepWith=oh,Z.cloneWith=nh,Z.conformsTo=ah,Z.deburr=vf,Z.defaultTo=z0,Z.divide=hp,Z.endsWith=y0,Z.eq=fn,Z.escape=b0,Z.escapeRegExp=m0,Z.every=_d,Z.find=xd,Z.findIndex=Ks,Z.findKey=Nh,Z.findLast=$d,Z.findLastIndex=zs,Z.findLastKey=Lh,Z.floor=pp,Z.forEach=Qs,Z.forEachRight=Js,Z.forIn=jh,Z.forInRight=qh,Z.forOwn=Uh,Z.forOwnRight=zh,Z.get=ra,Z.gt=fh,Z.gte=ch,Z.has=Wh,Z.hasIn=na,Z.head=Gs,Z.identity=zr,Z.includes=Pd,Z.indexOf=xl,Z.inRange=d0,Z.invoke=Qh,Z.isArguments=jn,Z.isArray=Gt,Z.isArrayBuffer=uh,Z.isArrayLike=Ur,Z.isArrayLikeObject=Cr,Z.isBoolean=lh,Z.isBuffer=Dn,Z.isDate=hh,Z.isElement=ph,Z.isEmpty=yh,Z.isEqual=bh,Z.isEqualWith=mh,Z.isError=ea,Z.isFinite=gh,Z.isFunction=_n,Z.isInteger=af,Z.isLength=eo,Z.isMap=sf,Z.isMatch=vh,Z.isMatchWith=_h,Z.isNaN=wh,Z.isNative=xh,Z.isNil=Eh,Z.isNull=$h,Z.isNumber=ff,Z.isObject=Er,Z.isObjectLike=Sr,Z.isPlainObject=pi,Z.isRegExp=ta,Z.isSafeInteger=Sh,Z.isSet=cf,Z.isString=to,Z.isSymbol=Vr,Z.isTypedArray=Xn,Z.isUndefined=Ah,Z.isWeakMap=Ch,Z.isWeakSet=Ph,Z.join=Cl,Z.kebabCase=g0,Z.last=nn,Z.lastIndexOf=Pl,Z.lowerCase=_0,Z.lowerFirst=w0,Z.lt=kh,Z.lte=Mh,Z.max=yp,Z.maxBy=bp,Z.mean=mp,Z.meanBy=gp,Z.min=vp,Z.minBy=_p,Z.stubArray=ca,Z.stubFalse=ua,Z.stubObject=op,Z.stubString=ap,Z.stubTrue=sp,Z.multiply=wp,Z.nth=kl,Z.noConflict=J0,Z.noop=fa,Z.now=Ji,Z.pad=x0,Z.padEnd=$0,Z.padStart=E0,Z.parseInt=S0,Z.random=h0,Z.reduce=Id,Z.reduceRight=Rd,Z.repeat=A0,Z.replace=C0,Z.result=n0,Z.round=xp,Z.runInContext=xe,Z.sample=Od,Z.size=Ld,Z.snakeCase=P0,Z.some=jd,Z.sortedIndex=Fl,Z.sortedIndexBy=Nl,Z.sortedIndexOf=Ll,Z.sortedLastIndex=jl,Z.sortedLastIndexBy=ql,Z.sortedLastIndexOf=Ul,Z.startCase=M0,Z.startsWith=D0,Z.subtract=$p,Z.sum=Ep,Z.sumBy=Sp,Z.template=T0,Z.times=fp,Z.toFinite=wn,Z.toInteger=Wt,Z.toLength=lf,Z.toLower=I0,Z.toNumber=on,Z.toSafeInteger=Dh,Z.toString=pr,Z.toUpper=R0,Z.trim=B0,Z.trimEnd=O0,Z.trimStart=F0,Z.truncate=N0,Z.unescape=L0,Z.uniqueId=up,Z.upperCase=j0,Z.upperFirst=ia,Z.each=Qs,Z.eachRight=Js,Z.first=Gs,sa(Z,function(){var l={};return un(Z,function(y,x){br.call(Z.prototype,x)||(l[x]=y)}),l}(),{chain:!1}),Z.VERSION=i,Xr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){Z[l].placeholder=Z}),Xr(["drop","take"],function(l,y){tr.prototype[l]=function(x){x=x===t?1:Dr(Wt(x),0);var T=this.__filtered__&&!y?new tr(this):this.clone();return T.__filtered__?T.__takeCount__=Br(x,T.__takeCount__):T.__views__.push({size:Br(x,B),type:l+(T.__dir__<0?"Right":"")}),T},tr.prototype[l+"Right"]=function(x){return this.reverse()[l](x).reverse()}}),Xr(["filter","map","takeWhile"],function(l,y){var x=y+1,T=x==w||x==I;tr.prototype[l]=function(G){var ne=this.clone();return ne.__iteratees__.push({iteratee:Bt(G,3),type:x}),ne.__filtered__=ne.__filtered__||T,ne}}),Xr(["head","last"],function(l,y){var x="take"+(y?"Right":"");tr.prototype[l]=function(){return this[x](1).value()[0]}}),Xr(["initial","tail"],function(l,y){var x="drop"+(y?"":"Right");tr.prototype[l]=function(){return this.__filtered__?new tr(this):this[x](1)}}),tr.prototype.compact=function(){return this.filter(zr)},tr.prototype.find=function(l){return this.filter(l).head()},tr.prototype.findLast=function(l){return this.reverse().find(l)},tr.prototype.invokeMap=Yt(function(l,y){return typeof l=="function"?new tr(this):this.map(function(x){return fi(x,l,y)})}),tr.prototype.reject=function(l){return this.filter(Zi(Bt(l)))},tr.prototype.slice=function(l,y){l=Wt(l);var x=this;return x.__filtered__&&(l>0||y<0)?new tr(x):(l<0?x=x.takeRight(-l):l&&(x=x.drop(l)),y!==t&&(y=Wt(y),x=y<0?x.dropRight(-y):x.take(y-l)),x)},tr.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},tr.prototype.toArray=function(){return this.take(B)},un(tr.prototype,function(l,y){var x=/^(?:filter|find|map|reject)|While$/.test(y),T=/^(?:head|last)$/.test(y),G=Z[T?"take"+(y=="last"?"Right":""):y],ne=T||/^find/.test(y);G&&(Z.prototype[y]=function(){var ue=this.__wrapped__,me=T?[1]:arguments,Ee=ue instanceof tr,Ue=me[0],Ke=Ee||Gt(ue),We=function(Zt){var rr=G.apply(Z,En([Zt],me));return T&&ut?rr[0]:rr};Ke&&x&&typeof Ue=="function"&&Ue.length!=1&&(Ee=Ke=!1);var ut=this.__chain__,wt=!!this.__actions__.length,Ft=ne&&!ut,Vt=Ee&&!wt;if(!ne&&Ke){ue=Vt?ue:new tr(this);var Nt=l.apply(ue,me);return Nt.__actions__.push({func:Yi,args:[We],thisArg:t}),new en(Nt,ut)}return Ft&&Vt?l.apply(this,me):(Nt=this.thru(We),Ft?T?Nt.value()[0]:Nt.value():Nt)})}),Xr(["pop","push","shift","sort","splice","unshift"],function(l){var y=wi[l],x=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",T=/^(?:pop|shift)$/.test(l);Z.prototype[l]=function(){var G=arguments;if(T&&!this.__chain__){var ne=this.value();return y.apply(Gt(ne)?ne:[],G)}return this[x](function(ue){return y.apply(Gt(ue)?ue:[],G)})}}),un(tr.prototype,function(l,y){var x=Z[y];if(x){var T=x.name+"";br.call(Wn,T)||(Wn[T]=[]),Wn[T].push({name:y,func:x})}}),Wn[Ui(t,D).name]=[{name:"wrapper",func:t}],tr.prototype.clone=Ic,tr.prototype.reverse=Rc,tr.prototype.value=Bc,Z.prototype.at=ld,Z.prototype.chain=dd,Z.prototype.commit=hd,Z.prototype.next=pd,Z.prototype.plant=bd,Z.prototype.reverse=md,Z.prototype.toJSON=Z.prototype.valueOf=Z.prototype.value=gd,Z.prototype.first=Z.prototype.head,ti&&(Z.prototype[ti]=yd),Z},zn=lc();Tn?((Tn.exports=zn)._=zn,oo._=zn):Ir._=zn}).call(commonjsGlobal)})(lodash,lodash.exports);var lodashExports=lodash.exports,__extends$4=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var a in o)o.hasOwnProperty(a)&&(i[a]=o[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate$5=commonjsGlobal&&commonjsGlobal.__decorate||function(n,e,t,i){var o=arguments.length,a=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(o<3?c(a):o>3?c(e,t,a):c(e,t))||a);return o>3&&a&&Object.defineProperty(e,t,a),a},__metadata$5=commonjsGlobal&&commonjsGlobal.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},__param$3=commonjsGlobal&&commonjsGlobal.__param||function(n,e){return function(t,i){e(t,i,n)}},__generator$1=commonjsGlobal&&commonjsGlobal.__generator||function(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,o,a,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(p){return function(h){return d([p,h])}}function d(p){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(a=p[0]&2?o.return:p[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,p[1])).done)return a;switch(o=0,a&&(p=[p[0]&2,a.value]),p[0]){case 0:case 1:a=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!a||p[1]>a[0]&&p[1]<a[3])){t.label=p[1];break}if(p[0]===6&&t.label<a[1]){t.label=a[1],a=p;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(p);break}a[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(h){p=[6,h],o=0}finally{i=a=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},__importDefault$5=commonjsGlobal&&commonjsGlobal.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(topk,"__esModule",{value:!0});var base_filter_1$4=__importDefault$5(baseFilter),count_min_sketch_1$1=__importDefault$5(countMinSketch),exportable_1$5=exportable,lodash_1$2=lodashExports,MinHeap=function(){function n(){this._content=[]}return Object.defineProperty(n.prototype,"length",{get:function(){return this._content.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"content",{get:function(){return this._content},set:function(e){this._content=e},enumerable:!0,configurable:!0}),n.prototype.get=function(e){return this._content[e]},n.prototype.add=function(e){var t=lodash_1$2.sortedIndexBy(this._content,e,function(i){return i.frequency});this._content.splice(t,0,e)},n.prototype.remove=function(e){this._content.splice(e,1)},n.prototype.popMin=function(){return this._content.shift()},n.prototype.indexOf=function(e){return this._content.findIndex(function(t){return t.value===e})},n.prototype.clear=function(){this._content=[]},n}(),TopK=function(n){__extends$4(e,n);function e(t,i,o){var a=n.call(this)||this;return a._k=t,a._errorRate=i,a._accuracy=o,a._sketch=count_min_sketch_1$1.default.create(i,o),a._heap=new MinHeap,a}return e.prototype.add=function(t){this._sketch.update(t);var i=this._sketch.count(t);if(this._heap.length<this._k||i>=this._heap.get(0).frequency){var o=this._heap.indexOf(t);o>-1&&this._heap.remove(o),this._heap.add({value:t,frequency:i}),this._heap.length>this._k&&this._heap.popMin()}},e.prototype.clear=function(){this._sketch=count_min_sketch_1$1.default.create(this._errorRate,this._accuracy),this._heap.clear()},e.prototype.values=function(){for(var t=[],i=this._heap.length-1;i>=0;i--){var o=this._heap.get(i);t.push({value:o.value,frequency:o.frequency,rank:this._heap.length-i})}return t},e.prototype.iterator=function(){var t=this._heap;return function(){var i,o;return __generator$1(this,function(a){switch(a.label){case 0:i=t.length-1,a.label=1;case 1:return i>=0?(o=t.get(i),[4,{value:o.value,frequency:o.frequency,rank:t.length-i}]):[3,4];case 2:a.sent(),a.label=3;case 3:return i--,[3,1];case 4:return[2]}})}()},__decorate$5([exportable_1$5.Field(),__metadata$5("design:type",Number)],e.prototype,"_k",void 0),__decorate$5([exportable_1$5.Field(),__metadata$5("design:type",Number)],e.prototype,"_errorRate",void 0),__decorate$5([exportable_1$5.Field(),__metadata$5("design:type",Number)],e.prototype,"_accuracy",void 0),__decorate$5([exportable_1$5.Field(),__metadata$5("design:type",count_min_sketch_1$1.default)],e.prototype,"_sketch",void 0),__decorate$5([exportable_1$5.Field(function(t){return t.content},function(t){var i=new MinHeap;return i.content=t,i}),__metadata$5("design:type",MinHeap)],e.prototype,"_heap",void 0),e=__decorate$5([exportable_1$5.AutoExportable("TopK",["_seed"]),__param$3(0,exportable_1$5.Parameter("_k")),__param$3(1,exportable_1$5.Parameter("_errorRate")),__param$3(2,exportable_1$5.Parameter("_accuracy")),__metadata$5("design:paramtypes",[Number,Number,Number])],e),e}(base_filter_1$4.default);topk.default=TopK;var minHash={},__extends$3=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var a in o)o.hasOwnProperty(a)&&(i[a]=o[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate$4=commonjsGlobal&&commonjsGlobal.__decorate||function(n,e,t,i){var o=arguments.length,a=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(o<3?c(a):o>3?c(e,t,a):c(e,t))||a);return o>3&&a&&Object.defineProperty(e,t,a),a},__metadata$4=commonjsGlobal&&commonjsGlobal.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},__param$2=commonjsGlobal&&commonjsGlobal.__param||function(n,e){return function(t,i){e(t,i,n)}},__read=commonjsGlobal&&commonjsGlobal.__read||function(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),o,a=[],c;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(u){c={error:u}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(c)throw c.error}}return a},__spread=commonjsGlobal&&commonjsGlobal.__spread||function(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(__read(arguments[e]));return n},__importDefault$4=commonjsGlobal&&commonjsGlobal.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(minHash,"__esModule",{value:!0});var base_filter_1$3=__importDefault$4(baseFilter),exportable_1$4=exportable,utils_1$3=utils$3,lodash_1$1=lodashExports,EmptyMinHashError=function(n){__extends$3(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Error);function applyHashFunction(n,e){return(e.a*n+e.b)%e.c}var MinHash=function(n){__extends$3(e,n);function e(t,i){var o=n.call(this)||this;return o._nbHashes=t,o._hashFunctions=i,o._signature=utils_1$3.allocateArray(o._nbHashes,1/0),o}return Object.defineProperty(e.prototype,"nbHashes",{get:function(){return this._nbHashes},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this._signature[0]===1/0},e.prototype.add=function(t){for(var i=0;i<this._nbHashes;i++)this._signature[i]=Math.min(this._signature[i],applyHashFunction(t,this._hashFunctions[i]))},e.prototype.bulkLoad=function(t){for(var i=this,o=function(u){var d=t.map(function(p){return applyHashFunction(p,i._hashFunctions[u])});a._signature[u]=Math.min.apply(Math,__spread([a._signature[u]],d))},a=this,c=0;c<this._nbHashes;c++)o(c)},e.prototype.compareWith=function(t){if(this.isEmpty()||t.isEmpty())throw new EmptyMinHashError("Cannot compute a Jaccard similairty with a MinHash that contains no values");return lodash_1$1.intersection(this._signature,t._signature).length/this._nbHashes},__decorate$4([exportable_1$4.Field(),__metadata$4("design:type",Number)],e.prototype,"_nbHashes",void 0),__decorate$4([exportable_1$4.Field(),__metadata$4("design:type",Array)],e.prototype,"_hashFunctions",void 0),__decorate$4([exportable_1$4.Field(),__metadata$4("design:type",Array)],e.prototype,"_signature",void 0),e=__decorate$4([exportable_1$4.AutoExportable("MinHash",["_seed"]),__param$2(0,exportable_1$4.Parameter("_nbHashes")),__param$2(1,exportable_1$4.Parameter("_hashFunctions")),__metadata$4("design:paramtypes",[Number,Array])],e),e}(base_filter_1$3.default);minHash.MinHash=MinHash;var minHashFactory={};Object.defineProperty(minHashFactory,"__esModule",{value:!0});var min_hash_1$1=minHash,lodash_1=lodashExports;function isPrime(n){if(n!==2&&n%2===0)return!1;for(var e=2;e<Math.sqrt(n);e++)if(n%e===0)return!1;return!0}function closestPrime(n){for(var e=0;;){if(isPrime(n+e))return n+e;e++}}var MinHashFactory=function(){function n(e,t){this._nbHashes=e,this._maxValue=t,this._hashFunctions=[];for(var i=closestPrime(this._maxValue),o=0;o<this._nbHashes;o++){var a=lodash_1.random(0,this._maxValue,!1),c=lodash_1.random(0,this._maxValue,!1);this._hashFunctions.push({a,b:c,c:i})}}return n.prototype.create=function(){return new min_hash_1$1.MinHash(this._nbHashes,this._hashFunctions)},n}();minHashFactory.default=MinHashFactory;var cuckooFilter={},bucket={};function eq(n,e){return n===e||n!==n&&e!==e}var lodash_eq=eq,INFINITY=1/0,MAX_INTEGER=17976931348623157e292,NAN=0/0,symbolTag="[object Symbol]",reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function baseFindIndex(n,e,t,i){for(var o=n.length,a=t+(i?1:-1);i?a--:++a<o;)if(e(n[a],a,n))return a;return-1}function baseIndexOf(n,e,t){if(e!==e)return baseFindIndex(n,baseIsNaN,t);for(var i=t-1,o=n.length;++i<o;)if(n[i]===e)return i;return-1}function baseIsNaN(n){return n!==n}var objectProto=Object.prototype,objectToString=objectProto.toString,nativeMax=Math.max;function indexOf(n,e,t){var i=n?n.length:0;if(!i)return-1;var o=t==null?0:toInteger(t);return o<0&&(o=nativeMax(i+o,0)),baseIndexOf(n,e,o)}function isObject(n){var e=typeof n;return!!n&&(e=="object"||e=="function")}function isObjectLike(n){return!!n&&typeof n=="object"}function isSymbol(n){return typeof n=="symbol"||isObjectLike(n)&&objectToString.call(n)==symbolTag}function toFinite(n){if(!n)return n===0?n:0;if(n=toNumber(n),n===INFINITY||n===-INFINITY){var e=n<0?-1:1;return e*MAX_INTEGER}return n===n?n:0}function toInteger(n){var e=toFinite(n),t=e%1;return e===e?t?e-t:e:0}function toNumber(n){if(typeof n=="number")return n;if(isSymbol(n))return NAN;if(isObject(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=isObject(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=n.replace(reTrim,"");var t=reIsBinary.test(n);return t||reIsOctal.test(n)?freeParseInt(n.slice(2),t?2:8):reIsBadHex.test(n)?NAN:+n}var lodash_indexof=indexOf,__decorate$3=commonjsGlobal&&commonjsGlobal.__decorate||function(n,e,t,i){var o=arguments.length,a=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(o<3?c(a):o>3?c(e,t,a):c(e,t))||a);return o>3&&a&&Object.defineProperty(e,t,a),a},__metadata$3=commonjsGlobal&&commonjsGlobal.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},__importDefault$3=commonjsGlobal&&commonjsGlobal.__importDefault||function(n){return n&&n.__esModule?n:{default:n}},__importStar=commonjsGlobal&&commonjsGlobal.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e};Object.defineProperty(bucket,"__esModule",{value:!0});var lodash_eq_1=__importDefault$3(lodash_eq),lodash_indexof_1=__importDefault$3(lodash_indexof),utils$1=__importStar(utils$3),exportable_1$3=exportable,exportable_2=exportable,Bucket=function(){function n(t){this._elements=utils$1.allocateArray(t,null),this._size=t,this._length=0}e=n,Object.defineProperty(n.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),n.prototype.isFree=function(){return this._length<this._size},n.prototype.nextEmptySlot=function(){return lodash_indexof_1.default(this._elements,null)},n.prototype.at=function(t){return this._elements[t]},n.prototype.add=function(t){return t===null||!this.isFree()?!1:(this.set(this.nextEmptySlot(),t),this._length++,!0)},n.prototype.remove=function(t){var i=lodash_indexof_1.default(this._elements,t);return i<=-1?!1:(this.unset(i),!0)},n.prototype.has=function(t){return lodash_indexof_1.default(this._elements,t)>-1},n.prototype.set=function(t,i){this._elements[t]=i},n.prototype.unset=function(t){this._elements[t]=null,this._length--},n.prototype.swapRandom=function(t,i){i===void 0&&(i=Math.random);var o=utils$1.randomInt(0,this._length-1,i),a=this._elements[o];return this._elements[o]=t,a},n.prototype.swap=function(t,i){var o=this._elements[t];return this._elements[t]=i,o},n.prototype.equals=function(t){return this._size!==t.size||this._length!==t.length?!1:this._elements.every(function(i,o){return lodash_eq_1.default(t.at(o),i)})};var e;return n=e=__decorate$3([exportable_1$3.Exportable({export:exportable_2.cloneObject("Bucket","_size","_elements"),import:function(t){if(t.type!=="Bucket"||"_size"in t,!("_elements"in t))throw new Error("Cannot create a Bucket from a JSON export which does not represent a bucket");var i=new e(t._size);return t._elements.forEach(function(o,a){o!==null&&(i._elements[a]=o,i._length++)}),i}}),__metadata$3("design:paramtypes",[Number])],n),n}();bucket.default=Bucket;var __extends$2=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var a in o)o.hasOwnProperty(a)&&(i[a]=o[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate$2=commonjsGlobal&&commonjsGlobal.__decorate||function(n,e,t,i){var o=arguments.length,a=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(o<3?c(a):o>3?c(e,t,a):c(e,t))||a);return o>3&&a&&Object.defineProperty(e,t,a),a},__metadata$2=commonjsGlobal&&commonjsGlobal.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},__importDefault$2=commonjsGlobal&&commonjsGlobal.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(cuckooFilter,"__esModule",{value:!0});var base_filter_1$2=__importDefault$2(baseFilter),bucket_1=__importDefault$2(bucket),exportable_1$2=exportable,utils_1$2=utils$3;function computeFingerpintLength(n,e){var t=Math.ceil(Math.log2(1/e)+Math.log2(2*n));return Math.ceil(t/4)}var CuckooFilter=function(n){__extends$2(e,n);function e(i,o,a,c){c===void 0&&(c=500);var u=n.call(this)||this;return u._filter=utils_1$2.allocateArray(i,function(){return new bucket_1.default(a)}),u._size=i,u._bucketSize=a,u._fingerprintLength=o,u._length=0,u._maxKicks=c,u}t=e,e.create=function(i,o,a,c){a===void 0&&(a=4),c===void 0&&(c=500);var u=computeFingerpintLength(a,o),d=Math.ceil(i/a/.955);return new t(d,u,a,c)},e.from=function(i,o,a,c){a===void 0&&(a=4),c===void 0&&(c=500);var u=Array.from(i),d=t.create(u.length,o,a,c);return u.forEach(function(p){return d.add(p)}),d},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullSize",{get:function(){return this.size*this.bucketSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fingerprintLength",{get:function(){return this._fingerprintLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bucketSize",{get:function(){return this._bucketSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxKicks",{get:function(){return this._maxKicks},enumerable:!0,configurable:!0}),e.prototype.add=function(i,o,a){o===void 0&&(o=!1),a===void 0&&(a=!1);var c=this._locations(i);if(this._filter[c.firstIndex].isFree())this._filter[c.firstIndex].add(c.fingerprint);else if(this._filter[c.secondIndex].isFree())this._filter[c.secondIndex].add(c.fingerprint);else{for(var u=this.random()<.5?c.firstIndex:c.secondIndex,d=c.fingerprint,p=[],h=0;h<this._maxKicks;h++){var b=utils_1$2.randomInt(0,this._filter[u].length-1,this.random),m=this._filter[u].at(b);p.push([u,b,m]),this._filter[u].set(b,d),d=m;var v=utils_1$2.hashAsInt(d,this.seed,64);if(u=Math.abs(u^Math.abs(v))%this._filter.length,this._filter[u].isFree())return this._filter[u].add(d),this._length++,!0}if(!a)for(var _=p.length-1;_>=0;_--){var $=p[_];this._filter[$[0]].set($[1],$[2])}if(o)throw new Error('The Cuckoo Filter is full, cannot insert element "'+i+'"');return!1}return this._length++,!0},e.prototype.remove=function(i){var o=this._locations(i);return this._filter[o.firstIndex].has(o.fingerprint)?(this._filter[o.firstIndex].remove(o.fingerprint),this._length--,!0):this._filter[o.secondIndex].has(o.fingerprint)?(this._filter[o.secondIndex].remove(o.fingerprint),this._length--,!0):!1},e.prototype.has=function(i){var o=this._locations(i);return this._filter[o.firstIndex].has(o.fingerprint)||this._filter[o.secondIndex].has(o.fingerprint)},e.prototype.rate=function(){var i=this._computeHashTableLoad(),o=this._fingerprintLength/i.load;return Math.pow(2,Math.log2(2*this._bucketSize)-i.load*o)},e.prototype._computeHashTableLoad=function(){var i=this._filter.length*this._bucketSize,o=this._filter.reduce(function(a,c){return a+c.length},0);return{used:o,free:i-o,size:i,load:o/i}},e.prototype._locations=function(i){var o=utils_1$2.hashIntAndString(i,this.seed,16,64),a=o.int;if(this._fingerprintLength>o.string.length)throw new Error("The fingerprint length ("+this._fingerprintLength+") is higher than the hash length ("+o.string.length+"). Please reduce the fingerprint length or report if it is an unexpected behavior.");var c=o.string.substring(0,this._fingerprintLength),u=Math.abs(a),d=Math.abs(utils_1$2.hashAsInt(c,this.seed,64)),p=Math.abs(u^d),h={fingerprint:c,firstIndex:u%this._size,secondIndex:p%this._size};return h},e.prototype.equals=function(i){for(var o=0,a=!0;a&&o<this._filter.length;){var c=this._filter[o];i._filter[o].equals(c)||(a=!1),o++}return a};var t;return e=t=__decorate$2([exportable_1$2.Exportable({export:exportable_1$2.cloneObject("CuckooFilter","_size","_fingerprintLength","_length","_maxKicks","_filter","_seed"),import:function(i){if(i.type!=="CuckooFilter"||!("_size"in i)||!("_fingerprintLength"in i)||!("_length"in i)||!("_maxKicks"in i)||!("_filter"in i)||!("_seed"in i))throw new Error("Cannot create a CuckooFilter from a JSON export which does not represent a cuckoo filter");var o=new t(i._size,i._fingerprintLength,i._bucketSize,i._maxKicks);return o._length=i._length,o._filter=i._filter.map(function(a){var c=new bucket_1.default(a._size);return a._elements.forEach(function(u,d){u!==null&&(c._elements[d]=u,c._length++)}),c}),o.seed=i.seed,o}}),__metadata$2("design:paramtypes",[Number,Number,Number,Number])],e),e}(base_filter_1$2.default);cuckooFilter.default=CuckooFilter;var invertibleBloomLookupTables={},cell={},__extends$1=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var a in o)o.hasOwnProperty(a)&&(i[a]=o[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate$1=commonjsGlobal&&commonjsGlobal.__decorate||function(n,e,t,i){var o=arguments.length,a=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(o<3?c(a):o>3?c(e,t,a):c(e,t))||a);return o>3&&a&&Object.defineProperty(e,t,a),a},__metadata$1=commonjsGlobal&&commonjsGlobal.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},__param$1=commonjsGlobal&&commonjsGlobal.__param||function(n,e){return function(t,i){e(t,i,n)}},__importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(cell,"__esModule",{value:!0});var buffer_1$1=buffer$2,utils_1$1=utils$3,exportable_1$1=exportable,base_filter_1$1=__importDefault$1(baseFilter),inspect=Symbol.for("nodejs.util.inspect.custom"),Cell=function(n){__extends$1(e,n);function e(i,o,a){var c=n.call(this)||this;return c._idSum=i,c._hashSum=o,c._count=a,c}t=e,e.empty=function(){return new t(buffer_1$1.Buffer.allocUnsafe(0).fill(0),buffer_1$1.Buffer.allocUnsafe(0).fill(0),0)},e.prototype[inspect]=function(){return"Cell:<"+JSON.stringify(this._idSum.toJSON().data)+", "+JSON.stringify(this._hashSum.toJSON().data)+", "+this._count+">"},Object.defineProperty(e.prototype,"idSum",{get:function(){return this._idSum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hashSum",{get:function(){return this._hashSum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),e.prototype.add=function(i,o){this._idSum=utils_1$1.xorBuffer(this._idSum,i),this._hashSum=utils_1$1.xorBuffer(this._hashSum,o),this._count++},e.prototype.xorm=function(i){return new t(utils_1$1.xorBuffer(this._idSum,i.idSum),utils_1$1.xorBuffer(this._hashSum,i.hashSum),this._count-i.count)},e.prototype.isEmpty=function(){return this._idSum.equals(buffer_1$1.Buffer.from(""))&&this._hashSum.equals(buffer_1$1.Buffer.from(""))&&this._count===0},e.prototype.equals=function(i){return this._count===i.count&&this._idSum.equals(i.idSum)&&this._hashSum.equals(i.hashSum)},e.prototype.isPure=function(){if(this.isEmpty()||this._count!==1&&this._count!==-1)return!1;var i=utils_1$1.hashTwiceAsString(JSON.stringify(this._idSum.toJSON()),this.seed);return this._hashSum.equals(buffer_1$1.Buffer.from(i.first))};var t;return __decorate$1([exportable_1$1.Field(function(i){return i.toString()},buffer_1$1.Buffer.from),__metadata$1("design:type",Object)],e.prototype,"_idSum",void 0),__decorate$1([exportable_1$1.Field(function(i){return i.toString()},buffer_1$1.Buffer.from),__metadata$1("design:type",Object)],e.prototype,"_hashSum",void 0),__decorate$1([exportable_1$1.Field(),__metadata$1("design:type",Number)],e.prototype,"_count",void 0),e=t=__decorate$1([exportable_1$1.AutoExportable("Cell",["_seed"]),__param$1(0,exportable_1$1.Parameter("_idSum")),__param$1(1,exportable_1$1.Parameter("_hashSum")),__param$1(2,exportable_1$1.Parameter("_count")),__metadata$1("design:paramtypes",[Object,Object,Number])],e),e}(base_filter_1$1.default);cell.default=Cell;var __extends=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var a in o)o.hasOwnProperty(a)&&(i[a]=o[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),__decorate=commonjsGlobal&&commonjsGlobal.__decorate||function(n,e,t,i){var o=arguments.length,a=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var u=n.length-1;u>=0;u--)(c=n[u])&&(a=(o<3?c(a):o>3?c(e,t,a):c(e,t))||a);return o>3&&a&&Object.defineProperty(e,t,a),a},__metadata=commonjsGlobal&&commonjsGlobal.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},__param=commonjsGlobal&&commonjsGlobal.__param||function(n,e){return function(t,i){e(t,i,n)}},__generator=commonjsGlobal&&commonjsGlobal.__generator||function(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,o,a,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(p){return function(h){return d([p,h])}}function d(p){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(a=p[0]&2?o.return:p[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,p[1])).done)return a;switch(o=0,a&&(p=[p[0]&2,a.value]),p[0]){case 0:case 1:a=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!a||p[1]>a[0]&&p[1]<a[3])){t.label=p[1];break}if(p[0]===6&&t.label<a[1]){t.label=a[1],a=p;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(p);break}a[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(h){p=[6,h],o=0}finally{i=a=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},__importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(invertibleBloomLookupTables,"__esModule",{value:!0});var buffer_1=buffer$2,base_filter_1=__importDefault(baseFilter),cell_1$1=__importDefault(cell),exportable_1=exportable,utils_1=utils$3,formulas_1=formulas,InvertibleBloomFilter=function(n){__extends(e,n);function e(i,o){o===void 0&&(o=3);var a=n.call(this)||this;if(buffer_1.Buffer===void 0)throw new Error('No native Buffer implementation bound in your JavaScript env. If you are in a Web browser, consider importing the polyfill "feross/buffer" (https://github.com/feross/buffer).');if(o<=0)throw new Error("The hashCount must be a non-zero, positive integer");return a._size=i,a._hashCount=o,a._elements=utils_1.allocateArray(a._size,function(){return cell_1$1.default.empty()}),a}t=e,e.create=function(i,o){var a=formulas_1.optimalFilterSize(i,o),c=formulas_1.optimalHashes(a,i);return new t(a,c)},e.from=function(i,o){var a=Array.from(i),c=t.create(a.length,o);return a.forEach(function(u){return c.add(u)}),c},Object.defineProperty(e.prototype,"hashCount",{get:function(){return this._hashCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._elements.reduce(function(i,o){return i+o.count},0)/this._hashCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elements",{get:function(){return this._elements},enumerable:!0,configurable:!0}),e.prototype.add=function(i){for(var o=utils_1.allInOneHashTwice(JSON.stringify(i.toJSON()),this.seed),a=utils_1.getDistinctIndices(o.string.first,this._size,this._hashCount,this.seed),c=0;c<this._hashCount;++c)this._elements[a[c]].add(i,buffer_1.Buffer.from(o.string.first))},e.prototype.remove=function(i){for(var o=utils_1.allInOneHashTwice(JSON.stringify(i.toJSON()),this.seed),a=utils_1.getDistinctIndices(o.string.first,this.size,this._hashCount,this.seed),c=0;c<this._hashCount;++c)this._elements[a[c]]=this._elements[a[c]].xorm(new cell_1$1.default(buffer_1.Buffer.from(i),buffer_1.Buffer.from(o.string.first),1));return!0},e.prototype.has=function(i){for(var o=utils_1.allInOneHashTwice(JSON.stringify(i.toJSON()),this.seed),a=utils_1.getDistinctIndices(o.string.first,this.size,this._hashCount,this.seed),c=0;c<this._hashCount;++c){if(this._elements[a[c]].count===0)return!1;if(this._elements[a[c]].count===1)return!!this._elements[a[c]].idSum.equals(i)}return!0},e.prototype.listEntries=function(){var i=this,o=[];return function(){var a,c,u;return __generator(this,function(d){switch(d.label){case 0:a=function(p){var h;return __generator(this,function(b){switch(b.label){case 0:return h=i._elements[p],h.count>0&&o.findIndex(function(m){return m.equals(h.idSum)})===-1?i.has(h.idSum)?(o.push(h.idSum),[4,h.idSum]):[3,2]:[3,3];case 1:return b.sent(),[3,3];case 2:return[2,{value:!1}];case 3:return[2]}})},c=0,d.label=1;case 1:return c<i._elements.length-1?[5,a(c)]:[3,4];case 2:if(u=d.sent(),typeof u=="object")return[2,u.value];d.label=3;case 3:return c++,[3,1];case 4:return[2,!0]}})}()},e.prototype.substract=function(i){if(this.size!==i.size)throw new Error("The two Invertible Bloom Filters must be of the same size");var o=new t(i._size,i._hashCount);o.seed=this.seed;for(var a=0;a<this.size;++a)o._elements[a]=this._elements[a].xorm(i._elements[a]);return o},e.prototype.equals=function(i){if(i._size!==this._size||i._hashCount!==this._hashCount||i.seed!==this.seed)return!1;for(var o=0;o<i._elements.length;++o)if(!i._elements[o].equals(this._elements[o]))return!1;return!0},e.prototype.decode=function(i,o){i===void 0&&(i=[]),o===void 0&&(o=[]);for(var a=[],c=null,u=0;u<this._elements.length;++u)c=this._elements[u],c.isPure()&&a.push(u);for(;a.length!==0;){c=this._elements[a.pop()];var d=c.idSum,p=c.count;if(c.isPure()){if(p===1)i.push(d);else if(p===-1)o.push(d);else throw new Error("Please report, not possible");for(var h=utils_1.allInOneHashTwice(JSON.stringify(d.toJSON()),this.seed),b=utils_1.getDistinctIndices(h.string.first,this._size,this._hashCount,this.seed),u=0;u<b.length;++u)this._elements[b[u]]=this._elements[b[u]].xorm(new cell_1$1.default(d,buffer_1.Buffer.from(h.string.first),p)),this._elements[b[u]].isPure()&&a.push(b[u])}}return this._elements.findIndex(function(m){return!m.isEmpty()})>-1?{success:!1,reason:{cell:c,iblt:this},additional:i,missing:o}:{success:!0,additional:i,missing:o}};var t;return __decorate([exportable_1.Field(),__metadata("design:type",Number)],e.prototype,"_size",void 0),__decorate([exportable_1.Field(),__metadata("design:type",Number)],e.prototype,"_hashCount",void 0),__decorate([exportable_1.Field(void 0,function(i){return i.map(function(o){var a=new cell_1$1.default(buffer_1.Buffer.from(o._idSum),buffer_1.Buffer.from(o._hashSum),o._count);return a.seed=o._seed,a})}),__metadata("design:type",Array)],e.prototype,"_elements",void 0),e=t=__decorate([exportable_1.AutoExportable("InvertibleBloomFilter",["_seed"]),__param(0,exportable_1.Parameter("_size")),__param(1,exportable_1.Parameter("_hashCount")),__metadata("design:paramtypes",[Number,Number])],e),e}(base_filter_1.default);invertibleBloomLookupTables.default=InvertibleBloomFilter;Object.defineProperty(api,"__esModule",{value:!0});var bloom_filter_1=bloomFilter,BloomFilter=api.BloomFilter=bloom_filter_1.default,counting_bloom_filter_1=countingBloomFilter;api.CountingBloomFilter=counting_bloom_filter_1.default;var partitioned_bloom_filter_1=partitionedBloomFilter;api.PartitionedBloomFilter=partitioned_bloom_filter_1.default;var count_min_sketch_1=countMinSketch;api.CountMinSketch=count_min_sketch_1.default;var hyperloglog_1=hyperloglog;api.HyperLogLog=hyperloglog_1.default;var topk_1=topk;api.TopK=topk_1.default;var min_hash_1=minHash;api.MinHash=min_hash_1.MinHash;var min_hash_factory_1=minHashFactory;api.MinHashFactory=min_hash_factory_1.default;var cuckoo_filter_1=cuckooFilter;api.CuckooFilter=cuckoo_filter_1.default;var invertible_bloom_lookup_tables_1=invertibleBloomLookupTables;api.InvertibleBloomFilter=invertible_bloom_lookup_tables_1.default;var cell_1=cell;api.Cell=cell_1.default;const FILTER_SIZE=1024,HASH_COUNT=16,SATURATION_THRESHOLD=320,createBare=async(n,e)=>{const t="0".repeat(FILTER_SIZE/4);return addToBare(n,t,legacyEncodingMistake(e,"base64pad"))},addToBare=async(n,e,t)=>{const i=fromHex(e),o=await n.hash.sha256(t);return i.add(toString$3(o,"hex")),await toHex(i)},addRevision=async(n,e,t,i)=>{const o=toString$3(t,"base64pad"),a=fromString$3(`${i}${o}`,"utf8");return await addToBare(n,e,a)},toPrivateName=async(n,e)=>{const t=await saturateFilter(n,fromHex(e));return toHash(n,t)},toHash=async(n,e)=>{const t=e.toBytes(),i=await n.hash.sha256(t);return fromBytes(i)},saturate=async(n,e,t=SATURATION_THRESHOLD)=>{const i=await saturateFilter(n,fromHex(e),t);return await toHex(i)},saturateFilter=async(n,e,t=SATURATION_THRESHOLD)=>{if(t>e.toBytes().byteLength*8)throw new Error("threshold is bigger than filter size");if(countOnes(e)>=t)return e;const o=e.toBytes();let a=o;do{const c=await n.hash.sha256(a);e.add(fromBytes(c)),a=c}while(bufEquals(o,e.toBytes()));return saturateFilter(n,e,t)},countOnes=n=>{const e=new Uint32Array(n.toBytes());let t=0;for(let i=0;i<e.length;i++)t+=bitCount32(e[i]);return t},toHex=n=>fromBytes(n.toBytes()),fromHex=n=>{const e=toBytes(n);return BloomFilter.fromBytes(e,HASH_COUNT)},bufEquals=(n,e)=>{if(n.byteLength!==e.byteLength)return!1;const t=new Uint8Array(n),i=new Uint8Array(e);for(let o=0;o<t.length;o++)if(t[o]!==i[o])return!1;return!0},bitCount32=n=>{const e=n-(n>>1&1431655765),t=(e&858993459)+(e>>2&858993459);return(t+(t>>4)&252645135)*16843009>>24};function legacyEncodingMistake(n,e){return fromString$3(toString$3(n,e),"utf8")}const addNode=async(n,e,t,i,o)=>{const{cid:a,size:c}=await putEncryptedFile(n,e,i,o),u=await addRevision(e,i.bareNameFilter,o,i.revision),d=await toPrivateName(e,u);if(await t.add(d,a),isPrivateFileInfo(i)){const b=fromString$3(i.key,"base64pad"),m=await addToBare(e,i.bareNameFilter,legacyEncodingMistake(b,"base64pad")),v=await addRevision(e,m,b,i.revision),_=await toPrivateName(e,v);await t.add(_,decodeCID(i.content))}const[p,h]=isPrivateFileInfo(i)?[{},!0]:[i.skeleton,!1];return{cid:a,name:d,key:o,size:c,isFile:h,skeleton:p}},readNode=async(n,e,t,i)=>{const o=await getEncryptedFile(n,e,t,i),a=JSON.parse(toString$3(o,"utf8"));if(!isDecryptedNode(a))throw new Error(`Could not parse a valid filesystem object: ${a}`);return a},getByName=async(n,e,t,i,o)=>{const a=await t.get(i);return a===null?null:getByCID(n,e,a,o)},getByCID=async(n,e,t,i)=>await readNode(n,e,t,i),getLatestByName=async(n,e,t,i,o)=>{const a=await t.get(i);return a===null?null:getLatestByCID(n,e,t,a,o)},getLatestByCID=async(n,e,t,i,o)=>{const a=await getByCID(n,e,i,o),c=await findLatestRevision(e,t,a.bareNameFilter,o,a.revision);return c?.cid?await getByCID(n,e,decodeCID(c?.cid),o):a},getLatestByBareNameFilter=async(n,e,t,i,o)=>{const a=await addRevision(e,i,o,1),c=await toPrivateName(e,a);return getLatestByName(n,e,t,c,o)},findLatestRevision=async(n,e,t,i,o)=>{let a=o,c=null,u=0,d=null;for(;c===null;){const p=o+Math.pow(2,u),h=await getRevision(n,e,t,i,p);h!==null?(d=h,a=p):c=p,u++}for(;a<c-1;){const p=Math.floor((c+a)/2),h=await getRevision(n,e,t,i,p);h!==null?(d=h,a=p):c=p}return d},getRevision=async(n,e,t,i,o)=>{const a=await addRevision(n,t,i,o),c=await toPrivateName(n,a),u=await e.get(c);return u?{cid:u,name:c,number:o}:null};async function namefilter(n,{bareFilter:e,shareKey:t}){const i=await n.hash.sha256(fromString$3(t,"base64pad"));return saturate(n,await addToBare(n,e,legacyEncodingMistake(i,"hex")))}async function create$2(n,{counter:e,recipientExchangeDid:t,senderRootDid:i}){const o=fromString$3(`${t}${i}${e}`,"utf8");return toString$3(await n.hash.sha256(o),"base64pad")}function payload({entryIndexCid:n,symmKey:e,symmKeyAlgo:t}){const i=n;return{algo:t,key:typeof e=="string"?fromString$3(e,"base64pad"):e,cid:i}}class BaseFile{constructor(e){this.content=e,this.readOnly=!1}async put(){const{cid:e}=await this.putDetailed();return e}async updateContent(e){if(this.readOnly)throw new Error("File is read-only");return this.content=e,this}}class BareFile extends BaseFile{constructor(e,t){super(t),this.depot=e}static create(e,t){return new BareFile(e,t)}static async fromCID(e,t){const i=await getFile(e,t);return new BareFile(e,i)}static instanceOf(e){return isObject$1(e)&&hasProp(e,"content")}async put(){const{cid:e}=await this.putDetailed();return e}async putDetailed(){return putFile$1(this.depot,this.content)}}class BaseTree{constructor(){this.readOnly=!1}async put(){const{cid:e}=await this.putDetailed();return e}async ls(e){const t=await this.get(e);if(t===null)throw new Error("Path does not exist");if(isFile(t))throw new Error("Can not `ls` a file");return t.getLinks()}async cat(e){const t=await this.get(e);if(t===null)throw new Error("Path does not exist");if(!isFile(t))throw new Error("Can not `cat` a directory");return t.content}async mkdir(e){return this.mkdirRecurse(e,()=>this.put())}async mkdirRecurse(e,t){const[i,...o]=e;if(!i)throw new Error("Invalid path: empty");const a=await this.getOrCreateDirectChild(i,t);if(isFile(a))throw new Error(`There is a file along the given path: ${log$8(e)}`);return o.length&&await a.mkdirRecurse(o,()=>this.updateDirectChild(a,i,t)),this}async add(e,t){return await this.addRecurse(e,t,()=>this.put()),this}async addRecurse(e,t,i){const[o,...a]=e;if(!o)throw new Error("Invalid path: empty");if(a.length===0)await this.createOrUpdateChildFile(t,o,i);else{const c=await this.getOrCreateDirectChild(o,i);if(isFile(c))throw new Error(`There is a file along the given path: ${log$8(e)}`);await c.addRecurse(a,t,async()=>{await this.updateDirectChild(c,o,i)})}return this}async rm(e){return await this.rmRecurse(e,()=>this.put()),this}async rmRecurse(e,t){const[i,...o]=e;if(!i)throw new Error("Invalid path: empty");if(o.length===0)this.removeDirectChild(i),t&&await t();else{const a=await this.getDirectChild(i);if(a===null)throw new Error("Invalid path: does not exist");if(isFile(a))throw new Error(`There is a file along the given path: ${log$8(e)}`);await a.rmRecurse(o,async()=>{await this.updateDirectChild(a,i,t)})}return this}async mv(e,t){const i=await this.get(e);if(i===null)throw new Error(`Path does not exist: ${log$8(e)}`);if(t.length<1)throw new Error(`Path does not exist: ${log$8(t)}`);const o=t.slice(0,-1);let a=await this.get(o);if(!a)await this.mkdir(o),a=await this.get(o);else if(isFile(a))throw new Error(`Can not \`mv\` to a file: ${log$8(o)}`);return await this.rm(e),await[...t].reverse().reduce((c,u,d)=>c.then(async p=>{const h=t.slice(0,-(d+1)),b=h.length?await this.get(h):this;if(b&&!isFile(b))return await b.updateDirectChild(p,u,null),b;throw new Error("Failed to update tree while moving node")}),Promise.resolve(i)),this}async exists(e){return await this.get(e)!==null}read(e){return this.get(e)}write(e,t){return this.add(e,t)}async getOrCreateDirectChild(e,t){const i=await this.getDirectChild(e);return i!==null?i:this.createChildTree(e,t)}async updateChild(e,t){const i=[];return await t.reduce(async(o,a,c)=>{const u=await o;if(i.push([a,u]),c+1===t.length)return u;const d=await u.getDirectChild(a);if(!isTree(d)){const p=t.slice(c+1);throw new Error(`Expected a tree at the given path: ${log$8(p)}`)}return d},Promise.resolve(this)),await i.reverse().reduce(async(o,[a,c])=>(await c.updateDirectChild(await o,a,null),c),Promise.resolve(e)),this}}class BareTree extends BaseTree{constructor(e,t){super(),this.type="BareTree",this.links=t,this.children={},this.depot=e}static async empty(e){return new BareTree(e,{})}static async fromCID(e,t){const i=arrToMap(await e.getUnixDirectory(t));return new BareTree(e,i)}static fromLinks(e,t){return new BareTree(e,t)}static instanceOf(e){return isObject$1(e)&&hasProp(e,"links")&&hasProp(e,"children")&&hasProp(e,"type")&&e.type==="BareTree"}async createChildTree(e,t){const i=await BareTree.empty(this.depot),o=this.children[e];if(o){if(isFile(o))throw new Error(`There is a file at the given path: ${e}`);return o}return await this.updateDirectChild(i,e,t),i}async createOrUpdateChildFile(e,t,i){const o=await this.getDirectChild(t);let a;if(o===null)a=await BareFile.create(this.depot,e);else if(BareFile.instanceOf(o))a=await o.updateContent(e);else throw new Error(`There is already a directory with that name: ${t}`);return await this.updateDirectChild(a,t,i),a}async putDetailed(){return putLinks(this.depot,this.links)}async putAndUpdateLink(e,t,i){const o=await e.putDetailed();return this.updateLink(t,o),i&&await i(),this}async updateDirectChild(e,t,i){return this.children[t]=e,this.putAndUpdateLink(e,t,i)}removeDirectChild(e){return delete this.links[e],this.children[e]&&delete this.children[e],this}async getDirectChild(e){if(this.children[e])return this.children[e];const t=this.links[e]||null;if(t===null)return null;const i=decodeCID(t.cid),o=t.isFile?await BareFile.fromCID(this.depot,i):await BareTree.fromCID(this.depot,i);return this.children[e]?this.children[e]:(this.children[e]=o,o)}async get(e){const[t,...i]=e;if(!t)return this;const o=await this.getDirectChild(t);if(i.length){if(o===null||isFile(o))return null}else return o;return o.get(i)}updateLink(e,t){const{cid:i,size:o,isFile:a}=t;return this.links[e]=make(e,i,a,o),this}getLinks(){return this.links}}const nibbles={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,a:!0,b:!0,c:!0,d:!0,e:!0,f:!0},isNibble=n=>nibbles[n]===!0;class MMPT{constructor(e,t){this.links=t,this.children={},this.depot=e}static create(e){return new MMPT(e,{})}static async fromCID(e,t){const i=await getSimpleLinks(e,t);return new MMPT(e,i)}async putDetailed(){return putLinks(this.depot,this.links)}async put(){const{cid:e}=await this.putDetailed();return e}async add(e,t){if(!isNibble(e[0]))throw new Error("Not a valid name, must be hexadecimal");const i=this.nextTreeOrSiblingName(e);if(e!==i)if(i===null)this.links[e]=make(e,t,!0,0);else if(i.length===1)await(await this.getDirectChild(i)).add(e.slice(1),t),await this.putAndUpdateChildLink(i);else{const o=this.addEmptyChild(e[0]),a=this.links[i].cid;this.removeChild(i),await Promise.all([o.add(e.slice(1),t),o.add(i.slice(1),decodeCID(a))]),await this.putAndUpdateChildLink(e[0])}}async putAndUpdateChildLink(e){const t=this.links[e]?.cid,{cid:i,size:o}=await this.children[e].putDetailed(),a=this.links[e]?.cid;if(t!=a)return await this.putAndUpdateChildLink(e);this.links[e]=make(e,i,!1,o)}addEmptyChild(e){const t=MMPT.create(this.depot);return this.children[e]=t,t}async get(e){const t=this.nextTreeName(e);return t===null?null:t.length>1?decodeCID(this.links[t].cid):(await this.getDirectChild(t)).get(e.slice(1))}async exists(e){return await this.get(e)!==null}async members(){return(await Promise.all(Object.values(this.links).map(async({name:t,cid:i})=>t.length>1?[{name:t,cid:decodeCID(i)}]:(await(await MMPT.fromCID(this.depot,decodeCID(i))).members()).map(c=>({...c,name:t+c.name}))))).reduce((t,i)=>t.concat(i))}async getDirectChild(e){if(this.children[e])return this.children[e];const t=await MMPT.fromCID(this.depot,decodeCID(this.links[e].cid));return this.children[e]?this.children[e]:(this.children[e]=t,t)}removeChild(e){delete this.links[e],this.children[e]&&delete this.children[e]}directChildExists(e){return this.links[e]!==void 0||this.children[e]!==void 0}nextTreeName(e){return this.directChildExists(e[0])?e[0]:this.directChildExists(e)?e:null}nextTreeOrSiblingName(e){const t=e[0];return this.directChildExists(t)?t:Object.keys(this.links).find(i=>t===i[0])||null}}var UnixNodeType;(function(n){n.Raw="raw",n.Directory="dir",n.File="file",n.Metadata="metadata",n.Symlink="symlink",n.HAMTShard="hamtShard"})(UnixNodeType||(UnixNodeType={}));const emptyUnix=n=>({mtime:Date.now(),ctime:Date.now(),mode:n?644:755,_type:n?UnixNodeType.File:UnixNodeType.Directory}),empty=(n,e)=>({isFile:n,version:e,unixMeta:emptyUnix(n)}),updateMtime=n=>({...n,unixMeta:{...n.unixMeta,mtime:Date.now()}}),encode$2=(n,e,t)=>({major:n,minor:e,patch:t}),fromString$1=n=>{const e=n.split(".").map(t=>parseInt(t));return e.length!==3||e.some(t=>typeof t!="number")?null:{major:e[0],minor:e[1],patch:e[2]}},toString$1=n=>{const{major:e,minor:t,patch:i}=n;return`${e}.${t}.${i}`},equals=(n,e)=>n.major===e.major&&n.minor===e.minor&&n.patch===e.patch,isSmallerThan=(n,e)=>n.major!=e.major?n.major<e.major:n.minor!=e.minor?n.minor<e.minor:n.patch<e.patch,isBiggerThan=(n,e)=>isSmallerThan(e,n);function isBiggerThanOrEqualTo(n,e){return isSmallerThan(e,n)||equals(n,e)}const isSupported$1=n=>isSmallerThan(n,latest)?"too-low":isBiggerThan(n,wnfsWasm)?"too-high":!0,v0=encode$2(0,0,0),latest=encode$2(2,0,0),wnfsWasm=encode$2(3,0,0),supported=[latest,wnfsWasm];class PrivateHistory{constructor(e,t,i){this.crypto=e,this.depot=t,this.node=i}async back(e=-1){const t=Math.min(e,-1),i=this.node.header?.revision;return i&&await this._getRevision(i+t)||null}async prior(e){return this.node.header.metadata.unixMeta.mtime<e?this.node:this._prior(this.node.header.revision-1,e)}async list(e=5){const t=this.node.header.revision;return Promise.all(Array.from({length:e},(i,o)=>{const a=o+1;return this._getRevisionInfoFromNumber(t-a).then(c=>({revisionInfo:c,delta:-a}))})).then(i=>i.filter(o=>!!o.revisionInfo)).then(i=>i.map(o=>{const a=o.revisionInfo.metadata.unixMeta.mtime;return{delta:o.delta,timestamp:a}}))}async _getRevision(e){const t=await this._getRevisionInfoFromNumber(e);return t&&await this.node.fromInfo(this.node.mmpt,this.node.key,t)}_getRevisionInfo(e){return readNode(this.depot,this.crypto,decodeCID(e.cid),this.node.key)}async _getRevisionInfoFromNumber(e){const{mmpt:t}=this.node,{bareNameFilter:i}=this.node.header,o=this.node.key,a=await getRevision(this.crypto,t,i,o,e);return a&&this._getRevisionInfo(a)}async _prior(e,t){const i=await this._getRevisionInfoFromNumber(e);return i?.revision?i.metadata.unixMeta.mtime<t?this._getRevision(i.revision):this._prior(i.revision-1,t):null}}class PrivateFile extends BaseFile{constructor({crypto:e,depot:t,content:i,mmpt:o,key:a,header:c}){super(i),this.crypto=e,this.depot=t,this.header=c,this.key=a,this.mmpt=o,this.history=new PrivateHistory(e,t,u(this));function u(d){return{...d,fromInfo:async(p,h,b)=>u(await PrivateFile.fromInfo(e,t,p,h,b))}}}static instanceOf(e){return isObject$1(e)&&hasProp(e,"content")&&hasProp(e,"mmpt")&&hasProp(e,"header")&&isPrivateFileInfo(e.header)}static async create(e,t,i,o,a,c){const u=await e.aes.exportKey(await e.aes.genKey(DEFAULT_AES_ALG)),d=await addToBare(e,a,legacyEncodingMistake(c,"base64pad")),p=await putEncryptedFile(t,e,o,u);return new PrivateFile({crypto:e,depot:t,content:o,mmpt:i,key:c,header:{bareNameFilter:d,key:toString$3(u,"base64pad"),revision:1,metadata:empty(!0,latest),content:encodeCID(p.cid)}})}static async fromBareNameFilter(e,t,i,o,a){const c=await getLatestByBareNameFilter(t,e,i,o,a);return this.fromInfo(e,t,i,a,c)}static async fromLatestName(e,t,i,o,a){const c=await getLatestByName(t,e,i,o,a);return PrivateFile.fromInfo(e,t,i,a,c)}static async fromName(e,t,i,o,a){const c=await getByName(t,e,i,o,a);return PrivateFile.fromInfo(e,t,i,a,c)}static async fromInfo(e,t,i,o,a){if(!isPrivateFileInfo(a))throw new Error("Could not parse a valid private file using the given key");const c=await getEncryptedFile(t,e,decodeCID(a.content),fromString$3(a.key,"base64pad"));return new PrivateFile({crypto:e,depot:t,content:c,key:o,mmpt:i,header:a})}async getName(){const{bareNameFilter:e,revision:t}=this.header,i=await addRevision(this.crypto,e,this.key,t);return toPrivateName(this.crypto,i)}async updateParentNameFilter(e){return this.header.bareNameFilter=await addToBare(this.crypto,e,legacyEncodingMistake(fromString$3(this.header.key,"base64pad"),"base64pad")),this}async updateContent(e){const t=await putEncryptedFile(this.depot,this.crypto,e,fromString$3(this.header.key,"base64pad"));return this.content=e,this.header={...this.header,revision:this.header.revision+1,content:encodeCID(t.cid)},this}async putDetailed(){return addNode(this.depot,this.crypto,this.mmpt,{...this.header,metadata:updateMtime(this.header.metadata)},this.key)}}class PrivateTree extends BaseTree{constructor({crypto:e,depot:t,manners:i,reference:o,mmpt:a,key:c,header:u}){super(),this.crypto=e,this.depot=t,this.manners=i,this.reference=o,this.children={},this.header=u,this.key=c,this.mmpt=a,this.history=new PrivateHistory(e,t,d(this));function d(p){return{...p,fromInfo:async(h,b,m)=>d(await PrivateTree.fromInfo(e,t,i,o,h,b,m))}}}static instanceOf(e){return isObject$1(e)&&hasProp(e,"mmpt")&&hasProp(e,"header")&&isPrivateTreeInfo(e.header)}static async create(e,t,i,o,a,c,u){const d=u?await addToBare(e,u,legacyEncodingMistake(c,"base64pad")):await createBare(e,c);return new PrivateTree({crypto:e,depot:t,manners:i,reference:o,mmpt:a,key:c,header:{metadata:empty(!1,latest),bareNameFilter:d,revision:1,links:{},skeleton:{}}})}static async fromBaseKey(e,t,i,o,a,c){const u=await createBare(e,c);return this.fromBareNameFilter(e,t,i,o,a,u,c)}static async fromBareNameFilter(e,t,i,o,a,c,u){const d=await getLatestByBareNameFilter(t,e,a,c,u);return this.fromInfo(e,t,i,o,a,u,d)}static async fromLatestName(e,t,i,o,a,c,u){const d=await getLatestByName(t,e,a,c,u);return this.fromInfo(e,t,i,o,a,u,d)}static async fromName(e,t,i,o,a,c,u){const d=await getByName(t,e,a,c,u);return this.fromInfo(e,t,i,o,a,u,d)}static async fromInfo(e,t,i,o,a,c,u){if(!isPrivateTreeInfo(u))throw new Error("Could not parse a valid private tree using the given key");return new PrivateTree({crypto:e,depot:t,manners:i,reference:o,mmpt:a,key:c,header:u})}async createChildTree(e,t){const i=await this.crypto.aes.genKey(DEFAULT_AES_ALG).then(this.crypto.aes.exportKey),o=await PrivateTree.create(this.crypto,this.depot,this.manners,this.reference,this.mmpt,i,this.header.bareNameFilter),a=this.children[e];if(a){if(PrivateFile.instanceOf(a))throw new Error(`There is a file at the given path: ${e}`);return a}return await this.updateDirectChild(o,e,t),o}async createOrUpdateChildFile(e,t,i){const o=await this.getDirectChild(t);let a;if(o===null){const c=await this.crypto.aes.genKey(DEFAULT_AES_ALG).then(this.crypto.aes.exportKey);a=await PrivateFile.create(this.crypto,this.depot,this.mmpt,e,this.header.bareNameFilter,c)}else if(PrivateFile.instanceOf(o))a=await o.updateContent(e);else throw new Error(`There is already a directory with that name: ${t}`);return await this.updateDirectChild(a,t,i),a}async putDetailed(){const e=Object.assign({},this.header);return e.skeleton=ensureSkeletonStringCIDs(e.skeleton),addNode(this.depot,this.crypto,this.mmpt,e,this.key)}async updateDirectChild(e,t,i){if(this.readOnly)throw new Error("Tree is read-only");await e.updateParentNameFilter(this.header.bareNameFilter),this.children[t]=e;const o=await e.putDetailed();return this.updateLink(t,o),i&&await i(),this}removeDirectChild(e){return this.header={...this.header,revision:this.header.revision+1,links:removeKeyFromObj(this.header.links,e),skeleton:removeKeyFromObj(this.header.skeleton,e)},this.children[e]&&delete this.children[e],this}async getDirectChild(e){let t=null;if(this.children[e])return this.children[e];const i=this.header.links[e];if(i===void 0)return null;if(isPrivateLink(i)){const o=fromString$3(i.key,"base64pad");t=i.isFile?await PrivateFile.fromLatestName(this.crypto,this.depot,this.mmpt,i.pointer,o):await PrivateTree.fromLatestName(this.crypto,this.depot,this.manners,this.reference,this.mmpt,i.pointer,o)}else if(isSoftLink(i))return PrivateTree.resolveSoftLink(this.crypto,this.depot,this.manners,this.reference,i);return this.children[e]?this.children[e]:(t&&(this.children[e]=t),t)}async getName(){const{bareNameFilter:e,revision:t}=this.header,i=await addRevision(this.crypto,e,this.key,t);return toPrivateName(this.crypto,i)}async updateParentNameFilter(e){return this.header.bareNameFilter=await addToBare(this.crypto,e,legacyEncodingMistake(this.key,"base64pad")),this}async get(e){if(e.length===0)return this;const[t,...i]=e,o=this.header.skeleton[t];return o===void 0?null:this.getRecurse(o,i)}async getRecurse(e,t){const[i,...o]=t;if(isSoftLink(e)){const d=await PrivateTree.resolveSoftLink(this.crypto,this.depot,this.manners,this.reference,e);if(!d)return null;if(i===void 0)return d;if(PrivateTree.instanceOf(d))return d.get(t).then(makeReadOnly$1);throw new Error("Was expecting a directory at: "+log$8(t))}if(i===void 0)return getNode(this.crypto,this.depot,this.manners,this.reference,this.mmpt,e);const a=e.subSkeleton[i];if(a!==void 0)return this.getRecurse(a,o);const c=await getLatestByCID(this.depot,this.crypto,this.mmpt,decodeCID(e.cid),fromString$3(e.key,"base64pad"));if(!isPrivateTreeInfo(c))return null;const u=c.skeleton[i];return u===void 0?null:this.getRecurse(u,o)}assignLink({name:e,link:t,skeleton:i}){this.header.links[e]=t,this.header.skeleton[e]=i,this.header.revision=this.header.revision+1,this.header.metadata.unixMeta.mtime=Date.now()}static async resolveSoftLink(e,t,i,o,a){const c=a.ipns.split("/")[0];if(!a.privateName||!a.key)throw new Error("Mixing public and private soft links is not supported yet.");const u=await o.dns.lookupDnsLink(c);if(!u)throw new Error(`Failed to resolve the soft link: ${a.ipns} - Could not resolve DNSLink`);const d=(await getSimpleLinks(t,decodeCID(u))).private.cid,p=await MMPT.fromCID(t,decodeCID(d)),h=fromString$3(a.key,"base64pad"),b=await getLatestByName(t,e,p,a.privateName,h);if(!b)return null;const m=b.metadata.isFile?await PrivateFile.fromInfo(e,t,p,h,b):await PrivateTree.fromInfo(e,t,i,o,p,h,b);return m&&(m.readOnly=!0),m}getLinks(){return mapObj(this.header.links,e=>{if(isSoftLink(e))return{...e};{const{key:t,...i}=e;return{...i}}})}updateLink(e,t){const{cid:i,size:o,isFile:a,skeleton:c}=t,u=toString$3(t.key,"base64pad"),d=t.name;return this.assignLink({name:e,link:{name:e,key:u,pointer:d,size:o,isFile:a},skeleton:{cid:encodeCID(i),key:u,subSkeleton:c}}),this}insertSoftLink({name:e,key:t,privateName:i,username:o}){const a={ipns:this.reference.dataRoot.domain(o),name:e,privateName:i,key:toString$3(t,"base64pad")};return this.assignLink({name:e,link:a,skeleton:a}),this}}async function getNode(n,e,t,i,o,a){const c=fromString$3(a.key,"base64pad"),u=await getLatestByCID(e,n,o,decodeCID(a.cid),c);return isPrivateFileInfo(u)?await PrivateFile.fromInfo(n,e,o,c,u):await PrivateTree.fromInfo(n,e,t,i,o,c,u)}function ensureSkeletonStringCIDs(n){return Object.entries(n).reduce((e,[t,i])=>{let o=i;return isPrivateSkeletonInfo(i)&&(i.cid=decodeCID(i.cid).toString(),i.subSkeleton=ensureSkeletonStringCIDs(i.subSkeleton)),{...e,[t]:o}},{})}function makeReadOnly$1(n){return n&&(n.readOnly=!0),n}const EXCHANGE_PATH=directory("public",".well-known","exchange");async function privateNode(n,e,t,i,o,a,{shareWith:c,sharedBy:u}){const d=Array.isArray(c)?c:c.startsWith("did:")?[c]:await listExchangeDIDs(e,i,c),p=o.sharedCounter||1,h=o.mmpt,b=await Promise.all(d.map(async H=>[H,await create$2(n,{counter:p,recipientExchangeDid:H,senderRootDid:u.rootDid})])),m=await n.aes.genKey(SymmAlg.AES_GCM).then(n.aes.exportKey),v=await PrivateTree.create(n,e,t,i,h,m,null);await Promise.all(a.map(async([H,j])=>{const W=await j.getName();return v.insertSoftLink({key:j.key,name:H,privateName:W,username:u.username})}));const _=SymmAlg.AES_GCM,$=Object.assign({},v.header),k=await putFile$1(e,await n.aes.encrypt(fromString$3(JSON.stringify($),"utf8"),v.key,_));if(b.length){const H=await namefilter(n,{bareFilter:$.bareNameFilter,shareKey:b[0][1]});await h.add(H,k.cid)}const D=encode$5(payload({entryIndexCid:encodeCID(k.cid),symmKey:v.key,symmKeyAlgo:_})),O=await Promise.all(b.map(async([H,j])=>{const{publicKey:W}=didToPublicKey(n,H),ae=await n.rsa.encrypt(D,W),fe=await e.putChunked(ae);return{name:j,cid:fe.cid,size:fe.size}}));return await o.addShares(O),{shareId:p.toString(),sharedBy:u}}async function listExchangeDIDs(n,e,t){const i=await e.dataRoot.lookup(t);if(!i)throw new Error("This person doesn't have a filesystem yet.");const a=(await getSimpleLinks(n,i))[RootBranch.Pretty]?.cid||null;if(!a)throw new Error("This person's filesystem doesn't have a pretty tree.");const c=await BareTree.fromCID(n,decodeCID(a)),u=unwrap$2(removePartition(EXCHANGE_PATH)),d=await c.get(u);return d&&d instanceof BareTree?Object.keys(d.getLinks()):[]}async function addSampleData(n){await n.mkdir(directory("private","Apps")),await n.mkdir(directory("private","Audio")),await n.mkdir(directory("private","Documents")),await n.mkdir(directory("private","Photos")),await n.mkdir(directory("private","Video")),await n.write(file("private","Welcome.txt"),new TextEncoder().encode("Welcome to your personal transportable encrypted file system "))}async function addPublicExchangeKey(n,e){const t=await exchange(n);await e.mkdir(combine(EXCHANGE_PATH,directory(t)))}async function hasPublicExchangeKey(n,e){const t=await exchange(n);return e.exists(combine(EXCHANGE_PATH,directory(t)))}async function retrieve({crypto:n,accountDID:e}){const t=await identifier(n,e);return n.keystore.exportSymmKey(t)}async function store({crypto:n,accountDID:e,readKey:t}){const i=await identifier(n,e);return n.keystore.importSymmKey(t,i)}function fromString(n){return fromString$3(n,"base64pad")}function identifier(n,e){const t=directory(RootBranch.Private);return readKey({crypto:n,path:t,accountDID:e})}var __classPrivateFieldSet=globalThis&&globalThis.__classPrivateFieldSet||function(n,e,t,i,o){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!o:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?o.call(n,t):o?o.value=t:e.set(n,t),t},__classPrivateFieldGet=globalThis&&globalThis.__classPrivateFieldGet||function(n,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(n):i?i.value:e.get(n)},_Session_crypto,_Session_storage,_Session_eventEmitter;class Session{constructor(e){_Session_crypto.set(this,void 0),_Session_storage.set(this,void 0),_Session_eventEmitter.set(this,void 0),__classPrivateFieldSet(this,_Session_crypto,e.crypto,"f"),__classPrivateFieldSet(this,_Session_storage,e.storage,"f"),__classPrivateFieldSet(this,_Session_eventEmitter,e.eventEmitter,"f"),this.fs=e.fs,this.type=e.type,this.username=e.username,__classPrivateFieldGet(this,_Session_eventEmitter,"f").emit("session:create",{session:this})}async destroy(){__classPrivateFieldGet(this,_Session_eventEmitter,"f").emit("session:destroy",{username:this.username}),await __classPrivateFieldGet(this,_Session_storage,"f").removeItem(__classPrivateFieldGet(this,_Session_storage,"f").KEYS.ACCOUNT_UCAN),await __classPrivateFieldGet(this,_Session_storage,"f").removeItem(__classPrivateFieldGet(this,_Session_storage,"f").KEYS.CID_LOG),await __classPrivateFieldGet(this,_Session_storage,"f").removeItem(__classPrivateFieldGet(this,_Session_storage,"f").KEYS.SESSION),await __classPrivateFieldGet(this,_Session_storage,"f").removeItem(__classPrivateFieldGet(this,_Session_storage,"f").KEYS.UCANS),await __classPrivateFieldGet(this,_Session_crypto,"f").keystore.clearStore(),this.fs&&this.fs.deactivate()}}_Session_crypto=new WeakMap,_Session_storage=new WeakMap,_Session_eventEmitter=new WeakMap;function isSessionInfo(n){return isObject$1(n)&&hasProp(n,"username")&&hasProp(n,"type")}async function restore(n){return n.getItem(n.KEYS.SESSION).then(e=>e||null).then(e=>e?JSON.parse(e):null).then(e=>isSessionInfo(e)?e:null)}function provide(n,e){return n.setItem(n.KEYS.SESSION,JSON.stringify({type:e.type,username:e.username}))}const TYPE="webCrypto";async function canDelegateAccount$1(n,e){const t=await n.reference.didRoot.lookup(e),i=await n.storage.getItem(n.storage.KEYS.ACCOUNT_UCAN);if(i){const o=rootIssuer(i),a=decode$4(i),{ptc:c}=a.payload;return t===o&&c==="SUPER_USER"}else{const o=await write(n.crypto);return t===o}}async function delegateAccount$2(n,e,t){const i=await n.storage.getItem(n.storage.KEYS.ACCOUNT_UCAN)??void 0,o=await build({dependencies:n,audience:t,issuer:await write(n.crypto),lifetimeInSeconds:60*60*24*30*12*1e3,potency:"SUPER_USER",proof:i});return{token:encode$6(o)}}async function linkDevice$2(n,e,t){const{token:i}=t,o=decode$4(i);await isValid(n.crypto,o)&&(await n.storage.setItem(n.storage.KEYS.ACCOUNT_UCAN,i),await provide(n.storage,{type:TYPE,username:e}))}async function register$1(n,e){return await provide(n.storage,{type:e.type||TYPE,username:e.username}),{success:!0}}async function session$1(n,e,t,i){return e?new Session({crypto:n.crypto,storage:n.storage,eventEmitter:i.session,type:TYPE,username:e}):null}function implementation$f(n){return{type:TYPE,canDelegateAccount:(...e)=>canDelegateAccount$1(n,...e),delegateAccount:(...e)=>delegateAccount$2(n,...e),linkDevice:(...e)=>linkDevice$2(n,...e),register:(...e)=>register$1(n,...e),session:session$1,createChannel:()=>{throw new Error("Not implemented")},isUsernameValid:()=>{throw new Error("Not implemented")},isUsernameAvailable:()=>{throw new Error("Not implemented")}}}var LinkingStep;(function(n){n.Broadcast="BROADCAST",n.Negotiation="NEGOTIATION",n.Delegation="DELEGATION"})(LinkingStep||(LinkingStep={}));class LinkingError extends Error{constructor(e){super(e),this.name="LinkingError"}}class LinkingWarning extends Error{constructor(e){super(e),this.name="LinkingWarning"}}const handleLinkingError=(n,e)=>{switch(e.name){case"LinkingWarning":n.warn(e.message);break;case"LinkingError":throw e;default:throw e}},tryParseMessage=(n,e,t)=>{try{const i=JSON.parse(n);return e(i)?{ok:!0,value:i}:{ok:!1,error:new LinkingWarning(`${t.participant} received an unexpected message in ${t.callSite}: ${n}. Ignoring message.`)}}catch{return{ok:!1,error:new LinkingWarning(`${t.participant} received a message in ${t.callSite} that it could not parse: ${n}. Ignoring message.`)}}},createConsumer=async(n,e)=>{const{username:t}=e,i=h=>handleLinkingError(n.manners,h);let o=new EventEmitter;const a={username:t,sessionKey:null,temporaryRsaPair:null,step:LinkingStep.Broadcast},c=async h=>{const{data:b}=h,m=b.arrayBuffer?new TextDecoder().decode(await b.arrayBuffer()):b;switch(a.step){case LinkingStep.Broadcast:return i(new LinkingWarning("Consumer is not ready to start linking"));case LinkingStep.Negotiation:if(a.sessionKey)i(new LinkingWarning("Consumer already received a session key"));else if(!a.temporaryRsaPair||!a.temporaryRsaPair.privateKey)i(new LinkingError("Consumer missing RSA key pair when handling session key message"));else{const v=await handleSessionKey(n.crypto,a.temporaryRsaPair.privateKey,m);if(v.ok){a.sessionKey=v.value;const{pin:_,challenge:$}=await generateUserChallenge(n.crypto,a.sessionKey);d.send($),o?.emit("challenge",{pin:Array.from(_)}),a.step=LinkingStep.Delegation}else i(v.error)}break;case LinkingStep.Delegation:if(!a.sessionKey)i(new LinkingError("Consumer was missing session key when linking device"));else if(!a.username)i(new LinkingError("Consumer was missing username when linking device"));else{const v=await linkDevice$1(n.auth,n.crypto,a.sessionKey,a.username,m);if(v.ok){const{approved:_}=v.value;o?.emit("link",{approved:_,username:a.username}),await u()}else i(v.error)}break}},u=async()=>{o?.emit("done",void 0),o=null,d.close(),clearInterval(p)},d=await n.auth.createChannel({handleMessage:c,username:t}),p=setInterval(async()=>{if(a.sessionKey)clearInterval(p);else{const{temporaryRsaPair:h,temporaryDID:b}=await generateTemporaryExchangeKey(n.crypto);a.temporaryRsaPair=h,a.step=LinkingStep.Negotiation,d.send(b)}},2e3);return{on:(...h)=>o?.on(...h),cancel:u}},generateTemporaryExchangeKey=async n=>{const e=await n.rsa.genKey(),t=await n.rsa.exportPublicKey(e.publicKey),i=publicKeyToDid(n,t,"rsa");return{temporaryRsaPair:e,temporaryDID:i}},handleSessionKey=async(n,e,t)=>{const o=tryParseMessage(t,a=>isObject$1(a)&&"iv"in a&&typeof a.iv=="string"&&"msg"in a&&typeof a.msg=="string"&&"sessionKey"in a&&typeof a.sessionKey=="string",{participant:"Consumer",callSite:"handleSessionKey"});if(o.ok){const{iv:a,msg:c,sessionKey:u}=o.value,d=fromString$3(a,"base64pad");let p;try{const _=fromString$3(u,"base64pad");p=await n.rsa.decrypt(_,e)}catch{return{ok:!1,error:new LinkingWarning(`Consumer received a session key in handleSessionKey that it could not decrypt: ${t}. Ignoring message`)}}let h=null;try{h=await n.aes.decrypt(fromString$3(c,"base64pad"),p,SymmAlg.AES_GCM,d)}catch{return{ok:!1,error:new LinkingError("Consumer could not decrypt closed UCAN with provided session key.")}}const b=decode$4(toString$3(h,"utf8"));if(await isValid(n,b)===!1)return{ok:!1,error:new LinkingError("Consumer received an invalid closed UCAN")};if(b.payload.ptc)return{ok:!1,error:new LinkingError("Consumer received a closed UCAN with potency. Closed UCAN must not have potency.")};const m=b.payload.fct[0]&&b.payload.fct[0].sessionKey;if(!m)return{ok:!1,error:new LinkingError("Consumer received a closed UCAN that was missing a session key in facts.")};const v=toString$3(p,"base64pad");return m!==v?{ok:!1,error:new LinkingError("Consumer received a closed UCAN session key does not match the session key")}:{ok:!0,value:p}}else return o},generateUserChallenge=async(n,e)=>{const t=Array.from(n.misc.randomNumbers({amount:6})).map(c=>c%9),i=n.misc.randomNumbers({amount:16}),o=await n.aes.encrypt(fromString$3(JSON.stringify({did:await write(n),pin:t}),"utf8"),e,SymmAlg.AES_GCM,i),a=JSON.stringify({iv:toString$3(i,"base64pad"),msg:toString$3(o,"base64pad")});return{pin:t,challenge:a}},linkDevice$1=async(n,e,t,i,o)=>{const c=tryParseMessage(o,u=>isObject$1(u)&&"iv"in u&&typeof u.iv=="string"&&"msg"in u&&typeof u.msg=="string",{participant:"Consumer",callSite:"linkDevice"});if(c.ok){const{iv:u,msg:d}=c.value,p=fromString$3(u,"base64");let h=null;try{h=await e.aes.decrypt(fromString$3(d,"base64pad"),t,SymmAlg.AES_GCM,p)}catch{return{ok:!1,error:new LinkingWarning("Consumer ignoring message that could not be decrypted in linkDevice.")}}const b=tryParseMessage(toString$3(h,"utf8"),isObject$1,{participant:"Consumer",callSite:"linkDevice"});return b.ok?b?.value.linkStatus==="DENIED"?{ok:!0,value:{approved:!1}}:(await n.linkDevice(i,b.value),{ok:!0,value:{approved:!0}}):b}else return c},createProducer=async(n,e)=>{const{username:t}=e,i=m=>handleLinkingError(n.manners,m);if(!await n.auth.canDelegateAccount(t))throw new LinkingError(`Producer cannot delegate account for username ${t}`);let a=new EventEmitter;const c={username:t,sessionKey:null,step:LinkingStep.Broadcast},u=async m=>{const{data:v}=m,_=v.arrayBuffer?new TextDecoder().decode(await v.arrayBuffer()):v;switch(c.step){case LinkingStep.Broadcast:{const{sessionKey:$,sessionKeyMessage:k}=await generateSessionKey(n.crypto,_);return c.sessionKey=$,c.step=LinkingStep.Negotiation,b.send(k)}case LinkingStep.Negotiation:if(c.sessionKey){const $=await handleUserChallenge(n.crypto,c.sessionKey,_);if(c.step=LinkingStep.Delegation,$.ok){const{pin:k,audience:D}=$.value,O=()=>{let W=!1;return{confirmPin:async()=>{W||(W=!0,c.sessionKey?await delegateAccount$1(n.auth,n.crypto,c.sessionKey,t,D,d):i(new LinkingError("Producer missing session key when delegating account")))},rejectPin:async()=>{W||(W=!0,c.sessionKey?await declineDelegation(n.crypto,c.sessionKey,d):i(new LinkingError("Producer missing session key when declining account delegation")))}}},{confirmPin:H,rejectPin:j}=O();a?.emit("challenge",{pin:k,confirmPin:H,rejectPin:j})}else i($.error)}else i(new LinkingError("Producer missing session key when handling user challenge"));break;case LinkingStep.Delegation:return i(new LinkingWarning("Producer received an unexpected message while delegating an account. The message will be ignored."))}},d=async(m,v)=>{await b.send(m),c.username!=null&&(a?.emit("link",{approved:v,username:c.username}),p())},p=()=>{c.sessionKey=null,c.step=LinkingStep.Broadcast},h=async()=>{a?.emit("done",void 0),a=null,b.close()},b=await n.auth.createChannel({username:t,handleMessage:u});return{on:(...m)=>a?.on(...m),cancel:h}},generateSessionKey=async(n,e)=>{const t=await n.aes.genKey(SymmAlg.AES_GCM),i=await n.aes.exportKey(t),{publicKey:o}=didToPublicKey(n,e),a=await n.rsa.encrypt(i,o),c=await build({dependencies:{crypto:n},issuer:await write(n),audience:e,lifetimeInSeconds:60*5,facts:[{sessionKey:toString$3(i,"base64pad")}],potency:null}),u=n.misc.randomNumbers({amount:16}),d=await n.aes.encrypt(fromString$3(encode$6(c),"utf8"),t,SymmAlg.AES_GCM,u),p=JSON.stringify({iv:toString$3(u,"base64pad"),msg:toString$3(d,"base64pad"),sessionKey:toString$3(a,"base64pad")});return{sessionKey:t,sessionKeyMessage:p}},handleUserChallenge=async(n,e,t)=>{const o=tryParseMessage(t,a=>isObject$1(a)&&"iv"in a&&typeof a.iv=="string"&&"msg"in a&&typeof a.msg=="string",{participant:"Producer",callSite:"handleUserChallenge"});if(o.ok){const{iv:a,msg:c}=o.value,u=fromString$3(a,"base64pad");let d=null;try{d=await n.aes.decrypt(fromString$3(c,"base64pad"),e,SymmAlg.AES_GCM,u)}catch{return{ok:!1,error:new LinkingWarning("Ignoring message that could not be decrypted.")}}const p=JSON.parse(toString$3(d,"utf8")),h=p.pin??null,b=p.did??null;return h!==null&&b!==null?{ok:!0,value:{pin:h,audience:b}}:{ok:!1,error:new LinkingError(`Producer received invalid pin ${p.pin} or audience ${p.audience}`)}}else return o},delegateAccount$1=async(n,e,t,i,o,a)=>{const c=await n.delegateAccount(i,o),u=JSON.stringify(c),d=e.misc.randomNumbers({amount:16}),p=await e.aes.encrypt(fromString$3(u,"utf8"),t,SymmAlg.AES_GCM,d),h=JSON.stringify({iv:toString$3(d,"base64pad"),msg:toString$3(p,"base64pad")});await a(h,!0)},declineDelegation=async(n,e,t)=>{const i=JSON.stringify({linkStatus:"DENIED"}),o=n.misc.randomNumbers({amount:16}),a=await n.aes.encrypt(fromString$3(i,"utf8"),e,SymmAlg.AES_GCM,o),c=JSON.stringify({iv:toString$3(o,"base64pad"),msg:toString$3(a,"base64pad")});await t(c,!1)};function namespace(n){return isString(n.namespace)?n.namespace:appId(n.namespace)}function throttle(n,e,t,i){var o,a=!1,c=0;function u(){o&&clearTimeout(o)}function d(){u(),a=!0}typeof e!="boolean"&&(i=t,t=e,e=void 0);function p(){for(var h=arguments.length,b=new Array(h),m=0;m<h;m++)b[m]=arguments[m];var v=this,_=Date.now()-c;if(a)return;function $(){c=Date.now(),t.apply(v,b)}function k(){o=void 0}i&&!o&&$(),u(),i===void 0&&_>n?$():e!==!0&&(o=setTimeout(i?k:$,i===void 0?n-_:n))}return p.cancel=d,p}class NoPermissionError extends Error{constructor(e){super(e),this.name="NoPermissionError"}}function nextNonEmpty(n){const e=n.slice(1);return e.length<1?null:e}class PublicHistory{constructor(e){this.node=e}back(e=-1){const t=Math.abs(Math.min(e,-1));return Array.from({length:t},(i,o)=>o).reduce(i=>i.then(o=>o?PublicHistory._getPreviousVersion(o):null),Promise.resolve(this.node))}async prior(e){return PublicHistory._prior(this.node,e)}async list(e=5){const{acc:t}=await Array.from({length:e},(i,o)=>o).reduce((i,o)=>i.then(({node:a,acc:c})=>a?PublicHistory._getPreviousVersion(a).then(u=>({node:u,acc:[...c,{delta:-(o+1),timestamp:a.header.metadata.unixMeta.mtime}]})):Promise.resolve({node:null,acc:c})),PublicHistory._getPreviousVersion(this.node).then(i=>({node:i,acc:[]})));return t}static async _getPreviousVersion(e){return e.header.previous?e.fromCID(decodeCID(e.header.previous)):Promise.resolve(null)}static async _prior(e,t){if(e.header.metadata.unixMeta.mtime<t)return e;const i=await PublicHistory._getPreviousVersion(e);return i?PublicHistory._prior(i,t):null}}let PublicFile$1=class yi extends BaseFile{constructor({depot:e,content:t,header:i,cid:o}){super(t),this.depot=e,this.cid=o,this.header=i,this.history=new PublicHistory(a(this));function a(c){return{...c,fromCID:async u=>a(await yi.fromCID(e,u))}}}static instanceOf(e){return isObject$1(e)&&hasProp(e,"content")&&hasProp(e,"header")&&isFileHeader(e.header)}static async create(e,t){return new yi({depot:e,content:t,header:{metadata:empty(!0,latest)},cid:null})}static async fromCID(e,t){const i=await get$2(e,t);return yi.fromInfo(e,i,t)}static async fromInfo(e,t,i){const{userland:o,metadata:a,previous:c}=t,u=await getFile(e,decodeCID(o));return new yi({depot:e,content:u,header:{metadata:a,previous:c},cid:i})}async putDetailed(){const e=await putFile(this.depot,this.content,updateMtime(this.header.metadata),this.cid);return this.cid=e.cid,e}};class PublicTree extends BaseTree{constructor({depot:e,reference:t,links:i,header:o,cid:a}){super(),this.depot=e,this.reference=t,this.children={},this.cid=a,this.links=i,this.header=o,this.history=new PublicHistory(c(this));function c(u){return{...u,fromCID:async d=>c(await PublicTree.fromCID(e,t,d))}}}static async empty(e,t){return new PublicTree({depot:e,reference:t,links:{},header:{metadata:empty(!1,latest),skeleton:{}},cid:null})}static async fromCID(e,t,i){const o=await get$2(e,i);if(!isTreeInfo(o))throw new Error(`Could not parse a valid public tree at: ${i}`);return PublicTree.fromInfo(e,t,o,i)}static async fromInfo(e,t,i,o){const{userland:a,metadata:c,previous:u,skeleton:d}=i,p=await getFileSystemLinks(e,decodeCID(a));return new PublicTree({depot:e,reference:t,links:p,header:{metadata:c,previous:u,skeleton:d},cid:o})}static instanceOf(e){return hasProp(e,"links")&&hasProp(e,"header")&&isLinks(e.links)&&isTreeHeader(e.header)}async createChildTree(e,t){const i=await PublicTree.empty(this.depot,this.reference),o=this.children[e];if(o){if(PublicFile$1.instanceOf(o))throw new Error(`There is a file at the given path: ${e}`);if(PublicTree.instanceOf(o))return o;throw new Error(`Not a public tree at the given path: ${e}`)}return await this.updateDirectChild(i,e,t),i}async createOrUpdateChildFile(e,t,i){const o=await this.getDirectChild(t);let a;if(o===null)a=await PublicFile$1.create(this.depot,e);else if(PublicFile$1.instanceOf(o))a=await o.updateContent(e);else throw new Error(`There is already a directory with that name: ${t}`);return await this.updateDirectChild(a,t,i),a}async putDetailed(){const e=await putTree(this.depot,this.links,this.header.skeleton,this.header.metadata,this.cid);return this.header.previous=this.cid||void 0,this.cid=e.cid,e}async updateDirectChild(e,t,i){if(this.readOnly)throw new Error("Tree is read-only");this.children[t]=e;const o=await e.putDetailed();return this.updateLink(t,o),i&&await i(),this}removeDirectChild(e){return delete this.links[e],delete this.header.skeleton[e],this.children[e]&&delete this.children[e],this}async getDirectChild(e){let t=null;if(this.children[e])return this.children[e];const i=this.header.skeleton[e]||null;if(i===null)return null;if(isSkeletonInfo(i)){const o=decodeCID(i.cid);t=i.isFile?await PublicFile$1.fromCID(this.depot,o):await PublicTree.fromCID(this.depot,this.reference,o)}else if(isSoftLink(i))return PublicTree.resolveSoftLink(this.depot,this.reference,i);return this.children[e]?this.children[e]:(t&&(this.children[e]=t),t)}async get(e){if(e.length<1)return this;const t=await this.getRecurse(this.header.skeleton,e);if(isSkeletonInfo(t)){const i=decodeCID(t.cid),o=await get$2(this.depot,i);return isFileInfo(o)?PublicFile$1.fromInfo(this.depot,o,i):PublicTree.fromInfo(this.depot,this.reference,o,i)}return t}async getRecurse(e,t){const i=t[0],o=e[i]||null,a=nextNonEmpty(t);if(isSoftLink(o)){const c=await PublicTree.resolveSoftLink(this.depot,this.reference,o);return a?PublicTree.instanceOf(c)?c.get(a).then(makeReadOnly):null:c}else return o===null||a===null?o:o.subSkeleton?this.getRecurse(o.subSkeleton,a):null}assignLink({name:e,link:t,skeleton:i}){this.links[e]=t,this.header.skeleton[e]=i,this.header.metadata.unixMeta.mtime=Date.now()}static async resolveSoftLink(e,t,i){const[o,...a]=i.ipns.split("/"),c=fromPosix(a.join("/"));if(!(isOnRootBranch(RootBranch.Public,c)||isOnRootBranch(RootBranch.Pretty,c)))throw new Error("Mixing public and private soft links is not supported yet.");const d=await t.dns.lookupDnsLink(o);if(!d)throw new Error(`Failed to resolve the soft link: ${i.ipns} - Could not resolve DNSLink`);const p=(await getSimpleLinks(e,decodeCID(d))).public.cid,h=removePartition(c),m=await(await PublicTree.fromCID(e,t,decodeCID(p))).get(unwrap$2(h));return m&&(m.readOnly=!0),m}getLinks(){return Object.values(this.links).reduce((e,t)=>{const i=this.header.skeleton[t.name];return{...e,[t.name]:i&&i.isFile!==void 0?{...t,isFile:i.isFile}:{...t}}},{})}updateLink(e,t){const{cid:i,metadata:o,userland:a,size:c,isFile:u,skeleton:d}=t;return this.assignLink({name:e,link:make(e,i,!1,c),skeleton:{cid:encodeCID(i),metadata:o,userland:a,subSkeleton:d,isFile:u}}),this}insertSoftLink({name:e,path:t,username:i}){const o={ipns:this.reference.dataRoot.domain(i)+`/public/${toPosix(t)}`,name:e};return this.assignLink({name:e,link:o,skeleton:o}),this}}function makeReadOnly(n){return n&&(n.readOnly=!0),n}const from=({name:n,code:e,encode:t})=>new Hasher(n,e,t);class Hasher{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?create$5(this.code,t):t.then(i=>create$5(this.code,i))}else throw Error("Unknown type, must be binary type")}}let wasm;const heap=new Array(32).fill(void 0);heap.push(void 0,null,!0,!1);function getObject(n){return heap[n]}let WASM_VECTOR_LEN=0,cachedUint8Memory0;function getUint8Memory0(){return cachedUint8Memory0.byteLength===0&&(cachedUint8Memory0=new Uint8Array(wasm.memory.buffer)),cachedUint8Memory0}const cachedTextEncoder=new TextEncoder("utf-8"),encodeString=typeof cachedTextEncoder.encodeInto=="function"?function(n,e){return cachedTextEncoder.encodeInto(n,e)}:function(n,e){const t=cachedTextEncoder.encode(n);return e.set(t),{read:n.length,written:t.length}};function passStringToWasm0(n,e,t){if(t===void 0){const u=cachedTextEncoder.encode(n),d=e(u.length);return getUint8Memory0().subarray(d,d+u.length).set(u),WASM_VECTOR_LEN=u.length,d}let i=n.length,o=e(i);const a=getUint8Memory0();let c=0;for(;c<i;c++){const u=n.charCodeAt(c);if(u>127)break;a[o+c]=u}if(c!==i){c!==0&&(n=n.slice(c)),o=t(o,i,i=c+n.length*3);const u=getUint8Memory0().subarray(o+c,o+i),d=encodeString(n,u);c+=d.written}return WASM_VECTOR_LEN=c,o}function isLikeNone(n){return n==null}let cachedInt32Memory0;function getInt32Memory0(){return cachedInt32Memory0.byteLength===0&&(cachedInt32Memory0=new Int32Array(wasm.memory.buffer)),cachedInt32Memory0}let heap_next=heap.length;function dropObject(n){n<36||(heap[n]=heap_next,heap_next=n)}function takeObject(n){const e=getObject(n);return dropObject(n),e}const cachedTextDecoder=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});cachedTextDecoder.decode();function getStringFromWasm0(n,e){return cachedTextDecoder.decode(getUint8Memory0().subarray(n,n+e))}function addHeapObject(n){heap_next===heap.length&&heap.push(heap.length+1);const e=heap_next;return heap_next=heap[e],heap[e]=n,e}function debugString(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const o=n.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=n.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(n)){const o=n.length;let a="[";o>0&&(a+=debugString(n[0]));for(let c=1;c<o;c++)a+=", "+debugString(n[c]);return a+="]",a}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let i;if(t.length>1)i=t[1];else return toString.call(n);if(i=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:i}const CLOSURE_DTORS=new FinalizationRegistry(n=>{wasm.__wbindgen_export_2.get(n.dtor)(n.a,n.b)});function makeMutClosure(n,e,t,i){const o={a:n,b:e,cnt:1,dtor:t},a=(...c)=>{o.cnt++;const u=o.a;o.a=0;try{return i(u,o.b,...c)}finally{--o.cnt===0?(wasm.__wbindgen_export_2.get(o.dtor)(u,o.b),CLOSURE_DTORS.unregister(o)):o.a=u}};return a.original=o,CLOSURE_DTORS.register(a,o,o),a}function __wbg_adapter_20(n,e,t){wasm._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__ha1ec3a5271c97341(n,e,addHeapObject(t))}let stack_pointer=32;function addBorrowedObject(n){if(stack_pointer==1)throw new Error("out of js stack");return heap[--stack_pointer]=n,stack_pointer}function passArray8ToWasm0(n,e){const t=e(n.length*1);return getUint8Memory0().set(n,t/1),WASM_VECTOR_LEN=n.length,t}function _assertClass(n,e){if(!(n instanceof e))throw new Error(`expected instance of ${e.name}`);return n.ptr}function getArrayU8FromWasm0(n,e){return getUint8Memory0().subarray(n/1,n/1+e)}function handleError(n,e){try{return n.apply(this,e)}catch(t){wasm.__wbindgen_exn_store(addHeapObject(t))}}function __wbg_adapter_82(n,e,t,i){wasm.wasm_bindgen__convert__closures__invoke2_mut__h1338dfb1e5ae1cd8(n,e,addHeapObject(t),addHeapObject(i))}new FinalizationRegistry(n=>wasm.__wbg_foreignblockstore_free(n));const PublicDirectoryFinalization=new FinalizationRegistry(n=>wasm.__wbg_publicdirectory_free(n));class PublicDirectory{static __wrap(e){const t=Object.create(PublicDirectory.prototype);return t.ptr=e,PublicDirectoryFinalization.register(t,t.ptr,t),t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,PublicDirectoryFinalization.unregister(this),e}free(){const e=this.__destroy_into_raw();wasm.__wbg_publicdirectory_free(e)}constructor(e){try{const t=wasm.publicdirectory_new(addBorrowedObject(e));return PublicDirectory.__wrap(t)}finally{heap[stack_pointer++]=void 0}}getNode(e,t){try{const c=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicdirectory_getNode(c,this.ptr,addBorrowedObject(e),addHeapObject(t));var i=getInt32Memory0()[c/4+0],o=getInt32Memory0()[c/4+1],a=getInt32Memory0()[c/4+2];if(a)throw takeObject(o);return takeObject(i)}finally{wasm.__wbindgen_add_to_stack_pointer(16),heap[stack_pointer++]=void 0}}lookupNode(e,t){try{const c=wasm.__wbindgen_add_to_stack_pointer(-16),u=passStringToWasm0(e,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),d=WASM_VECTOR_LEN;wasm.publicdirectory_lookupNode(c,this.ptr,u,d,addHeapObject(t));var i=getInt32Memory0()[c/4+0],o=getInt32Memory0()[c/4+1],a=getInt32Memory0()[c/4+2];if(a)throw takeObject(o);return takeObject(i)}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}store(e){try{const a=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicdirectory_store(a,this.ptr,addHeapObject(e));var t=getInt32Memory0()[a/4+0],i=getInt32Memory0()[a/4+1],o=getInt32Memory0()[a/4+2];if(o)throw takeObject(i);return takeObject(t)}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}static load(e,t){try{const c=wasm.__wbindgen_add_to_stack_pointer(-16),u=passArray8ToWasm0(e,wasm.__wbindgen_malloc),d=WASM_VECTOR_LEN;wasm.publicdirectory_load(c,u,d,addHeapObject(t));var i=getInt32Memory0()[c/4+0],o=getInt32Memory0()[c/4+1],a=getInt32Memory0()[c/4+2];if(a)throw takeObject(o);return takeObject(i)}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}read(e,t){try{const c=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicdirectory_read(c,this.ptr,addBorrowedObject(e),addHeapObject(t));var i=getInt32Memory0()[c/4+0],o=getInt32Memory0()[c/4+1],a=getInt32Memory0()[c/4+2];if(a)throw takeObject(o);return takeObject(i)}finally{wasm.__wbindgen_add_to_stack_pointer(16),heap[stack_pointer++]=void 0}}ls(e,t){try{const c=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicdirectory_ls(c,this.ptr,addBorrowedObject(e),addHeapObject(t));var i=getInt32Memory0()[c/4+0],o=getInt32Memory0()[c/4+1],a=getInt32Memory0()[c/4+2];if(a)throw takeObject(o);return takeObject(i)}finally{wasm.__wbindgen_add_to_stack_pointer(16),heap[stack_pointer++]=void 0}}rm(e,t){try{const c=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicdirectory_rm(c,this.ptr,addBorrowedObject(e),addHeapObject(t));var i=getInt32Memory0()[c/4+0],o=getInt32Memory0()[c/4+1],a=getInt32Memory0()[c/4+2];if(a)throw takeObject(o);return takeObject(i)}finally{wasm.__wbindgen_add_to_stack_pointer(16),heap[stack_pointer++]=void 0}}write(e,t,i,o){try{const d=wasm.__wbindgen_add_to_stack_pointer(-16),p=passArray8ToWasm0(t,wasm.__wbindgen_malloc),h=WASM_VECTOR_LEN;wasm.publicdirectory_write(d,this.ptr,addBorrowedObject(e),p,h,addBorrowedObject(i),addHeapObject(o));var a=getInt32Memory0()[d/4+0],c=getInt32Memory0()[d/4+1],u=getInt32Memory0()[d/4+2];if(u)throw takeObject(c);return takeObject(a)}finally{wasm.__wbindgen_add_to_stack_pointer(16),heap[stack_pointer++]=void 0,heap[stack_pointer++]=void 0}}basicMv(e,t,i,o){try{const d=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicdirectory_basicMv(d,this.ptr,addBorrowedObject(e),addBorrowedObject(t),addBorrowedObject(i),addHeapObject(o));var a=getInt32Memory0()[d/4+0],c=getInt32Memory0()[d/4+1],u=getInt32Memory0()[d/4+2];if(u)throw takeObject(c);return takeObject(a)}finally{wasm.__wbindgen_add_to_stack_pointer(16),heap[stack_pointer++]=void 0,heap[stack_pointer++]=void 0,heap[stack_pointer++]=void 0}}mkdir(e,t,i){try{const u=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicdirectory_mkdir(u,this.ptr,addBorrowedObject(e),addBorrowedObject(t),addHeapObject(i));var o=getInt32Memory0()[u/4+0],a=getInt32Memory0()[u/4+1],c=getInt32Memory0()[u/4+2];if(c)throw takeObject(a);return takeObject(o)}finally{wasm.__wbindgen_add_to_stack_pointer(16),heap[stack_pointer++]=void 0,heap[stack_pointer++]=void 0}}baseHistoryOn(e,t){try{const c=wasm.__wbindgen_add_to_stack_pointer(-16);_assertClass(e,PublicDirectory),wasm.publicdirectory_baseHistoryOn(c,this.ptr,e.ptr,addHeapObject(t));var i=getInt32Memory0()[c/4+0],o=getInt32Memory0()[c/4+1],a=getInt32Memory0()[c/4+2];if(a)throw takeObject(o);return takeObject(i)}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}previousCid(){const e=wasm.publicdirectory_previousCid(this.ptr);return takeObject(e)}metadata(){try{const o=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicdirectory_metadata(o,this.ptr);var e=getInt32Memory0()[o/4+0],t=getInt32Memory0()[o/4+1],i=getInt32Memory0()[o/4+2];if(i)throw takeObject(t);return takeObject(e)}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}asNode(){const e=wasm.publicdirectory_asNode(this.ptr);return PublicNode.__wrap(e)}getId(){try{const i=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicdirectory_getId(i,this.ptr);var e=getInt32Memory0()[i/4+0],t=getInt32Memory0()[i/4+1];return getStringFromWasm0(e,t)}finally{wasm.__wbindgen_add_to_stack_pointer(16),wasm.__wbindgen_free(e,t)}}}const PublicFileFinalization=new FinalizationRegistry(n=>wasm.__wbg_publicfile_free(n));class PublicFile{static __wrap(e){const t=Object.create(PublicFile.prototype);return t.ptr=e,PublicFileFinalization.register(t,t.ptr,t),t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,PublicFileFinalization.unregister(this),e}free(){const e=this.__destroy_into_raw();wasm.__wbg_publicfile_free(e)}constructor(e,t){try{const c=wasm.__wbindgen_add_to_stack_pointer(-16),u=passArray8ToWasm0(t,wasm.__wbindgen_malloc),d=WASM_VECTOR_LEN;wasm.publicfile_new(c,addBorrowedObject(e),u,d);var i=getInt32Memory0()[c/4+0],o=getInt32Memory0()[c/4+1],a=getInt32Memory0()[c/4+2];if(a)throw takeObject(o);return PublicFile.__wrap(i)}finally{wasm.__wbindgen_add_to_stack_pointer(16),heap[stack_pointer++]=void 0}}getId(){try{const i=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicfile_getId(i,this.ptr);var e=getInt32Memory0()[i/4+0],t=getInt32Memory0()[i/4+1];return getStringFromWasm0(e,t)}finally{wasm.__wbindgen_add_to_stack_pointer(16),wasm.__wbindgen_free(e,t)}}store(e){try{const a=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicfile_store(a,this.ptr,addHeapObject(e));var t=getInt32Memory0()[a/4+0],i=getInt32Memory0()[a/4+1],o=getInt32Memory0()[a/4+2];if(o)throw takeObject(i);return takeObject(t)}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}static load(e,t){try{const c=wasm.__wbindgen_add_to_stack_pointer(-16),u=passArray8ToWasm0(e,wasm.__wbindgen_malloc),d=WASM_VECTOR_LEN;wasm.publicfile_load(c,u,d,addHeapObject(t));var i=getInt32Memory0()[c/4+0],o=getInt32Memory0()[c/4+1],a=getInt32Memory0()[c/4+2];if(a)throw takeObject(o);return takeObject(i)}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}previousCid(){const e=wasm.publicfile_previousCid(this.ptr);return takeObject(e)}metadata(){try{const o=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicfile_metadata(o,this.ptr);var e=getInt32Memory0()[o/4+0],t=getInt32Memory0()[o/4+1],i=getInt32Memory0()[o/4+2];if(i)throw takeObject(t);return takeObject(e)}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}contentCid(){try{const o=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicfile_contentCid(o,this.ptr);var e=getInt32Memory0()[o/4+0],t=getInt32Memory0()[o/4+1],i=getArrayU8FromWasm0(e,t).slice();return wasm.__wbindgen_free(e,t*1),i}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}}const PublicNodeFinalization=new FinalizationRegistry(n=>wasm.__wbg_publicnode_free(n));class PublicNode{static __wrap(e){const t=Object.create(PublicNode.prototype);return t.ptr=e,PublicNodeFinalization.register(t,t.ptr,t),t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,PublicNodeFinalization.unregister(this),e}free(){const e=this.__destroy_into_raw();wasm.__wbg_publicnode_free(e)}asDir(){try{const o=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicnode_asDir(o,this.ptr);var e=getInt32Memory0()[o/4+0],t=getInt32Memory0()[o/4+1],i=getInt32Memory0()[o/4+2];if(i)throw takeObject(t);return PublicDirectory.__wrap(e)}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}asFile(){try{const o=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicnode_asFile(o,this.ptr);var e=getInt32Memory0()[o/4+0],t=getInt32Memory0()[o/4+1],i=getInt32Memory0()[o/4+2];if(i)throw takeObject(t);return PublicFile.__wrap(e)}finally{wasm.__wbindgen_add_to_stack_pointer(16)}}isDir(){return wasm.publicnode_isDir(this.ptr)!==0}isFile(){return wasm.publicnode_isFile(this.ptr)!==0}getId(){try{const i=wasm.__wbindgen_add_to_stack_pointer(-16);wasm.publicnode_getId(i,this.ptr);var e=getInt32Memory0()[i/4+0],t=getInt32Memory0()[i/4+1];return getStringFromWasm0(e,t)}finally{wasm.__wbindgen_add_to_stack_pointer(16),wasm.__wbindgen_free(e,t)}}}async function load(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(i){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function getImports(){const n={};return n.wbg={},n.wbg.__wbindgen_string_get=function(e,t){const i=getObject(t),o=typeof i=="string"?i:void 0;var a=isLikeNone(o)?0:passStringToWasm0(o,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),c=WASM_VECTOR_LEN;getInt32Memory0()[e/4+1]=c,getInt32Memory0()[e/4+0]=a},n.wbg.__wbindgen_object_drop_ref=function(e){takeObject(e)},n.wbg.__wbg_publicdirectory_new=function(e){const t=PublicDirectory.__wrap(e);return addHeapObject(t)},n.wbg.__wbg_publicfile_new=function(e){const t=PublicFile.__wrap(e);return addHeapObject(t)},n.wbg.__wbg_publicnode_new=function(e){const t=PublicNode.__wrap(e);return addHeapObject(t)},n.wbg.__wbindgen_string_new=function(e,t){const i=getStringFromWasm0(e,t);return addHeapObject(i)},n.wbg.__wbg_putBlock_88cdb3be9020efb7=function(e,t,i,o){var a=getArrayU8FromWasm0(t,i).slice();wasm.__wbindgen_free(t,i*1);const c=getObject(e).putBlock(a,o>>>0);return addHeapObject(c)},n.wbg.__wbg_getBlock_ef67031e09d5c6fd=function(e,t,i){var o=getArrayU8FromWasm0(t,i).slice();wasm.__wbindgen_free(t,i*1);const a=getObject(e).getBlock(o);return addHeapObject(a)},n.wbg.__wbindgen_bigint_new=function(e,t){const i=BigInt(getStringFromWasm0(e,t));return addHeapObject(i)},n.wbg.__wbindgen_number_new=function(e){return addHeapObject(e)},n.wbg.__wbindgen_cb_drop=function(e){const t=takeObject(e).original;return t.cnt--==1?(t.a=0,!0):!1},n.wbg.__wbg_new_693216e109162396=function(){const e=new Error;return addHeapObject(e)},n.wbg.__wbg_stack_0ddaca5d1abfb52f=function(e,t){const i=getObject(t).stack,o=passStringToWasm0(i,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),a=WASM_VECTOR_LEN;getInt32Memory0()[e/4+1]=a,getInt32Memory0()[e/4+0]=o},n.wbg.__wbg_error_09919627ac0992f5=function(e,t){try{console.error(getStringFromWasm0(e,t))}finally{wasm.__wbindgen_free(e,t)}},n.wbg.__wbg_get_f0f4f1608ebf633e=function(e,t){const i=getObject(e)[t>>>0];return addHeapObject(i)},n.wbg.__wbg_length_93debb0e2e184ab6=function(e){return getObject(e).length},n.wbg.__wbg_new_2ab697f1555e0dbc=function(){const e=new Array;return addHeapObject(e)},n.wbg.__wbg_new_306ce8d57919e6ae=function(){const e=new Object;return addHeapObject(e)},n.wbg.__wbg_push_811c8b08bf4ff9d5=function(e,t){return getObject(e).push(getObject(t))},n.wbg.__wbg_new_651776e932b7e9c7=function(e,t){const i=new Error(getStringFromWasm0(e,t));return addHeapObject(i)},n.wbg.__wbg_call_9855a4612eb496cb=function(){return handleError(function(e,t,i){const o=getObject(e).call(getObject(t),getObject(i));return addHeapObject(o)},arguments)},n.wbg.__wbg_getTime_7c8d3b79f51e2b87=function(e){return getObject(e).getTime()},n.wbg.__wbg_new_78403b138428b684=function(e,t){try{var i={a:e,b:t},o=(c,u)=>{const d=i.a;i.a=0;try{return __wbg_adapter_82(d,i.b,c,u)}finally{i.a=d}};const a=new Promise(o);return addHeapObject(a)}finally{i.a=i.b=0}},n.wbg.__wbg_resolve_f269ce174f88b294=function(e){const t=Promise.resolve(getObject(e));return addHeapObject(t)},n.wbg.__wbg_then_1c698eedca15eed6=function(e,t){const i=getObject(e).then(getObject(t));return addHeapObject(i)},n.wbg.__wbg_then_4debc41d4fc92ce5=function(e,t,i){const o=getObject(e).then(getObject(t),getObject(i));return addHeapObject(o)},n.wbg.__wbg_buffer_de1150f91b23aa89=function(e){const t=getObject(e).buffer;return addHeapObject(t)},n.wbg.__wbg_newwithbyteoffsetandlength_9ca61320599a2c84=function(e,t,i){const o=new Uint8Array(getObject(e),t>>>0,i>>>0);return addHeapObject(o)},n.wbg.__wbg_new_97cf52648830a70d=function(e){const t=new Uint8Array(getObject(e));return addHeapObject(t)},n.wbg.__wbg_set_a0172b213e2469e9=function(e,t,i){getObject(e).set(getObject(t),i>>>0)},n.wbg.__wbg_length_e09c0b925ab8de5d=function(e){return getObject(e).length},n.wbg.__wbg_set_b12cd0ab82903c2f=function(){return handleError(function(e,t,i){return Reflect.set(getObject(e),getObject(t),getObject(i))},arguments)},n.wbg.__wbindgen_debug_string=function(e,t){const i=debugString(getObject(t)),o=passStringToWasm0(i,wasm.__wbindgen_malloc,wasm.__wbindgen_realloc),a=WASM_VECTOR_LEN;getInt32Memory0()[e/4+1]=a,getInt32Memory0()[e/4+0]=o},n.wbg.__wbindgen_throw=function(e,t){throw new Error(getStringFromWasm0(e,t))},n.wbg.__wbindgen_memory=function(){const e=wasm.memory;return addHeapObject(e)},n.wbg.__wbindgen_closure_wrapper945=function(e,t,i){const o=makeMutClosure(e,t,417,__wbg_adapter_20);return addHeapObject(o)},n}function finalizeInit(n,e){return wasm=n.exports,init$1.__wbindgen_wasm_module=e,cachedInt32Memory0=new Int32Array(wasm.memory.buffer),cachedUint8Memory0=new Uint8Array(wasm.memory.buffer),wasm}async function init$1(n){typeof n>"u"&&(n=new URL("/minder-preview/Erudition/Minder/branch/master/assets/wasm_wnfs_bg-f3b54d92.wasm",self.location));const e=getImports();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:i}=await load(await n,e);return finalizeInit(t,i)}class DepotBlockStore{constructor(e){this.depot=e}async getBlock(e){const t=CID.decode(e);return await this.depot.getBlock(t)}async putBlock(e,t){if(!isIdentifier(t))throw new Error(`No codec was registered for the code: ${numberHex(t)}`);return(await this.depot.putBlock(e,t)).bytes}}let initialized=!1;async function loadWasm({manners:n}){if(initialized)return;initialized=!0,n.log(" Loading WNFS WASM");const e=performance.now();await init$1(n.wnfsWasmLookup(WASM_WNFS_VERSION));const t=performance.now()-e;n.log(` Loaded WNFS WASM (${t.toFixed(0)}ms)`)}class PublicRootWasm{constructor(e,t,i,o){this.dependencies=e,this.root=Promise.resolve(t),this.lastRoot=t,this.store=i,this.readOnly=o}static async empty(e){await loadWasm(e);const t=new DepotBlockStore(e.depot),i=new PublicDirectory(new Date);return new PublicRootWasm(e,i,t,!1)}static async fromCID(e,t){await loadWasm(e);const i=new DepotBlockStore(e.depot),o=await PublicDirectory.load(t.bytes,i);return new PublicRootWasm(e,o,i,!1)}async atomically(e){const t=await this.root;this.root=e(t),await this.root}async withError(e,t){try{return await e}catch(i){throw console.error(`Error during WASM operation ${t}:`),i}}async ls(e){const t=await this.root,{result:i}=await this.withError(t.getNode(e,this.store),`ls(${e.join("/")})`);if(i==null)throw new Error(`Can't ls ${e.join("/")}: No such directory`);if(!i.isDir())throw new Error(`Can't ls ${e.join("/")}: Not a directory`);const o=i.asDir(),{result:a}=await this.withError(t.ls(e,this.store),`ls(${e.join("/")})`),c={};for(const u of a){const d=await o.lookupNode(u.name,this.store),p=d.isFile()?CID.decode(await d.asFile().store(this.store)):CID.decode(await d.asDir().store(this.store));c[u.name]={name:u.name,isFile:u.metadata.unixMeta.kind==="file",size:0,cid:p}}return c}async mkdir(e){return await this.atomically(async t=>{const{rootDir:i}=await this.withError(t.mkdir(e,new Date,this.store),`mkdir(${e.join("/")})`);return i}),this}async cat(e){const t=await this.root,{result:i}=await this.withError(t.read(e,this.store),`read(${e.join("/")})`),o=CID.decode(i);return this.dependencies.depot.getUnixFile(o)}async add(e,t){const{cid:i}=await this.dependencies.depot.putChunked(t);return await this.atomically(async o=>{const{rootDir:a}=await this.withError(o.write(e,i.bytes,new Date,this.store),`write(${e.join("/")})`);return a}),this}async rm(e){return await this.atomically(async t=>{const{rootDir:i}=await this.withError(t.rm(e,this.store),`rm(${e.join("/")})`);return i}),this}async mv(e,t){return await this.atomically(async i=>{const{rootDir:o}=await this.withError(i.basicMv(e,t,new Date,this.store),`basicMv(${e.join("/")}, ${t.join("/")})`);return o}),this}async get(e){const t=await this.root,{result:i}=await this.withError(t.getNode(e,this.store),`getNode(${e.join("/")})`);if(i==null)return null;if(i.isFile()){const o=i.asFile(),a=await this.cat(e),c=e.slice(0,-1),u=e[e.length-1];return new PublicFileWasm(a,c,u,this,o)}else if(i.isDir()){const o=i.asDir();return new PublicDirectoryWasm(this.readOnly,e,this,o)}throw new Error("Unknown node type. Can only handle files and directories.")}async exists(e){const t=await this.root;try{return await t.getNode(e,this.store),!0}catch{return!1}}async historyStep(){return await this.atomically(async e=>{const{rootDir:t}=await e.baseHistoryOn(this.lastRoot,this.store);return this.lastRoot=e,t}),await this.root}async put(){const t=await(await this.historyStep()).store(this.store);return CID.decode(t)}async putDetailed(){return{cid:await this.put(),size:0,isFile:!1}}}class PublicDirectoryWasm{constructor(e,t,i,o){this.readOnly=e,this.directory=t,this.publicRoot=i,this.cachedDir=o}checkMutability(e){if(this.readOnly)throw new Error(`Directory is read-only. Cannot ${e}`)}async updateCache(){const t=await(await this.publicRoot.root).getNode(this.directory,this.publicRoot.store);this.cachedDir=t.asDir()}get header(){return nodeHeader(this.cachedDir)}async ls(e){return await this.publicRoot.ls([...this.directory,...e])}async mkdir(e){return this.checkMutability(`mkdir at ${[...this.directory,...e].join("/")}`),await this.publicRoot.mkdir([...this.directory,...e]),await this.updateCache(),this}async cat(e){return await this.publicRoot.cat([...this.directory,...e])}async add(e,t){return this.checkMutability(`write at ${[...this.directory,...e].join("/")}`),await this.publicRoot.add([...this.directory,...e],t),await this.updateCache(),this}async rm(e){return this.checkMutability(`remove at ${[...this.directory,...e].join("/")}`),await this.publicRoot.rm([...this.directory,...e]),await this.updateCache(),this}async mv(e,t){return this.checkMutability(`mv from ${[...this.directory,...e].join("/")} to ${[...this.directory,...t].join("/")}`),await this.publicRoot.mv([...this.directory,...e],[...this.directory,...t]),await this.updateCache(),this}async get(e){return await this.publicRoot.get([...this.directory,...e])}async exists(e){return await this.publicRoot.exists([...this.directory,...e])}async put(){await this.publicRoot.put();const t=await(await this.publicRoot.root).store(this.publicRoot.store);return CID.decode(t)}async putDetailed(){return{isFile:!1,size:0,cid:await this.put()}}}class PublicFileWasm extends BaseFile{constructor(e,t,i,o,a){super(e),this.directory=t,this.filename=i,this.publicRoot=o,this.cachedFile=a}async updateCache(){const t=await(await this.publicRoot.root).getNode([...this.directory,this.filename],this.publicRoot.store);this.cachedFile=t.asFile()}get header(){return nodeHeader(this.cachedFile)}async updateContent(e){return await super.updateContent(e),await this.updateCache(),this}async putDetailed(){const e=await this.publicRoot.root,t=[...this.directory,this.filename],{result:i}=await e.getNode(t,this.publicRoot.store);if(i==null)throw new Error(`No file at /${t.join("/")}.`);if(!i.isFile())throw new Error(`Not a file at /${t.join("/")}`);const o=i.asFile();return{isFile:!0,size:0,cid:CID.decode(await o.store(this.publicRoot.store))}}}function nodeHeader(n){const e=n.metadata(),t={isFile:e.unixMeta.kind==="file",version:e.version,unixMeta:{_type:e.unixMeta.kind,ctime:Number(e.unixMeta.created),mtime:Number(e.unixMeta.modified),mode:e.unixMeta.mode}},i=n.previousCid();return i==null?{metadata:t}:{metadata:t,previous:CID.decode(i)}}class RootTree{constructor({dependencies:e,links:t,mmpt:i,privateLog:o,sharedCounter:a,sharedLinks:c,publicTree:u,prettyTree:d,privateNodes:p}){this.dependencies=e,this.links=t,this.mmpt=i,this.privateLog=o,this.sharedCounter=a,this.sharedLinks=c,this.publicTree=u,this.prettyTree=d,this.privateNodes=p}static async empty({accountDID:e,dependencies:t,rootKey:i,wnfsWasm:o}){o&&t.manners.log(" Running an EXPERIMENTAL new version of the file system: 3.0.0");const a=o?await PublicRootWasm.empty(t):await PublicTree.empty(t.depot,t.reference),c=await BareTree.empty(t.depot),u=MMPT.create(t.depot),d=toPosix(directory(RootBranch.Private)),p=await PrivateTree.create(t.crypto,t.depot,t.manners,t.reference,u,i,null);await p.put();const h=new RootTree({dependencies:t,links:{},mmpt:u,privateLog:[],sharedCounter:1,sharedLinks:{},publicTree:a,prettyTree:c,privateNodes:{[d]:p}});return await store({accountDID:e,crypto:t.crypto,readKey:i}),await h.setVersion(o?wnfsWasm:latest),await Promise.all([h.updatePuttable(RootBranch.Public,a),h.updatePuttable(RootBranch.Pretty,c),h.updatePuttable(RootBranch.Private,u)]),h}static async fromCID({accountDID:e,dependencies:t,cid:i,permissions:o}){const{crypto:a,depot:c,manners:u}=t,d=await getSimpleLinks(t.depot,i),p=await permissionKeys(a,e,o||ROOT_FILESYSTEM_PERMISSIONS),h=await parseVersionFromLinks(t.depot,d),b=equals(h,wnfsWasm);b&&t.manners.log(" Running an EXPERIMENTAL new version of the file system: 3.0.0");const m=d[RootBranch.Public]?.cid||null,v=m===null?await PublicTree.empty(t.depot,t.reference):b?await PublicRootWasm.fromCID({depot:c,manners:u},decodeCID(m)):await PublicTree.fromCID(t.depot,t.reference,decodeCID(m)),_=d[RootBranch.Pretty]?await BareTree.fromCID(t.depot,decodeCID(d[RootBranch.Pretty].cid)):await BareTree.empty(t.depot),$=d[RootBranch.Private]?.cid||null;let k,D;$===null?(k=MMPT.create(t.depot),D={}):(k=await MMPT.fromCID(t.depot,decodeCID($)),D=await loadPrivateNodes(t,e,p,k));const O=d[RootBranch.PrivateLog]?.cid,H=O?await getPB(c,decodeCID(O)).then(ve=>ve.Links.map(fromDAGLink)).then(ve=>ve.sort((Qe,re)=>parseInt(Qe.name,10)-parseInt(re.name,10))):[],j=d[RootBranch.Shared]?.cid||null,W=j?await this.getSharedLinks(c,decodeCID(j)):{},ae=d[RootBranch.SharedCounter]?.cid||null,fe=ae?await getFile(t.depot,decodeCID(ae)).then(ve=>JSON.parse(toString$3(ve,"utf8"))):1,pe=new RootTree({dependencies:t,links:d,mmpt:k,privateLog:H,sharedCounter:fe,sharedLinks:W,publicTree:v,prettyTree:_,privateNodes:D});return d[RootBranch.Version]==null&&await pe.setVersion(latest),pe}async put(){const{cid:e}=await this.putDetailed();return e}async putDetailed(){return putLinks(this.dependencies.depot,this.links)}updateLink(e,t){const{cid:i,size:o,isFile:a}=t;return this.links[e]=make(e,i,a,o),this}async updatePuttable(e,t){return this.updateLink(e,await t.putDetailed())}findPrivateNode(e){return findPrivateNode(this.privateNodes,e)}async addPrivateLogEntry(e,t){const i=[...this.privateLog];let o=Math.max(0,i.length-1),a=i[o]?.cid?await e.getUnixFile(decodeCID(i[o].cid)).then(b=>toString$3(b,"utf8")).then(b=>b.split(",")):[];a.length+1>RootTree.LOG_CHUNK_SIZE&&(o=o+1,a=[]);const u=await this.dependencies.crypto.hash.sha256(fromString$3(encodeCID(t),"utf8")),d=[...a,u],p=await putFile$1(this.dependencies.depot,fromString$3(d.join(","),"utf8"));i[o]={name:o.toString(),cid:p.cid,size:p.size};const h=await putPB(this.dependencies.depot,i.map(toDAGLink));this.updateLink(RootBranch.PrivateLog,{cid:h,isFile:!1,size:await this.dependencies.depot.size(h)}),this.privateLog=i}async addShares(e){this.sharedLinks=e.reduce((o,a)=>({...o,[a.name]:a}),this.sharedLinks);const t=Object.values(this.sharedLinks).reduce((o,{cid:a,name:c,size:u})=>({...o,[c]:{cid:a,name:c,size:u}}),{}),i=await this.dependencies.depot.putBlock(encode$5(t),code$3);return this.updateLink(RootBranch.Shared,{cid:i,isFile:!1,size:await this.dependencies.depot.size(i)}),this}static async getSharedLinks(e,t){const i=await e.getBlock(t),o=decode$3(i);if(!isObject$1(o))throw new Error("Invalid shared section, not an object");return Object.values(o).reduce((a,c)=>{if(!isObject$1(c))return a;const u=c.name?c.name:null,d=c.cid?decodeCID(c.cid):null;return!u||!d?a:{...a,[u]:{name:u,cid:d,size:c.size||0}}},{})}async setSharedCounter(e){this.sharedCounter=e;const{cid:t,size:i}=await putFile$1(this.dependencies.depot,fromString$3(JSON.stringify(e),"utf8"));return this.updateLink(RootBranch.SharedCounter,{cid:t,isFile:!0,size:i}),e}async bumpSharedCounter(){const e=this.sharedCounter+1;return this.setSharedCounter(e)}async setVersion(e){const t=fromString$3(toString$1(e),"utf8"),i=await putFile$1(this.dependencies.depot,t);return this.updateLink(RootBranch.Version,i)}async getVersion(){return await parseVersionFromLinks(this.dependencies.depot,this.links)}}RootTree.LOG_CHUNK_SIZE=1020;async function findBareNameFilter(n,e,t,i,o){const a=await bareNameFilter({accountDID:t,crypto:n,path:o}),c=await e.getItem(a);if(c)return c;const[u,d]=findPrivateNode(i,o);if(!d)return null;const h=unwrap$2(o).slice(unwrap$2(u).length);return PrivateFile.instanceOf(d)?h.length===0?d.header.bareNameFilter:null:(d.exists(h)||(isDirectory(o)?await d.mkdir(h):await d.add(h,new Uint8Array)),d.get(h).then(b=>b?b.header.bareNameFilter:null))}function findPrivateNode(n,e){const t=n[toPosix(e)];if(t)return[e,t];const i=parent(e);return i?findPrivateNode(n,i):[e,null]}function loadPrivateNodes(n,e,t,i){const{crypto:o,storage:a}=n;return sortedPathKeys(t).reduce((c,{path:u,key:d})=>c.then(async p=>{let h;const b=unwrap$2(u);if(b.length===1&&b[0]===RootBranch.Private)h=await PrivateTree.fromBaseKey(n.crypto,n.depot,n.manners,n.reference,i,d);else{const v=await findBareNameFilter(o,a,e,p,u);if(!v)throw new Error(`Was trying to load the PrivateTree for the path \`${u}\`, but couldn't find the bare name filter for it.`);isDirectory(u)?h=await PrivateTree.fromBareNameFilter(n.crypto,n.depot,n.manners,n.reference,i,v,d):h=await PrivateFile.fromBareNameFilter(n.crypto,n.depot,i,v,d)}const m=toPosix(u);return{...p,[m]:h}}),Promise.resolve({}))}async function parseVersionFromLinks(n,e){const t=await getFile(n,decodeCID(e[RootBranch.Version].cid));return fromString$1(toString$3(t))??v0}async function permissionKeys(n,e,t){return permissionPaths(t).reduce(async(i,o)=>{if(isPartition(RootBranch.Public,o))return i;const a=await readKey({accountDID:e,crypto:n,path:o}),c=await n.keystore.exportSymmKey(a),u={path:o,key:c};return i.then(d=>[...d,u])},Promise.resolve([]))}function sortedPathKeys(n){return n.sort((e,t)=>toPosix(e.path).localeCompare(toPosix(t.path)))}class FileSystem{constructor({account:e,dependencies:t,eventEmitter:i,root:o,localOnly:a}){this.account=e,this.dependencies=t,this.eventEmitter=i,this.localOnly=a||!1,this.proofs={},this.publishHooks=[],this.root=o,this._publishWhenOnline=[],this._publishing=!1,this._whenOnline=this._whenOnline.bind(this),this._beforeLeaving=this._beforeLeaving.bind(this);const c=async d=>{await this.dependencies.reference.repositories.cidLog.add(d),this.dependencies.manners.log(" Adding to the CID ledger:",d.toString())},u=throttle(3e3,!1,(d,p)=>{if(globalThis.navigator.onLine)return this._publishing=[d,!0],this.dependencies.reference.dataRoot.update(d,p).then(()=>{this._publishing&&this._publishing[0]===d&&(i.emit("fileSystem:publish",{root:d}),this._publishing=!1)});this._publishWhenOnline.push([d,p])},!1);this.publishHooks.push(c),this.publishHooks.push(u),this.localOnly||(globalThis.addEventListener("online",this._whenOnline),globalThis.addEventListener("beforeunload",this._beforeLeaving))}static async empty(e){const{account:t,dependencies:i,eventEmitter:o,localOnly:a}=e,c=e.rootKey||await i.crypto.aes.genKey(DEFAULT_AES_ALG).then(i.crypto.aes.exportKey),u=e.version===toString$1(wnfsWasm),d=await RootTree.empty({accountDID:t.rootDID,dependencies:i,rootKey:c,wnfsWasm:u});return new FileSystem({account:t,dependencies:i,eventEmitter:o,root:d,localOnly:a})}static async fromCID(e,t){const{account:i,dependencies:o,eventEmitter:a,permissions:c,localOnly:u}=t,d=await RootTree.fromCID({accountDID:i.rootDID,dependencies:o,cid:e,permissions:c});return new FileSystem({account:i,dependencies:o,eventEmitter:a,root:d,localOnly:u})}deactivate(){this.localOnly||(globalThis.removeEventListener("online",this._whenOnline),globalThis.removeEventListener("beforeunload",this._beforeLeaving))}async ls(e){if(isFile$1(e))throw new Error("`ls` only accepts directory paths");return this.runOnNode(e,{public:async(t,i)=>t.ls(i),private:async(t,i)=>{if(isFile(t))throw new Error("Tried to `ls` a file");return t.ls(i)}})}async mkdir(e,t={}){if(isFile$1(e))throw new Error("`mkdir` only accepts directory paths");return await this.runMutationOnNode(e,{public:async(i,o)=>{await i.mkdir(o)},private:async(i,o)=>{if(isFile(i))throw new Error("Tried to `mkdir` a file");await i.mkdir(o)}}),t.publish&&await this.publish(),this}async write(e,t,i={}){if(isSoftLink(t)||isSoftLinkDictionary(t)||isSoftLinkList(t)){if(isFile$1(e))throw new Error("Can't add soft links to a file");await this.runMutationOnNode(e,{public:async(a,c)=>{const u=Array.isArray(t)?t:isObject$1(t)?Object.values(t):[t];await this.runOnChildTree(a,c,async d=>(u.forEach(p=>{(PrivateTree.instanceOf(d)||PublicTree.instanceOf(d))&&d.assignLink({name:p.name,link:p,skeleton:p})}),d))},private:async(a,c)=>{const u=Array.isArray(t)?t:isObject$1(t)?Object.values(t):[t];await this.runOnChildTree(a,c,async d=>(u.forEach(p=>{(PrivateTree.instanceOf(d)||PublicTree.instanceOf(d))&&d.assignLink({name:p.name,link:p,skeleton:p})}),d))}})}else{if(isDirectory(e))throw new Error("`add` only accepts file paths when working with regular files");await this.runMutationOnNode(e,{public:async(a,c)=>{await a.add(c,t)},private:async(a,c)=>{isFile(a)?await a.updateContent(t):await a.add(c,t)}})}return i.publish&&await this.publish(),this}async read(e){if(isDirectory(e))throw new Error("`cat` only accepts file paths");return this.runOnNode(e,{public:async(t,i)=>await t.cat(i),private:async(t,i)=>isFile(t)?t.content:await t.cat(i)})}async exists(e){return this.runOnNode(e,{public:async(t,i)=>await t.exists(i),private:async(t,i)=>isFile(t)||await t.exists(i)})}async get(e){return this.runOnNode(e,{public:async(t,i)=>await t.get(i),private:async(t,i)=>isFile(t)?t:await t.get(i)})}async mv(e,t){const i=isSamePartition(e,t);if(!isSameKind(e,t)){const o=kind(e),a=kind(t);throw new Error(`Can't move to a different kind of path, from is a ${o} and to is a ${a}`)}if(!i)throw new Error("`mv` is only supported on the same tree for now");if(await this.exists(t))throw new Error("Destination already exists");return await this.runMutationOnNode(e,{public:async(o,a)=>{const[c,...u]=unwrap$2(t);await o.mv(a,u)},private:async(o,a)=>{if(isFile(o))throw new Error("Tried to `mv` within a file");const[c,...u]=unwrap$2(t);await o.mv(a,u)}}),this}resolveSymlink(e){return hasProp(e,"privateName")?PrivateTree.resolveSoftLink(this.dependencies.crypto,this.dependencies.depot,this.dependencies.manners,this.dependencies.reference,e):PublicTree.resolveSoftLink(this.dependencies.depot,this.dependencies.reference,e)}async rm(e){return await this.runMutationOnNode(e,{public:async(t,i)=>{await t.rm(i)},private:async(t,i)=>{if(isFile(t))throw new Error("Cannot `rm` a file you've asked permission for");await t.rm(i)}}),this}async symlink(e){const{at:t,name:i}=e,o=e.referringTo.path,a=e.referringTo.username||this.account.username;if(t==null)throw new Error("Missing parameter `symlink.at`");if(isFile$1(t))throw new Error("`symlink.at` only accepts directory paths");const c=isSamePartition(t,o);if(!a)throw new Error("I need a username in order to use this method");if(!c)throw new Error("`link` is only supported on the same tree for now");return await this.runMutationOnNode(t,{public:async(u,d)=>{if(!BareTree.instanceOf(u))if(PublicTree.instanceOf(u))await this.runOnChildTree(u,d,async p=>(PublicTree.instanceOf(p)&&p.insertSoftLink({path:removePartition(o),name:i,username:a}),p));else throw new Error("Symlinks not supported in WASM-WNFS yet.")},private:async(u,d)=>{if(isFile(u))throw new Error("Cannot add a soft link to a file");await this.runOnChildTree(u,d,async p=>{if(PrivateTree.instanceOf(p)){const h=await this.runOnNode(o,{public:async()=>{throw new Error("File system hit a public node within a private node. This is not supported/this should not happen.")},private:async(b,m)=>{const v=isFile(b)?b:await b.get(m);if(PrivateTree.instanceOf(v))return v;if(PrivateFile.instanceOf(v))return v;throw new Error("`symlink.referringTo` is not of the right type")}});if(!h)throw new Error("Could not find the item the symlink is referring to");p.insertSoftLink({name:i,username:a,key:h.key,privateName:await h.getName()})}return p})}}),this}async publish(){const e=Array.from(Object.entries(this.proofs));this.proofs={};const t=await this.root.put();return e.forEach(([i,o])=>{this.publishHooks.forEach(a=>a(t,o))}),t}async historyStep(){const e=this.root.publicTree;hasProp(e,"historyStep")&&typeof e.historyStep=="function"&&await e.historyStep()}async acceptShare({shareId:e,sharedBy:t}){const i=await this.loadShare({shareId:e,sharedBy:t});return await this.write(directory(RootBranch.Private,"Shared with me",t),await i.ls([]).then(Object.values).then(o=>o.filter(isSoftLink))),this}async loadShare({shareId:e,sharedBy:t}){const i=await exchange(this.dependencies.crypto),o=await this.dependencies.reference.didRoot.lookup(t),a=await create$2(this.dependencies.crypto,{counter:parseInt(e,10),recipientExchangeDid:i,senderRootDid:o}),c=await this.dependencies.reference.dataRoot.lookup(t);if(!c)throw new Error("This user doesn't have a filesystem yet.");const u=await getSimpleLinks(this.dependencies.depot,c),d=u[RootBranch.Shared]?.cid||null;if(!d)throw new Error("This user hasn't shared anything yet.");const p=await RootTree.getSharedLinks(this.dependencies.depot,decodeCID(d)),h=isObject$1(p)?p[a]:null;if(!h)throw new Error("Couldn't find a matching share.");const b=isObject$1(h)?h.cid:null;if(!b)throw new Error("Couldn't find a matching share.");const m=await this.dependencies.depot.getBlock(decodeCID(b)),v=await this.dependencies.crypto.keystore.decrypt(m),_=decode$3(v);if(!hasProp(_,"cid"))throw new Error("Share payload is missing the `cid` property");if(!hasProp(_,"key"))throw new Error("Share payload is missing the `key` property");if(!hasProp(_,"algo"))throw new Error("Share payload is missing the `algo` property");const $=_.cid,k=_.key,D=_.algo;if(!u[RootBranch.Private]?.cid)throw new Error("This user's filesystem doesn't have a private branch");const H=await MMPT.fromCID(this.dependencies.depot,decodeCID(u[RootBranch.Private]?.cid)),j=await this.dependencies.depot.getBlock(decodeCID($)),W=await this.dependencies.crypto.aes.decrypt(j,k,D),ae=JSON.parse(toString$3(W,"utf8"));if(!isDecryptedNode(ae))throw new Error("The share payload did not point to a valid entry index");return PrivateTree.fromInfo(this.dependencies.crypto,this.dependencies.depot,this.dependencies.manners,this.dependencies.reference,H,k,ae)}async sharePrivate(e,{sharedBy:t,shareWith:i}){const o=e.filter(u=>isOnRootBranch(RootBranch.Private,u));if(!t){if(!this.account.username)throw new Error("I need a username in order to use this method");t={rootDid:this.account.rootDID,username:this.account.username}}const a=await o.reduce(async(u,d)=>{const p=await u,h=terminus(d),b=await this.get(d);return h&&(PrivateFile.instanceOf(b)||PrivateTree.instanceOf(b))?[...p,[h,b]]:p},Promise.resolve([]));if(!a.length)throw new Error("Didn't find any items to share");const c=await privateNode(this.dependencies.crypto,this.dependencies.depot,this.dependencies.manners,this.dependencies.reference,this.root,a,{shareWith:i,sharedBy:t});return await this.root.bumpSharedCounter(),await this.root.updatePuttable(RootBranch.Private,this.root.mmpt),await this.publish(),c}async checkMutationPermissionAndAddProof(e,t){const i=t?"make changes to":"query";if(!this.localOnly){const o=await this.dependencies.reference.repositories.ucans.lookupFilesystemUcan(e);if(!o||isExpired(o)||!o.signature)throw new NoPermissionError(`I don't have the necessary permissions to ${i} the file system at "${toPosix(e)}"`);this.proofs[o.signature]=o}}async runMutationOnNode(e,t){const i=unwrap$2(e),o=i[0],a=i.slice(1);if(await this.checkMutationPermissionAndAddProof(e,!0),o===RootBranch.Public)await t.public(this.root.publicTree,a),await t.public(this.root.prettyTree,a),await Promise.all([this.root.updatePuttable(RootBranch.Public,this.root.publicTree),this.root.updatePuttable(RootBranch.Pretty,this.root.prettyTree)]);else if(o===RootBranch.Private){const[c,u]=this.root.findPrivateNode(e);if(!u)throw new NoPermissionError(`I don't have the necessary permissions to make changes to the file system at "${toPosix(e)}"`);await t.private(u,i.slice(unwrap$2(c).length)),await u.put(),await this.root.updatePuttable(RootBranch.Private,this.root.mmpt);const d=await this.root.mmpt.put();await this.root.addPrivateLogEntry(this.dependencies.depot,d)}else throw o===RootBranch.Pretty?new Error("The pretty path is read only"):new Error("Not a valid FileSystem path");this.eventEmitter.emit("fileSystem:local-change",{root:await this.root.put(),path:e})}async runOnNode(e,t){const i=unwrap$2(e),o=i[0],a=i.slice(1);if(await this.checkMutationPermissionAndAddProof(e,!1),o===RootBranch.Public)return await t.public(this.root.publicTree,a);if(o===RootBranch.Private){const[c,u]=this.root.findPrivateNode(e);if(!u)throw new NoPermissionError(`I don't have the necessary permissions to query the file system at "${toPosix(e)}"`);return await t.private(u,i.slice(unwrap$2(c).length))}else{if(o===RootBranch.Pretty)return await t.public(this.root.prettyTree,a);throw new Error("Not a valid FileSystem path")}}async runOnChildTree(e,t,i){let o=e;if(t.length){await o.exists(t)||await o.mkdir(t);const a=await o.get(t);if(isTree(a))o=a;else throw new Error("Path does not point to a directory")}return o=await i(o),t.length?await e.updateChild(o,t):e}_whenOnline(){const e=[...this._publishWhenOnline];this._publishWhenOnline=[],e.forEach(([t,i])=>{this.publishHooks.forEach(o=>o(t,i))})}_beforeLeaving(e){const t="Are you sure you want to leave? We don't control the browser so you may lose your data.";if(this._publishing||this._publishWhenOnline.length)return(e||globalThis.event).returnValue=t,t}}async function loadFileSystem$1({config:n,dependencies:e,eventEmitter:t,rootKey:i,username:o}){const{crypto:a,depot:c,manners:u,reference:d,storage:p}=e;let h,b;const m=d.repositories.cidLog,v={username:o,rootDID:await d.didRoot.lookup(o)},_=navigator.onLine?await getDataRoot(d,o,{maxRetries:20}):null,$=_?m.indexOf(_):-1;if(navigator.onLine)if(!_)h=m.newest(),h?u.log(" No DNSLink, using local CID:",h.toString()):u.log(" Creating a new file system");else if($===m.length()-1)h=_,u.log(" DNSLink is up to date:",h.toString());else if($!==-1&&$<m.length()-1){h=m.newest();const O=m.length()-1-$,H=O===1?"1 newer local entry":O.toString()+" newer local entries";u.log(" DNSLink is outdated ("+H+"), using local CID:",h.toString())}else h=_,await m.add(h),u.log(" DNSLink is newer:",h.toString());else throw h=m.newest(),h&&u.log(" Working offline, using local CID:",h.toString()),new Error("Offline, don't have a filesystem to work with.");const k=n.permissions,D={crypto:a,depot:c,reference:d,storage:p};return h?(await checkFileSystemVersion(e.depot,n,h),await u.fileSystem.hooks.beforeLoadExisting(h,v,D),b=await FileSystem.fromCID(h,{account:v,dependencies:e,eventEmitter:t,permissions:k}),await u.fileSystem.hooks.afterLoadExisting(b,v,D),b):(await u.fileSystem.hooks.beforeLoadNew(v,D),b=await FileSystem.empty({account:v,dependencies:e,eventEmitter:t,rootKey:i,permissions:k,version:n.fileSystem?.version}),await u.fileSystem.hooks.afterLoadNew(b,v,D),b)}async function recoverFileSystem({auth:n,dependencies:e,oldUsername:t,newUsername:i,readKey:o}){const{crypto:a,reference:c,storage:u}=e,d=await write(a),{success:p}=await n.register({username:i});if(!p)throw new Error("Failed to register new user");const h=await u.getItem(u.KEYS.ACCOUNT_UCAN),b=await build({dependencies:e,potency:"APPEND",resource:"*",proof:h||void 0,lifetimeInSeconds:60*3,audience:d,issuer:d}),m=await c.dataRoot.lookup(t);if(!m)throw new Error("Failed to lookup oldUsername");return await c.dataRoot.update(m,b),await store({accountDID:d,crypto:a,readKey:o}),{success:!0}}const DEFAULT_USER_MESSAGES={versionMismatch:{newer:async()=>alertIfPossible(`Sorry, we can't sync your filesystem with this app. This app only understands older versions of filesystems.

Please try to hard refresh this site or let this app's developer know.

Feel free to contact Fission support: support@fission.codes`),older:async()=>alertIfPossible(`Sorry, we can't sync your filesystem with this app. Your filesystem version is out-dated and it needs to be migrated.

Run a migration (https://guide.fission.codes/accounts/account-signup/account-migration) or talk to Fission support: support@fission.codes`)}};async function checkFileSystemVersion(n,e,t){const i=await getSimpleLinks(n,t),o=i[RootBranch.Version]==null?"1.0.0":new TextDecoder().decode(await getFile(n,decodeCID(i[RootBranch.Version].cid))),a=async()=>(await(e.userMessages||DEFAULT_USER_MESSAGES).versionMismatch.newer(o),new Error(`Incompatible filesystem version. Version: ${o} Supported versions: ${supported.map(p=>toString$1(p)).join(", ")}. Please upgrade this app's ODD SDK version.`)),c=async()=>(await(e.userMessages||DEFAULT_USER_MESSAGES).versionMismatch.older(o),new Error(`Incompatible filesystem version. Version: ${o} Supported versions: ${supported.map(p=>toString$1(p)).join(", ")}. The user should migrate their filesystem.`)),u=fromString$1(o);if(u==null)throw await a();const d=isSupported$1(u);if(d==="too-high")throw await a();if(d==="too-low")throw await c()}function alertIfPossible(n){globalThis.alert!=null&&globalThis.alert(n)}async function getDataRoot(n,e,t={}){const i=t.maxRetries??0,o=t.retryInterval??500;let a=await n.dataRoot.lookup(e).catch(()=>null);return a?a.toString()===EMPTY_CID?null:a:new Promise((c,u)=>{let d=0;const p=setInterval(async()=>{if(a=await n.dataRoot.lookup(e).catch(()=>null),!a&&d<i){d++;return}else d>=i&&u("Failed to load data root");clearInterval(p),c(a?.toString()===EMPTY_CID?null:a)},o)})}const _globalReference=globalThis||window||self,webcrypto=_globalReference.crypto;var naclFast={exports:{}};(function(n){(function(e){var t=function(F){var Y,Q=new Float64Array(16);if(F)for(Y=0;Y<F.length;Y++)Q[Y]=F[Y];return Q},i=function(){throw new Error("no PRNG")},o=new Uint8Array(16),a=new Uint8Array(32);a[0]=9;var c=t(),u=t([1]),d=t([56129,1]),p=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),v=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function _(F,Y,Q,M){F[Y]=Q>>24&255,F[Y+1]=Q>>16&255,F[Y+2]=Q>>8&255,F[Y+3]=Q&255,F[Y+4]=M>>24&255,F[Y+5]=M>>16&255,F[Y+6]=M>>8&255,F[Y+7]=M&255}function $(F,Y,Q,M,X){var ge,_e=0;for(ge=0;ge<X;ge++)_e|=F[Y+ge]^Q[M+ge];return(1&_e-1>>>8)-1}function k(F,Y,Q,M){return $(F,Y,Q,M,16)}function D(F,Y,Q,M){return $(F,Y,Q,M,32)}function O(F,Y,Q,M){for(var X=M[0]&255|(M[1]&255)<<8|(M[2]&255)<<16|(M[3]&255)<<24,ge=Q[0]&255|(Q[1]&255)<<8|(Q[2]&255)<<16|(Q[3]&255)<<24,_e=Q[4]&255|(Q[5]&255)<<8|(Q[6]&255)<<16|(Q[7]&255)<<24,Ce=Q[8]&255|(Q[9]&255)<<8|(Q[10]&255)<<16|(Q[11]&255)<<24,je=Q[12]&255|(Q[13]&255)<<8|(Q[14]&255)<<16|(Q[15]&255)<<24,Xe=M[4]&255|(M[5]&255)<<8|(M[6]&255)<<16|(M[7]&255)<<24,Ve=Y[0]&255|(Y[1]&255)<<8|(Y[2]&255)<<16|(Y[3]&255)<<24,zt=Y[4]&255|(Y[5]&255)<<8|(Y[6]&255)<<16|(Y[7]&255)<<24,at=Y[8]&255|(Y[9]&255)<<8|(Y[10]&255)<<16|(Y[11]&255)<<24,xt=Y[12]&255|(Y[13]&255)<<8|(Y[14]&255)<<16|(Y[15]&255)<<24,St=M[8]&255|(M[9]&255)<<8|(M[10]&255)<<16|(M[11]&255)<<24,kt=Q[16]&255|(Q[17]&255)<<8|(Q[18]&255)<<16|(Q[19]&255)<<24,At=Q[20]&255|(Q[21]&255)<<8|(Q[22]&255)<<16|(Q[23]&255)<<24,$t=Q[24]&255|(Q[25]&255)<<8|(Q[26]&255)<<16|(Q[27]&255)<<24,vt=Q[28]&255|(Q[29]&255)<<8|(Q[30]&255)<<16|(Q[31]&255)<<24,Et=M[12]&255|(M[13]&255)<<8|(M[14]&255)<<16|(M[15]&255)<<24,it=X,yt=ge,tt=_e,st=Ce,ft=je,nt=Xe,ke=Ve,De=zt,He=at,q=xt,te=St,J=kt,ce=At,ye=$t,le=vt,Se=Et,ee,Oe=0;Oe<20;Oe+=2)ee=it+ce|0,ft^=ee<<7|ee>>>32-7,ee=ft+it|0,He^=ee<<9|ee>>>32-9,ee=He+ft|0,ce^=ee<<13|ee>>>32-13,ee=ce+He|0,it^=ee<<18|ee>>>32-18,ee=nt+yt|0,q^=ee<<7|ee>>>32-7,ee=q+nt|0,ye^=ee<<9|ee>>>32-9,ee=ye+q|0,yt^=ee<<13|ee>>>32-13,ee=yt+ye|0,nt^=ee<<18|ee>>>32-18,ee=te+ke|0,le^=ee<<7|ee>>>32-7,ee=le+te|0,tt^=ee<<9|ee>>>32-9,ee=tt+le|0,ke^=ee<<13|ee>>>32-13,ee=ke+tt|0,te^=ee<<18|ee>>>32-18,ee=Se+J|0,st^=ee<<7|ee>>>32-7,ee=st+Se|0,De^=ee<<9|ee>>>32-9,ee=De+st|0,J^=ee<<13|ee>>>32-13,ee=J+De|0,Se^=ee<<18|ee>>>32-18,ee=it+st|0,yt^=ee<<7|ee>>>32-7,ee=yt+it|0,tt^=ee<<9|ee>>>32-9,ee=tt+yt|0,st^=ee<<13|ee>>>32-13,ee=st+tt|0,it^=ee<<18|ee>>>32-18,ee=nt+ft|0,ke^=ee<<7|ee>>>32-7,ee=ke+nt|0,De^=ee<<9|ee>>>32-9,ee=De+ke|0,ft^=ee<<13|ee>>>32-13,ee=ft+De|0,nt^=ee<<18|ee>>>32-18,ee=te+q|0,J^=ee<<7|ee>>>32-7,ee=J+te|0,He^=ee<<9|ee>>>32-9,ee=He+J|0,q^=ee<<13|ee>>>32-13,ee=q+He|0,te^=ee<<18|ee>>>32-18,ee=Se+le|0,ce^=ee<<7|ee>>>32-7,ee=ce+Se|0,ye^=ee<<9|ee>>>32-9,ee=ye+ce|0,le^=ee<<13|ee>>>32-13,ee=le+ye|0,Se^=ee<<18|ee>>>32-18;it=it+X|0,yt=yt+ge|0,tt=tt+_e|0,st=st+Ce|0,ft=ft+je|0,nt=nt+Xe|0,ke=ke+Ve|0,De=De+zt|0,He=He+at|0,q=q+xt|0,te=te+St|0,J=J+kt|0,ce=ce+At|0,ye=ye+$t|0,le=le+vt|0,Se=Se+Et|0,F[0]=it>>>0&255,F[1]=it>>>8&255,F[2]=it>>>16&255,F[3]=it>>>24&255,F[4]=yt>>>0&255,F[5]=yt>>>8&255,F[6]=yt>>>16&255,F[7]=yt>>>24&255,F[8]=tt>>>0&255,F[9]=tt>>>8&255,F[10]=tt>>>16&255,F[11]=tt>>>24&255,F[12]=st>>>0&255,F[13]=st>>>8&255,F[14]=st>>>16&255,F[15]=st>>>24&255,F[16]=ft>>>0&255,F[17]=ft>>>8&255,F[18]=ft>>>16&255,F[19]=ft>>>24&255,F[20]=nt>>>0&255,F[21]=nt>>>8&255,F[22]=nt>>>16&255,F[23]=nt>>>24&255,F[24]=ke>>>0&255,F[25]=ke>>>8&255,F[26]=ke>>>16&255,F[27]=ke>>>24&255,F[28]=De>>>0&255,F[29]=De>>>8&255,F[30]=De>>>16&255,F[31]=De>>>24&255,F[32]=He>>>0&255,F[33]=He>>>8&255,F[34]=He>>>16&255,F[35]=He>>>24&255,F[36]=q>>>0&255,F[37]=q>>>8&255,F[38]=q>>>16&255,F[39]=q>>>24&255,F[40]=te>>>0&255,F[41]=te>>>8&255,F[42]=te>>>16&255,F[43]=te>>>24&255,F[44]=J>>>0&255,F[45]=J>>>8&255,F[46]=J>>>16&255,F[47]=J>>>24&255,F[48]=ce>>>0&255,F[49]=ce>>>8&255,F[50]=ce>>>16&255,F[51]=ce>>>24&255,F[52]=ye>>>0&255,F[53]=ye>>>8&255,F[54]=ye>>>16&255,F[55]=ye>>>24&255,F[56]=le>>>0&255,F[57]=le>>>8&255,F[58]=le>>>16&255,F[59]=le>>>24&255,F[60]=Se>>>0&255,F[61]=Se>>>8&255,F[62]=Se>>>16&255,F[63]=Se>>>24&255}function H(F,Y,Q,M){for(var X=M[0]&255|(M[1]&255)<<8|(M[2]&255)<<16|(M[3]&255)<<24,ge=Q[0]&255|(Q[1]&255)<<8|(Q[2]&255)<<16|(Q[3]&255)<<24,_e=Q[4]&255|(Q[5]&255)<<8|(Q[6]&255)<<16|(Q[7]&255)<<24,Ce=Q[8]&255|(Q[9]&255)<<8|(Q[10]&255)<<16|(Q[11]&255)<<24,je=Q[12]&255|(Q[13]&255)<<8|(Q[14]&255)<<16|(Q[15]&255)<<24,Xe=M[4]&255|(M[5]&255)<<8|(M[6]&255)<<16|(M[7]&255)<<24,Ve=Y[0]&255|(Y[1]&255)<<8|(Y[2]&255)<<16|(Y[3]&255)<<24,zt=Y[4]&255|(Y[5]&255)<<8|(Y[6]&255)<<16|(Y[7]&255)<<24,at=Y[8]&255|(Y[9]&255)<<8|(Y[10]&255)<<16|(Y[11]&255)<<24,xt=Y[12]&255|(Y[13]&255)<<8|(Y[14]&255)<<16|(Y[15]&255)<<24,St=M[8]&255|(M[9]&255)<<8|(M[10]&255)<<16|(M[11]&255)<<24,kt=Q[16]&255|(Q[17]&255)<<8|(Q[18]&255)<<16|(Q[19]&255)<<24,At=Q[20]&255|(Q[21]&255)<<8|(Q[22]&255)<<16|(Q[23]&255)<<24,$t=Q[24]&255|(Q[25]&255)<<8|(Q[26]&255)<<16|(Q[27]&255)<<24,vt=Q[28]&255|(Q[29]&255)<<8|(Q[30]&255)<<16|(Q[31]&255)<<24,Et=M[12]&255|(M[13]&255)<<8|(M[14]&255)<<16|(M[15]&255)<<24,it=X,yt=ge,tt=_e,st=Ce,ft=je,nt=Xe,ke=Ve,De=zt,He=at,q=xt,te=St,J=kt,ce=At,ye=$t,le=vt,Se=Et,ee,Oe=0;Oe<20;Oe+=2)ee=it+ce|0,ft^=ee<<7|ee>>>32-7,ee=ft+it|0,He^=ee<<9|ee>>>32-9,ee=He+ft|0,ce^=ee<<13|ee>>>32-13,ee=ce+He|0,it^=ee<<18|ee>>>32-18,ee=nt+yt|0,q^=ee<<7|ee>>>32-7,ee=q+nt|0,ye^=ee<<9|ee>>>32-9,ee=ye+q|0,yt^=ee<<13|ee>>>32-13,ee=yt+ye|0,nt^=ee<<18|ee>>>32-18,ee=te+ke|0,le^=ee<<7|ee>>>32-7,ee=le+te|0,tt^=ee<<9|ee>>>32-9,ee=tt+le|0,ke^=ee<<13|ee>>>32-13,ee=ke+tt|0,te^=ee<<18|ee>>>32-18,ee=Se+J|0,st^=ee<<7|ee>>>32-7,ee=st+Se|0,De^=ee<<9|ee>>>32-9,ee=De+st|0,J^=ee<<13|ee>>>32-13,ee=J+De|0,Se^=ee<<18|ee>>>32-18,ee=it+st|0,yt^=ee<<7|ee>>>32-7,ee=yt+it|0,tt^=ee<<9|ee>>>32-9,ee=tt+yt|0,st^=ee<<13|ee>>>32-13,ee=st+tt|0,it^=ee<<18|ee>>>32-18,ee=nt+ft|0,ke^=ee<<7|ee>>>32-7,ee=ke+nt|0,De^=ee<<9|ee>>>32-9,ee=De+ke|0,ft^=ee<<13|ee>>>32-13,ee=ft+De|0,nt^=ee<<18|ee>>>32-18,ee=te+q|0,J^=ee<<7|ee>>>32-7,ee=J+te|0,He^=ee<<9|ee>>>32-9,ee=He+J|0,q^=ee<<13|ee>>>32-13,ee=q+He|0,te^=ee<<18|ee>>>32-18,ee=Se+le|0,ce^=ee<<7|ee>>>32-7,ee=ce+Se|0,ye^=ee<<9|ee>>>32-9,ee=ye+ce|0,le^=ee<<13|ee>>>32-13,ee=le+ye|0,Se^=ee<<18|ee>>>32-18;F[0]=it>>>0&255,F[1]=it>>>8&255,F[2]=it>>>16&255,F[3]=it>>>24&255,F[4]=nt>>>0&255,F[5]=nt>>>8&255,F[6]=nt>>>16&255,F[7]=nt>>>24&255,F[8]=te>>>0&255,F[9]=te>>>8&255,F[10]=te>>>16&255,F[11]=te>>>24&255,F[12]=Se>>>0&255,F[13]=Se>>>8&255,F[14]=Se>>>16&255,F[15]=Se>>>24&255,F[16]=ke>>>0&255,F[17]=ke>>>8&255,F[18]=ke>>>16&255,F[19]=ke>>>24&255,F[20]=De>>>0&255,F[21]=De>>>8&255,F[22]=De>>>16&255,F[23]=De>>>24&255,F[24]=He>>>0&255,F[25]=He>>>8&255,F[26]=He>>>16&255,F[27]=He>>>24&255,F[28]=q>>>0&255,F[29]=q>>>8&255,F[30]=q>>>16&255,F[31]=q>>>24&255}function j(F,Y,Q,M){O(F,Y,Q,M)}function W(F,Y,Q,M){H(F,Y,Q,M)}var ae=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function fe(F,Y,Q,M,X,ge,_e){var Ce=new Uint8Array(16),je=new Uint8Array(64),Xe,Ve;for(Ve=0;Ve<16;Ve++)Ce[Ve]=0;for(Ve=0;Ve<8;Ve++)Ce[Ve]=ge[Ve];for(;X>=64;){for(j(je,Ce,_e,ae),Ve=0;Ve<64;Ve++)F[Y+Ve]=Q[M+Ve]^je[Ve];for(Xe=1,Ve=8;Ve<16;Ve++)Xe=Xe+(Ce[Ve]&255)|0,Ce[Ve]=Xe&255,Xe>>>=8;X-=64,Y+=64,M+=64}if(X>0)for(j(je,Ce,_e,ae),Ve=0;Ve<X;Ve++)F[Y+Ve]=Q[M+Ve]^je[Ve];return 0}function pe(F,Y,Q,M,X){var ge=new Uint8Array(16),_e=new Uint8Array(64),Ce,je;for(je=0;je<16;je++)ge[je]=0;for(je=0;je<8;je++)ge[je]=M[je];for(;Q>=64;){for(j(_e,ge,X,ae),je=0;je<64;je++)F[Y+je]=_e[je];for(Ce=1,je=8;je<16;je++)Ce=Ce+(ge[je]&255)|0,ge[je]=Ce&255,Ce>>>=8;Q-=64,Y+=64}if(Q>0)for(j(_e,ge,X,ae),je=0;je<Q;je++)F[Y+je]=_e[je];return 0}function ve(F,Y,Q,M,X){var ge=new Uint8Array(32);W(ge,M,X,ae);for(var _e=new Uint8Array(8),Ce=0;Ce<8;Ce++)_e[Ce]=M[Ce+16];return pe(F,Y,Q,_e,ge)}function Qe(F,Y,Q,M,X,ge,_e){var Ce=new Uint8Array(32);W(Ce,ge,_e,ae);for(var je=new Uint8Array(8),Xe=0;Xe<8;Xe++)je[Xe]=ge[Xe+16];return fe(F,Y,Q,M,X,je,Ce)}var re=function(F){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var Y,Q,M,X,ge,_e,Ce,je;Y=F[0]&255|(F[1]&255)<<8,this.r[0]=Y&8191,Q=F[2]&255|(F[3]&255)<<8,this.r[1]=(Y>>>13|Q<<3)&8191,M=F[4]&255|(F[5]&255)<<8,this.r[2]=(Q>>>10|M<<6)&7939,X=F[6]&255|(F[7]&255)<<8,this.r[3]=(M>>>7|X<<9)&8191,ge=F[8]&255|(F[9]&255)<<8,this.r[4]=(X>>>4|ge<<12)&255,this.r[5]=ge>>>1&8190,_e=F[10]&255|(F[11]&255)<<8,this.r[6]=(ge>>>14|_e<<2)&8191,Ce=F[12]&255|(F[13]&255)<<8,this.r[7]=(_e>>>11|Ce<<5)&8065,je=F[14]&255|(F[15]&255)<<8,this.r[8]=(Ce>>>8|je<<8)&8191,this.r[9]=je>>>5&127,this.pad[0]=F[16]&255|(F[17]&255)<<8,this.pad[1]=F[18]&255|(F[19]&255)<<8,this.pad[2]=F[20]&255|(F[21]&255)<<8,this.pad[3]=F[22]&255|(F[23]&255)<<8,this.pad[4]=F[24]&255|(F[25]&255)<<8,this.pad[5]=F[26]&255|(F[27]&255)<<8,this.pad[6]=F[28]&255|(F[29]&255)<<8,this.pad[7]=F[30]&255|(F[31]&255)<<8};re.prototype.blocks=function(F,Y,Q){for(var M=this.fin?0:2048,X,ge,_e,Ce,je,Xe,Ve,zt,at,xt,St,kt,At,$t,vt,Et,it,yt,tt,st=this.h[0],ft=this.h[1],nt=this.h[2],ke=this.h[3],De=this.h[4],He=this.h[5],q=this.h[6],te=this.h[7],J=this.h[8],ce=this.h[9],ye=this.r[0],le=this.r[1],Se=this.r[2],ee=this.r[3],Oe=this.r[4],Fe=this.r[5],Le=this.r[6],Ge=this.r[7],ct=this.r[8],bt=this.r[9];Q>=16;)X=F[Y+0]&255|(F[Y+1]&255)<<8,st+=X&8191,ge=F[Y+2]&255|(F[Y+3]&255)<<8,ft+=(X>>>13|ge<<3)&8191,_e=F[Y+4]&255|(F[Y+5]&255)<<8,nt+=(ge>>>10|_e<<6)&8191,Ce=F[Y+6]&255|(F[Y+7]&255)<<8,ke+=(_e>>>7|Ce<<9)&8191,je=F[Y+8]&255|(F[Y+9]&255)<<8,De+=(Ce>>>4|je<<12)&8191,He+=je>>>1&8191,Xe=F[Y+10]&255|(F[Y+11]&255)<<8,q+=(je>>>14|Xe<<2)&8191,Ve=F[Y+12]&255|(F[Y+13]&255)<<8,te+=(Xe>>>11|Ve<<5)&8191,zt=F[Y+14]&255|(F[Y+15]&255)<<8,J+=(Ve>>>8|zt<<8)&8191,ce+=zt>>>5|M,at=0,xt=at,xt+=st*ye,xt+=ft*(5*bt),xt+=nt*(5*ct),xt+=ke*(5*Ge),xt+=De*(5*Le),at=xt>>>13,xt&=8191,xt+=He*(5*Fe),xt+=q*(5*Oe),xt+=te*(5*ee),xt+=J*(5*Se),xt+=ce*(5*le),at+=xt>>>13,xt&=8191,St=at,St+=st*le,St+=ft*ye,St+=nt*(5*bt),St+=ke*(5*ct),St+=De*(5*Ge),at=St>>>13,St&=8191,St+=He*(5*Le),St+=q*(5*Fe),St+=te*(5*Oe),St+=J*(5*ee),St+=ce*(5*Se),at+=St>>>13,St&=8191,kt=at,kt+=st*Se,kt+=ft*le,kt+=nt*ye,kt+=ke*(5*bt),kt+=De*(5*ct),at=kt>>>13,kt&=8191,kt+=He*(5*Ge),kt+=q*(5*Le),kt+=te*(5*Fe),kt+=J*(5*Oe),kt+=ce*(5*ee),at+=kt>>>13,kt&=8191,At=at,At+=st*ee,At+=ft*Se,At+=nt*le,At+=ke*ye,At+=De*(5*bt),at=At>>>13,At&=8191,At+=He*(5*ct),At+=q*(5*Ge),At+=te*(5*Le),At+=J*(5*Fe),At+=ce*(5*Oe),at+=At>>>13,At&=8191,$t=at,$t+=st*Oe,$t+=ft*ee,$t+=nt*Se,$t+=ke*le,$t+=De*ye,at=$t>>>13,$t&=8191,$t+=He*(5*bt),$t+=q*(5*ct),$t+=te*(5*Ge),$t+=J*(5*Le),$t+=ce*(5*Fe),at+=$t>>>13,$t&=8191,vt=at,vt+=st*Fe,vt+=ft*Oe,vt+=nt*ee,vt+=ke*Se,vt+=De*le,at=vt>>>13,vt&=8191,vt+=He*ye,vt+=q*(5*bt),vt+=te*(5*ct),vt+=J*(5*Ge),vt+=ce*(5*Le),at+=vt>>>13,vt&=8191,Et=at,Et+=st*Le,Et+=ft*Fe,Et+=nt*Oe,Et+=ke*ee,Et+=De*Se,at=Et>>>13,Et&=8191,Et+=He*le,Et+=q*ye,Et+=te*(5*bt),Et+=J*(5*ct),Et+=ce*(5*Ge),at+=Et>>>13,Et&=8191,it=at,it+=st*Ge,it+=ft*Le,it+=nt*Fe,it+=ke*Oe,it+=De*ee,at=it>>>13,it&=8191,it+=He*Se,it+=q*le,it+=te*ye,it+=J*(5*bt),it+=ce*(5*ct),at+=it>>>13,it&=8191,yt=at,yt+=st*ct,yt+=ft*Ge,yt+=nt*Le,yt+=ke*Fe,yt+=De*Oe,at=yt>>>13,yt&=8191,yt+=He*ee,yt+=q*Se,yt+=te*le,yt+=J*ye,yt+=ce*(5*bt),at+=yt>>>13,yt&=8191,tt=at,tt+=st*bt,tt+=ft*ct,tt+=nt*Ge,tt+=ke*Le,tt+=De*Fe,at=tt>>>13,tt&=8191,tt+=He*Oe,tt+=q*ee,tt+=te*Se,tt+=J*le,tt+=ce*ye,at+=tt>>>13,tt&=8191,at=(at<<2)+at|0,at=at+xt|0,xt=at&8191,at=at>>>13,St+=at,st=xt,ft=St,nt=kt,ke=At,De=$t,He=vt,q=Et,te=it,J=yt,ce=tt,Y+=16,Q-=16;this.h[0]=st,this.h[1]=ft,this.h[2]=nt,this.h[3]=ke,this.h[4]=De,this.h[5]=He,this.h[6]=q,this.h[7]=te,this.h[8]=J,this.h[9]=ce},re.prototype.finish=function(F,Y){var Q=new Uint16Array(10),M,X,ge,_e;if(this.leftover){for(_e=this.leftover,this.buffer[_e++]=1;_e<16;_e++)this.buffer[_e]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(M=this.h[1]>>>13,this.h[1]&=8191,_e=2;_e<10;_e++)this.h[_e]+=M,M=this.h[_e]>>>13,this.h[_e]&=8191;for(this.h[0]+=M*5,M=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=M,M=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=M,Q[0]=this.h[0]+5,M=Q[0]>>>13,Q[0]&=8191,_e=1;_e<10;_e++)Q[_e]=this.h[_e]+M,M=Q[_e]>>>13,Q[_e]&=8191;for(Q[9]-=8192,X=(M^1)-1,_e=0;_e<10;_e++)Q[_e]&=X;for(X=~X,_e=0;_e<10;_e++)this.h[_e]=this.h[_e]&X|Q[_e];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,ge=this.h[0]+this.pad[0],this.h[0]=ge&65535,_e=1;_e<8;_e++)ge=(this.h[_e]+this.pad[_e]|0)+(ge>>>16)|0,this.h[_e]=ge&65535;F[Y+0]=this.h[0]>>>0&255,F[Y+1]=this.h[0]>>>8&255,F[Y+2]=this.h[1]>>>0&255,F[Y+3]=this.h[1]>>>8&255,F[Y+4]=this.h[2]>>>0&255,F[Y+5]=this.h[2]>>>8&255,F[Y+6]=this.h[3]>>>0&255,F[Y+7]=this.h[3]>>>8&255,F[Y+8]=this.h[4]>>>0&255,F[Y+9]=this.h[4]>>>8&255,F[Y+10]=this.h[5]>>>0&255,F[Y+11]=this.h[5]>>>8&255,F[Y+12]=this.h[6]>>>0&255,F[Y+13]=this.h[6]>>>8&255,F[Y+14]=this.h[7]>>>0&255,F[Y+15]=this.h[7]>>>8&255},re.prototype.update=function(F,Y,Q){var M,X;if(this.leftover){for(X=16-this.leftover,X>Q&&(X=Q),M=0;M<X;M++)this.buffer[this.leftover+M]=F[Y+M];if(Q-=X,Y+=X,this.leftover+=X,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(Q>=16&&(X=Q-Q%16,this.blocks(F,Y,X),Y+=X,Q-=X),Q){for(M=0;M<Q;M++)this.buffer[this.leftover+M]=F[Y+M];this.leftover+=Q}};function C(F,Y,Q,M,X,ge){var _e=new re(ge);return _e.update(Q,M,X),_e.finish(F,Y),0}function S(F,Y,Q,M,X,ge){var _e=new Uint8Array(16);return C(_e,0,Q,M,X,ge),k(F,Y,_e,0)}function w(F,Y,Q,M,X){var ge;if(Q<32)return-1;for(Qe(F,0,Y,0,Q,M,X),C(F,16,F,32,Q-32,F),ge=0;ge<16;ge++)F[ge]=0;return 0}function E(F,Y,Q,M,X){var ge,_e=new Uint8Array(32);if(Q<32||(ve(_e,0,32,M,X),S(Y,16,Y,32,Q-32,_e)!==0))return-1;for(Qe(F,0,Y,0,Q,M,X),ge=0;ge<32;ge++)F[ge]=0;return 0}function I(F,Y){var Q;for(Q=0;Q<16;Q++)F[Q]=Y[Q]|0}function N(F){var Y,Q,M=1;for(Y=0;Y<16;Y++)Q=F[Y]+M+65535,M=Math.floor(Q/65536),F[Y]=Q-M*65536;F[0]+=M-1+37*(M-1)}function U(F,Y,Q){for(var M,X=~(Q-1),ge=0;ge<16;ge++)M=X&(F[ge]^Y[ge]),F[ge]^=M,Y[ge]^=M}function L(F,Y){var Q,M,X,ge=t(),_e=t();for(Q=0;Q<16;Q++)_e[Q]=Y[Q];for(N(_e),N(_e),N(_e),M=0;M<2;M++){for(ge[0]=_e[0]-65517,Q=1;Q<15;Q++)ge[Q]=_e[Q]-65535-(ge[Q-1]>>16&1),ge[Q-1]&=65535;ge[15]=_e[15]-32767-(ge[14]>>16&1),X=ge[15]>>16&1,ge[14]&=65535,U(_e,ge,1-X)}for(Q=0;Q<16;Q++)F[2*Q]=_e[Q]&255,F[2*Q+1]=_e[Q]>>8}function P(F,Y){var Q=new Uint8Array(32),M=new Uint8Array(32);return L(Q,F),L(M,Y),D(Q,0,M,0)}function B(F){var Y=new Uint8Array(32);return L(Y,F),Y[0]&1}function A(F,Y){var Q;for(Q=0;Q<16;Q++)F[Q]=Y[2*Q]+(Y[2*Q+1]<<8);F[15]&=32767}function z(F,Y,Q){for(var M=0;M<16;M++)F[M]=Y[M]+Q[M]}function de(F,Y,Q){for(var M=0;M<16;M++)F[M]=Y[M]-Q[M]}function we(F,Y,Q){var M,X,ge=0,_e=0,Ce=0,je=0,Xe=0,Ve=0,zt=0,at=0,xt=0,St=0,kt=0,At=0,$t=0,vt=0,Et=0,it=0,yt=0,tt=0,st=0,ft=0,nt=0,ke=0,De=0,He=0,q=0,te=0,J=0,ce=0,ye=0,le=0,Se=0,ee=Q[0],Oe=Q[1],Fe=Q[2],Le=Q[3],Ge=Q[4],ct=Q[5],bt=Q[6],Pt=Q[7],Mt=Q[8],Rt=Q[9],Jt=Q[10],cr=Q[11],_r=Q[12],Ar=Q[13],$r=Q[14],kr=Q[15];M=Y[0],ge+=M*ee,_e+=M*Oe,Ce+=M*Fe,je+=M*Le,Xe+=M*Ge,Ve+=M*ct,zt+=M*bt,at+=M*Pt,xt+=M*Mt,St+=M*Rt,kt+=M*Jt,At+=M*cr,$t+=M*_r,vt+=M*Ar,Et+=M*$r,it+=M*kr,M=Y[1],_e+=M*ee,Ce+=M*Oe,je+=M*Fe,Xe+=M*Le,Ve+=M*Ge,zt+=M*ct,at+=M*bt,xt+=M*Pt,St+=M*Mt,kt+=M*Rt,At+=M*Jt,$t+=M*cr,vt+=M*_r,Et+=M*Ar,it+=M*$r,yt+=M*kr,M=Y[2],Ce+=M*ee,je+=M*Oe,Xe+=M*Fe,Ve+=M*Le,zt+=M*Ge,at+=M*ct,xt+=M*bt,St+=M*Pt,kt+=M*Mt,At+=M*Rt,$t+=M*Jt,vt+=M*cr,Et+=M*_r,it+=M*Ar,yt+=M*$r,tt+=M*kr,M=Y[3],je+=M*ee,Xe+=M*Oe,Ve+=M*Fe,zt+=M*Le,at+=M*Ge,xt+=M*ct,St+=M*bt,kt+=M*Pt,At+=M*Mt,$t+=M*Rt,vt+=M*Jt,Et+=M*cr,it+=M*_r,yt+=M*Ar,tt+=M*$r,st+=M*kr,M=Y[4],Xe+=M*ee,Ve+=M*Oe,zt+=M*Fe,at+=M*Le,xt+=M*Ge,St+=M*ct,kt+=M*bt,At+=M*Pt,$t+=M*Mt,vt+=M*Rt,Et+=M*Jt,it+=M*cr,yt+=M*_r,tt+=M*Ar,st+=M*$r,ft+=M*kr,M=Y[5],Ve+=M*ee,zt+=M*Oe,at+=M*Fe,xt+=M*Le,St+=M*Ge,kt+=M*ct,At+=M*bt,$t+=M*Pt,vt+=M*Mt,Et+=M*Rt,it+=M*Jt,yt+=M*cr,tt+=M*_r,st+=M*Ar,ft+=M*$r,nt+=M*kr,M=Y[6],zt+=M*ee,at+=M*Oe,xt+=M*Fe,St+=M*Le,kt+=M*Ge,At+=M*ct,$t+=M*bt,vt+=M*Pt,Et+=M*Mt,it+=M*Rt,yt+=M*Jt,tt+=M*cr,st+=M*_r,ft+=M*Ar,nt+=M*$r,ke+=M*kr,M=Y[7],at+=M*ee,xt+=M*Oe,St+=M*Fe,kt+=M*Le,At+=M*Ge,$t+=M*ct,vt+=M*bt,Et+=M*Pt,it+=M*Mt,yt+=M*Rt,tt+=M*Jt,st+=M*cr,ft+=M*_r,nt+=M*Ar,ke+=M*$r,De+=M*kr,M=Y[8],xt+=M*ee,St+=M*Oe,kt+=M*Fe,At+=M*Le,$t+=M*Ge,vt+=M*ct,Et+=M*bt,it+=M*Pt,yt+=M*Mt,tt+=M*Rt,st+=M*Jt,ft+=M*cr,nt+=M*_r,ke+=M*Ar,De+=M*$r,He+=M*kr,M=Y[9],St+=M*ee,kt+=M*Oe,At+=M*Fe,$t+=M*Le,vt+=M*Ge,Et+=M*ct,it+=M*bt,yt+=M*Pt,tt+=M*Mt,st+=M*Rt,ft+=M*Jt,nt+=M*cr,ke+=M*_r,De+=M*Ar,He+=M*$r,q+=M*kr,M=Y[10],kt+=M*ee,At+=M*Oe,$t+=M*Fe,vt+=M*Le,Et+=M*Ge,it+=M*ct,yt+=M*bt,tt+=M*Pt,st+=M*Mt,ft+=M*Rt,nt+=M*Jt,ke+=M*cr,De+=M*_r,He+=M*Ar,q+=M*$r,te+=M*kr,M=Y[11],At+=M*ee,$t+=M*Oe,vt+=M*Fe,Et+=M*Le,it+=M*Ge,yt+=M*ct,tt+=M*bt,st+=M*Pt,ft+=M*Mt,nt+=M*Rt,ke+=M*Jt,De+=M*cr,He+=M*_r,q+=M*Ar,te+=M*$r,J+=M*kr,M=Y[12],$t+=M*ee,vt+=M*Oe,Et+=M*Fe,it+=M*Le,yt+=M*Ge,tt+=M*ct,st+=M*bt,ft+=M*Pt,nt+=M*Mt,ke+=M*Rt,De+=M*Jt,He+=M*cr,q+=M*_r,te+=M*Ar,J+=M*$r,ce+=M*kr,M=Y[13],vt+=M*ee,Et+=M*Oe,it+=M*Fe,yt+=M*Le,tt+=M*Ge,st+=M*ct,ft+=M*bt,nt+=M*Pt,ke+=M*Mt,De+=M*Rt,He+=M*Jt,q+=M*cr,te+=M*_r,J+=M*Ar,ce+=M*$r,ye+=M*kr,M=Y[14],Et+=M*ee,it+=M*Oe,yt+=M*Fe,tt+=M*Le,st+=M*Ge,ft+=M*ct,nt+=M*bt,ke+=M*Pt,De+=M*Mt,He+=M*Rt,q+=M*Jt,te+=M*cr,J+=M*_r,ce+=M*Ar,ye+=M*$r,le+=M*kr,M=Y[15],it+=M*ee,yt+=M*Oe,tt+=M*Fe,st+=M*Le,ft+=M*Ge,nt+=M*ct,ke+=M*bt,De+=M*Pt,He+=M*Mt,q+=M*Rt,te+=M*Jt,J+=M*cr,ce+=M*_r,ye+=M*Ar,le+=M*$r,Se+=M*kr,ge+=38*yt,_e+=38*tt,Ce+=38*st,je+=38*ft,Xe+=38*nt,Ve+=38*ke,zt+=38*De,at+=38*He,xt+=38*q,St+=38*te,kt+=38*J,At+=38*ce,$t+=38*ye,vt+=38*le,Et+=38*Se,X=1,M=ge+X+65535,X=Math.floor(M/65536),ge=M-X*65536,M=_e+X+65535,X=Math.floor(M/65536),_e=M-X*65536,M=Ce+X+65535,X=Math.floor(M/65536),Ce=M-X*65536,M=je+X+65535,X=Math.floor(M/65536),je=M-X*65536,M=Xe+X+65535,X=Math.floor(M/65536),Xe=M-X*65536,M=Ve+X+65535,X=Math.floor(M/65536),Ve=M-X*65536,M=zt+X+65535,X=Math.floor(M/65536),zt=M-X*65536,M=at+X+65535,X=Math.floor(M/65536),at=M-X*65536,M=xt+X+65535,X=Math.floor(M/65536),xt=M-X*65536,M=St+X+65535,X=Math.floor(M/65536),St=M-X*65536,M=kt+X+65535,X=Math.floor(M/65536),kt=M-X*65536,M=At+X+65535,X=Math.floor(M/65536),At=M-X*65536,M=$t+X+65535,X=Math.floor(M/65536),$t=M-X*65536,M=vt+X+65535,X=Math.floor(M/65536),vt=M-X*65536,M=Et+X+65535,X=Math.floor(M/65536),Et=M-X*65536,M=it+X+65535,X=Math.floor(M/65536),it=M-X*65536,ge+=X-1+37*(X-1),X=1,M=ge+X+65535,X=Math.floor(M/65536),ge=M-X*65536,M=_e+X+65535,X=Math.floor(M/65536),_e=M-X*65536,M=Ce+X+65535,X=Math.floor(M/65536),Ce=M-X*65536,M=je+X+65535,X=Math.floor(M/65536),je=M-X*65536,M=Xe+X+65535,X=Math.floor(M/65536),Xe=M-X*65536,M=Ve+X+65535,X=Math.floor(M/65536),Ve=M-X*65536,M=zt+X+65535,X=Math.floor(M/65536),zt=M-X*65536,M=at+X+65535,X=Math.floor(M/65536),at=M-X*65536,M=xt+X+65535,X=Math.floor(M/65536),xt=M-X*65536,M=St+X+65535,X=Math.floor(M/65536),St=M-X*65536,M=kt+X+65535,X=Math.floor(M/65536),kt=M-X*65536,M=At+X+65535,X=Math.floor(M/65536),At=M-X*65536,M=$t+X+65535,X=Math.floor(M/65536),$t=M-X*65536,M=vt+X+65535,X=Math.floor(M/65536),vt=M-X*65536,M=Et+X+65535,X=Math.floor(M/65536),Et=M-X*65536,M=it+X+65535,X=Math.floor(M/65536),it=M-X*65536,ge+=X-1+37*(X-1),F[0]=ge,F[1]=_e,F[2]=Ce,F[3]=je,F[4]=Xe,F[5]=Ve,F[6]=zt,F[7]=at,F[8]=xt,F[9]=St,F[10]=kt,F[11]=At,F[12]=$t,F[13]=vt,F[14]=Et,F[15]=it}function se(F,Y){we(F,Y,Y)}function he(F,Y){var Q=t(),M;for(M=0;M<16;M++)Q[M]=Y[M];for(M=253;M>=0;M--)se(Q,Q),M!==2&&M!==4&&we(Q,Q,Y);for(M=0;M<16;M++)F[M]=Q[M]}function $e(F,Y){var Q=t(),M;for(M=0;M<16;M++)Q[M]=Y[M];for(M=250;M>=0;M--)se(Q,Q),M!==1&&we(Q,Q,Y);for(M=0;M<16;M++)F[M]=Q[M]}function Ae(F,Y,Q){var M=new Uint8Array(32),X=new Float64Array(80),ge,_e,Ce=t(),je=t(),Xe=t(),Ve=t(),zt=t(),at=t();for(_e=0;_e<31;_e++)M[_e]=Y[_e];for(M[31]=Y[31]&127|64,M[0]&=248,A(X,Q),_e=0;_e<16;_e++)je[_e]=X[_e],Ve[_e]=Ce[_e]=Xe[_e]=0;for(Ce[0]=Ve[0]=1,_e=254;_e>=0;--_e)ge=M[_e>>>3]>>>(_e&7)&1,U(Ce,je,ge),U(Xe,Ve,ge),z(zt,Ce,Xe),de(Ce,Ce,Xe),z(Xe,je,Ve),de(je,je,Ve),se(Ve,zt),se(at,Ce),we(Ce,Xe,Ce),we(Xe,je,zt),z(zt,Ce,Xe),de(Ce,Ce,Xe),se(je,Ce),de(Xe,Ve,at),we(Ce,Xe,d),z(Ce,Ce,Ve),we(Xe,Xe,Ce),we(Ce,Ve,at),we(Ve,je,X),se(je,zt),U(Ce,je,ge),U(Xe,Ve,ge);for(_e=0;_e<16;_e++)X[_e+16]=Ce[_e],X[_e+32]=Xe[_e],X[_e+48]=je[_e],X[_e+64]=Ve[_e];var xt=X.subarray(32),St=X.subarray(16);return he(xt,xt),we(St,St,xt),L(F,St),0}function ze(F,Y){return Ae(F,Y,a)}function oe(F,Y){return i(Y,32),ze(F,Y)}function ie(F,Y,Q){var M=new Uint8Array(32);return Ae(M,Q,Y),W(F,o,M,ae)}var Ie=w,qe=E;function Ze(F,Y,Q,M,X,ge){var _e=new Uint8Array(32);return ie(_e,X,ge),Ie(F,Y,Q,M,_e)}function lt(F,Y,Q,M,X,ge){var _e=new Uint8Array(32);return ie(_e,X,ge),qe(F,Y,Q,M,_e)}var ht=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function gt(F,Y,Q,M){for(var X=new Int32Array(16),ge=new Int32Array(16),_e,Ce,je,Xe,Ve,zt,at,xt,St,kt,At,$t,vt,Et,it,yt,tt,st,ft,nt,ke,De,He,q,te,J,ce=F[0],ye=F[1],le=F[2],Se=F[3],ee=F[4],Oe=F[5],Fe=F[6],Le=F[7],Ge=Y[0],ct=Y[1],bt=Y[2],Pt=Y[3],Mt=Y[4],Rt=Y[5],Jt=Y[6],cr=Y[7],_r=0;M>=128;){for(ft=0;ft<16;ft++)nt=8*ft+_r,X[ft]=Q[nt+0]<<24|Q[nt+1]<<16|Q[nt+2]<<8|Q[nt+3],ge[ft]=Q[nt+4]<<24|Q[nt+5]<<16|Q[nt+6]<<8|Q[nt+7];for(ft=0;ft<80;ft++)if(_e=ce,Ce=ye,je=le,Xe=Se,Ve=ee,zt=Oe,at=Fe,xt=Le,St=Ge,kt=ct,At=bt,$t=Pt,vt=Mt,Et=Rt,it=Jt,yt=cr,ke=Le,De=cr,He=De&65535,q=De>>>16,te=ke&65535,J=ke>>>16,ke=(ee>>>14|Mt<<32-14)^(ee>>>18|Mt<<32-18)^(Mt>>>41-32|ee<<32-(41-32)),De=(Mt>>>14|ee<<32-14)^(Mt>>>18|ee<<32-18)^(ee>>>41-32|Mt<<32-(41-32)),He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,ke=ee&Oe^~ee&Fe,De=Mt&Rt^~Mt&Jt,He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,ke=ht[ft*2],De=ht[ft*2+1],He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,ke=X[ft%16],De=ge[ft%16],He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,q+=He>>>16,te+=q>>>16,J+=te>>>16,tt=te&65535|J<<16,st=He&65535|q<<16,ke=tt,De=st,He=De&65535,q=De>>>16,te=ke&65535,J=ke>>>16,ke=(ce>>>28|Ge<<32-28)^(Ge>>>34-32|ce<<32-(34-32))^(Ge>>>39-32|ce<<32-(39-32)),De=(Ge>>>28|ce<<32-28)^(ce>>>34-32|Ge<<32-(34-32))^(ce>>>39-32|Ge<<32-(39-32)),He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,ke=ce&ye^ce&le^ye&le,De=Ge&ct^Ge&bt^ct&bt,He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,q+=He>>>16,te+=q>>>16,J+=te>>>16,xt=te&65535|J<<16,yt=He&65535|q<<16,ke=Xe,De=$t,He=De&65535,q=De>>>16,te=ke&65535,J=ke>>>16,ke=tt,De=st,He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,q+=He>>>16,te+=q>>>16,J+=te>>>16,Xe=te&65535|J<<16,$t=He&65535|q<<16,ye=_e,le=Ce,Se=je,ee=Xe,Oe=Ve,Fe=zt,Le=at,ce=xt,ct=St,bt=kt,Pt=At,Mt=$t,Rt=vt,Jt=Et,cr=it,Ge=yt,ft%16===15)for(nt=0;nt<16;nt++)ke=X[nt],De=ge[nt],He=De&65535,q=De>>>16,te=ke&65535,J=ke>>>16,ke=X[(nt+9)%16],De=ge[(nt+9)%16],He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,tt=X[(nt+1)%16],st=ge[(nt+1)%16],ke=(tt>>>1|st<<32-1)^(tt>>>8|st<<32-8)^tt>>>7,De=(st>>>1|tt<<32-1)^(st>>>8|tt<<32-8)^(st>>>7|tt<<32-7),He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,tt=X[(nt+14)%16],st=ge[(nt+14)%16],ke=(tt>>>19|st<<32-19)^(st>>>61-32|tt<<32-(61-32))^tt>>>6,De=(st>>>19|tt<<32-19)^(tt>>>61-32|st<<32-(61-32))^(st>>>6|tt<<32-6),He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,q+=He>>>16,te+=q>>>16,J+=te>>>16,X[nt]=te&65535|J<<16,ge[nt]=He&65535|q<<16;ke=ce,De=Ge,He=De&65535,q=De>>>16,te=ke&65535,J=ke>>>16,ke=F[0],De=Y[0],He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,q+=He>>>16,te+=q>>>16,J+=te>>>16,F[0]=ce=te&65535|J<<16,Y[0]=Ge=He&65535|q<<16,ke=ye,De=ct,He=De&65535,q=De>>>16,te=ke&65535,J=ke>>>16,ke=F[1],De=Y[1],He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,q+=He>>>16,te+=q>>>16,J+=te>>>16,F[1]=ye=te&65535|J<<16,Y[1]=ct=He&65535|q<<16,ke=le,De=bt,He=De&65535,q=De>>>16,te=ke&65535,J=ke>>>16,ke=F[2],De=Y[2],He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,q+=He>>>16,te+=q>>>16,J+=te>>>16,F[2]=le=te&65535|J<<16,Y[2]=bt=He&65535|q<<16,ke=Se,De=Pt,He=De&65535,q=De>>>16,te=ke&65535,J=ke>>>16,ke=F[3],De=Y[3],He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,q+=He>>>16,te+=q>>>16,J+=te>>>16,F[3]=Se=te&65535|J<<16,Y[3]=Pt=He&65535|q<<16,ke=ee,De=Mt,He=De&65535,q=De>>>16,te=ke&65535,J=ke>>>16,ke=F[4],De=Y[4],He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,q+=He>>>16,te+=q>>>16,J+=te>>>16,F[4]=ee=te&65535|J<<16,Y[4]=Mt=He&65535|q<<16,ke=Oe,De=Rt,He=De&65535,q=De>>>16,te=ke&65535,J=ke>>>16,ke=F[5],De=Y[5],He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,q+=He>>>16,te+=q>>>16,J+=te>>>16,F[5]=Oe=te&65535|J<<16,Y[5]=Rt=He&65535|q<<16,ke=Fe,De=Jt,He=De&65535,q=De>>>16,te=ke&65535,J=ke>>>16,ke=F[6],De=Y[6],He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,q+=He>>>16,te+=q>>>16,J+=te>>>16,F[6]=Fe=te&65535|J<<16,Y[6]=Jt=He&65535|q<<16,ke=Le,De=cr,He=De&65535,q=De>>>16,te=ke&65535,J=ke>>>16,ke=F[7],De=Y[7],He+=De&65535,q+=De>>>16,te+=ke&65535,J+=ke>>>16,q+=He>>>16,te+=q>>>16,J+=te>>>16,F[7]=Le=te&65535|J<<16,Y[7]=cr=He&65535|q<<16,_r+=128,M-=128}return M}function Me(F,Y,Q){var M=new Int32Array(8),X=new Int32Array(8),ge=new Uint8Array(256),_e,Ce=Q;for(M[0]=1779033703,M[1]=3144134277,M[2]=1013904242,M[3]=2773480762,M[4]=1359893119,M[5]=2600822924,M[6]=528734635,M[7]=1541459225,X[0]=4089235720,X[1]=2227873595,X[2]=4271175723,X[3]=1595750129,X[4]=2917565137,X[5]=725511199,X[6]=4215389547,X[7]=327033209,gt(M,X,Y,Q),Q%=128,_e=0;_e<Q;_e++)ge[_e]=Y[Ce-Q+_e];for(ge[Q]=128,Q=256-128*(Q<112?1:0),ge[Q-9]=0,_(ge,Q-8,Ce/536870912|0,Ce<<3),gt(M,X,ge,Q),_e=0;_e<8;_e++)_(F,8*_e,M[_e],X[_e]);return 0}function jt(F,Y){var Q=t(),M=t(),X=t(),ge=t(),_e=t(),Ce=t(),je=t(),Xe=t(),Ve=t();de(Q,F[1],F[0]),de(Ve,Y[1],Y[0]),we(Q,Q,Ve),z(M,F[0],F[1]),z(Ve,Y[0],Y[1]),we(M,M,Ve),we(X,F[3],Y[3]),we(X,X,h),we(ge,F[2],Y[2]),z(ge,ge,ge),de(_e,M,Q),de(Ce,ge,X),z(je,ge,X),z(Xe,M,Q),we(F[0],_e,Ce),we(F[1],Xe,je),we(F[2],je,Ce),we(F[3],_e,Xe)}function ot(F,Y,Q){var M;for(M=0;M<4;M++)U(F[M],Y[M],Q)}function Ot(F,Y){var Q=t(),M=t(),X=t();he(X,Y[2]),we(Q,Y[0],X),we(M,Y[1],X),L(F,M),F[31]^=B(Q)<<7}function Ut(F,Y,Q){var M,X;for(I(F[0],c),I(F[1],u),I(F[2],u),I(F[3],c),X=255;X>=0;--X)M=Q[X/8|0]>>(X&7)&1,ot(F,Y,M),jt(Y,F),jt(F,F),ot(F,Y,M)}function be(F,Y){var Q=[t(),t(),t(),t()];I(Q[0],b),I(Q[1],m),I(Q[2],u),we(Q[3],b,m),Ut(F,Q,Y)}function Pe(F,Y,Q){var M=new Uint8Array(64),X=[t(),t(),t(),t()],ge;for(Q||i(Y,32),Me(M,Y,32),M[0]&=248,M[31]&=127,M[31]|=64,be(X,M),Ot(F,X),ge=0;ge<32;ge++)Y[ge+32]=F[ge];return 0}var Be=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Re(F,Y){var Q,M,X,ge;for(M=63;M>=32;--M){for(Q=0,X=M-32,ge=M-12;X<ge;++X)Y[X]+=Q-16*Y[M]*Be[X-(M-32)],Q=Math.floor((Y[X]+128)/256),Y[X]-=Q*256;Y[X]+=Q,Y[M]=0}for(Q=0,X=0;X<32;X++)Y[X]+=Q-(Y[31]>>4)*Be[X],Q=Y[X]>>8,Y[X]&=255;for(X=0;X<32;X++)Y[X]-=Q*Be[X];for(M=0;M<32;M++)Y[M+1]+=Y[M]>>8,F[M]=Y[M]&255}function Ye(F){var Y=new Float64Array(64),Q;for(Q=0;Q<64;Q++)Y[Q]=F[Q];for(Q=0;Q<64;Q++)F[Q]=0;Re(F,Y)}function Tt(F,Y,Q,M){var X=new Uint8Array(64),ge=new Uint8Array(64),_e=new Uint8Array(64),Ce,je,Xe=new Float64Array(64),Ve=[t(),t(),t(),t()];Me(X,M,32),X[0]&=248,X[31]&=127,X[31]|=64;var zt=Q+64;for(Ce=0;Ce<Q;Ce++)F[64+Ce]=Y[Ce];for(Ce=0;Ce<32;Ce++)F[32+Ce]=X[32+Ce];for(Me(_e,F.subarray(32),Q+32),Ye(_e),be(Ve,_e),Ot(F,Ve),Ce=32;Ce<64;Ce++)F[Ce]=M[Ce];for(Me(ge,F,Q+64),Ye(ge),Ce=0;Ce<64;Ce++)Xe[Ce]=0;for(Ce=0;Ce<32;Ce++)Xe[Ce]=_e[Ce];for(Ce=0;Ce<32;Ce++)for(je=0;je<32;je++)Xe[Ce+je]+=ge[Ce]*X[je];return Re(F.subarray(32),Xe),zt}function Je(F,Y){var Q=t(),M=t(),X=t(),ge=t(),_e=t(),Ce=t(),je=t();return I(F[2],u),A(F[1],Y),se(X,F[1]),we(ge,X,p),de(X,X,F[2]),z(ge,F[2],ge),se(_e,ge),se(Ce,_e),we(je,Ce,_e),we(Q,je,X),we(Q,Q,ge),$e(Q,Q),we(Q,Q,X),we(Q,Q,ge),we(Q,Q,ge),we(F[0],Q,ge),se(M,F[0]),we(M,M,ge),P(M,X)&&we(F[0],F[0],v),se(M,F[0]),we(M,M,ge),P(M,X)?-1:(B(F[0])===Y[31]>>7&&de(F[0],c,F[0]),we(F[3],F[0],F[1]),0)}function dt(F,Y,Q,M){var X,ge=new Uint8Array(32),_e=new Uint8Array(64),Ce=[t(),t(),t(),t()],je=[t(),t(),t(),t()];if(Q<64||Je(je,M))return-1;for(X=0;X<Q;X++)F[X]=Y[X];for(X=0;X<32;X++)F[X+32]=M[X];if(Me(_e,F,Q),Ye(_e),Ut(Ce,je,_e),be(je,Y.subarray(32)),jt(Ce,je),Ot(ge,Ce),Q-=64,D(Y,0,ge,0)){for(X=0;X<Q;X++)F[X]=0;return-1}for(X=0;X<Q;X++)F[X]=Y[X+64];return Q}var rt=32,et=24,pt=32,Kt=16,Ct=32,er=32,nr=32,It=32,Qt=32,fr=et,qt=pt,lr=Kt,Xt=64,Dt=32,ir=64,ar=32,Lt=64;e.lowlevel={crypto_core_hsalsa20:W,crypto_stream_xor:Qe,crypto_stream:ve,crypto_stream_salsa20_xor:fe,crypto_stream_salsa20:pe,crypto_onetimeauth:C,crypto_onetimeauth_verify:S,crypto_verify_16:k,crypto_verify_32:D,crypto_secretbox:w,crypto_secretbox_open:E,crypto_scalarmult:Ae,crypto_scalarmult_base:ze,crypto_box_beforenm:ie,crypto_box_afternm:Ie,crypto_box:Ze,crypto_box_open:lt,crypto_box_keypair:oe,crypto_hash:Me,crypto_sign:Tt,crypto_sign_keypair:Pe,crypto_sign_open:dt,crypto_secretbox_KEYBYTES:rt,crypto_secretbox_NONCEBYTES:et,crypto_secretbox_ZEROBYTES:pt,crypto_secretbox_BOXZEROBYTES:Kt,crypto_scalarmult_BYTES:Ct,crypto_scalarmult_SCALARBYTES:er,crypto_box_PUBLICKEYBYTES:nr,crypto_box_SECRETKEYBYTES:It,crypto_box_BEFORENMBYTES:Qt,crypto_box_NONCEBYTES:fr,crypto_box_ZEROBYTES:qt,crypto_box_BOXZEROBYTES:lr,crypto_sign_BYTES:Xt,crypto_sign_PUBLICKEYBYTES:Dt,crypto_sign_SECRETKEYBYTES:ir,crypto_sign_SEEDBYTES:ar,crypto_hash_BYTES:Lt,gf:t,D:p,L:Be,pack25519:L,unpack25519:A,M:we,A:z,S:se,Z:de,pow2523:$e,add:jt,set25519:I,modL:Re,scalarmult:Ut,scalarbase:be};function dr(F,Y){if(F.length!==rt)throw new Error("bad key size");if(Y.length!==et)throw new Error("bad nonce size")}function yr(F,Y){if(F.length!==nr)throw new Error("bad public key size");if(Y.length!==It)throw new Error("bad secret key size")}function _t(){for(var F=0;F<arguments.length;F++)if(!(arguments[F]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function hr(F){for(var Y=0;Y<F.length;Y++)F[Y]=0}e.randomBytes=function(F){var Y=new Uint8Array(F);return i(Y,F),Y},e.secretbox=function(F,Y,Q){_t(F,Y,Q),dr(Q,Y);for(var M=new Uint8Array(pt+F.length),X=new Uint8Array(M.length),ge=0;ge<F.length;ge++)M[ge+pt]=F[ge];return w(X,M,M.length,Y,Q),X.subarray(Kt)},e.secretbox.open=function(F,Y,Q){_t(F,Y,Q),dr(Q,Y);for(var M=new Uint8Array(Kt+F.length),X=new Uint8Array(M.length),ge=0;ge<F.length;ge++)M[ge+Kt]=F[ge];return M.length<32||E(X,M,M.length,Y,Q)!==0?null:X.subarray(pt)},e.secretbox.keyLength=rt,e.secretbox.nonceLength=et,e.secretbox.overheadLength=Kt,e.scalarMult=function(F,Y){if(_t(F,Y),F.length!==er)throw new Error("bad n size");if(Y.length!==Ct)throw new Error("bad p size");var Q=new Uint8Array(Ct);return Ae(Q,F,Y),Q},e.scalarMult.base=function(F){if(_t(F),F.length!==er)throw new Error("bad n size");var Y=new Uint8Array(Ct);return ze(Y,F),Y},e.scalarMult.scalarLength=er,e.scalarMult.groupElementLength=Ct,e.box=function(F,Y,Q,M){var X=e.box.before(Q,M);return e.secretbox(F,Y,X)},e.box.before=function(F,Y){_t(F,Y),yr(F,Y);var Q=new Uint8Array(Qt);return ie(Q,F,Y),Q},e.box.after=e.secretbox,e.box.open=function(F,Y,Q,M){var X=e.box.before(Q,M);return e.secretbox.open(F,Y,X)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var F=new Uint8Array(nr),Y=new Uint8Array(It);return oe(F,Y),{publicKey:F,secretKey:Y}},e.box.keyPair.fromSecretKey=function(F){if(_t(F),F.length!==It)throw new Error("bad secret key size");var Y=new Uint8Array(nr);return ze(Y,F),{publicKey:Y,secretKey:new Uint8Array(F)}},e.box.publicKeyLength=nr,e.box.secretKeyLength=It,e.box.sharedKeyLength=Qt,e.box.nonceLength=fr,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(F,Y){if(_t(F,Y),Y.length!==ir)throw new Error("bad secret key size");var Q=new Uint8Array(Xt+F.length);return Tt(Q,F,F.length,Y),Q},e.sign.open=function(F,Y){if(_t(F,Y),Y.length!==Dt)throw new Error("bad public key size");var Q=new Uint8Array(F.length),M=dt(Q,F,F.length,Y);if(M<0)return null;for(var X=new Uint8Array(M),ge=0;ge<X.length;ge++)X[ge]=Q[ge];return X},e.sign.detached=function(F,Y){for(var Q=e.sign(F,Y),M=new Uint8Array(Xt),X=0;X<M.length;X++)M[X]=Q[X];return M},e.sign.detached.verify=function(F,Y,Q){if(_t(F,Y,Q),Y.length!==Xt)throw new Error("bad signature size");if(Q.length!==Dt)throw new Error("bad public key size");var M=new Uint8Array(Xt+F.length),X=new Uint8Array(Xt+F.length),ge;for(ge=0;ge<Xt;ge++)M[ge]=Y[ge];for(ge=0;ge<F.length;ge++)M[ge+Xt]=F[ge];return dt(X,M,M.length,Q)>=0},e.sign.keyPair=function(){var F=new Uint8Array(Dt),Y=new Uint8Array(ir);return Pe(F,Y),{publicKey:F,secretKey:Y}},e.sign.keyPair.fromSecretKey=function(F){if(_t(F),F.length!==ir)throw new Error("bad secret key size");for(var Y=new Uint8Array(Dt),Q=0;Q<Y.length;Q++)Y[Q]=F[32+Q];return{publicKey:Y,secretKey:new Uint8Array(F)}},e.sign.keyPair.fromSeed=function(F){if(_t(F),F.length!==ar)throw new Error("bad seed size");for(var Y=new Uint8Array(Dt),Q=new Uint8Array(ir),M=0;M<32;M++)Q[M]=F[M];return Pe(Y,Q,!0),{publicKey:Y,secretKey:Q}},e.sign.publicKeyLength=Dt,e.sign.secretKeyLength=ir,e.sign.seedLength=ar,e.sign.signatureLength=Xt,e.hash=function(F){_t(F);var Y=new Uint8Array(Lt);return Me(Y,F,F.length),Y},e.hash.hashLength=Lt,e.verify=function(F,Y){return _t(F,Y),F.length===0||Y.length===0||F.length!==Y.length?!1:$(F,0,Y,0,F.length)===0},e.setPRNG=function(F){i=F},function(){var F=typeof self<"u"?self.crypto||self.msCrypto:null;if(F&&F.getRandomValues){var Y=65536;e.setPRNG(function(Q,M){var X,ge=new Uint8Array(M);for(X=0;X<M;X+=Y)F.getRandomValues(ge.subarray(X,X+Math.min(M-X,Y)));for(X=0;X<M;X++)Q[X]=ge[X];hr(ge)})}else typeof commonjsRequire<"u"&&(F=requireCryptoBrowserify(),F&&F.randomBytes&&e.setPRNG(function(Q,M){var X,ge=F.randomBytes(M);for(X=0;X<M;X++)Q[X]=ge[X];hr(ge)}))}()})(n.exports?n.exports:self.nacl=self.nacl||{})})(naclFast);var naclFastExports=naclFast.exports;const tweetnacl=getDefaultExportFromCjs(naclFastExports),KeyDoesNotExist=new Error("Key does not exist. Make sure you properly instantiated the keystore."),NotKeyPair=new Error("Retrieved a symmetric key when an asymmetric keypair was expected. Please use a different key name."),NotKey=new Error("Retrieved an asymmetric keypair when an symmetric key was expected. Please use a different key name."),ECCNotEnabled=new Error("ECC is not enabled for this browser. Please use RSA instead."),UnsupportedCrypto=new Error("Cryptosystem not supported. Please use ECC or RSA"),InvalidKeyUse=new Error("Invalid key use. Please use 'exchange' or 'write"),InvalidMaxValue=new Error("Max must be less than 256 and greater than 0");function checkIsKeyPair(n){if(!n||n===null)throw KeyDoesNotExist;if(n.privateKey===void 0)throw NotKeyPair;return n}function checkIsKey(n){if(!n||n===null)throw KeyDoesNotExist;if(n.privateKey!==void 0||n.algorithm===void 0)throw NotKey;return n}function checkValidCryptoSystem(n){checkValid(n,[CryptoSystem.ECC,CryptoSystem.RSA],UnsupportedCrypto)}function checkValidKeyUse(n){checkValid(n,[KeyUse.Exchange,KeyUse.Write],InvalidKeyUse)}function checkValid(n,e,t){if(!e.some(o=>o===n))throw t}const errors$1={KeyDoesNotExist,NotKeyPair,NotKey,ECCNotEnabled,UnsupportedCrypto,InvalidKeyUse,checkIsKeyPair,checkIsKey,checkValidCryptoSystem,checkValidKeyUse,InvalidMaxValue};function arrBufToStr(n,e){const t=e===8?new Uint8Array(n):new Uint16Array(n);return Array.from(t).map(i=>String.fromCharCode(i)).join("")}function arrBufToBase64(n){return toString$3(new Uint8Array(n),"base64pad")}function strToArrBuf(n,e){const t=e===8?new Uint8Array(n.length):new Uint16Array(n.length);for(let i=0,o=n.length;i<o;i++)t[i]=n.charCodeAt(i);return t.buffer}function base64ToArrBuf(n){return fromString$3(n,"base64pad").buffer}function publicExponent(){return new Uint8Array([1,0,1])}function randomBuf(n,{max:e}={max:255}){if(e<1||e>255)throw errors$1.InvalidMaxValue;const t=new Uint8Array(n);if(e==255)return webcrypto.getRandomValues(t),t.buffer;let i=0;const o=e+1,a=Math.floor(256/o)*o,c=new Uint8Array(1);for(;i<t.length;)webcrypto.getRandomValues(c),c[0]<a&&(t[i]=c[0]%o,i++);return t.buffer}function joinBufs(n,e){const t=new Uint8Array(n),i=new Uint8Array(e),o=new Uint8Array(t.length+i.length);return o.set(t),o.set(i,t.length),o.buffer}const normalizeUtf8ToBuf=n=>normalizeToBuf(n,e=>strToArrBuf(e,CharSize.B8)),normalizeUtf16ToBuf=n=>normalizeToBuf(n,e=>strToArrBuf(e,CharSize.B16)),normalizeBase64ToBuf=n=>normalizeToBuf(n,base64ToArrBuf),normalizeUnicodeToBuf=(n,e)=>{switch(e){case 8:return normalizeUtf8ToBuf(n);default:return normalizeUtf16ToBuf(n)}},normalizeToBuf=(n,e)=>{if(typeof n=="string")return e(n);if(typeof n=="object"&&n.byteLength!==void 0)return new Uint8Array(n).buffer;throw new Error("Improper value. Must be a string, ArrayBuffer, Uint8Array")};async function structuralClone(n){return new Promise(e=>{const{port1:t,port2:i}=new MessageChannel;i.onmessage=o=>e(o.data),t.postMessage(n)})}const utils={arrBufToStr,arrBufToBase64,strToArrBuf,base64ToArrBuf,publicExponent,randomBuf,joinBufs,normalizeUtf8ToBuf,normalizeUtf16ToBuf,normalizeBase64ToBuf,normalizeToBuf,structuralClone},ECC_EXCHANGE_ALG="ECDH",ECC_WRITE_ALG="ECDSA",RSA_EXCHANGE_ALG="RSA-OAEP",RSA_WRITE_ALG="RSASSA-PKCS1-v1_5",SALT_LENGTH=128,DEFAULT_CRYPTOSYSTEM="ecc",DEFAULT_ECC_CURVE=EccCurve.P_256,DEFAULT_RSA_SIZE=RsaSize.B2048,DEFAULT_SYMM_ALG=SymmAlg.AES_CTR,DEFAULT_SYMM_LEN=SymmKeyLength.B256,DEFAULT_CTR_LEN=64,DEFAULT_HASH_ALG=HashAlg.SHA_256,DEFAULT_CHAR_SIZE=CharSize.B16,DEFAULT_STORE_NAME="keystore",DEFAULT_EXCHANGE_KEY_NAME="exchange-key",DEFAULT_WRITE_KEY_NAME="write-key";async function makeKey(n){return webcrypto.subtle.generateKey({name:n?.alg||DEFAULT_SYMM_ALG,length:n?.length||DEFAULT_SYMM_LEN},!0,["encrypt","decrypt"])}async function importKey(n,e){const t=utils.base64ToArrBuf(n);return webcrypto.subtle.importKey("raw",t,{name:e?.alg||DEFAULT_SYMM_ALG,length:e?.length||DEFAULT_SYMM_LEN},!0,["encrypt","decrypt"])}const keys$1={makeKey,importKey};async function encryptBytes(n,e,t){const i=utils.normalizeUtf16ToBuf(n),o=typeof e=="string"?await keys$1.importKey(e,t):e,a=t?.alg||DEFAULT_SYMM_ALG,c=t?.iv||utils.randomBuf(16),u=await webcrypto.subtle.encrypt({name:a,iv:a===SymmAlg.AES_CTR?void 0:c,counter:a===SymmAlg.AES_CTR?new Uint8Array(c):void 0,length:a===SymmAlg.AES_CTR?DEFAULT_CTR_LEN:void 0},o,i);return utils.joinBufs(c,u)}async function decryptBytes(n,e,t){const i=utils.normalizeBase64ToBuf(n),o=typeof e=="string"?await keys$1.importKey(e,t):e,a=t?.alg||DEFAULT_SYMM_ALG,c=i.slice(0,16),u=i.slice(16);return await webcrypto.subtle.decrypt({name:a,iv:a===SymmAlg.AES_CTR?void 0:c,counter:a===SymmAlg.AES_CTR?new Uint8Array(c):void 0,length:a===SymmAlg.AES_CTR?DEFAULT_CTR_LEN:void 0},o,u)}async function encrypt$1(n,e,t){const i=await encryptBytes(n,e,t);return utils.arrBufToBase64(i)}async function decrypt$1(n,e,t){const i=await decryptBytes(n,e,t);return utils.arrBufToStr(i,16)}async function exportKey(n){const e=await webcrypto.subtle.exportKey("raw",n);return utils.arrBufToBase64(e)}const operations$1={encryptBytes,decryptBytes,encrypt:encrypt$1,decrypt:decrypt$1,exportKey},aes$1={...keys$1,...operations$1};async function makeKeypair$1(n,e,t){checkValidKeyUse(t);const i=t===KeyUse.Exchange?RSA_EXCHANGE_ALG:RSA_WRITE_ALG,o=t===KeyUse.Exchange?["encrypt","decrypt"]:["sign","verify"];return webcrypto.subtle.generateKey({name:i,modulusLength:n,publicExponent:utils.publicExponent(),hash:{name:e}},!1,o)}function stripKeyHeader(n){return n.replace(`-----BEGIN PUBLIC KEY-----
`,"").replace(`
-----END PUBLIC KEY-----`,"")}async function importPublicKey$1(n,e,t){checkValidKeyUse(t);const i=t===KeyUse.Exchange?RSA_EXCHANGE_ALG:RSA_WRITE_ALG,o=t===KeyUse.Exchange?["encrypt"]:["verify"],a=utils.base64ToArrBuf(stripKeyHeader(n));return webcrypto.subtle.importKey("spki",a,{name:i,hash:{name:e}},!0,o)}const keys={makeKeypair:makeKeypair$1,importPublicKey:importPublicKey$1};async function sign(n,e,t=DEFAULT_CHAR_SIZE){return webcrypto.subtle.sign({name:RSA_WRITE_ALG,saltLength:SALT_LENGTH},e,normalizeUnicodeToBuf(n,t))}async function verify(n,e,t,i=DEFAULT_CHAR_SIZE,o=DEFAULT_HASH_ALG){return webcrypto.subtle.verify({name:RSA_WRITE_ALG,saltLength:SALT_LENGTH},typeof t=="string"?await keys.importPublicKey(t,o,KeyUse.Write):t,normalizeBase64ToBuf(e),normalizeUnicodeToBuf(n,i))}async function encrypt(n,e,t=DEFAULT_CHAR_SIZE,i=DEFAULT_HASH_ALG){return webcrypto.subtle.encrypt({name:RSA_EXCHANGE_ALG},typeof e=="string"?await keys.importPublicKey(e,i,KeyUse.Exchange):e,normalizeUnicodeToBuf(n,t))}async function decrypt(n,e){const t=normalizeBase64ToBuf(n);return webcrypto.subtle.decrypt({name:RSA_EXCHANGE_ALG},e,t)}async function getPublicKey(n){const e=await webcrypto.subtle.exportKey("spki",n.publicKey);return utils.arrBufToBase64(e)}const operations={sign,verify,encrypt,decrypt,getPublicKey};function createStore(n){return localforage.createInstance({name:n})}async function createIfDoesNotExist(n,e,t=localforage){if(await exists(n,t))return;const i=await e();await put(n,i,t)}async function put(n,e,t=localforage){return t.setItem(n,e)}async function getKeypair(n,e=localforage){return get$1(n,checkIsKeyPair,e)}async function getKey(n,e=localforage){return get$1(n,checkIsKey,e)}async function get$1(n,e,t=localforage){const i=await t.getItem(n);return i===null?null:e(i)}async function exists(n,e=localforage){return await e.getItem(n)!==null}async function rm(n,e=localforage){return e.removeItem(n)}async function dropStore(n){return n.dropInstance()}async function clear$1(n){return n?dropStore(n):localforage.clear()}const IDB={createStore,createIfDoesNotExist,put,getKeypair,getKey,exists,rm,dropStore,clear:clear$1};async function makeKeypair(n,e){checkValidKeyUse(e);const t=e===KeyUse.Exchange?ECC_EXCHANGE_ALG:ECC_WRITE_ALG,i=e===KeyUse.Exchange?["deriveKey","deriveBits"]:["sign","verify"];return webcrypto.subtle.generateKey({name:t,namedCurve:n},!1,i)}async function importPublicKey(n,e,t){checkValidKeyUse(t);const i=t===KeyUse.Exchange?ECC_EXCHANGE_ALG:ECC_WRITE_ALG,o=t===KeyUse.Exchange?[]:["verify"],a=utils.base64ToArrBuf(n);return webcrypto.subtle.importKey("raw",a,{name:i,namedCurve:e},!0,o)}const ecc={makeKeypair,importPublicKey},defaultConfig={type:DEFAULT_CRYPTOSYSTEM,curve:DEFAULT_ECC_CURVE,rsaSize:DEFAULT_RSA_SIZE,symmAlg:DEFAULT_SYMM_ALG,symmLen:DEFAULT_SYMM_LEN,hashAlg:DEFAULT_HASH_ALG,charSize:DEFAULT_CHAR_SIZE,storeName:DEFAULT_STORE_NAME,exchangeKeyName:DEFAULT_EXCHANGE_KEY_NAME,writeKeyName:DEFAULT_WRITE_KEY_NAME};function normalize(n,e=!0){let t;return n?t={...defaultConfig,...n}:t=defaultConfig,n?.type||(t.type=e?CryptoSystem.ECC:CryptoSystem.RSA),t}async function eccEnabled(){const n=await ecc.makeKeypair(DEFAULT_ECC_CURVE,KeyUse.Exchange);try{await utils.structuralClone(n)}catch{return!1}return!0}function merge(n,e={}){return{...n,...e}}function symmKeyOpts(n){return{alg:n.symmAlg,length:n.symmLen}}const config$1={defaultConfig,normalize,eccEnabled,merge,symmKeyOpts};class KeyStoreBase{constructor(e,t){this.cfg=e,this.store=t}async writeKey(){const e=await IDB.getKeypair(this.cfg.writeKeyName,this.store);return checkIsKeyPair(e)}async exchangeKey(){const e=await IDB.getKeypair(this.cfg.exchangeKeyName,this.store);return checkIsKeyPair(e)}async getSymmKey(e,t){const i=config$1.merge(this.cfg,t),o=await IDB.getKey(e,this.store);if(o!==null)return o;const a=await aes$1.makeKey(config$1.symmKeyOpts(i));return await IDB.put(e,a,this.store),a}async keyExists(e){return await IDB.getKey(e,this.store)!==null}async deleteKey(e){return IDB.rm(e,this.store)}async destroy(){return IDB.dropStore(this.store)}async importSymmKey(e,t,i){const o=config$1.merge(this.cfg,i),a=await aes$1.importKey(e,config$1.symmKeyOpts(o));await IDB.put(t,a,this.store)}async exportSymmKey(e,t){const i=await this.getSymmKey(e,t);return aes$1.exportKey(i)}async encryptWithSymmKey(e,t,i){const o=config$1.merge(this.cfg,i),a=await this.getSymmKey(t,i),c=await aes$1.encryptBytes(utils.strToArrBuf(e,o.charSize),a,config$1.symmKeyOpts(o));return utils.arrBufToBase64(c)}async decryptWithSymmKey(e,t,i){const o=config$1.merge(this.cfg,i),a=await this.getSymmKey(t,i),c=await aes$1.decryptBytes(utils.base64ToArrBuf(e),a,config$1.symmKeyOpts(o));return utils.arrBufToStr(c,o.charSize)}}class RSAKeyStore extends KeyStoreBase{static async init(e){const t=config$1.normalize({...e||{},type:CryptoSystem.RSA}),{rsaSize:i,hashAlg:o,storeName:a,exchangeKeyName:c,writeKeyName:u}=t,d=IDB.createStore(a);return await IDB.createIfDoesNotExist(c,()=>keys.makeKeypair(i,o,KeyUse.Exchange),d),await IDB.createIfDoesNotExist(u,()=>keys.makeKeypair(i,o,KeyUse.Write),d),new RSAKeyStore(t,d)}async sign(e,t){const i=config$1.merge(this.cfg,t),o=await this.writeKey();return utils.arrBufToBase64(await operations.sign(e,o.privateKey,i.charSize))}async verify(e,t,i,o){const a=config$1.merge(this.cfg,o);return operations.verify(e,t,i,a.charSize,a.hashAlg)}async encrypt(e,t,i){const o=config$1.merge(this.cfg,i);return utils.arrBufToBase64(await operations.encrypt(e,t,o.charSize,o.hashAlg))}async decrypt(e,t,i){const o=await this.exchangeKey(),a=config$1.merge(this.cfg,i);return utils.arrBufToStr(await operations.decrypt(e,o.privateKey),a.charSize)}async publicExchangeKey(){const e=await this.exchangeKey();return operations.getPublicKey(e)}async publicWriteKey(){const e=await this.writeKey();return operations.getPublicKey(e)}}const rsaOperations={...keys,...operations,...RSAKeyStore},aes={decrypt:aesDecrypt,encrypt:aesEncrypt,exportKey:aesExportKey,genKey:aesGenKey};function importAesKey(n,e){return webcrypto.subtle.importKey("raw",n,{name:e,length:SymmKeyLength.B256},!0,["encrypt","decrypt"])}async function aesDecrypt(n,e,t,i){const o=isCryptoKey(e)?e:await importAesKey(e,t),a=i?await webcrypto.subtle.decrypt({name:t,iv:i},o,n):await decryptBytes(n,o,{alg:t});return new Uint8Array(a)}async function aesEncrypt(n,e,t,i){const o=isCryptoKey(e)?e:await importAesKey(e,t),a=i?await webcrypto.subtle.encrypt({name:t,iv:i},o,n):await encryptBytes(n,o,{alg:t});return new Uint8Array(a)}async function aesExportKey(n){const e=await webcrypto.subtle.exportKey("raw",n);return new Uint8Array(e)}function aesGenKey(n){return makeKey({length:SymmKeyLength.B256,alg:n})}const did$1={keyTypes:{"bls12-381":{magicBytes:new Uint8Array([234,1]),verify:()=>{throw new Error("Not implemented")}},ed25519:{magicBytes:new Uint8Array([237,1]),verify:ed25519Verify},rsa:{magicBytes:new Uint8Array([0,245,2]),verify:rsaVerify}}};async function ed25519Verify({message:n,publicKey:e,signature:t}){return tweetnacl.sign.detached.verify(n,t,e)}async function rsaVerify({message:n,publicKey:e,signature:t}){return rsaOperations.verify(n,t,await webcrypto.subtle.importKey("spki",e,{name:RSA_WRITE_ALG,hash:RSA_HASHING_ALGORITHM},!1,["verify"]),8)}const hash$1={sha256:sha256$1};async function sha256$1(n){return new Uint8Array(await webcrypto.subtle.digest("sha-256",n))}function ksClearStore(n){return n.destroy()}async function ksDecrypt(n,e){const t=await n.exchangeKey();return rsaDecrypt(e,t.privateKey)}async function ksExportSymmKey(n,e){if(await n.keyExists(e)===!1)throw new Error(`Expected a key under the name '${e}', but couldn't find anything`);const t=await n.getSymmKey(e),i=await webcrypto.subtle.exportKey("raw",t);return new Uint8Array(i)}function ksGetAlgorithm(n){return Promise.resolve("rsa")}function ksGetUcanAlgorithm(n){return Promise.resolve("RS256")}function ksImportSymmKey(n,e,t){return n.importSymmKey(toString$3(e,"base64pad"),t)}function ksKeyExists(n,e){return n.keyExists(e)}async function ksPublicExchangeKey(n){const e=await n.exchangeKey(),t=await webcrypto.subtle.exportKey("spki",e.publicKey);return new Uint8Array(t)}async function ksPublicWriteKey(n){const e=await n.writeKey(),t=await webcrypto.subtle.exportKey("spki",e.publicKey);return new Uint8Array(t)}async function ksSign(n,e){const t=await n.writeKey(),i=await rsaOperations.sign(e,t.privateKey,n.cfg.charSize);return new Uint8Array(i)}const misc={randomNumbers};function randomNumbers(n){return webcrypto.getRandomValues(new Uint8Array(n.amount))}const rsa={decrypt:rsaDecrypt,encrypt:rsaEncrypt,exportPublicKey:rsaExportPublicKey,genKey:rsaGenKey},RSA_ALGORITHM="RSA-OAEP",RSA_HASHING_ALGORITHM="SHA-256";function importRsaKey(n,e){return webcrypto.subtle.importKey("spki",n,{name:RSA_ALGORITHM,hash:RSA_HASHING_ALGORITHM},!1,e)}async function rsaDecrypt(n,e){const t=await webcrypto.subtle.decrypt({name:RSA_ALGORITHM},isCryptoKey(e)?e:await importRsaKey(e,["decrypt"]),n);return new Uint8Array(t)}async function rsaEncrypt(n,e){const t=isCryptoKey(e)?e:await importRsaKey(e,["encrypt"]),i=await webcrypto.subtle.encrypt({name:RSA_ALGORITHM},t,n);return new Uint8Array(i)}async function rsaExportPublicKey(n){const e=await webcrypto.subtle.exportKey("spki",n);return new Uint8Array(e)}function rsaGenKey(){return webcrypto.subtle.generateKey({name:RSA_ALGORITHM,modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:RSA_HASHING_ALGORITHM}},!0,["encrypt","decrypt"])}async function implementation$e({storeName:n,exchangeKeyName:e,writeKeyName:t}){const i=await RSAKeyStore.init({charSize:8,hashAlg:HashAlg.SHA_256,storeName:n,exchangeKeyName:e,writeKeyName:t});return{aes,did:did$1,hash:hash$1,misc,rsa,keystore:{clearStore:(...o)=>ksClearStore(i,...o),decrypt:(...o)=>ksDecrypt(i,...o),exportSymmKey:(...o)=>ksExportSymmKey(i,...o),getAlgorithm:(...o)=>ksGetAlgorithm(i,...o),getUcanAlgorithm:(...o)=>ksGetUcanAlgorithm(i,...o),importSymmKey:(...o)=>ksImportSymmKey(i,...o),keyExists:(...o)=>ksKeyExists(i,...o),publicExchangeKey:(...o)=>ksPublicExchangeKey(i,...o),publicWriteKey:(...o)=>ksPublicWriteKey(i,...o),sign:(...o)=>ksSign(i,...o)}}}const KEYS={ACCOUNT_UCAN:"account-ucan",CID_LOG:"cid-log",SESSION:"session",UCANS:"permissioned-ucans"};function getItem(n,e){return assertBrowser("storage.getItem"),n.getItem(e)}function setItem(n,e,t){return assertBrowser("storage.setItem"),n.setItem(e,t)}function removeItem(n,e){return assertBrowser("storage.removeItem"),n.removeItem(e)}async function clear(n){return assertBrowser("storage.clear"),n.clear()}function implementation$d({name:n}){const e=localforage.createInstance({name:n});return{KEYS,getItem:(...t)=>getItem(e,...t),setItem:(...t)=>setItem(e,...t),removeItem:(...t)=>removeItem(e,...t),clear:(...t)=>clear(e,...t)}}async function lookupTxtRecord(n){return Promise.any([googleLookup(n),cloudflareLookup(n)])}async function googleLookup(n){return dnsOverHttps(`https://dns.google/resolve?name=${n}&type=txt`)}function cloudflareLookup(n){return dnsOverHttps(`https://cloudflare-dns.com/dns-query?name=${n}&type=txt`)}function dnsOverHttps(n){return fetch(n,{headers:{accept:"application/dns-json"}}).then(e=>e.json()).then(e=>{if(e.Answer){const t=e.Answer.map(i=>(i.data||"").replace(/^"+|"+$/g,""));return t[0][3]===";"?t.sort((i,o)=>i.slice(0,4).localeCompare(o.slice(0,4))).map(i=>i.slice(4)).join(""):t.join("")}else return null})}async function lookupDnsLink(n){const e=await lookupTxtRecord(n.startsWith("_dnslink.")?n:`_dnslink.${n}`);return e&&!e.includes("/ipns/")?e.replace(/^dnslink=/,"").replace(/^\/ipfs\//,""):null}const PRODUCTION={apiPath:"/v2/api",lobby:"https://auth.fission.codes",server:"https://runfission.com",userDomain:"fission.name"};function apiUrl(n,e){return`${n.server}${n.apiPath}${e?.length?"/"+e.replace(/^\/+/,""):""}`}const didCache={did:null,host:null,lastFetched:0};async function did(n){let e;try{e=new URL(n.server).host}catch{throw new Error("Unable to parse API Endpoint")}const t=Date.now();if((didCache.host!==e||didCache.lastFetched+1e3*60*60*3<=t)&&(didCache.did=await lookupTxtRecord("_did."+e),didCache.host=e,didCache.lastFetched=t),!didCache.did)throw new Error("Couldn't get the Fission API DID");return didCache.did}const RSA="RSA",identity$1=from$1({prefix:"\0",name:"identity",encode:n=>toString$2(n),decode:n=>fromString$2(n)}),identityBase=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$1},Symbol.toStringTag,{value:"Module"})),base2=rfc4648({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$1=Object.freeze(Object.defineProperty({__proto__:null,base2},Symbol.toStringTag,{value:"Module"})),base8=rfc4648({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$1=Object.freeze(Object.defineProperty({__proto__:null,base8},Symbol.toStringTag,{value:"Module"})),base10=baseX({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$1=Object.freeze(Object.defineProperty({__proto__:null,base10},Symbol.toStringTag,{value:"Module"})),base16=rfc4648({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper=rfc4648({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$1=Object.freeze(Object.defineProperty({__proto__:null,base16,base16upper},Symbol.toStringTag,{value:"Module"})),base36=baseX({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper=baseX({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$1=Object.freeze(Object.defineProperty({__proto__:null,base36,base36upper},Symbol.toStringTag,{value:"Module"})),base64=rfc4648({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad=rfc4648({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url=rfc4648({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad=rfc4648({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$1=Object.freeze(Object.defineProperty({__proto__:null,base64,base64pad,base64url,base64urlpad},Symbol.toStringTag,{value:"Module"})),alphabet=Array.from(""),alphabetBytesToChars=alphabet.reduce((n,e,t)=>(n[t]=e,n),[]),alphabetCharsToBytes=alphabet.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function encode$1(n){return n.reduce((e,t)=>(e+=alphabetBytesToChars[t],e),"")}function decode(n){const e=[];for(const t of n){const i=alphabetCharsToBytes[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const base256emoji=from$1({prefix:"",name:"base256emoji",encode:encode$1,decode}),base256emoji$1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji},Symbol.toStringTag,{value:"Module"})),sha=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),sha256=from({name:"sha2-256",code:18,encode:sha("SHA-256")}),code=0,name="identity",encode=coerce,digest=n=>create$5(code,encode(n)),identity={code,name,encode,digest};new TextEncoder;new TextDecoder;const bases={...identityBase,...base2$1,...base8$1,...base10$1,...base16$1,...base32$1,...base36$1,...base58,...base64$1,...base256emoji$1};Object.values(bases).map(n=>n.decoder).reduce((n,e)=>n.or(e),bases.identity.decoder);const log$7=debug("ipfs:repo:migrator:migration-8");function unwrap$1(n){return n.child?unwrap$1(n.child):n}function keyToMultihash$1(n){try{const e=base32.decode(`b${n.toString().toLowerCase().slice(1)}`),t=CID.decode(e).multihash.bytes,i=base32.encode(t).slice(1).toUpperCase();return new Key(`/${i}`,!1)}catch{return n}}function keyToCid$1(n){try{const e=base32.decode(`b${n.toString().toLowerCase().slice(1)}`),t=decode$6(e),i=base32.encode(CID.createV1(code$1,t).bytes).slice(1);return new Key(`/${i.toUpperCase()}`,!1)}catch{return n}}async function process$2(n,e,t){const i=n.blocks;await i.open();const o=unwrap$1(i),a=await length$1(o.queryKeys({filters:[c=>t(c).toString()!==c.toString()]}));try{let c=0;for await(const u of o.query({})){const d=t(u.key);d.toString()!==u.key.toString()&&(c+=1,log$7(`Migrating Block from ${u.key} to ${d}`,await o.has(u.key)),await o.delete(u.key),await o.put(d,u.value),e(c/a*100,`Migrated Block from ${u.key} to ${d}`))}}finally{await i.close()}}const migration$4={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(n,e=()=>{})=>process$2(n,e,keyToMultihash$1),revert:(n,e=()=>{})=>process$2(n,e,keyToCid$1)},$Reader$5=$protobuf.Reader,$Writer$5=$protobuf.Writer;$protobuf.util;const $root$5=$protobuf.roots.default||($protobuf.roots.default={}),ipfs=$root$5.ipfs=(()=>{const n={};return n.pin=function(){const e={};return e.Set=function(){function t(i){if(i)for(var o=Object.keys(i),a=0;a<o.length;++a)i[o[a]]!=null&&(this[o[a]]=i[o[a]])}return t.prototype.version=0,t.prototype.fanout=0,t.prototype.seed=0,t.encode=function(o,a){return a||(a=$Writer$5.create()),o.version!=null&&Object.hasOwnProperty.call(o,"version")&&a.uint32(8).uint32(o.version),o.fanout!=null&&Object.hasOwnProperty.call(o,"fanout")&&a.uint32(16).uint32(o.fanout),o.seed!=null&&Object.hasOwnProperty.call(o,"seed")&&a.uint32(29).fixed32(o.seed),a},t.decode=function(o,a){o instanceof $Reader$5||(o=$Reader$5.create(o));for(var c=a===void 0?o.len:o.pos+a,u=new $root$5.ipfs.pin.Set;o.pos<c;){var d=o.uint32();switch(d>>>3){case 1:u.version=o.uint32();break;case 2:u.fanout=o.uint32();break;case 3:u.seed=o.fixed32();break;default:o.skipType(d&7);break}}return u},t.fromObject=function(o){if(o instanceof $root$5.ipfs.pin.Set)return o;var a=new $root$5.ipfs.pin.Set;return o.version!=null&&(a.version=o.version>>>0),o.fanout!=null&&(a.fanout=o.fanout>>>0),o.seed!=null&&(a.seed=o.seed>>>0),a},t.toObject=function(o,a){a||(a={});var c={};return a.defaults&&(c.version=0,c.fanout=0,c.seed=0),o.version!=null&&o.hasOwnProperty("version")&&(c.version=o.version),o.fanout!=null&&o.hasOwnProperty("fanout")&&(c.fanout=o.fanout),o.seed!=null&&o.hasOwnProperty("seed")&&(c.seed=o.seed),c},t.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},t}(),e}(),n})(),PIN_DS_KEY=new Key("/local/pins"),DEFAULT_FANOUT=256,MAX_ITEMS=8192,EMPTY_KEY=CID.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),PinTypes$1={direct:"direct",recursive:"recursive"};function cidToKey$2(n){return new Key(`/${base32.encode(n.multihash.bytes).toUpperCase().substring(1)}`)}const PinSet=ipfs.pin.Set;function readHeader(n){const e=n.Data;if(!e)throw new Error("No data present");const t=varint$2.decode(e),i=varint$2.decode.bytes;if(i<=0)throw new Error("Invalid Set header length");if(i+t>e.length)throw new Error("Impossibly large set header length");const o=e.slice(i,t+i),a=PinSet.toObject(PinSet.decode(o),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(a.version!==1)throw new Error(`Unsupported Set version: ${a.version}`);if(a.fanout>n.Links.length)throw new Error("Impossibly large fanout");return{header:a,data:e.slice(t+i)}}function hash(n,e){const t=new Uint8Array(4);new DataView(t.buffer).setUint32(0,n,!0);const o=fromString$7(e.toString()),a=concat$1([t,o],t.byteLength+o.byteLength);return fnv1a(toString$5(a))}async function*walkItems(n,e){const t=readHeader(e);let i=0;for(const o of e.Links){if(i<t.header.fanout){const a=o.Hash;if(!EMPTY_KEY.equals(a)){const c=await n.get(a),u=decode$2(c);yield*walkItems(n,u)}}else yield o.Hash;i++}}async function*loadSet(n,e,t){const i=e.Links.find(c=>c.Name===t);if(!i)throw new Error("No link found with name "+t);const o=await n.get(i.Hash),a=decode$2(o);yield*walkItems(n,a)}function storeItems(n,e){return t(e,0);async function t(i,o){const a=PinSet.encode({version:1,fanout:DEFAULT_FANOUT,seed:o}).finish(),c=varint$2.encode(a.length),u=concat$1([c,a]),d=[];for(let h=0;h<DEFAULT_FANOUT;h++)d.push({Name:"",Tsize:1,Hash:EMPTY_KEY});if(i.length<=MAX_ITEMS){const h=i.map(v=>({link:{Name:"",Tsize:1,Hash:v.key},data:v.data||new Uint8Array})).sort((v,_)=>compare(v.link.Hash.bytes,_.link.Hash.bytes)),b=d.concat(h.map(v=>v.link));return{Data:concat$1([u,...h.map(v=>v.data)]),Links:b}}else{const h=i.reduce((m,v)=>{const _=hash(o,v.key)%DEFAULT_FANOUT;return m[_]=_ in m?m[_].concat([v]):[v],m},[]);let b=0;for(const m of h){const v=await t(m,o+1);await p(v,b),b++}return{Data:u,Links:d}}async function p(h,b){const m=encode$4(h),v=await sha256.digest(m),_=CID.createV0(v);await n.put(_,m);const $=h.Links.reduce((k,D)=>k+(D.Tsize||0),0)+m.length;d[b]={Name:"",Tsize:$,Hash:_}}}}async function storeSet(n,e,t){const i=await storeItems(n,t.map(d=>({key:d}))),o=encode$4(i),a=await sha256.digest(o),c=CID.createV0(a);await n.put(c,o);const u=i.Links.reduce((d,p)=>d+p.Tsize,0)+o.length;return{Name:e,Tsize:u,Hash:c}}async function pinsToDatastore(n,e,t,i){if(!await e.has(PIN_DS_KEY))return;const o=await e.get(PIN_DS_KEY),a=CID.decode(o),c=await n.get(a),u=decode$2(c);let d=0;const p=await length$1(loadSet(n,u,PinTypes$1.recursive))+await length$1(loadSet(n,u,PinTypes$1.direct));for await(const h of loadSet(n,u,PinTypes$1.recursive)){d++;const b={depth:1/0};h.version!==0&&(b.version=h.version),h.code!==code$2&&(b.codec=h.code),await t.put(cidToKey$2(h),encode$g(b)),i(d/p*100,`Migrated recursive pin ${h}`)}for await(const h of loadSet(n,u,PinTypes$1.direct)){d++;const b={depth:0};h.version!==0&&(b.version=h.version),h.code!==code$2&&(b.codec=h.code),await t.put(cidToKey$2(h),encode$g(b)),i(d/p*100,`Migrated direct pin ${h}`)}await n.delete(a),await e.delete(PIN_DS_KEY)}async function pinsToDAG(n,e,t,i){const o=[],a=[];let c=0;const u=await length$1(t.queryKeys({}));for await(const{key:m,value:v}of t.query({})){c++;const _=decode$g(v),$=CID.create(_.version||0,_.codec||code$2,decode$6(base32.decode("b"+m.toString().toLowerCase().split("/").pop())));_.depth===0?(i(c/u*100,`Reverted direct pin ${$}`),a.push($)):(i(c/u*100,`Reverted recursive pin ${$}`),o.push($))}i(100,"Updating pin root");const d={Links:[await storeSet(n,PinTypes$1.direct,a),await storeSet(n,PinTypes$1.recursive,o)]},p=encode$4(d),h=await sha256.digest(p),b=CID.createV0(h);await n.put(b,p),await e.put(PIN_DS_KEY,b.bytes)}async function process$1(n,e,t){const i=n.blocks,o=n.datastore,a=n.pins;await i.open(),await o.open(),await a.open();try{await t(i,o,a,e)}finally{await a.close(),await o.close(),await i.close()}}const migration$3={version:9,description:"Migrates pins to datastore",migrate:(n,e=()=>{})=>process$1(n,e,pinsToDatastore),revert:(n,e=()=>{})=>process$1(n,e,pinsToDAG)},CONFIG_KEY=new Key("/config"),VERSION_KEY=new Key("/version");function findLevelJs$1(n){let e=n;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}async function hasWithFallback$1(n,e,t){const i=await e(n);if(i)return i;const o=findLevelJs$1(t);return o?new Promise((a,c)=>{const u=o.store("readonly").get(n.toString());u.transaction.onabort=()=>{c(u.transaction.error)},u.transaction.oncomplete=()=>{a(!!u.result)}}):!1}async function getWithFallback$1(n,e,t,i){if(await t(n))return e(n);const o=findLevelJs$1(i);if(!o)throw notFoundError();return new Promise((a,c)=>{const u=o.store("readonly").get(n.toString());u.transaction.onabort=()=>{c(u.transaction.error)},u.transaction.oncomplete=()=>{if(u.result)return a(u.result);c(notFoundError())}})}function wrapStore(n){const e=n.get.bind(n),t=n.has.bind(n);return n.get=i=>getWithFallback$1(i,e,t,n),n.has=i=>hasWithFallback$1(i,t,n),n}function wrapBackends(n){return{...n,root:wrapStore(n.root),datastore:wrapStore(n.datastore),pins:wrapStore(n.pins),keys:wrapStore(n.keys)}}async function keysToBinary(n,e,t=()=>{}){const i=findLevelJs$1(e);if(!i){t(`${n} did not need an upgrade`);return}t(`Upgrading ${n}`),await withEach(i,(a,c)=>[{type:"del",key:a},{type:"put",key:fromString$7(a),value:c}])}async function keysToStrings(n,e,t=()=>{}){const i=findLevelJs$1(e);if(!i){t(`${n} did not need a downgrade`);return}t(`Downgrading ${n}`),await withEach(i,(a,c)=>[{type:"del",key:a},{type:"put",key:toString$5(a),value:c}])}function unwrap(n){return n.child?unwrap(n.child):n}async function process(n,e,t){const i=Object.entries(n).map(([c,u])=>({key:c,backend:unwrap(u)})).filter(({key:c,backend:u})=>u.constructor.name==="LevelDatastore").map(({key:c,backend:u})=>({name:c,store:u}));e(0,`Migrating ${i.length} dbs`);let o=0;const a=c=>{e(Math.round(o/i.length*100),c)};for(const{name:c,store:u}of i){await u.open();try{await t(c,u,a)}finally{o++,await u.close()}}e(100,`Migrated ${i.length} dbs`)}const migration$2={version:10,description:"Migrates datastore-level keys to binary",migrate:(n,e=()=>{})=>process(n,e,keysToBinary),revert:(n,e=()=>{})=>process(n,e,keysToStrings)};function withEach(n,e){function t(i,o){const a=n.store("readwrite"),c=a.transaction;let u=0,d;c.onabort=()=>o(d||c.error||new Error("aborted by user")),c.oncomplete=()=>o();function p(){const h=i[u++],b=h.key;let m;try{m=h.type==="del"?a.delete(b):a.put(h.value,b)}catch(v){d=v,c.abort();return}u<i.length&&(m.onsuccess=p)}p()}return new Promise((i,o)=>{const a=n.iterator(),c=d=>d;a._deserializeKey=a._deserializeValue=c,u();function u(){const d=(p,h,b)=>{if(p||h===void 0){const m=v=>{if(v){o(v);return}i()};a.end(m);return}t(e(h,b),u)};a.next(d)}})}const MFS_ROOT_KEY$1=new Key("/local/filesroot");async function storeMfsRootInDatastore(n,e=()=>{}){if(e(100,"Migrating MFS root to repo datastore"),await n.root.open(),await n.datastore.open(),await n.root.has(MFS_ROOT_KEY$1)){const t=await n.root.get(MFS_ROOT_KEY$1);await n.datastore.put(MFS_ROOT_KEY$1,t),await n.root.delete(MFS_ROOT_KEY$1)}await n.datastore.close(),await n.root.close(),e(100,"Stored MFS root in repo datastore")}async function storeMfsRootInRoot(n,e=()=>{}){if(e(100,"Migrating MFS root to repo root datastore"),await n.root.open(),await n.datastore.open(),await n.datastore.has(MFS_ROOT_KEY$1)){const t=await n.datastore.get(MFS_ROOT_KEY$1);await n.root.put(MFS_ROOT_KEY$1,t),await n.datastore.delete(MFS_ROOT_KEY$1)}await n.datastore.close(),await n.root.close(),e(100,"Stored MFS root in repo root datastore")}const migration$1={version:11,description:"Store mfs root in the datastore",migrate:storeMfsRootInDatastore,revert:storeMfsRootInRoot},$Reader$4=$protobuf.Reader,$Writer$4=$protobuf.Writer,$util$4=$protobuf.util,$root$4=$protobuf.roots.default||($protobuf.roots.default={}),Protocols=$root$4.Protocols=(()=>{function n(e){if(this.protocols=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return n.prototype.protocols=$util$4.emptyArray,n.encode=function(t,i){if(i||(i=$Writer$4.create()),t.protocols!=null&&t.protocols.length)for(var o=0;o<t.protocols.length;++o)i.uint32(10).string(t.protocols[o]);return i},n.decode=function(t,i){t instanceof $Reader$4||(t=$Reader$4.create(t));for(var o=i===void 0?t.len:t.pos+i,a=new $root$4.Protocols;t.pos<o;){var c=t.uint32();switch(c>>>3){case 1:a.protocols&&a.protocols.length||(a.protocols=[]),a.protocols.push(t.string());break;default:t.skipType(c&7);break}}return a},n.fromObject=function(t){if(t instanceof $root$4.Protocols)return t;var i=new $root$4.Protocols;if(t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Protocols.protocols: array expected");i.protocols=[];for(var o=0;o<t.protocols.length;++o)i.protocols[o]=String(t.protocols[o])}return i},n.toObject=function(t,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.protocols=[]),t.protocols&&t.protocols.length){o.protocols=[];for(var a=0;a<t.protocols.length;++a)o.protocols[a]=t.protocols[a]}return o},n.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},n})(),$Reader$3=$protobuf.Reader,$Writer$3=$protobuf.Writer,$util$3=$protobuf.util,$root$3=$protobuf.roots.default||($protobuf.roots.default={}),Addresses=$root$3.Addresses=(()=>{function n(e){if(this.addrs=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return n.prototype.addrs=$util$3.emptyArray,n.prototype.certifiedRecord=null,n.encode=function(t,i){if(i||(i=$Writer$3.create()),t.addrs!=null&&t.addrs.length)for(var o=0;o<t.addrs.length;++o)$root$3.Addresses.Address.encode(t.addrs[o],i.uint32(10).fork()).ldelim();return t.certifiedRecord!=null&&Object.hasOwnProperty.call(t,"certifiedRecord")&&$root$3.Addresses.CertifiedRecord.encode(t.certifiedRecord,i.uint32(18).fork()).ldelim(),i},n.decode=function(t,i){t instanceof $Reader$3||(t=$Reader$3.create(t));for(var o=i===void 0?t.len:t.pos+i,a=new $root$3.Addresses;t.pos<o;){var c=t.uint32();switch(c>>>3){case 1:a.addrs&&a.addrs.length||(a.addrs=[]),a.addrs.push($root$3.Addresses.Address.decode(t,t.uint32()));break;case 2:a.certifiedRecord=$root$3.Addresses.CertifiedRecord.decode(t,t.uint32());break;default:t.skipType(c&7);break}}return a},n.fromObject=function(t){if(t instanceof $root$3.Addresses)return t;var i=new $root$3.Addresses;if(t.addrs){if(!Array.isArray(t.addrs))throw TypeError(".Addresses.addrs: array expected");i.addrs=[];for(var o=0;o<t.addrs.length;++o){if(typeof t.addrs[o]!="object")throw TypeError(".Addresses.addrs: object expected");i.addrs[o]=$root$3.Addresses.Address.fromObject(t.addrs[o])}}if(t.certifiedRecord!=null){if(typeof t.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");i.certifiedRecord=$root$3.Addresses.CertifiedRecord.fromObject(t.certifiedRecord)}return i},n.toObject=function(t,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.addrs=[]),i.defaults&&(o.certifiedRecord=null),t.addrs&&t.addrs.length){o.addrs=[];for(var a=0;a<t.addrs.length;++a)o.addrs[a]=$root$3.Addresses.Address.toObject(t.addrs[a],i)}return t.certifiedRecord!=null&&t.hasOwnProperty("certifiedRecord")&&(o.certifiedRecord=$root$3.Addresses.CertifiedRecord.toObject(t.certifiedRecord,i)),o},n.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},n.Address=function(){function e(i){if(i)for(var o=Object.keys(i),a=0;a<o.length;++a)i[o[a]]!=null&&(this[o[a]]=i[o[a]])}e.prototype.multiaddr=$util$3.newBuffer([]),e.prototype.isCertified=null;let t;return Object.defineProperty(e.prototype,"_isCertified",{get:$util$3.oneOfGetter(t=["isCertified"]),set:$util$3.oneOfSetter(t)}),e.encode=function(o,a){return a||(a=$Writer$3.create()),o.multiaddr!=null&&Object.hasOwnProperty.call(o,"multiaddr")&&a.uint32(10).bytes(o.multiaddr),o.isCertified!=null&&Object.hasOwnProperty.call(o,"isCertified")&&a.uint32(16).bool(o.isCertified),a},e.decode=function(o,a){o instanceof $Reader$3||(o=$Reader$3.create(o));for(var c=a===void 0?o.len:o.pos+a,u=new $root$3.Addresses.Address;o.pos<c;){var d=o.uint32();switch(d>>>3){case 1:u.multiaddr=o.bytes();break;case 2:u.isCertified=o.bool();break;default:o.skipType(d&7);break}}return u},e.fromObject=function(o){if(o instanceof $root$3.Addresses.Address)return o;var a=new $root$3.Addresses.Address;return o.multiaddr!=null&&(typeof o.multiaddr=="string"?$util$3.base64.decode(o.multiaddr,a.multiaddr=$util$3.newBuffer($util$3.base64.length(o.multiaddr)),0):o.multiaddr.length&&(a.multiaddr=o.multiaddr)),o.isCertified!=null&&(a.isCertified=!!o.isCertified),a},e.toObject=function(o,a){a||(a={});var c={};return a.defaults&&(a.bytes===String?c.multiaddr="":(c.multiaddr=[],a.bytes!==Array&&(c.multiaddr=$util$3.newBuffer(c.multiaddr)))),o.multiaddr!=null&&o.hasOwnProperty("multiaddr")&&(c.multiaddr=a.bytes===String?$util$3.base64.encode(o.multiaddr,0,o.multiaddr.length):a.bytes===Array?Array.prototype.slice.call(o.multiaddr):o.multiaddr),o.isCertified!=null&&o.hasOwnProperty("isCertified")&&(c.isCertified=o.isCertified,a.oneofs&&(c._isCertified="isCertified")),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),n.CertifiedRecord=function(){function e(t){if(t)for(var i=Object.keys(t),o=0;o<i.length;++o)t[i[o]]!=null&&(this[i[o]]=t[i[o]])}return e.prototype.seq=$util$3.Long?$util$3.Long.fromBits(0,0,!0):0,e.prototype.raw=$util$3.newBuffer([]),e.encode=function(i,o){return o||(o=$Writer$3.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&o.uint32(8).uint64(i.seq),i.raw!=null&&Object.hasOwnProperty.call(i,"raw")&&o.uint32(18).bytes(i.raw),o},e.decode=function(i,o){i instanceof $Reader$3||(i=$Reader$3.create(i));for(var a=o===void 0?i.len:i.pos+o,c=new $root$3.Addresses.CertifiedRecord;i.pos<a;){var u=i.uint32();switch(u>>>3){case 1:c.seq=i.uint64();break;case 2:c.raw=i.bytes();break;default:i.skipType(u&7);break}}return c},e.fromObject=function(i){if(i instanceof $root$3.Addresses.CertifiedRecord)return i;var o=new $root$3.Addresses.CertifiedRecord;return i.seq!=null&&($util$3.Long?(o.seq=$util$3.Long.fromValue(i.seq)).unsigned=!0:typeof i.seq=="string"?o.seq=parseInt(i.seq,10):typeof i.seq=="number"?o.seq=i.seq:typeof i.seq=="object"&&(o.seq=new $util$3.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0))),i.raw!=null&&(typeof i.raw=="string"?$util$3.base64.decode(i.raw,o.raw=$util$3.newBuffer($util$3.base64.length(i.raw)),0):i.raw.length&&(o.raw=i.raw)),o},e.toObject=function(i,o){o||(o={});var a={};if(o.defaults){if($util$3.Long){var c=new $util$3.Long(0,0,!0);a.seq=o.longs===String?c.toString():o.longs===Number?c.toNumber():c}else a.seq=o.longs===String?"0":0;o.bytes===String?a.raw="":(a.raw=[],o.bytes!==Array&&(a.raw=$util$3.newBuffer(a.raw)))}return i.seq!=null&&i.hasOwnProperty("seq")&&(typeof i.seq=="number"?a.seq=o.longs===String?String(i.seq):i.seq:a.seq=o.longs===String?$util$3.Long.prototype.toString.call(i.seq):o.longs===Number?new $util$3.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0):i.seq),i.raw!=null&&i.hasOwnProperty("raw")&&(a.raw=o.bytes===String?$util$3.base64.encode(i.raw,0,i.raw.length):o.bytes===Array?Array.prototype.slice.call(i.raw):i.raw),a},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),n})(),$Reader$2=$protobuf.Reader,$Writer$2=$protobuf.Writer,$util$2=$protobuf.util,$root$2=$protobuf.roots.default||($protobuf.roots.default={}),Peer=$root$2.Peer=(()=>{function n(t){if(this.addresses=[],this.protocols=[],this.metadata=[],t)for(var i=Object.keys(t),o=0;o<i.length;++o)t[i[o]]!=null&&(this[i[o]]=t[i[o]])}n.prototype.addresses=$util$2.emptyArray,n.prototype.protocols=$util$2.emptyArray,n.prototype.metadata=$util$2.emptyArray,n.prototype.pubKey=null,n.prototype.peerRecordEnvelope=null;let e;return Object.defineProperty(n.prototype,"_pubKey",{get:$util$2.oneOfGetter(e=["pubKey"]),set:$util$2.oneOfSetter(e)}),Object.defineProperty(n.prototype,"_peerRecordEnvelope",{get:$util$2.oneOfGetter(e=["peerRecordEnvelope"]),set:$util$2.oneOfSetter(e)}),n.encode=function(i,o){if(o||(o=$Writer$2.create()),i.addresses!=null&&i.addresses.length)for(var a=0;a<i.addresses.length;++a)$root$2.Address.encode(i.addresses[a],o.uint32(10).fork()).ldelim();if(i.protocols!=null&&i.protocols.length)for(var a=0;a<i.protocols.length;++a)o.uint32(18).string(i.protocols[a]);if(i.metadata!=null&&i.metadata.length)for(var a=0;a<i.metadata.length;++a)$root$2.Metadata.encode(i.metadata[a],o.uint32(26).fork()).ldelim();return i.pubKey!=null&&Object.hasOwnProperty.call(i,"pubKey")&&o.uint32(34).bytes(i.pubKey),i.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(i,"peerRecordEnvelope")&&o.uint32(42).bytes(i.peerRecordEnvelope),o},n.decode=function(i,o){i instanceof $Reader$2||(i=$Reader$2.create(i));for(var a=o===void 0?i.len:i.pos+o,c=new $root$2.Peer;i.pos<a;){var u=i.uint32();switch(u>>>3){case 1:c.addresses&&c.addresses.length||(c.addresses=[]),c.addresses.push($root$2.Address.decode(i,i.uint32()));break;case 2:c.protocols&&c.protocols.length||(c.protocols=[]),c.protocols.push(i.string());break;case 3:c.metadata&&c.metadata.length||(c.metadata=[]),c.metadata.push($root$2.Metadata.decode(i,i.uint32()));break;case 4:c.pubKey=i.bytes();break;case 5:c.peerRecordEnvelope=i.bytes();break;default:i.skipType(u&7);break}}return c},n.fromObject=function(i){if(i instanceof $root$2.Peer)return i;var o=new $root$2.Peer;if(i.addresses){if(!Array.isArray(i.addresses))throw TypeError(".Peer.addresses: array expected");o.addresses=[];for(var a=0;a<i.addresses.length;++a){if(typeof i.addresses[a]!="object")throw TypeError(".Peer.addresses: object expected");o.addresses[a]=$root$2.Address.fromObject(i.addresses[a])}}if(i.protocols){if(!Array.isArray(i.protocols))throw TypeError(".Peer.protocols: array expected");o.protocols=[];for(var a=0;a<i.protocols.length;++a)o.protocols[a]=String(i.protocols[a])}if(i.metadata){if(!Array.isArray(i.metadata))throw TypeError(".Peer.metadata: array expected");o.metadata=[];for(var a=0;a<i.metadata.length;++a){if(typeof i.metadata[a]!="object")throw TypeError(".Peer.metadata: object expected");o.metadata[a]=$root$2.Metadata.fromObject(i.metadata[a])}}return i.pubKey!=null&&(typeof i.pubKey=="string"?$util$2.base64.decode(i.pubKey,o.pubKey=$util$2.newBuffer($util$2.base64.length(i.pubKey)),0):i.pubKey.length&&(o.pubKey=i.pubKey)),i.peerRecordEnvelope!=null&&(typeof i.peerRecordEnvelope=="string"?$util$2.base64.decode(i.peerRecordEnvelope,o.peerRecordEnvelope=$util$2.newBuffer($util$2.base64.length(i.peerRecordEnvelope)),0):i.peerRecordEnvelope.length&&(o.peerRecordEnvelope=i.peerRecordEnvelope)),o},n.toObject=function(i,o){o||(o={});var a={};if((o.arrays||o.defaults)&&(a.addresses=[],a.protocols=[],a.metadata=[]),i.addresses&&i.addresses.length){a.addresses=[];for(var c=0;c<i.addresses.length;++c)a.addresses[c]=$root$2.Address.toObject(i.addresses[c],o)}if(i.protocols&&i.protocols.length){a.protocols=[];for(var c=0;c<i.protocols.length;++c)a.protocols[c]=i.protocols[c]}if(i.metadata&&i.metadata.length){a.metadata=[];for(var c=0;c<i.metadata.length;++c)a.metadata[c]=$root$2.Metadata.toObject(i.metadata[c],o)}return i.pubKey!=null&&i.hasOwnProperty("pubKey")&&(a.pubKey=o.bytes===String?$util$2.base64.encode(i.pubKey,0,i.pubKey.length):o.bytes===Array?Array.prototype.slice.call(i.pubKey):i.pubKey,o.oneofs&&(a._pubKey="pubKey")),i.peerRecordEnvelope!=null&&i.hasOwnProperty("peerRecordEnvelope")&&(a.peerRecordEnvelope=o.bytes===String?$util$2.base64.encode(i.peerRecordEnvelope,0,i.peerRecordEnvelope.length):o.bytes===Array?Array.prototype.slice.call(i.peerRecordEnvelope):i.peerRecordEnvelope,o.oneofs&&(a._peerRecordEnvelope="peerRecordEnvelope")),a},n.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},n})();$root$2.Address=(()=>{function n(t){if(t)for(var i=Object.keys(t),o=0;o<i.length;++o)t[i[o]]!=null&&(this[i[o]]=t[i[o]])}n.prototype.multiaddr=$util$2.newBuffer([]),n.prototype.isCertified=null;let e;return Object.defineProperty(n.prototype,"_isCertified",{get:$util$2.oneOfGetter(e=["isCertified"]),set:$util$2.oneOfSetter(e)}),n.encode=function(i,o){return o||(o=$Writer$2.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&o.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&o.uint32(16).bool(i.isCertified),o},n.decode=function(i,o){i instanceof $Reader$2||(i=$Reader$2.create(i));for(var a=o===void 0?i.len:i.pos+o,c=new $root$2.Address;i.pos<a;){var u=i.uint32();switch(u>>>3){case 1:c.multiaddr=i.bytes();break;case 2:c.isCertified=i.bool();break;default:i.skipType(u&7);break}}return c},n.fromObject=function(i){if(i instanceof $root$2.Address)return i;var o=new $root$2.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?$util$2.base64.decode(i.multiaddr,o.multiaddr=$util$2.newBuffer($util$2.base64.length(i.multiaddr)),0):i.multiaddr.length&&(o.multiaddr=i.multiaddr)),i.isCertified!=null&&(o.isCertified=!!i.isCertified),o},n.toObject=function(i,o){o||(o={});var a={};return o.defaults&&(o.bytes===String?a.multiaddr="":(a.multiaddr=[],o.bytes!==Array&&(a.multiaddr=$util$2.newBuffer(a.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(a.multiaddr=o.bytes===String?$util$2.base64.encode(i.multiaddr,0,i.multiaddr.length):o.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(a.isCertified=i.isCertified,o.oneofs&&(a._isCertified="isCertified")),a},n.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},n})();$root$2.Metadata=(()=>{function n(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return n.prototype.key="",n.prototype.value=$util$2.newBuffer([]),n.encode=function(t,i){return i||(i=$Writer$2.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&i.uint32(10).string(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(18).bytes(t.value),i},n.decode=function(t,i){t instanceof $Reader$2||(t=$Reader$2.create(t));for(var o=i===void 0?t.len:t.pos+i,a=new $root$2.Metadata;t.pos<o;){var c=t.uint32();switch(c>>>3){case 1:a.key=t.string();break;case 2:a.value=t.bytes();break;default:t.skipType(c&7);break}}return a},n.fromObject=function(t){if(t instanceof $root$2.Metadata)return t;var i=new $root$2.Metadata;return t.key!=null&&(i.key=String(t.key)),t.value!=null&&(typeof t.value=="string"?$util$2.base64.decode(t.value,i.value=$util$2.newBuffer($util$2.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),i},n.toObject=function(t,i){i||(i={});var o={};return i.defaults&&(o.key="",i.bytes===String?o.value="":(o.value=[],i.bytes!==Array&&(o.value=$util$2.newBuffer(o.value)))),t.key!=null&&t.hasOwnProperty("key")&&(o.key=t.key),t.value!=null&&t.hasOwnProperty("value")&&(o.value=i.bytes===String?$util$2.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),o},n.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},n})();const $Reader$1=$protobuf.Reader,$Writer$1=$protobuf.Writer,$util$1=$protobuf.util,$root$1=$protobuf.roots.default||($protobuf.roots.default={}),Envelope=$root$1.Envelope=(()=>{function n(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return n.prototype.publicKey=$util$1.newBuffer([]),n.prototype.payloadType=$util$1.newBuffer([]),n.prototype.payload=$util$1.newBuffer([]),n.prototype.signature=$util$1.newBuffer([]),n.encode=function(t,i){return i||(i=$Writer$1.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&i.uint32(10).bytes(t.publicKey),t.payloadType!=null&&Object.hasOwnProperty.call(t,"payloadType")&&i.uint32(18).bytes(t.payloadType),t.payload!=null&&Object.hasOwnProperty.call(t,"payload")&&i.uint32(26).bytes(t.payload),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&i.uint32(42).bytes(t.signature),i},n.decode=function(t,i){t instanceof $Reader$1||(t=$Reader$1.create(t));for(var o=i===void 0?t.len:t.pos+i,a=new $root$1.Envelope;t.pos<o;){var c=t.uint32();switch(c>>>3){case 1:a.publicKey=t.bytes();break;case 2:a.payloadType=t.bytes();break;case 3:a.payload=t.bytes();break;case 5:a.signature=t.bytes();break;default:t.skipType(c&7);break}}return a},n.fromObject=function(t){if(t instanceof $root$1.Envelope)return t;var i=new $root$1.Envelope;return t.publicKey!=null&&(typeof t.publicKey=="string"?$util$1.base64.decode(t.publicKey,i.publicKey=$util$1.newBuffer($util$1.base64.length(t.publicKey)),0):t.publicKey.length&&(i.publicKey=t.publicKey)),t.payloadType!=null&&(typeof t.payloadType=="string"?$util$1.base64.decode(t.payloadType,i.payloadType=$util$1.newBuffer($util$1.base64.length(t.payloadType)),0):t.payloadType.length&&(i.payloadType=t.payloadType)),t.payload!=null&&(typeof t.payload=="string"?$util$1.base64.decode(t.payload,i.payload=$util$1.newBuffer($util$1.base64.length(t.payload)),0):t.payload.length&&(i.payload=t.payload)),t.signature!=null&&(typeof t.signature=="string"?$util$1.base64.decode(t.signature,i.signature=$util$1.newBuffer($util$1.base64.length(t.signature)),0):t.signature.length&&(i.signature=t.signature)),i},n.toObject=function(t,i){i||(i={});var o={};return i.defaults&&(i.bytes===String?o.publicKey="":(o.publicKey=[],i.bytes!==Array&&(o.publicKey=$util$1.newBuffer(o.publicKey))),i.bytes===String?o.payloadType="":(o.payloadType=[],i.bytes!==Array&&(o.payloadType=$util$1.newBuffer(o.payloadType))),i.bytes===String?o.payload="":(o.payload=[],i.bytes!==Array&&(o.payload=$util$1.newBuffer(o.payload))),i.bytes===String?o.signature="":(o.signature=[],i.bytes!==Array&&(o.signature=$util$1.newBuffer(o.signature)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(o.publicKey=i.bytes===String?$util$1.base64.encode(t.publicKey,0,t.publicKey.length):i.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.payloadType!=null&&t.hasOwnProperty("payloadType")&&(o.payloadType=i.bytes===String?$util$1.base64.encode(t.payloadType,0,t.payloadType.length):i.bytes===Array?Array.prototype.slice.call(t.payloadType):t.payloadType),t.payload!=null&&t.hasOwnProperty("payload")&&(o.payload=i.bytes===String?$util$1.base64.encode(t.payload,0,t.payload.length):i.bytes===Array?Array.prototype.slice.call(t.payload):t.payload),t.signature!=null&&t.hasOwnProperty("signature")&&(o.signature=i.bytes===String?$util$1.base64.encode(t.signature,0,t.signature.length):i.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),o},n.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},n})(),$Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots.default||($protobuf.roots.default={}),PeerRecord=$root.PeerRecord=(()=>{function n(e){if(this.addresses=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return n.prototype.peerId=$util.newBuffer([]),n.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,n.prototype.addresses=$util.emptyArray,n.encode=function(t,i){if(i||(i=$Writer.create()),t.peerId!=null&&Object.hasOwnProperty.call(t,"peerId")&&i.uint32(10).bytes(t.peerId),t.seq!=null&&Object.hasOwnProperty.call(t,"seq")&&i.uint32(16).uint64(t.seq),t.addresses!=null&&t.addresses.length)for(var o=0;o<t.addresses.length;++o)$root.PeerRecord.AddressInfo.encode(t.addresses[o],i.uint32(26).fork()).ldelim();return i},n.decode=function(t,i){t instanceof $Reader||(t=$Reader.create(t));for(var o=i===void 0?t.len:t.pos+i,a=new $root.PeerRecord;t.pos<o;){var c=t.uint32();switch(c>>>3){case 1:a.peerId=t.bytes();break;case 2:a.seq=t.uint64();break;case 3:a.addresses&&a.addresses.length||(a.addresses=[]),a.addresses.push($root.PeerRecord.AddressInfo.decode(t,t.uint32()));break;default:t.skipType(c&7);break}}return a},n.fromObject=function(t){if(t instanceof $root.PeerRecord)return t;var i=new $root.PeerRecord;if(t.peerId!=null&&(typeof t.peerId=="string"?$util.base64.decode(t.peerId,i.peerId=$util.newBuffer($util.base64.length(t.peerId)),0):t.peerId.length&&(i.peerId=t.peerId)),t.seq!=null&&($util.Long?(i.seq=$util.Long.fromValue(t.seq)).unsigned=!0:typeof t.seq=="string"?i.seq=parseInt(t.seq,10):typeof t.seq=="number"?i.seq=t.seq:typeof t.seq=="object"&&(i.seq=new $util.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0))),t.addresses){if(!Array.isArray(t.addresses))throw TypeError(".PeerRecord.addresses: array expected");i.addresses=[];for(var o=0;o<t.addresses.length;++o){if(typeof t.addresses[o]!="object")throw TypeError(".PeerRecord.addresses: object expected");i.addresses[o]=$root.PeerRecord.AddressInfo.fromObject(t.addresses[o])}}return i},n.toObject=function(t,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.addresses=[]),i.defaults)if(i.bytes===String?o.peerId="":(o.peerId=[],i.bytes!==Array&&(o.peerId=$util.newBuffer(o.peerId))),$util.Long){var a=new $util.Long(0,0,!0);o.seq=i.longs===String?a.toString():i.longs===Number?a.toNumber():a}else o.seq=i.longs===String?"0":0;if(t.peerId!=null&&t.hasOwnProperty("peerId")&&(o.peerId=i.bytes===String?$util.base64.encode(t.peerId,0,t.peerId.length):i.bytes===Array?Array.prototype.slice.call(t.peerId):t.peerId),t.seq!=null&&t.hasOwnProperty("seq")&&(typeof t.seq=="number"?o.seq=i.longs===String?String(t.seq):t.seq:o.seq=i.longs===String?$util.Long.prototype.toString.call(t.seq):i.longs===Number?new $util.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0):t.seq),t.addresses&&t.addresses.length){o.addresses=[];for(var c=0;c<t.addresses.length;++c)o.addresses[c]=$root.PeerRecord.AddressInfo.toObject(t.addresses[c],i)}return o},n.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},n.AddressInfo=function(){function e(t){if(t)for(var i=Object.keys(t),o=0;o<i.length;++o)t[i[o]]!=null&&(this[i[o]]=t[i[o]])}return e.prototype.multiaddr=$util.newBuffer([]),e.encode=function(i,o){return o||(o=$Writer.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&o.uint32(10).bytes(i.multiaddr),o},e.decode=function(i,o){i instanceof $Reader||(i=$Reader.create(i));for(var a=o===void 0?i.len:i.pos+o,c=new $root.PeerRecord.AddressInfo;i.pos<a;){var u=i.uint32();switch(u>>>3){case 1:c.multiaddr=i.bytes();break;default:i.skipType(u&7);break}}return c},e.fromObject=function(i){if(i instanceof $root.PeerRecord.AddressInfo)return i;var o=new $root.PeerRecord.AddressInfo;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?$util.base64.decode(i.multiaddr,o.multiaddr=$util.newBuffer($util.base64.length(i.multiaddr)),0):i.multiaddr.length&&(o.multiaddr=i.multiaddr)),o},e.toObject=function(i,o){o||(o={});var a={};return o.defaults&&(o.bytes===String?a.multiaddr="":(a.multiaddr=[],o.bytes!==Array&&(a.multiaddr=$util.newBuffer(a.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(a.multiaddr=o.bytes===String?$util.base64.encode(i.multiaddr,0,i.multiaddr.length):o.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),a},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e}(),n})();$protobuf.util.Long=void 0;$protobuf.configure();async function storePeerUnderSingleDatastoreKey(n,e=()=>{}){e(0,"Storing each peerstore key under a single datastore key"),await n.datastore.open();const t={},i=[];for await(const{key:o,value:a}of n.datastore.query({prefix:"/peers"})){i.push(o);const c=o.toString(),[,u,d,p,h]=c.split("/");if(u==="peers"&&["protos","addrs","metadata","keys"].includes(d)&&p)if(t[p]=t[p]||{addresses:[],protocols:[],metadata:[]},d==="protos"){const b=Protocols.decode(a);t[p].protocols=b.protocols.sort()}else if(d==="addrs"){const b=Addresses.decode(a);t[p].addresses=b.addrs.sort((m,v)=>multiaddr(m.multiaddr).toString().localeCompare(multiaddr(v.multiaddr).toString())),b.certifiedRecord&&b.certifiedRecord.raw&&(t[p].peerRecordEnvelope=b.certifiedRecord.raw)}else d==="metadata"?t[p].metadata.push({key:h,value:a}):d==="keys"&&(t[p].pubKey=a)}e(33,"Read peer data from store");for(const o of i)await n.datastore.delete(o);e(66,"Removed existing peer data from store");for(const o of Object.keys(t)){const a=t[o];a.metadata=a.metadata.sort((u,d)=>u.key.localeCompare(d.key));const c=Peer.encode(a).finish();await n.datastore.put(new Key(`/peers/${o}`),c)}await n.datastore.close(),e(100,"Stored each peerstore key under a single datastore key")}async function storePeerUnderMultipleDatastoreKeys(n,e=()=>{}){e(0,"Storing each peerstore key under a multiple datastore keys"),await n.datastore.open();const t={},i=[];for await(const{key:o,value:a}of n.datastore.query({prefix:"/peers"})){i.push(o);const c=o.toString(),[,,u]=c.split("/");t[u]=Peer.decode(a)}e(33,"Read peer data from store");for(const o of i)await n.datastore.delete(o);e(66,"Removed existing peer data from store");for(const[o,a]of Object.entries(t)){if(a.protocols&&a.protocols.length>0&&await n.datastore.put(new Key(`/peers/protos/${o}`),Protocols.encode({protocols:a.protocols}).finish()),a.addresses&&a.addresses.length>0){const c=a.peerRecordEnvelope;let u;if(c){const d=Envelope.decode(c),p=PeerRecord.decode(d.payload);u={raw:c,seq:p.seq}}await n.datastore.put(new Key(`/peers/addrs/${o}`),Addresses.encode({addrs:a.addresses,certifiedRecord:u}).finish())}if(a.metadata&&a.metadata.length>0)for(const{key:c,value:u}of a.metadata)await n.datastore.put(new Key(`/peers/metadata/${o}/${c}`),u);a.pubKey&&await n.datastore.put(new Key(`/peers/keys/${o}`),a.pubKey)}await n.datastore.close(),e(100,"Stored each peerstore key under multiple datastore keys")}const migration={version:12,description:"Store each peerstore peer under a single datastore key",migrate:storePeerUnderSingleDatastoreKey,revert:storePeerUnderMultipleDatastoreKeys},emptyMigration={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0},defaultMigrations=[Object.assign({version:1},emptyMigration),Object.assign({version:2},emptyMigration),Object.assign({version:3},emptyMigration),Object.assign({version:4},emptyMigration),Object.assign({version:5},emptyMigration),Object.assign({version:6},emptyMigration),Object.assign({version:7},emptyMigration),migration$4,migration$3,migration$2,migration$1,migration];class NonReversibleMigrationError extends Error{constructor(e){super(e),this.name="NonReversibleMigrationError",this.code=NonReversibleMigrationError.code,this.message=e}}NonReversibleMigrationError.code="ERR_NON_REVERSIBLE_MIGRATION";class NotInitializedRepoError extends Error{constructor(e){super(e),this.name="NotInitializedRepoError",this.code=NotInitializedRepoError.code,this.message=e}}NotInitializedRepoError.code="ERR_NOT_INITIALIZED_REPO";class RequiredParameterError extends Error{constructor(e){super(e),this.name="RequiredParameterError",this.code=RequiredParameterError.code,this.message=e}}RequiredParameterError.code="ERR_REQUIRED_PARAMETER";class InvalidValueError extends Error{constructor(e){super(e),this.name="InvalidValueError",this.code=InvalidValueError.code,this.message=e}}InvalidValueError.code="ERR_INVALID_VALUE";class MissingRepoOptionsError extends Error{constructor(e){super(e),this.name="MissingRepoOptionsError",this.code=MissingRepoOptionsError.code,this.message=e}}MissingRepoOptionsError.code="ERR_MISSING_REPO_OPTIONS";const Errors=Object.freeze(Object.defineProperty({__proto__:null,InvalidValueError,MissingRepoOptionsError,NonReversibleMigrationError,NotInitializedRepoError,RequiredParameterError},Symbol.toStringTag,{value:"Module"})),log$6=debug("ipfs:repo:migrator:repo:init");async function isRepoInitialized(n){if(!n)throw new MissingRepoOptionsError("Please pass repo options when trying to open a repo");const e=n.root;try{await e.open();const t=await e.has(VERSION_KEY),i=await e.has(CONFIG_KEY);return!t||!i?(log$6(`Version entry present: ${t}`),log$6(`Config entry present: ${i}`),!1):!0}catch(t){return log$6("While checking if repo is initialized error was thrown: "+t.message),!1}finally{if(e!==void 0)try{await e.close()}catch{}}}async function getVersion(n){if(!await isRepoInitialized(n))throw new NotInitializedRepoError("Repo is not initialized!");const e=n.root;await e.open();try{return parseInt(toString$5(await e.get(VERSION_KEY)))}finally{await e.close()}}async function setVersion(n,e){if(!e)throw new MissingRepoOptionsError("Please pass repo options when trying to open a repo");const t=e.root;await t.open(),await t.put(VERSION_KEY,fromString$7(String(n))),await t.close()}const log$5=debug("ipfs:repo:migrator");function getLatestMigrationVersion(n){return n=n||defaultMigrations,!Array.isArray(n)||n.length===0?0:n[n.length-1].version}async function migrate(n,e,t,i,o={}){const a=o.ignoreLock??!1,c=o.onProgress,u=o.isDryRun??!1,d=o.migrations??defaultMigrations;if(!n)throw new errors.RequiredParameterError("Path argument is required!");if(!t)throw new errors.RequiredParameterError("repoOptions argument is required!");if(!i)throw new errors.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(i)||i<=0)throw new errors.InvalidValueError("Version has to be positive integer!");e=wrapBackends(e);const p=await getVersion(e);if(p===i){log$5("Nothing to migrate.");return}if(p>i)throw new errors.InvalidValueError(`Current repo's version (${p}) is higher then toVersion (${i}), you probably wanted to revert it?`);verifyAvailableMigrations(d,p,i);let h;!u&&!a&&(h=await t.repoLock.lock(n));try{for(const b of d){if(i!==void 0&&b.version>i)break;if(!(b.version<=p)){log$5(`Migrating version ${b.version}`);try{if(!u){let m=()=>{};c&&(m=(v,_)=>c(b.version,v.toFixed(2),_)),await b.migrate(e,m)}}catch(m){const v=b.version-1;throw log$5(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${v}`),await setVersion(v,e),new Error(`During migration to version ${b.version} exception was raised: ${m.stack||m.message||m}`)}log$5(`Migrating to version ${b.version} finished`)}}u||await setVersion(i||getLatestMigrationVersion(d),e),log$5("Repo successfully migrated",i!==void 0?`to version ${i}!`:"to latest version!")}finally{!u&&!a&&h&&await h.close()}}async function revert(n,e,t,i,o={}){const a=o.ignoreLock??!1,c=o.onProgress,u=o.isDryRun??!1,d=o.migrations??defaultMigrations;if(!n)throw new errors.RequiredParameterError("Path argument is required!");if(!t)throw new errors.RequiredParameterError("repoOptions argument is required!");if(!i)throw new errors.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(i)||i<=0)throw new errors.InvalidValueError("Version has to be positive integer!");e=wrapBackends(e);const p=await getVersion(e);if(p===i){log$5("Nothing to revert.");return}if(p<i)throw new errors.InvalidValueError(`Current repo's version (${p}) is lower then toVersion (${i}), you probably wanted to migrate it?`);verifyAvailableMigrations(d,i,p,!0);let h;!u&&!a&&(h=await t.repoLock.lock(n)),log$5(`Reverting from version ${p} to ${i}`);try{const b=d.slice().reverse();for(const m of b){if(m.version<=i)break;if(!(m.version>p)){log$5(`Reverting migration version ${m.version}`);try{if(!u){let v=()=>{};c&&(v=(_,$)=>c(m.version,_.toFixed(2),$)),await m.revert(e,v)}}catch(v){const _=m.version;throw log$5(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${_}`),await setVersion(_,e),v.message=`During reversion to version ${m.version} exception was raised: ${v.message}`,v}log$5(`Reverting to version ${m.version} finished`)}}u||await setVersion(i,e),log$5(`All migrations successfully reverted to version ${i}!`)}finally{!u&&!a&&h&&await h.close()}}function verifyAvailableMigrations(n,e,t,i=!1){let o=0;for(const a of n){if(a.version>t)break;if(a.version>e){if(i&&!a.revert)throw new errors.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${a.version} is not reversible. Cancelling reversion.`);o++}}if(o!==t-e)throw new errors.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${t}`)}const errors=Errors,repoVersion=12;class LockExistsError extends Error{constructor(e){super(e),this.name="LockExistsError",this.code=LockExistsError.code}}LockExistsError.code="ERR_LOCK_EXISTS";class NotFoundError extends Error{constructor(e){super(e),this.name="NotFoundError",this.code=NotFoundError.code}}NotFoundError.code="ERR_NOT_FOUND";class InvalidRepoVersionError extends Error{constructor(e){super(e),this.name="InvalidRepoVersionError",this.code=InvalidRepoVersionError.code}}InvalidRepoVersionError.code="ERR_INVALID_REPO_VERSION";const ERR_REPO_NOT_INITIALIZED="ERR_REPO_NOT_INITIALIZED",ERR_REPO_ALREADY_OPEN="ERR_REPO_ALREADY_OPEN",ERR_REPO_ALREADY_CLOSED="ERR_REPO_ALREADY_CLOSED";async function hasWithFallback(n,e,t){const i=await e(n);if(i)return i;const o=findLevelJs(t);return o?new Promise((a,c)=>{const u=o.store("readonly").get(n.toString());u.transaction.onabort=()=>{c(u.transaction.error)},u.transaction.oncomplete=()=>{a(!!u.result)}}):!1}async function getWithFallback(n,e,t,i){if(await t(n))return e(n);const o=findLevelJs(i);if(!o)throw new NotFoundError;return new Promise((a,c)=>{const u=o.store("readonly").get(n.toString());u.transaction.onabort=()=>{c(u.transaction.error)},u.transaction.oncomplete=()=>{if(u.result)return a(u.result);c(new NotFoundError)}})}function findLevelJs(n){let e=n;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}const log$4=debug("ipfs:repo:version"),versionKey=new Key("version");function version(n){return{async exists(){return hasWithFallback(versionKey,n.has.bind(n),n)},async get(){const e=await getWithFallback(versionKey,n.get.bind(n),n.has.bind(n),n);return parseInt(toString$5(e),10)},set(e){return n.put(versionKey,fromString$7(String(e)))},async check(e){const t=await this.get();return log$4("comparing version: %s and %s",t,e),t===e||(t===6&&e===7||e===6&&t===7)}}}const Queue=PQueue.default?PQueue.default:PQueue,configKey=new Key("config");function config(n){const e=new Queue({concurrency:1}),t={async getAll(a={}){const c=await getWithFallback(configKey,n.get.bind(n),n.has.bind(n),n);return JSON.parse(toString$5(c))},async get(a,c={}){if(a==null)throw new NotFoundError(`Key ${a} does not exist in config`);const u=await this.getAll(c),d=objectSafeGet(u,a);if(d===void 0)throw new NotFoundError(`Key ${a} does not exist in config`);return d},set(a,c,u={}){if(typeof a!="string"&&!(a instanceof String))throw errcode(new Error("Invalid key type: "+typeof a),"ERR_INVALID_KEY");if(c===void 0||c instanceof Uint8Array)throw errcode(new Error("Invalid value type: "+typeof c),"ERR_INVALID_VALUE");return e.add(()=>i({key:a,value:c},u.signal))},replace(a,c={}){if(!a||a instanceof Uint8Array)throw errcode(new Error("Invalid value type: "+typeof a),"ERR_INVALID_VALUE");return e.add(()=>i({key:void 0,value:a},c.signal))},async exists(){return hasWithFallback(configKey,n.has.bind(n),n)}};return t;async function i(a,c){if(c&&c.aborted)return;const u=a.key,d=a.value;if(u){const p=await t.getAll();return typeof p=="object"&&p!==null&&objectSafeSet(p,u,d),o(p)}return o(d)}function o(a){const c=fromString$7(JSON.stringify(a,null,2));return n.put(configKey,c)}}const specKey=new Key("datastore_spec");function spec(n){return{exists(){return n.has(specKey)},async get(){const e=await n.get(specKey);return JSON.parse(toString$5(e))},async set(e){return n.put(specKey,fromString$7(JSON.stringify(sortKeys(e,{deep:!0}))))}}}const apiFile=new Key("api");function apiAddr(n){return{async get(){const e=await n.get(apiFile);return e&&e.toString()},set(e){return n.put(apiFile,fromString$7(e.toString()))},delete(){return n.delete(apiFile)}}}function createIdStore(n){return{open(){return n.open()},close(){return n.close()},query(e,t){return n.query(e,t)},queryKeys(e,t){return n.queryKeys(e,t)},async get(e,t){const i=extractContents(e);return i.isIdentity?Promise.resolve(i.digest):n.get(e,t)},async*getMany(e,t){for await(const i of e)yield this.get(i,t)},async put(e,t,i){const{isIdentity:o}=extractContents(e);o||await n.put(e,t,i)},async*putMany(e,t){const i=pushable({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{await drain$2(n.putMany(async function*(){for await(const{key:a,value:c}of e)extractContents(a).isIdentity||(yield{key:a,value:c}),i.push({key:a,value:c})}())),i.end()}catch(a){i.end(a)}}),yield*i},has(e,t){const{isIdentity:i}=extractContents(e);return i?Promise.resolve(!0):n.has(e,t)},delete(e,t){const{isIdentity:i}=extractContents(e);return i?Promise.resolve():n.delete(e,t)},deleteMany(e,t){return n.deleteMany(filter$2(e,i=>!extractContents(i).isIdentity),t)},batch(){const e=n.batch();return{put(t,i){const{isIdentity:o}=extractContents(t);o||e.put(t,i)},delete(t){const{isIdentity:i}=extractContents(t);i||e.delete(t)},commit:t=>e.commit(t)}}}}function extractContents(n){const e=CID.asCID(n);if(e==null)throw errcode(new Error("Not a valid cid"),"ERR_INVALID_CID");return e.multihash.code!==identity.code?{isIdentity:!1}:{isIdentity:!0,digest:e.multihash.digest}}const log$3=debug("ipfs:repo:lock:memory"),lockFile="repo.lock",LOCKS={};async function lock(n){const e=n+"/"+lockFile;if(log$3("locking %s",e),LOCKS[e]===!0)throw new LockExistsError(`Lock already being held for file: ${e}`);return LOCKS[e]=!0,{async close(){LOCKS[e]&&delete LOCKS[e]}}}async function locked(n){const e=n+"/"+lockFile;return log$3(`checking lock: ${e}`),!!LOCKS[e]}const MemoryLock={lock,locked},defaultOptions={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:MemoryLock},defaultDatastore={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};function readonly({enumerable:n=!0,configurable:e=!1}={}){return{enumerable:n,configurable:e,writable:!1}}function*linksWithin(n,e){if(e!=null&&typeof e=="object")if(Array.isArray(e))for(const[t,i]of e.entries()){const o=[...n,t],a=CID.asCID(i);a?yield[o.join("/"),a]:typeof i=="object"&&(yield*links(i,o))}else{const t=CID.asCID(e);t?yield[n.join("/"),t]:yield*links(e,n)}}function*links(n,e){if(!(n==null||n instanceof Uint8Array))for(const[t,i]of Object.entries(n)){const o=[...e,t];yield*linksWithin(o,i)}}function*treeWithin(n,e){if(Array.isArray(e))for(const[t,i]of e.entries()){const o=[...n,t];yield o.join("/"),typeof i=="object"&&!CID.asCID(i)&&(yield*tree(i,o))}else yield*tree(e,n)}function*tree(n,e){if(!(n==null||typeof n!="object"))for(const[t,i]of Object.entries(n)){const o=[...e,t];yield o.join("/"),i!=null&&!(i instanceof Uint8Array)&&typeof i=="object"&&!CID.asCID(i)&&(yield*treeWithin(o,i))}}function get(n,e){let t=n;for(const[i,o]of e.entries()){if(t=t[o],t==null)throw new Error(`Object has no property at ${e.slice(0,i+1).map(c=>`[${JSON.stringify(c)}]`).join("")}`);const a=CID.asCID(t);if(a)return{value:a,remaining:e.slice(i+1).join("/")}}return{value:t}}class Block{constructor({cid:e,bytes:t,value:i}){if(!e||!t||typeof i>"u")throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=i,this.asBlock=this,Object.defineProperties(this,{cid:readonly(),bytes:readonly(),value:readonly(),asBlock:readonly()})}links(){return links(this.value,[])}tree(){return tree(this.value,[])}get(e="/"){return get(this.value,e.split("/").filter(Boolean))}}function createUnsafe({bytes:n,cid:e,value:t,codec:i}){const o=t!==void 0?t:i&&i.decode(n);if(o===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new Block({cid:e,bytes:n,value:o})}function cidToKey$1(n){const e=CID.asCID(n);if(e==null)throw errcode(new Error("Not a valid cid"),"ERR_INVALID_CID");const t=base32.encode(e.multihash.bytes);return new Key("/"+t.slice(1).toUpperCase(),!1)}function keyToMultihash(n){return decode$6(base32.decode(`b${n.toString().toLowerCase().substring(1)}`))}const log$2=debug("ipfs:repo:utils:walk-dag");async function*walkDag(n,e,t,i){try{const o=await e.get(n,i),a=await t(n.code),c=createUnsafe({bytes:o,cid:n,codec:a});for(const[,u]of c.links())yield u,yield*walkDag(u,e,t,i)}catch(o){throw log$2("Could not walk DAG for CID",n.toString(),o),o}}const PinTypes={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"},CID_CACHE_MAX_SIZE=2048;function invalidPinTypeErr(n){const e=`Invalid type '${n}', must be one of {direct, indirect, recursive, all}`;return errcode(new Error(e),"ERR_INVALID_PIN_TYPE")}class PinManager{constructor({pinstore:e,blockstore:t,loadCodec:i}){this.pinstore=e,this.blockstore=t,this.loadCodec=i,this.log=debug("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,t={}){await this.blockstore.get(e,t);const i={depth:0};return e.version!==0&&(i.version=e.version),e.code!==code$2&&(i.codec=e.code),t.metadata&&(i.metadata=t.metadata),this.pinstore.put(cidToKey$1(e),encode$g(i))}unpin(e,t){return this.pinstore.delete(cidToKey$1(e),t)}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);const i={depth:1/0};e.version!==0&&(i.version=e.version),e.code!==code$2&&(i.codec=e.code),t.metadata&&(i.metadata=t.metadata),await this.pinstore.put(cidToKey$1(e),encode$g(i))}async*directKeys(e){for await(const t of this.pinstore.query({filters:[i=>decode$g(i.value).depth===0]})){const i=decode$g(t.value),o=i.version||0,a=i.codec!=null?i.codec:code$2,c=keyToMultihash(t.key);yield{cid:CID.create(o,a,c),metadata:i.metadata}}}async*recursiveKeys(e){for await(const t of this.pinstore.query({filters:[i=>decode$g(i.value).depth===1/0]})){const i=decode$g(t.value),o=i.version||0,a=i.codec!=null?i.codec:code$2,c=keyToMultihash(t.key);yield{cid:CID.create(o,a,c),metadata:i.metadata}}}async*indirectKeys(e){for await(const{cid:t}of this.recursiveKeys())for await(const i of walkDag(t,this.blockstore,this.loadCodec,e)){const o=[PinTypes.recursive];(await this.isPinnedWithType(i,o)).pinned||(yield i)}}async isPinnedWithType(e,t,i){Array.isArray(t)||(t=[t]);const o=t.includes(PinTypes.all),a=t.includes(PinTypes.direct),c=t.includes(PinTypes.recursive),u=t.includes(PinTypes.indirect);if(c||a||o){const h=await first(this.pinstore.query({prefix:cidToKey$1(e).toString(),filters:[b=>{if(o)return!0;const m=decode$g(b.value);return t.includes(m.depth===0?PinTypes.direct:PinTypes.recursive)}],limit:1}));if(h){const b=decode$g(h.value);return{cid:e,pinned:!0,reason:b.depth===0?PinTypes.direct:PinTypes.recursive,metadata:b.metadata}}}const d=this;async function*p(h,b){for await(const{cid:m}of b)for await(const v of walkDag(m,d.blockstore,d.loadCodec))if(v.equals(h)){yield m;return}}if(o||u){const h=await first(p(e,this.recursiveKeys()));if(h)return{cid:e,pinned:!0,reason:PinTypes.indirect,parent:h}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t={}){const i=new QuickLRU({maxSize:t.cidCacheMaxSize??CID_CACHE_MAX_SIZE}),o=async(a,c)=>{if(i.has(a.toString()))return;i.set(a.toString(),!0);const u=await this.blockstore.get(a,c),d=await this.loadCodec(a.code),p=createUnsafe({bytes:u,cid:a,codec:d});await Promise.all([...p.links()].map(([,h])=>o(h,c)))};await o(e,t)}static checkPinType(e){if(typeof e!="string"||!Object.keys(PinTypes).includes(e))throw invalidPinTypeErr(e);return!0}}function createPinnedBlockstore(n,e){return{open(){return e.open()},close(){return e.close()},query(t,i){return e.query(t,i)},queryKeys(t,i){return e.queryKeys(t,i)},async get(t,i){return e.get(t,i)},async*getMany(t,i){yield*e.getMany(t,i)},async put(t,i,o){await e.put(t,i,o)},async*putMany(t,i){yield*e.putMany(t,i)},has(t,i){return e.has(t,i)},async delete(t,i){return await ensureNotPinned(t,n),e.delete(t,i)},deleteMany(t,i){return e.deleteMany(map$2(t,async o=>(await ensureNotPinned(o,n),o)),i)},batch(){return e.batch()}}}async function ensureNotPinned(n,e){const{pinned:t,reason:i}=await e.isPinnedWithType(n,PinTypes.all);if(t)throw errcode(new Error(`pinned: ${i}`),"ERR_BLOCK_PINNED")}const log$1=debug("ipfs:repo:gc"),ERR_NOT_FOUND=notFoundError().code,BLOCK_RM_CONCURRENCY=256,MFS_ROOT_KEY=new Key("/local/filesroot");function gc({gcLock:n,pins:e,blockstore:t,root:i,loadCodec:o}){async function*a(){const c=Date.now();log$1("Creating set of marked blocks");const u=await n.writeLock();try{const d=await createMarkedSet({pins:e,blockstore:t,root:i,loadCodec:o}),p=t.queryKeys({});yield*deleteUnmarkedBlocks({blockstore:t},d,p),log$1(`Complete (${Date.now()-c}ms)`)}finally{u()}}return a}async function createMarkedSet({pins:n,blockstore:e,loadCodec:t,root:i}){const o=async function*(){let u;try{u=await i.get(MFS_ROOT_KEY)}catch(p){if(p.code===ERR_NOT_FOUND){log$1("No blocks in MFS");return}throw p}const d=CID.decode(u);yield d,yield*walkDag(d,e,t)}(),a=merge$2(map$2(n.recursiveKeys(),({cid:u})=>u),n.indirectKeys(),map$2(n.directKeys(),({cid:u})=>u),o),c=new Set;for await(const u of merge$2(a,o))c.add(base32.encode(u.multihash.bytes));return c}async function*deleteUnmarkedBlocks({blockstore:n},e,t){let i=0,o=0;yield*pipe(parallelBatch(map$2(t,async c=>async function(){i++;try{const d=base32.encode(c.multihash.bytes);if(e.has(d))return null;try{await n.delete(c),o++}catch(p){return{err:new Error(`Could not delete block with CID ${c}: ${p.message}`)}}return{cid:c}}catch(d){const p=`Could delete block with CID ${c}`;return log$1(p,d),{err:new Error(p+`: ${d.message}`)}}}),BLOCK_RM_CONCURRENCY),c=>filter$2(c,Boolean)),log$1(`Marked set has ${e.size} unique blocks. Blockstore has ${i} blocks. Deleted ${o} blocks.`)}const log=debug("ipfs:repo"),noLimit=Number.MAX_SAFE_INTEGER,AUTO_MIGRATE_CONFIG_KEY="repoAutoMigrate";let Repo$1=class{constructor(e,t,i,o){if(typeof e!="string")throw new Error("missing repo path");if(typeof t!="function")throw new Error("missing codec loader");this.options=mergeOptions$1(defaultOptions,o),this.closed=!0,this.path=e,this.root=i.root,this.datastore=i.datastore,this.keys=i.keys;const a=i.blocks,c=i.pins;this.pins=new PinManager({pinstore:c,blockstore:a,loadCodec:t});const u=createPinnedBlockstore(this.pins,a);this.blocks=createIdStore(u),this.version=version(this.root),this.config=config(this.root),this.spec=spec(this.root),this.apiAddr=apiAddr(this.root),this.gcLock=createMortice({name:e,singleProcess:this.options.repoOwner!==!1}),this.gc=gc({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}async init(e){log("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(buildConfig(e)),await this.spec.set(buildDatastoreSpec(e)),await this.version.set(repoVersion)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch{return!1}}async open(){if(!this.closed)throw errcode(new Error("repo is already open"),ERR_REPO_ALREADY_OPEN);log("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),log("acquired repo.lock"),!await this.version.check(repoVersion))if(await this._isAutoMigrationEnabled())await this._migrate(repoVersion,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new InvalidRepoVersionError("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");log("creating datastore"),await this.datastore.open(),log("creating blocks"),await this.blocks.open(),log("creating keystore"),await this.keys.open(),log("creating pins"),await this.pins.pinstore.open(),this.closed=!1,log("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(t){log("error removing lock",t)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){const e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw errcode(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){log("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(t){throw t.code==="ERR_NOT_FOUND"?errcode(new Error("repo is not initialized yet"),ERR_REPO_NOT_INITIALIZED,{path:this.path}):t}if(!e)throw errcode(new Error("repo is not initialized yet"),ERR_REPO_NOT_INITIALIZED,{path:this.path})}async close(){if(this.closed)throw errcode(new Error("repo is already closed"),ERR_REPO_ALREADY_CLOSED);log("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==ERR_REPO_NOT_INITIALIZED&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),log("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){const[e,t,i,o,a]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),getSize(this.datastore),getSize(this.keys)]),c=t.size+o+a;return{repoPath:this.path,storageMax:e,version:i,numObjects:t.count,repoSize:c}}throw errcode(new Error("repo is not initialized yet"),ERR_REPO_NOT_INITIALIZED,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(AUTO_MIGRATE_CONFIG_KEY)}catch(t){if(t.code===NotFoundError.code)e=!0;else throw t}return e}async _migrate(e,t){return await this.version.get()>e?(log(`reverting to version ${e}`),revert(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(log(`migrating to version ${e}`),migrate(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{const e=await this.config.get("Datastore.StorageMax");return BigInt(bytes$1(e))}catch{return BigInt(noLimit)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(const{key:i,value:o}of this.blocks.query({}))e+=BigInt(1),t+=BigInt(o.byteLength),t+=BigInt(i.bytes.byteLength);return{count:e,size:t}}};async function getSize(n){let e=BigInt(0);for await(const t of n.query({}))e+=BigInt(t.value.byteLength),e+=BigInt(t.key.uint8Array().byteLength);return e}function createRepo(n,e,t,i){return new Repo$1(n,e,t,i)}function buildConfig(n){return n.Datastore=Object.assign({},defaultDatastore,objectSafeGet(n,"datastore")),n}function buildDatastoreSpec(n){const e={...defaultDatastore.Spec,...objectSafeGet(n,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(t=>({mountpoint:t.mountpoint,type:t.child.type,path:t.child.path,shardFunc:t.child.shardFunc}))}}const drain=async n=>{for await(const e of n);};var itDrain=drain;const drain$1=getDefaultExportFromCjs(itDrain),filter=async function*(n,e){for await(const t of n)await e(t)&&(yield t)};var itFilter=filter;const filter$1=getDefaultExportFromCjs(itFilter),take=async function*(n,e){let t=0;if(!(e<1)){for await(const i of n)if(yield i,t++,t===e)return}};var itTake=take;const take$1=getDefaultExportFromCjs(itTake),sortAll=(n,e)=>async function*(){yield*(await all$3(n)).sort(e)}();class BaseBlockstore{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,i){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:i,value:o}of e)await this.put(i,o,t),yield{key:i,value:o}}async*getMany(e,t={}){for await(const i of e)yield this.get(i,t)}async*deleteMany(e,t={}){for await(const i of e)await this.delete(i,t),yield i}batch(){let e=[],t=[];return{put(i,o){e.push({key:i,value:o})},delete(i){t.push(i)},commit:async i=>{await drain$1(this.putMany(e,i)),e=[],await drain$1(this.deleteMany(t,i)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let i=this._all(e,t);if(e.prefix!=null&&(i=filter$1(i,o=>o.key.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((o,a)=>filter$1(o,a),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((o,a)=>sortAll(o,a),i)),e.offset!=null){let o=0;i=filter$1(i,()=>o++>=(e.offset||0))}return e.limit!=null&&(i=take$1(i,e.limit)),i}queryKeys(e,t){let i=this._allKeys(e,t);if(e.prefix!=null&&(i=filter$1(i,o=>o.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((o,a)=>filter$1(o,a),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((o,a)=>sortAll(o,a),i)),e.offset!=null){let o=0;i=filter$1(i,()=>o++>=e.offset)}return e.limit!=null&&(i=take$1(i,e.limit)),i}}function cidToKey(n){const e=CID.asCID(n);if(!e)throw errcode(new Error("Not a valid cid"),"ERR_INVALID_CID");return new Key("/"+base32.encode(e.multihash.bytes).slice(1).toUpperCase(),!1)}function keyToCid(n){return CID.createV1(code$1,decode$6(base32.decode("b"+n.toString().slice(1).toLowerCase())))}function convertPrefix(n){const e=n.substring(0,1);if(e==="/")return convertPrefix(n.substring(1));let t;e.toLowerCase()==="b"?t=a=>base32.decode(a.toLowerCase()).subarray(2):e.toLowerCase()==="c"?t=a=>base32pad.decode(a.toLowerCase()).subarray(2):e==="z"?t=a=>base58btc.decode(a).subarray(2):e==="Q"?t=a=>base58btc.decode("z"+a):t=a=>base32.decode("b"+a.toLowerCase()).subarray(2);let i;for(let a=1;a<n.length;a++)try{i=t(n.substring(0,a))}catch(c){if(c.message!=="Unexpected end of data")throw c}let o="/C";return i&&(o=`/${base32.encode(i).slice(1,-1).toUpperCase()||"C"}`),o}function convertQuery(n){return{...n,prefix:n.prefix?convertPrefix(n.prefix):void 0,filters:n.filters?n.filters.map(e=>t=>e({key:keyToCid(t.key),value:t.value})):void 0,orders:n.orders?n.orders.map(e=>(t,i)=>e({key:keyToCid(t.key),value:t.value},{key:keyToCid(i.key),value:i.value})):void 0}}function convertKeyQuery(n){return{...n,prefix:n.prefix?convertPrefix(n.prefix):void 0,filters:n.filters?n.filters.map(e=>t=>e(keyToCid(t))):void 0,orders:n.orders?n.orders.map(e=>(t,i)=>e(keyToCid(t),keyToCid(i))):void 0}}class BlockstoreDatastoreAdapter extends BaseBlockstore{constructor(e){super(),this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,t){for await(const{key:i,value:o}of this.child.query(convertQuery(e),t))yield{key:keyToCid(i),value:o}}async*queryKeys(e,t){for await(const i of this.child.queryKeys(convertKeyQuery(e),t))yield keyToCid(i)}async get(e,t){return this.child.get(cidToKey(e),t)}async*getMany(e,t){for await(const i of e)yield this.get(i,t)}async put(e,t,i){await this.child.put(cidToKey(e),t,i)}async*putMany(e,t){const i=pushable({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{const a=this.child;await drain$2(this.child.putMany(async function*(){for await(const c of e){const u=cidToKey(c.key);await a.has(u,t)||(yield{key:u,value:c.value}),i.push(c)}}())),i.end()}catch(a){i.end(a)}}),yield*i}has(e,t){return this.child.has(cidToKey(e),t)}delete(e,t){return this.child.delete(cidToKey(e),t)}deleteMany(e,t){const i=pushable({objectMode:!0});return drain$2(this.child.deleteMany(async function*(){for await(const o of e)yield cidToKey(o),i.push(o);i.end()}(),t)).catch(o=>{i.end(o)}),i}}function create$1(n){const e=new MemoryDatastore;return createRepo(n,t=>{const i={[code$2]:dagPB,[name$2]:dagPB,[code$3]:dagCBOR,[name$3]:dagCBOR,[code$1]:raw,[name$1]:raw};return Promise.resolve(i[t])},{root:new LevelDatastore(`${n}/root`,{prefix:"",version:2}),blocks:new BlockstoreDatastoreAdapter(new LevelDatastore(`${n}/blocks`,{prefix:"",version:2})),keys:new LevelDatastore(`${n}/keys`,{prefix:"",version:2}),datastore:e,pins:new LevelDatastore(`${n}/pins`,{prefix:"",version:2})},{repoLock:{lock:async()=>({close:async()=>{}}),locked:async()=>!1},autoMigrate:!1})}const latestPeerTimeoutIds={},isSafari=/^((?!chrome|android).)*safari/i.test(globalThis.navigator?.userAgent||""),KEEP_ALIVE_INTERVAL=1*60*1e3,KEEP_TRYING_INTERVAL=5*60*1e3,BACKOFF_INIT={retryNumber:0,lastBackoff:0,currentBackoff:1e3},OPTIONS={config:{Addresses:{Delegates:[]},Bootstrap:[],Discovery:{webRTCStar:{Enabled:!1}},Pubsub:{Enabled:!1}},preload:{enabled:!1,addresses:[]},libp2p:{peerDiscovery:[],connectionManager:{autoDial:!1}},init:{algorithm:isSafari?RSA:void 0,emptyRepo:!0}};async function createAndConnect(n,e,t,i,o){const a=await listPeers(n.storage,t);if(a.length===0)throw new Error(" Couldn't start IPFS node, peer list is empty");const c=create$1(i),u=await e.create({...OPTIONS,repo:c});return a.forEach(d=>{latestPeerTimeoutIds[d.toString()]=null,tryConnecting(u,d,o)}),globalThis.addEventListener("online",async()=>{(await listPeers(n.storage,t)).filter(d=>{const p=d.toString();return!p.includes("/localhost/")&&!p.includes("/127.0.0.1/")&&!p.includes("/0.0.0.0/")}).forEach(d=>{tryConnecting(u,d,o)})}),o&&console.log(" Started IPFS node"),{ipfs:u,repo:c}}function fetchPeers(n){return fetch(n).then(e=>e.json()).then(e=>Array.isArray(e)?e:[]).then(e=>e.filter(t=>isString(t)&&t.includes("/wss/"))).catch(()=>{throw new Error(" Couldn't start IPFS node, failed to fetch peer list")})}async function listPeers(n,e){let t;const i=`ipfs-peers-${e}`,o=await n.getItem(i);return isString(o)&&o.trim()!==""?(t=JSON.parse(o),fetchPeers(e).then(a=>n.setItem(i,JSON.stringify(a))).catch(a=>{console.error(a)})):(t=await fetchPeers(e),await n.setItem(i,JSON.stringify(t))),t.map(multiaddr)}function keepAlive(n,e,t,i){let o=null;t.currentBackoff<KEEP_TRYING_INTERVAL?o=setTimeout(()=>reconnect(n,e,t,i),t.currentBackoff):o=setTimeout(()=>reconnect(n,e,t,i),KEEP_TRYING_INTERVAL),latestPeerTimeoutIds[e.toString()]=o,ping(n,e).then(({latency:a})=>{const c={connected:!0,lastConnectedAt:Date.now(),latency:a};report(e,c),o&&clearTimeout(o),o===latestPeerTimeoutIds[e.toString()]&&setTimeout(()=>keepAlive(n,e,BACKOFF_INIT,c),KEEP_ALIVE_INTERVAL)}).catch(()=>{})}async function reconnect(n,e,t,i){const o={...i,connected:!1,latency:null};report(e,o);try{await n.swarm.disconnect(e),await n.swarm.connect(e)}catch{}if(t.currentBackoff<KEEP_TRYING_INTERVAL){const a={retryNumber:t.retryNumber+1,lastBackoff:t.currentBackoff,currentBackoff:t.lastBackoff+t.currentBackoff};keepAlive(n,e,a,o)}else keepAlive(n,e,t,o)}function tryConnecting(n,e,t){ping(n,e).then(({latency:i})=>n.swarm.connect(e,{timeout:60*1e3}).then(()=>{t&&console.log(` Connected to ${e}`);const o={connected:!0,lastConnectedAt:Date.now(),latency:i};report(e,o),setTimeout(()=>keepAlive(n,e,BACKOFF_INIT,o),KEEP_ALIVE_INTERVAL)})).catch(()=>{t&&console.log(` Could not connect to ${e}`);const i={connected:!1,lastConnectedAt:null,latency:null};report(e,i),keepAlive(n,e,BACKOFF_INIT,i)})}async function ping(n,e){return n.libp2p.ping(e).then(t=>({latency:t}))}let peerConnections=[];function report(n,e){peerConnections=peerConnections.filter(i=>i.peer!==n).concat({peer:n,status:e}),peerConnections.every(i=>!i.status.connected),peerConnections.reduce((i,{status:o})=>i>=(o.lastConnectedAt||0)?i:o.lastConnectedAt||0,0);const t=peerConnections.filter(i=>i.status.latency!==null);t.length>0&&peerConnections.reduce((i,o)=>i+(o.status.latency||0),0)/t.length}const DEFAULT_CDN_URL="https://unpkg.com/ipfs-core@0.17.0/dist/index.min.js",nodeWithPkg=(n,e,t,i,o)=>createAndConnect(n,e,t,i,o),pkgFromCDN=async n=>{if(!n)throw new Error("This function requires a URL to a CDN");return __vitePreload(()=>import(n),[]).then(e=>self.IpfsCore)};async function implementation$c(n){return{getBlock:async e=>{const{ipfs:t}=await n();return t.block.get(e)},getUnixDirectory:async e=>{const{ipfs:t}=await n(),i=[];for await(const o of t.ls(e)){const{name:a="",cid:c,size:u,type:d}=o;i.push({name:a,cid:c,size:u,isFile:d!=="dir"})}return i},getUnixFile:async e=>{const{ipfs:t}=await n(),i=[];for await(const o of t.cat(e))i.push(o);return concat(i)},putBlock:async(e,t)=>{const{repo:i}=await n(),o=getByIdentifier(t),a=await sha256.digest(e),c=CID.createV1(o.code,a);return await i.blocks.put(c,e),c},putChunked:async e=>{const{ipfs:t}=await n();return{...await t.add(e,{cidVersion:1,hashAlg:"sha2-256",rawLeaves:!0,wrapWithDirectory:!1,preload:!1,pin:!1}),isFile:!0}},size:async e=>{const{ipfs:t}=await n();return(await t.files.stat(`/ipfs/${e}`)).cumulativeSize}}}async function implementation$b(n,e,t){let i=null;return implementation$c(async()=>i||(i=await nodeWithPkg(n,await pkgFromCDN(DEFAULT_CDN_URL),e,t,!1),i))}async function implementation$a(n,e){return implementation$b(n,PRODUCTION.server+"/ipfs/peers",e)}function endpoint(n){return({rootDID:e})=>`${n}/user/link/${e}`}const createWssChannel=async(n,e,t)=>{const{username:i,handleMessage:o}=t,a=await waitForRootDid(n,i);if(!a)throw new Error(`Failed to lookup DID for ${i}`);const c=`deviceLink#${a}`;console.log("Opening channel",c);const u=new WebSocket(e({rootDID:a}));await waitForOpenConnection(u),u.onmessage=o;const d=publishOnWssChannel(u),p=closeWssChannel(u);return{send:d,close:p}},waitForRootDid=async(n,e)=>{let t=await n.didRoot.lookup(e).catch(()=>(console.warn("Could not fetch root DID. Retrying."),null));return t||new Promise((i,o)=>{let c=0;const u=setInterval(async()=>{if(t=await n.didRoot.lookup(e).catch(()=>(console.warn("Could not fetch root DID. Retrying."),null)),!t&&c<10){c++;return}else!t&&c===10&&o("Failed to fetch root DID.");clearInterval(u),i(t)},1e3)})},waitForOpenConnection=async n=>new Promise((e,t)=>{n.onopen=()=>e(),n.onerror=()=>t("Websocket channel could not be opened")}),closeWssChannel=n=>function(){n&&n.close(1e3)},publishOnWssChannel=n=>function(e){const t=typeof e=="string"?new TextEncoder().encode(e).buffer:e;n?.send(t)},USERNAME_BLOCKLIST=["fission","ipfs","ipns","did","id","identity",".htaccess","htaccess",".htpasswd","htpasswd",".well-known","well-known","400","401","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","421","422","423","424","426","428","429","431","500","501","502","503","504","505","506","507","508","509","510","511","_domainkey","about","about-us","abuse","access","account","accounts","ad","add","admin","administration","administrator","ads","ads.txt","advertise","advertising","aes128-ctr","aes128-gcm","aes192-ctr","aes256-ctr","aes256-gcm","affiliate","affiliates","ajax","alert","alerts","alpha","amp","analytics","api","app","app-ads.txt","apps","asc","assets","atom","auth","authentication","authorize","autoconfig","autodiscover","avatar","backup","banner","banners","bbs","beta","billing","billings","blog","blogs","board","bookmark","bookmarks","broadcasthost","business","buy","cache","calendar","campaign","captcha","careers","cart","cas","categories","category","cdn","cgi","cgi-bin","chacha20-poly1305","change","channel","channels","chart","chat","checkout","clear","client","close","cloud","cms","com","comment","comments","community","compare","compose","config","connect","contact","contest","cookies","copy","copyright","count","cp","cpanel","create","crossdomain.xml","css","curve25519-sha256","customer","customers","customize","dashboard","db","deals","debug","delete","desc","destroy","dev","developer","developers","diffie-hellman-group-exchange-sha256","diffie-hellman-group14-sha1","disconnect","discuss","dns","dns0","dns1","dns2","dns3","dns4","docs","documentation","domain","download","downloads","downvote","draft","drop","ecdh-sha2-nistp256","ecdh-sha2-nistp384","ecdh-sha2-nistp521","edit","editor","email","enterprise","error","errors","event","events","example","exception","exit","explore","export","extensions","false","family","faq","faqs","favicon.ico","features","feed","feedback","feeds","file","files","filter","follow","follower","followers","following","fonts","forgot","forgot-password","forgotpassword","form","forms","forum","forums","friend","friends","ftp","get","git","go","graphql","group","groups","guest","guidelines","guides","head","header","help","hide","hmac-sha","hmac-sha1","hmac-sha1-etm","hmac-sha2-256","hmac-sha2-256-etm","hmac-sha2-512","hmac-sha2-512-etm","home","host","hosting","hostmaster","htpasswd","http","httpd","https","humans.txt","icons","images","imap","img","import","index","info","insert","investors","invitations","invite","invites","invoice","is","isatap","issues","it","jobs","join","js","json","keybase.txt","learn","legal","license","licensing","like","limit","live","load","local","localdomain","localhost","lock","login","logout","lost-password","m","mail","mail0","mail1","mail2","mail3","mail4","mail5","mail6","mail7","mail8","mail9","mailer-daemon","mailerdaemon","map","marketing","marketplace","master","me","media","member","members","message","messages","metrics","mis","mobile","moderator","modify","more","mx","mx1","my","net","network","new","news","newsletter","newsletters","next","nil","no-reply","nobody","noc","none","noreply","notification","notifications","ns","ns0","ns1","ns2","ns3","ns4","ns5","ns6","ns7","ns8","ns9","null","oauth","oauth2","offer","offers","online","openid","order","orders","overview","owa","owner","page","pages","partners","passwd","password","pay","payment","payments","photo","photos","pixel","plans","plugins","policies","policy","pop","pop3","popular","portal","portfolio","post","postfix","postmaster","poweruser","preferences","premium","press","previous","pricing","print","privacy","privacy-policy","private","prod","product","production","profile","profiles","project","projects","public","purchase","put","quota","recover","recovery","redirect","reduce","refund","refunds","register","registration","remove","replies","reply","report","request","request-password","reset","reset-password","response","return","returns","review","reviews","robots.txt","root","rootuser","rsa-sha2-2","rsa-sha2-512","rss","rules","sales","save","script","sdk","search","secure","security","select","services","session","sessions","settings","setup","share","shift","shop","signin","signup","site","sitemap","sites","smtp","sort","source","sql","ssh","ssh-rsa","ssl","ssladmin","ssladministrator","sslwebmaster","stage","staging","stat","static","statistics","stats","status","store","style","styles","stylesheet","stylesheets","subdomain","subscribe","sudo","super","superuser","support","survey","sync","sysadmin","system","tablet","tag","tags","team","telnet","terms","terms-of-use","test","testimonials","theme","themes","today","tools","topic","topics","tour","training","translate","translations","trending","trial","true","umac-128","umac-128-etm","umac-64","umac-64-etm","undefined","unfollow","unlike","unsubscribe","update","upgrade","usenet","user","username","users","uucp","var","verify","video","view","void","vote","vpn","webmail","webmaster","website","widget","widgets","wiki","wpad","write","www","www-data","www1","www2","www3","www4","you","yourname","yourusername","zlib"];async function createAccount(n,e,t){const i=encode$6(await build({audience:await did(n),dependencies:e,issuer:await write(e.crypto)}));return{success:(await fetch(apiUrl(n,"/user"),{method:"PUT",headers:{authorization:`Bearer ${i}`,"content-type":"application/json"},body:JSON.stringify(t)})).status<300}}async function isUsernameAvailable$1(n,e){return!(await fetch(apiUrl(n,`/user/data/${e}`))).ok}function isUsernameValid$1(n){return!n.startsWith("-")&&!n.endsWith("-")&&!n.startsWith("_")&&/^[a-zA-Z0-9_-]+$/.test(n)&&!USERNAME_BLOCKLIST.includes(n.toLowerCase())}function createChannel(n,e,t){return createWssChannel(e.reference,endpoint(`${n.server}${n.apiPath}`.replace(/^https?:\/\//,"wss://")),t)}const isUsernameAvailable=async(n,e)=>isUsernameAvailable$1(n,e),isUsernameValid=async n=>isUsernameValid$1(n),register=async(n,e,t)=>{const{success:i}=await createAccount(n,e,t);return i?register$1(e,{...t,type:TYPE}):{success:!1}};function implementation$9(n,e){const t=implementation$f(e);return{type:t.type,canDelegateAccount:t.canDelegateAccount,delegateAccount:t.delegateAccount,linkDevice:t.linkDevice,session:t.session,isUsernameValid,createChannel:(...i)=>createChannel(n,e,...i),isUsernameAvailable:(...i)=>isUsernameAvailable(n,...i),register:(...i)=>register(n,e,...i)}}async function canDelegateAccount(n,e){const t=await n.reference.didRoot.lookup(e);return await retrieve({crypto:n.crypto,accountDID:t})?canDelegateAccount$1(n,e):!1}async function delegateAccount(n,e,t){const i=await n.reference.didRoot.lookup(e),o=await retrieve({crypto:n.crypto,accountDID:i}),{token:a}=await delegateAccount$2(n,e,t);return{readKey:toString$3(o,"base64pad"),ucan:a}}async function linkDevice(n,e,t){if(!isWnfsLinkingData(t))throw new LinkingError(`Consumer received invalid link device response from producer: Expected read key and ucan, but got ${JSON.stringify(t)}`);const{readKey:i,ucan:o}=t,a=decode$4(o);if(await isValid(n.crypto,a)){await n.storage.setItem(n.storage.KEYS.ACCOUNT_UCAN,o),await store({accountDID:await n.reference.didRoot.lookup(e),crypto:n.crypto,readKey:fromString(i)});const c=await write(n.crypto),u=await build({dependencies:n,potency:"APPEND",resource:"*",proof:o,lifetimeInSeconds:60*60*24*30*12*1e3,audience:c,issuer:c});await n.reference.repositories.ucans.add(u)}else throw new LinkingError(`Consumer received invalid link device response from producer. Given ucan is invalid: ${t.ucan}`);await provide(n.storage,{type:TYPE,username:e})}async function session(n,e,t,i){if(e){if(!n.reference.repositories.ucans.find(u=>u.payload.exp<Date.now()+604800?!1:u.payload.ptc==="APPEND"&&u.payload.rsc==="*")){const u=await write(n.crypto),d=await n.storage.getItem(n.storage.KEYS.ACCOUNT_UCAN),p=await build({dependencies:n,potency:"APPEND",resource:"*",proof:d||void 0,lifetimeInSeconds:60*60*24*30*12*1e3,audience:u,issuer:u});await n.reference.repositories.ucans.add(p)}const a=t.fileSystem?.loadImmediately===!1?void 0:await loadFileSystem$1({config:t,dependencies:{crypto:n.crypto,depot:n.depot,manners:n.manners,reference:n.reference,storage:n.storage},eventEmitter:i.fileSystem,username:e});return new Session({crypto:n.crypto,fs:a,eventEmitter:i.session,storage:n.storage,type:TYPE,username:e})}return null}function isWnfsLinkingData(n){return isObject$1(n)&&"readKey"in n&&typeof n.readKey=="string"&&"ucan"in n&&typeof n.ucan=="string"}function implementation$8(n){const e=implementation$f(n);return{type:e.type,session,canDelegateAccount:(...t)=>canDelegateAccount(n,...t),delegateAccount:(...t)=>delegateAccount(n,...t),linkDevice:(...t)=>linkDevice(n,...t),createChannel:e.createChannel,isUsernameValid:e.isUsernameValid,isUsernameAvailable:e.isUsernameAvailable,register:e.register}}function implementation$7(n,e){const t=implementation$9(n,e),i=implementation$8(e);return{type:i.type,canDelegateAccount:i.canDelegateAccount,delegateAccount:i.delegateAccount,linkDevice:i.linkDevice,session:i.session,createChannel:t.createChannel,isUsernameValid:t.isUsernameValid,isUsernameAvailable:t.isUsernameAvailable,register:t.register}}function implementation$6(n){return implementation$7(PRODUCTION,n)}async function collect(n,e){const t=new URL(self.location.href),i=t.searchParams.get("username")??"";if(!i)return null;const o=await retry(()=>getClassifiedViaPostMessage(n,e.crypto),{tries:20,timeout:6e4,timeoutMessage:"Trying to retrieve UCAN(s) and readKey(s) from the auth lobby timed out after 60 seconds."}),a=await translateClassifiedInfo(e,o);if(!a)throw new Error("Failed to retrieve secrets from lobby url parameters");return t.searchParams.delete("authorised"),t.searchParams.delete("cancelled"),t.searchParams.delete("newUser"),t.searchParams.delete("username"),history.replaceState(null,document.title,t.toString()),{...a,username:i}}async function request(n,e,t={}){const{permissions:i}=t,o=i?.app,a=i?.fs,c=i?.platform,u=i?.raw,d=i?.sharing,p=await exchange(e.crypto),h=await write(e.crypto),b=t.returnUrl||window.location.href,m=[["didExchange",p],["didWrite",h],["redirectTo",b],["sdk",VERSION.toString()],["sharedRepo","f"],["sharing",d?"t":"f"]].concat(o?[["appFolder",`${o.creator}/${o.name}`]]:[],a?.private?a.private.map(v=>["privatePath",toPosix(v,{absolute:!0})]):[],a?.public?a.public.map(v=>["publicPath",toPosix(v,{absolute:!0})]):[],u?[["raw",urlEncode(JSON.stringify(u))]]:[],t.extraParams?Object.entries(t.extraParams):[]).concat((()=>{const v=c?.apps;switch(typeof v){case"string":return[["app",v]];case"object":return v.map(_=>["app",_]);default:return[]}})());window.location.href=n.lobby+"?"+m.map(([v,_])=>encodeURIComponent(v)+"="+encodeURIComponent(_)).join("&")}async function getClassifiedViaPostMessage(n,e){const t=await exchange(e),i=await new Promise(o=>{const a=document.createElement("iframe");a.id="odd-secret-exchange",a.style.width="0",a.style.height="0",a.style.border="none",a.style.display="none",document.body.appendChild(a),a.onload=()=>{o(a)},a.src=`${n.lobby}/exchange.html`});return new Promise((o,a)=>{function c(){globalThis.removeEventListener("message",u),document.body.removeChild(i),a()}function u(p){if(new URL(p.origin).host!==new URL(n.lobby).host||p.data==null)return c();let h;try{h=JSON.parse(p.data)}catch{c()}isLobbyClassifiedInfo(h)||c(),globalThis.removeEventListener("message",u);try{document.body.removeChild(i)}catch{}o(h)}if(globalThis.addEventListener("message",u),i.contentWindow==null)throw new Error("Can't import UCANs & readKey(s): No access to its contentWindow");const d={odd:"exchange-secrets",didExchange:t};i.contentWindow.postMessage(d,i.src)})}function isLobbyClassifiedInfo(n){return isObject$1(n)&&isString(n.sessionKey)&&isString(n.secrets)&&isString(n.iv)}function isLobbySecrets(n){return isObject$1(n)&&isObject$1(n.fs)&&Object.values(n.fs).every(e=>hasProp(e,"key")&&hasProp(e,"bareNameFilter"))&&Array.isArray(n.ucans)&&n.ucans.every(e=>isString(e))}async function translateClassifiedInfo({crypto:n},e){const t=await n.keystore.decrypt(fromString$3(e.sessionKey,"base64pad")),o=t[1]===0?fromString$3(new TextDecoder("utf-16").decode(t),"base64pad"):t,a=await n.aes.decrypt(fromString$3(e.secrets,"base64pad"),o,SymmAlg.AES_GCM,fromString$3(e.iv,"base64pad")),c=JSON.parse(toString$3(a,"utf8"));if(!isLobbySecrets(c))throw new Error("Invalid secrets received");const u=isLobbySecrets(c)?Object.entries(c.fs).map(([p,{bareNameFilter:h,key:b}])=>({bareNameFilter:h,path:fromPosix(p),readKey:fromString$3(b,"base64pad")})):[],d=c.ucans.map(p=>decode$4(p));return{fileSystemSecrets:u,ucans:d}}async function retry(n,e){return new Promise((t,i)=>{if(e.tries>0){const o=()=>{retry(n,{...e,tries:e.tries-1})},a=setTimeout(o,e.timeout);n().then(t,o).finally(()=>clearTimeout(a))}else i(new Error(e.timeoutMessage))})}function implementation$5(n,e){return{collect:()=>collect(n,e),request:(...t)=>request(n,e,...t)}}function implementation$4(n){return implementation$5(PRODUCTION,n)}function create({storage:n}){return Repo.create({storage:n,storageName:n.KEYS.CID_LOG})}class Repo extends Repository{constructor(e){super(e)}fromJSON(e){return decodeCID(e)}toJSON(e){return e.toString()}indexOf(e){return this.memoryCache.map(t=>t.toString()).indexOf(e.toString())}newest(){return this.memoryCache[this.memoryCache.length-1]}}async function didRootLookup(n,e){const t=await n.storage.getItem(n.storage.KEYS.ACCOUNT_UCAN);return t?rootIssuer(t):await write(n.crypto)}async function implementation$3(n){return{dataRoot:{domain:()=>{throw new Error("Not implemented")},lookup:()=>{throw new Error("Not implemented")},update:()=>{throw new Error("Not implemented")}},didRoot:{lookup:(...e)=>didRootLookup(n,...e)},dns:{lookupDnsLink,lookupTxtRecord},repositories:{cidLog:await create({storage:n.storage}),ucans:await create$4({storage:n.storage})}}}async function lookup(n,e,t){const i=await lookupOnFisson(n,e,t);if(!i)return null;if(i!==null)return i;try{const o=await lookupDnsLink(t+".files."+n.userDomain);return o?decodeCID(o):null}catch(o){throw console.error(o),new Error("Could not locate user root in DNS")}}async function lookupOnFisson(n,e,t){try{const o=await(await fetch(apiUrl(n,`user/data/${t}`),{cache:"reload"})).json();return decodeCID(o)}catch(i){return e.manners.log("Could not locate user root on Fission server: ",hasProp(i,"toString")?i.toString():i),null}}async function update(n,e,t,i){const o=t.toString();return e.manners.log(" Updating your DNSLink:",o),await fetchWithRetry(apiUrl(n,`user/data/${o}`),{headers:async()=>({authorization:`Bearer ${encode$6(await build({dependencies:e,audience:await did(n),issuer:await write(e.crypto),potency:"APPEND",proof:encode$6(i),resource:i.payload.rsc}))}`}),retries:100,retryDelay:5e3,retryOn:[502,503,504]},{method:"PUT"}).then(a=>(a.status<300?e.manners.log(" DNSLink updated:",o):e.manners.log(" Failed to update DNSLink for:",o),{success:a.status<300})).catch(a=>(e.manners.log(" Failed to update DNSLink for:",o),console.error(a),{success:!1}))}async function fetchWithRetry(n,e,t,i=0){const o=await e.headers(),a=await fetch(n,{...t,headers:{...t.headers,...o}});if(e.retryOn.includes(a.status)){if(i<e.retries)return await new Promise((c,u)=>setTimeout(()=>fetchWithRetry(n,e,t,i+1).then(c,u),e.retryDelay));throw new Error("Too many retries for fetch")}return a}async function root(n,e){try{const t=await lookupTxtRecord(`_did.${e}.${n.userDomain}`);if(t!==null)return t}catch{}throw new Error("Could not locate user DID in DNS.")}async function implementation$2(n,e){const t=await implementation$3(e);return t.dataRoot.domain=i=>`${i}.files.${n.userDomain}`,t.dataRoot.lookup=(...i)=>lookup(n,e,...i),t.dataRoot.update=(...i)=>update(n,e,...i),t.didRoot.lookup=(...i)=>root(n,...i),t}function implementation$1(n){return implementation$2(PRODUCTION,n)}function implementation(n){return{log:n.configuration.debug?console.log:()=>{},warn:n.configuration.debug?console.warn:()=>{},wnfsWasmLookup:e=>fetch(`https://unpkg.com/wnfs@${e}/wasm_wnfs_bg.wasm`),fileSystem:{hooks:{afterLoadExisting:async()=>{},afterLoadNew:async e=>{await e.publish()},beforeLoadExisting:async()=>{},beforeLoadNew:async()=>{}}}}}var ProgramError;(function(n){n.InsecureContext="INSECURE_CONTEXT",n.UnsupportedBrowser="UNSUPPORTED_BROWSER"})(ProgramError||(ProgramError={}));async function program(n){if(!n)throw new Error("Expected a settings object of the type `Partial<Components> & Configuration` as the first parameter");if(globalThis.isSecureContext===!1)throw ProgramError.InsecureContext;if(await isSupported()===!1)throw ProgramError.UnsupportedBrowser;const e=await gatherComponents(n);return assemble(extractConfig(n),e)}async function assemble(n,e){const t=n.permissions;await ensureBackwardsCompatibility(e,n);const i=createEmitter(),o=createEmitter(),a=merge$1(i,o),c=await restore(e.storage),u=(m=>({implementation:m,accountConsumer(v){return createConsumer({auth:m,crypto:e.crypto,manners:e.manners},{username:v})},accountProducer(v){return createProducer({auth:m,crypto:e.crypto,manners:e.manners},{username:v})},isUsernameAvailable:m.isUsernameAvailable,isUsernameValid:m.isUsernameValid,register:m.register,async session(){const v=await restore(e.storage);return v?this.implementation.session(e,v.username,n,{fileSystem:i,session:o}):null}}))(e.auth),d={async collect(){const m=await e.capabilities.collect();return m?(await collect$1({capabilities:m,crypto:e.crypto,reference:e.reference,storage:e.storage}),m.username):null},request(m){return e.capabilities.request({permissions:t,...m||{}})},async session(m){if(!validatePermissions(e.reference.repositories.ucans,t||{}))return console.warn("The present UCANs did not satisfy the configured permissions."),null;const _=await e.reference.didRoot.lookup(m);if(!await validateSecrets(e.crypto,_,t||{}))return console.warn("The present filesystem secrets did not satisfy the configured permissions."),null;await provide(e.storage,{type:SESSION_TYPE,username:m});const k=n.fileSystem?.loadImmediately===!1?void 0:await loadFileSystem$1({config:n,dependencies:e,eventEmitter:i,username:m});return new Session({fs:k,username:m,crypto:e.crypto,storage:e.storage,type:SESSION_TYPE,eventEmitter:o})}};let p=null;if(isCapabilityBasedAuthConfiguration(n)){const m=await d.collect();m&&(p=await d.session(m)),c&&c.type===SESSION_TYPE&&(p=await d.session(c.username))}else c&&c.type!==SESSION_TYPE&&(p=await u.session());const b={...{accountDID:m=>e.reference.didRoot.lookup(m),agentDID:()=>write(e.crypto),sharingDID:()=>exchange(e.crypto),fileSystem:{addPublicExchangeKey:m=>addPublicExchangeKey(e.crypto,m),addSampleData:m=>addSampleData(m),hasPublicExchangeKey:m=>hasPublicExchangeKey(e.crypto,m),load:m=>loadFileSystem$1({config:n,username:m,dependencies:e,eventEmitter:i}),recover:m=>recoverFileSystem({auth:u,dependencies:e,...m})}},...listenTo(a),configuration:{...n},auth:u,components:e,capabilities:d,session:p};if(n.debug){if(n.debugging?.injectIntoGlobalContext===void 0?!0:n.debugging?.injectIntoGlobalContext){const _=globalThis;_.__odd=_.__odd||{},_.__odd.programs=_.__odd.programs||{},_.__odd.programs[namespace(n)]=b}if(n.debugging?.emitWindowPostMessages===void 0?!0:n.debugging?.emitWindowPostMessages){const{connect:_,disconnect:$}=await create$3({namespace:n.namespace,session:p,capabilities:n.permissions,dependencies:e,eventEmitters:{fileSystem:i,session:o}}),k=globalThis;k.__odd=k.__odd||{},k.__odd.extension=k.__odd.extension||{},k.__odd.extension.connect=_,k.__odd.extension.disconnect=$,globalThis.postMessage({id:"odd-devtools-ready-message"})}}return b}async function gatherComponents(n){const e=extractConfig(n),t=n.crypto||await defaultCryptoComponent(e),i=n.manners||defaultMannersComponent(e),o=n.storage||defaultStorageComponent(e),a=n.reference||await defaultReferenceComponent({crypto:t,manners:i,storage:o}),c=n.depot||await defaultDepotComponent({storage:o},e),u=n.capabilities||defaultCapabilitiesComponent({crypto:t});return{auth:n.auth||defaultAuthComponent({crypto:t,reference:a,storage:o}),capabilities:u,crypto:t,depot:c,manners:i,reference:a,storage:o}}function defaultAuthComponent({crypto:n,reference:e,storage:t}){return implementation$6({crypto:n,reference:e,storage:t})}function defaultCapabilitiesComponent({crypto:n}){return implementation$4({crypto:n})}function defaultCryptoComponent(n){return implementation$e({storeName:namespace(n),exchangeKeyName:"exchange-key",writeKeyName:"write-key"})}function defaultDepotComponent({storage:n},e){return implementation$a({storage:n},`${namespace(e)}/ipfs`)}function defaultMannersComponent(n){return implementation({configuration:n})}function defaultReferenceComponent({crypto:n,manners:e,storage:t}){return implementation$1({crypto:n,manners:e,storage:t})}function defaultStorageComponent(n){return implementation$d({name:namespace(n)})}async function isSupported(){return localforage.supports(localforage.INDEXEDDB)&&await(()=>new Promise(n=>{const e=indexedDB.open("testDatabase");e.onsuccess=()=>n(!0),e.onerror=()=>n(!1)}))()}async function ensureBackwardsCompatibility(n,e){const[t,i]=["migrated",VERSION],o=fromString$1(VERSION);if(!o)throw new Error("The ODD SDK VERSION should be a semver string");if(await n.storage.getItem(t).then(p=>typeof p=="string"?fromString$1(p):null).then(p=>p&&isBiggerThanOrEqualTo(p,o))||!globalThis.indexedDB)return;const c=globalThis.indexedDB.databases?(await globalThis.indexedDB.databases()).map(p=>p.name):["keystore","localforage"],u=c.includes("keystore")?await bwOpenDatabase("keystore"):null;if(u){const p=await bwGetValue(u,"keyvaluepairs","exchange-key"),h=await bwGetValue(u,"keyvaluepairs","write-key");p&&h&&(await n.storage.setItem("exchange-key",p),await n.storage.setItem("write-key",h))}const d=c.includes("localforage")?await bwOpenDatabase("localforage"):null;if(d){const p=await bwGetValue(d,"keyvaluepairs","ucan"),h=await bwGetValue(d,"keyvaluepairs","webnative.auth_ucans"),b=await bwGetValue(d,"keyvaluepairs","readKey"),m=await bwGetValue(d,"keyvaluepairs","webnative.auth_username");if(b&&isString(b)){const v=p||(Array.isArray(h)?h[0]:void 0),_=v?rootIssuer(v):typeof m=="string"?await n.reference.didRoot.lookup(m):null;if(!_)throw new Error("Failed to retrieve account DID");await store({accountDID:_,crypto:n.crypto,readKey:fromString$3(b,"base64pad")})}p&&await n.storage.setItem(n.storage.KEYS.ACCOUNT_UCAN,p),m&&await n.storage.setItem(n.storage.KEYS.SESSION,JSON.stringify({type:isCapabilityBasedAuthConfiguration(e)?SESSION_TYPE:TYPE,username:m}))}await n.storage.setItem(t,i)}function bwGetValue(n,e,t){return new Promise((i,o)=>{if(!n.objectStoreNames.contains(e))return i(null);const u=n.transaction([e],"readonly").objectStore(e).get(t);u.onerror=()=>{i(null)},u.onsuccess=()=>{i(u.result)}})}function bwOpenDatabase(n){return new Promise((e,t)=>{const i=globalThis.indexedDB.open(n);i.onerror=()=>{e(null)},i.onsuccess=()=>{e(i.result)},i.onupgradeneeded=o=>{i.transaction?.abort(),globalThis.indexedDB.deleteDatabase(n)}})}function extractConfig(n){return{namespace:n.namespace,debug:n.debug,fileSystem:n.fileSystem,permissions:n.permissions,userMessages:n.userMessages}}function isCapabilityBasedAuthConfiguration(n){return!!n.permissions}function createTaskPortNamespace(n){return n.createNamespace("fission-codes/webnative","8.1.0")}function init(n){const e=Object.fromEntries((n.fileSystems||[]).map(c=>[fileSystemRef(c),c])),t=Object.fromEntries((n.programs||[]).map(c=>[programRef(c),c])),i=createTaskPortNamespace(n.TaskPort),o=c=>withProgram(t,c),a=c=>withFileSystem(e,c);return i.register("program",c=>createProgram(t,e,c)),i.register("loadFileSystem",o(c=>u=>loadFileSystem(e,c,u))),i.register("auth_isUsernameAvailable",o(c=>c.auth.isUsernameAvailable)),i.register("auth_isUsernameValid",o(c=>c.auth.isUsernameValid)),i.register("auth_register",o(c=>c.auth.register)),i.register("auth_session",o(c=>c.auth.session)),i.register("capabilities_collect",o(c=>c.capabilities.collect)),i.register("capabilities_request",o(c=>c.capabilities.request)),i.register("capabilities_session",o(c=>c.capabilities.session)),i.register("fileSystem_acceptShare",a(c=>c.acceptShare)),i.register("fileSystem_account",a(c=>c.account)),i.register("fileSystem_deactivate",a(c=>c.deactivate)),i.register("fileSystem_exists",a(c=>c.exists)),i.register("fileSystem_get",a(c=>c.get)),i.register("fileSystem_historyStep",a(c=>c.historyStep)),i.register("fileSystem_loadShare",a(c=>c.loadShare)),i.register("fileSystem_ls",a(c=>c.ls)),i.register("fileSystem_mkdir",a(c=>c.mkdir)),i.register("fileSystem_mv",a(c=>c.mv)),i.register("fileSystem_publish",a(c=>c.publish)),i.register("fileSystem_read",a(c=>c.read)),i.register("fileSystem_resolveSymlink",a(c=>c.resolveSymlink)),i.register("fileSystem_rm",a(c=>c.rm)),i.register("fileSystem_sharePrivate",a(c=>c.sharePrivate)),i.register("fileSystem_symlink",a(c=>c.symlink)),i.register("fileSystem_write",a(addToFileSystem)),{taskPortNamespace:i}}function addToFileSystem(n){return(e,t)=>n.write(e,Uint8Array.from(t))}function createProgram(n,e,t){return program(t).then(i=>{const o=namespace(t);n[o]=i;const a=i.session?.fs?fileSystemRef(i.session.fs):null;return a&&i.session?.fs&&(e[a]=i.session.fs),{ok:encodeProgram(i)}},i=>({err:typeof i=="string"?i:i.message||"Unknown error"}))}async function loadFileSystem(n,e,t){const i=await e.fileSystem.load(t),o=fileSystemRef(i);return n[o]=i,o}function encodeProgram(n){return{fs:n.session&&n.session.fs?fileSystemRef(n.session.fs):null,program:programRef(n),session:n.session}}function fileSystemRef(n){return n.account.rootDID}function programRef(n){return namespace(n.configuration)}function withFileSystem(n,e){return async({arg:t,fileSystemRef:i,useSplat:o})=>{const a=n[i],c=e(a);if(typeof c!="function")return c;const u=o?await c.apply(a,t):await c.call(a,t);return hasProp(u,"account")?null:hasProp(u,"code")?u.toString():hasProp(u,"buffer")?Array.from(u):u}}function withProgram(n,e){return({arg:t,programRef:i,useSplat:o})=>{const a=n[i],c=e(a);return typeof c!="function"?c:o?c.apply(a,t):c.call(a,t)}}export{createTaskPortNamespace,encodeProgram,fileSystemRef,init,programRef};
//# sourceMappingURL=index-5fd5a15c.js.map
